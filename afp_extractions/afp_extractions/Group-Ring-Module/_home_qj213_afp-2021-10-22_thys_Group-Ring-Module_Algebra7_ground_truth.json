{"file_name": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module/Algebra7.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module", "problem_names": ["lemma (in Module) module_is_ag: \"aGroup M\"", "lemma (in Module) module_inc_zero:\" \\<zero>\\<^bsub>M\\<^esub> \\<in> carrier M\"", "lemma (in Module) submodule_subset:\"submodule R M H \\<Longrightarrow> H \\<subseteq> carrier M\"", "lemma (in Module) submodule_asubg:\"submodule R M H \\<Longrightarrow> M +> H\"", "lemma (in Module) submodule_subset1:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                            h \\<in> carrier M\"", "lemma (in Module) submodule_inc_0:\"submodule R M H \\<Longrightarrow>\n                                           \\<zero>\\<^bsub>M\\<^esub> \\<in> H\"", "lemma (in Module) sc_un:\" m \\<in> carrier M \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = m\"", "lemma (in Module) sc_mem:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> carrier M\"", "lemma (in Module) submodule_sc_closed:\"\\<lbrakk>submodule R M H; \n a \\<in> carrier R; h \\<in> H\\<rbrakk> \\<Longrightarrow>  a \\<cdot>\\<^sub>s h \\<in> H\"", "lemma (in Module) sc_assoc:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; \n m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s m =  a \\<cdot>\\<^sub>s ( b \\<cdot>\\<^sub>s m)\"", "lemma (in Module) sc_l_distr:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; \n m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b)\\<cdot>\\<^sub>s m = a \\<cdot>\\<^sub>s m \\<plusminus>  b \\<cdot>\\<^sub>s m\"", "lemma (in Module) sc_r_distr:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; n \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                 a \\<cdot>\\<^sub>s (m \\<plusminus> n) = a \\<cdot>\\<^sub>s m \\<plusminus>  a \\<cdot>\\<^sub>s n\"", "lemma (in Module) sc_0_m:\"m \\<in> carrier M \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub>\\<cdot>\\<^sub>s m = \\<zero>\\<^bsub>M\\<^esub>\"", "lemma (in Module) sc_a_0:\"a \\<in> carrier R \\<Longrightarrow> a \\<cdot>\\<^sub>s \\<zero>  = \\<zero>\"", "lemma (in Module) sc_minus_am:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n                     \\<Longrightarrow> -\\<^sub>a (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s (-\\<^sub>a m)\"", "lemma (in Module) sc_minus_am1:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n            \\<Longrightarrow> -\\<^sub>a (a \\<cdot>\\<^sub>s m) = (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m\"", "lemma (in Module) submodule_0:\"submodule R M {\\<zero>}\"", "lemma (in Module) submodule_whole:\"submodule R M (carrier M)\"", "lemma (in Module) submodule_pOp_closed:\"\\<lbrakk>submodule R M H; h \\<in> H; k \\<in> H\\<rbrakk> \\<Longrightarrow> \n                  h \\<plusminus> k \\<in> H\"", "lemma (in Module) submodule_mOp_closed:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk>\n                 \\<Longrightarrow> -\\<^sub>a h \\<in> H\"", "lemma (in Ring) mHom_func:\"f \\<in> mHom R M N \\<Longrightarrow> f \\<in> carrier M \\<rightarrow> carrier N\"", "lemma (in Module) mHom_test:\"\\<lbrakk>R module N; f \\<in> carrier M \\<rightarrow> carrier N \\<and> \n      f \\<in> extensional (carrier M) \\<and> \n     (\\<forall>m\\<in>carrier M. \\<forall>n\\<in>carrier M. f (m \\<plusminus>\\<^bsub>M\\<^esub> n) = f m \\<plusminus>\\<^bsub>N\\<^esub> (f n)) \\<and> \n     (\\<forall>a\\<in>carrier R. \\<forall>m\\<in>carrier M. f (a \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f m))\\<rbrakk> \\<Longrightarrow>\n     f \\<in> mHom R M N\"", "lemma (in Module) mHom_mem:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n \\<Longrightarrow> f m \\<in> carrier N\"", "lemma (in Module) mHom_add:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M; \n             n \\<in> carrier M\\<rbrakk> \\<Longrightarrow> f (m \\<plusminus> n) = f m \\<plusminus>\\<^bsub>N\\<^esub> (f n)\"", "lemma (in Module) mHom_0:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> f (\\<zero>) = \\<zero>\\<^bsub>N\\<^esub>\"", "lemma (in Module) mHom_inv:\"\\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> \n                 f (-\\<^sub>a m) = -\\<^sub>a\\<^bsub>N\\<^esub> (f m)\"", "lemma (in Module) mHom_lin:\"\\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N;\n                    a \\<in> carrier R\\<rbrakk> \\<Longrightarrow> f (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f m)\"", "lemma (in Module) mker_inc_zero:\n           \"\\<lbrakk>R module N; f \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow> \\<zero> \\<in> (ker\\<^bsub>M,N\\<^esub> f)\"", "lemma (in Module) mHom_eq_ker:\"\\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M; \n      b\\<in> carrier M; a \\<plusminus> (-\\<^sub>a b) \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow> f a = f b\"", "lemma (in Module) mHom_ker_eq:\"\\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M; \n      b\\<in> carrier M; f a = f b\\<rbrakk> \\<Longrightarrow> a \\<plusminus> (-\\<^sub>a b) \\<in> ker\\<^bsub>M,N\\<^esub> f\"", "lemma (in Module) mker_submodule:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                                    submodule R M (ker\\<^bsub>M,N\\<^esub> f)\"", "lemma (in Module) mker_mzeromap:\"R module N \\<Longrightarrow>\n                         ker\\<^bsub>M,N\\<^esub> (mzeromap M N) = carrier M\"", "lemma (in Module) mdl_carrier:\"submodule R M H \\<Longrightarrow> carrier (mdl M H) = H\"", "lemma (in Module) mdl_is_ag:\"submodule R M H \\<Longrightarrow> aGroup (mdl M H)\"", "lemma (in Module) mdl_is_module:\"submodule R M H \\<Longrightarrow> R module (mdl M H)\"", "lemma (in Module) submodule_of_mdl:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n                   \\<Longrightarrow> submodule R (mdl M N) H\"", "lemma (in Module) img_set_submodule:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n         submodule R N (f ` (carrier M))\"", "lemma (in Module) mimg_module:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                                              R module (mimg R M N f)\"", "lemma (in Module) surjec_to_mimg:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                                       surjec\\<^bsub>M, (mimg R M N f)\\<^esub> f\"", "lemma (in Module) zero_HOM:\"R module N \\<Longrightarrow>\n         mzeromap M N = \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\"", "lemma (in Module) tOp_mHom_closed:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n      \\<Longrightarrow> tOp_mHom R M N f g \\<in> mHom R M N\"", "lemma (in Module) iOp_mHom_closed:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n                                     \\<Longrightarrow> iOp_mHom R M N f \\<in> mHom R M N\"", "lemma (in Module) mHom_ex_zero:\"R module N \\<Longrightarrow>  mzeromap M N \\<in> mHom R M N\"", "lemma (in Module) mHom_eq:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N; \n                            \\<forall>m\\<in>carrier M. f m = g m\\<rbrakk> \\<Longrightarrow> f = g\"", "lemma (in Module) mHom_l_zero:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n              \\<Longrightarrow> tOp_mHom R M N (mzeromap M N) f = f\"", "lemma  (in Module) mHom_l_inv:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N (iOp_mHom R M N f) f = mzeromap M N\"", "lemma  (in Module) mHom_tOp_assoc:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        h \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> tOp_mHom R M N (tOp_mHom R M N f g) h =\n          tOp_mHom R M N f (tOp_mHom R M N g h)\"", "lemma (in Module) mHom_tOp_commute:\"\\<lbrakk>R module N; f \\<in> mHom R M N; \n        g \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> tOp_mHom R M N f g = tOp_mHom R M N g f\"", "lemma  (in Module) HOM_is_ag:\"R module N \\<Longrightarrow> aGroup (HOM\\<^bsub>R\\<^esub> M N)\"", "lemma (in Module) sprod_mHom_closed:\"\\<lbrakk>R module N; a \\<in> carrier R; \n       f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> sprod_mHom R M N a f \\<in> mHom R M N\"", "lemma (in Module) HOM_is_module:\"R module N \\<Longrightarrow> R module (HOM\\<^bsub>R\\<^esub> M N)\"", "lemma (in Module) minjec_inj:\"\\<lbrakk>R module N; injec\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n                            inj_on f (carrier M)\"", "lemma (in Module) invmfun_l_inv:\"\\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                            (invmfun R M N f) (f m) = m\"", "lemma (in Module) invmfun_mHom:\"\\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow>\n                 invmfun R M N f \\<in> mHom R N M\"", "lemma (in Module) invmfun_r_inv:\"\\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> carrier N\\<rbrakk> \\<Longrightarrow>\n                           f ((invmfun R M N f) n) = n\"", "lemma (in Module) mHom_compos:\"\\<lbrakk>R module L; R module N; f \\<in> mHom R L M; \n       g \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow> compos L g f \\<in> mHom R L N\"", "lemma (in Module) mcompos_inj_inj:\"\\<lbrakk>R module L; R module N; f \\<in> mHom R L M; \n       g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g \\<rbrakk> \\<Longrightarrow> injec\\<^bsub>L,N\\<^esub> (compos L g f)\"", "lemma (in Module) mcompos_surj_surj:\"\\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow> \n                                        surjec\\<^bsub>L,N\\<^esub> (compos L g f)\"", "lemma (in Module) mId_mHom:\"mId\\<^bsub>M\\<^esub> \\<in> mHom R M M\"", "lemma (in Module) mHom_mId_bijec:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n      compose (carrier M) g f = mId\\<^bsub>M\\<^esub>; compose (carrier N) f g = mId\\<^bsub>N\\<^esub>\\<rbrakk> \\<Longrightarrow>\n      bijec\\<^bsub>M,N\\<^esub> f\"", "lemma (in Module) sup_sharp_homTr:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N; \n      f \\<in> mHom R N L \\<rbrakk> \\<Longrightarrow> sup_sharp R M N L u f \\<in> mHom R M L\"", "lemma (in Module) sup_sharp_hom:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> \n           sup_sharp R M N L u \\<in> mHom R (HOM\\<^bsub>R\\<^esub> N L) (HOM\\<^bsub>R\\<^esub> M L)\"", "lemma (in Module) sub_sharp_homTr:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N; \n       f \\<in> mHom R L M\\<rbrakk> \\<Longrightarrow> sub_sharp R L M N u f \\<in> mHom R L N\"", "lemma (in Module) sub_sharp_hom:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> \n          sub_sharp R L M N u \\<in> mHom R (HOM\\<^bsub>R\\<^esub> L M) (HOM\\<^bsub>R\\<^esub> L N)\"", "lemma (in Module) mId_bijec:\"bijec\\<^bsub>M,M\\<^esub> (mId\\<^bsub>M\\<^esub>)\"", "lemma (in Module) invmfun_bijec:\"\\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n                  bijec\\<^bsub>N,M\\<^esub> (invmfun R M N f)\"", "lemma (in Module) misom_self:\"M \\<cong>\\<^bsub>R\\<^esub> M\"", "lemma (in Module) misom_sym:\"\\<lbrakk>R module N; M \\<cong>\\<^bsub>R\\<^esub> N\\<rbrakk> \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M\"", "lemma (in Module) misom_trans:\"\\<lbrakk>R module L; R module N; L \\<cong>\\<^bsub>R\\<^esub> M; M \\<cong>\\<^bsub>R\\<^esub> N\\<rbrakk> \\<Longrightarrow> \n                               L \\<cong>\\<^bsub>R\\<^esub> N\"", "lemma (in Module) qmodule_carr:\"submodule R M H \\<Longrightarrow>\n            carrier (qmodule M H) = set_mr_cos M H\"", "lemma (in Module) set_mr_cos_mem:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\"", "lemma (in Module) mem_set_mr_cos:\"\\<lbrakk>submodule R M N; x \\<in> set_mr_cos M N\\<rbrakk> \\<Longrightarrow>\n                          \\<exists>m \\<in> carrier M. x = m  \\<uplus>\\<^bsub>M\\<^esub> N\"", "lemma (in Module) m_in_mr_coset:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                                   m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) mr_cos_h_stable:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                                                       H = h \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) mr_cos_h_stable1:\"\\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H\\<rbrakk>\n             \\<Longrightarrow> (m \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> H = m \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) x_in_mr_coset:\"\\<lbrakk>submodule R M H; m \\<in> carrier M; x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n                 \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x\"", "lemma (in Module) mr_cos_sprodTr:\"\\<lbrakk>submodule R M H; a \\<in> carrier R; \n       m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> mr_cos_sprod M H a (m \\<uplus>\\<^bsub>M\\<^esub> H) = (a \\<cdot>\\<^sub>s m) \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) mr_cos_sprod_mem:\"\\<lbrakk>submodule R M H; a \\<in> carrier R; \n       X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> mr_cos_sprod M H a X \\<in> set_mr_cos M H\"", "lemma (in Module) mr_cos_sprod_assoc:\"\\<lbrakk>submodule R M H; a \\<in> carrier R;\n b \\<in> carrier R; X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> mr_cos_sprod  M H (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) X = \n                           mr_cos_sprod M H a (mr_cos_sprod M H b X)\"", "lemma (in Module) mr_cos_sprod_one:\"\\<lbrakk>submodule R M H; X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow>\n                   mr_cos_sprod M H (1\\<^sub>r\\<^bsub>R\\<^esub>) X = X\"", "lemma (in Module) mr_cospOpTr:\"\\<lbrakk>submodule R M H; m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n        \\<Longrightarrow> mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H) (n \\<uplus>\\<^bsub>M\\<^esub> H) = (m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma(in Module) mr_cos_sprod_distrib1:\"\\<lbrakk>submodule R M H; a \\<in> carrier R; \n                b \\<in> carrier R;  X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> \n                mr_cos_sprod M H (a \\<plusminus>\\<^bsub>R\\<^esub> b) X =  \n                 mr_cospOp M H (mr_cos_sprod M H a X) (mr_cos_sprod M H b X)\"", "lemma (in Module) mr_cos_sprod_distrib2:\"\\<lbrakk>submodule R M H; \n a \\<in> carrier R; X \\<in> set_mr_cos M H; Y \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> \n mr_cos_sprod M H a (mr_cospOp M H X Y) =  \n           mr_cospOp M H (mr_cos_sprod M H a X) (mr_cos_sprod M H a Y)\"", "lemma (in Module) mr_cosmOpTr:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> \n                mr_cosmOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H) = (-\\<^sub>a m) \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) mr_cos_oneTr:\"submodule R M H \\<Longrightarrow> H =  \\<zero> \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) mr_cos_oneTr1:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                            mr_cospOp M H H (m \\<uplus>\\<^bsub>M\\<^esub> H) = m \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) qmodule_is_ag:\"submodule R M H \\<Longrightarrow> aGroup (M /\\<^sub>m H)\"", "lemma (in Module) qmodule_module:\"submodule R M H \\<Longrightarrow> R module (M /\\<^sub>m H)\"", "lemma (in Module) indmhom_someTr:\"\\<lbrakk>R module N; f \\<in> mHom R M N; \n      X \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk> \\<Longrightarrow> f (SOME xa. xa \\<in> X) \\<in> f `(carrier M)\"", "lemma (in Module) indmhom_someTr1:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n        \\<Longrightarrow>  f (SOME xa. xa \\<in> (ar_coset m M (ker\\<^bsub>M,N\\<^esub> f))) = f m\"", "lemma (in Module) indmhom_someTr2:\"\\<lbrakk>R module N; f \\<in> mHom R M N; \n       submodule R M H; m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow> \n                       f (SOME xa. xa \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H) = f m\"", "lemma (in Module) indmhomTr1:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n               (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>) (m \\<uplus>\\<^bsub>M\\<^esub> (ker\\<^bsub>M,N\\<^esub> f)) = f m\"", "lemma (in Module) indmhomTr2:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \n      \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>) \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f) \\<rightarrow> carrier N\"", "lemma (in Module) indmhom:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \n                           \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>) \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\"", "lemma (in Module) indmhom_injec:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n       injec\\<^bsub>(M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)),N\\<^esub> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>)\"", "lemma (in Module) indmhom_surjec1:\"\\<lbrakk>R module N; surjec\\<^bsub>M,N\\<^esub> f;\n f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> surjec\\<^bsub>(M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)),N\\<^esub> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>)\"", "lemma (in Module) module_homTr:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                           f \\<in> mHom R M (mimg\\<^bsub>R M,N\\<^esub> f)\"", "lemma (in Module) ker_to_mimg:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f = ker\\<^bsub>M,N\\<^esub> f\"", "lemma (in Module) module_homTr1:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n   (mimg\\<^bsub>R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)),N\\<^esub> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>)) = mimg\\<^bsub>R M,N\\<^esub> f\"", "lemma (in Module) module_Homth_1:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                     M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f) \\<cong>\\<^bsub>R\\<^esub> mimg\\<^bsub>R M,N\\<^esub> f\"", "lemma (in Module) elem_mpj:\"\\<lbrakk>m \\<in> carrier M; submodule R M H\\<rbrakk> \\<Longrightarrow>\n                                                 mpj M H m = m \\<uplus>\\<^bsub>M\\<^esub> H\"", "lemma (in Module) mpj_mHom:\"submodule R M H \\<Longrightarrow> mpj M H \\<in> mHom R M (M /\\<^sub>m H)\"", "lemma (in Module) mpj_mem:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                                mpj M H m \\<in> carrier (M /\\<^sub>m H)\"", "lemma (in Module) mpj_surjec:\"submodule R M H \\<Longrightarrow>\n                             surjec\\<^bsub>M,(M /\\<^sub>m H)\\<^esub> (mpj M H)\"", "lemma (in Module) mpj_0:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                                 mpj M H h  = \\<zero>\\<^bsub>(M /\\<^sub>m H)\\<^esub>\"", "lemma (in Module) mker_of_mpj:\"submodule R M H \\<Longrightarrow>\n                                 ker\\<^bsub>M,(M /\\<^sub>m H)\\<^esub> (mpj M H) = H\"", "lemma (in Module) indmhom1:\"\\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;  H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow> \\<exists>!g. g \\<in> (mHom R (M /\\<^sub>m H) N) \\<and> (compos M g (mpj M H)) = f\"", "lemma (in Module) mQmpTr0:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>  mQmp M H N (m \\<uplus>\\<^bsub>M\\<^esub> H) = m \\<uplus>\\<^bsub>M\\<^esub> N\"", "lemma (in Module) mQmpTr1:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n m \\<in> carrier M; n \\<in> carrier M; m \\<uplus>\\<^bsub>M\\<^esub> H = n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk> \\<Longrightarrow>  m \\<uplus>\\<^bsub>M\\<^esub> N = n \\<uplus>\\<^bsub>M\\<^esub> N\"", "lemma (in Module) mQmpTr2:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N ; \n        X \\<in> carrier (M /\\<^sub>m H)\\<rbrakk> \\<Longrightarrow> (mQmp M H N) X \\<in> carrier (M /\\<^sub>m N)\"", "lemma (in Module) mQmpTr2_1:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N \\<rbrakk>\n \\<Longrightarrow> mQmp M H N \\<in> carrier (M /\\<^sub>m H) \\<rightarrow> carrier (M /\\<^sub>m N)\"", "lemma (in Module) mQmpTr3:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N ; \nX \\<in> carrier (M /\\<^sub>m H); Y \\<in> carrier (M /\\<^sub>m H)\\<rbrakk> \\<Longrightarrow> (mQmp M H N) (mr_cospOp M H X Y) = mr_cospOp M N ((mQmp M H N) X) ((mQmp M H N) Y)\"", "lemma (in Module) mQmpTr4:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n                            a \\<in> N\\<rbrakk> \\<Longrightarrow> mr_coset a (mdl M N) H = mr_coset a M H\"", "lemma (in Module) mQmp_mHom:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow>\n                  (Mp\\<^bsub>M H,N\\<^esub>) \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\"", "lemma (in Module) Mp_surjec:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> \n                surjec\\<^bsub>(M /\\<^sub>m H),(M /\\<^sub>m N)\\<^esub> (Mp\\<^bsub>M H,N\\<^esub>)\"", "lemma (in Module) kerQmp:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \n \\<Longrightarrow> ker\\<^bsub>(M /\\<^sub>m H),(M /\\<^sub>m N)\\<^esub> (Mp\\<^bsub>M H,N\\<^esub>) = carrier ((mdl M N) /\\<^sub>m H)\"", "lemma (in Module) misom2Tr:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> \n            (M /\\<^sub>m H) /\\<^sub>m (carrier ((mdl M N) /\\<^sub>m H)) \\<cong>\\<^bsub>R\\<^esub> (M /\\<^sub>m N)\"", "lemma (in Module) eq_class_of_Submodule:\"\\<lbrakk>submodule R M H; submodule R M N; \n         H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> carrier ((mdl M N) /\\<^sub>m H) = N \\<^sub>s/\\<^sub>M H\"", "theorem (in Module) misom2:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> \n                           (M /\\<^sub>m H) /\\<^sub>m (N \\<^sub>s/\\<^sub>M H) \\<cong>\\<^bsub>R\\<^esub> (M /\\<^sub>m N)\"", "lemma (in Module) finitesumbase_sub_carrier:\"f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n             finitesum_base M I f \\<subseteq> carrier M\"", "lemma (in Module) finitesum_sub_carrier:\"f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n                       finitesum M I f \\<subseteq> carrier M\"", "lemma (in Module) finitesum_inc_zero:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}\\<rbrakk>\n      \\<Longrightarrow>   \\<zero> \\<in> finitesum M I f\"", "lemma (in Module) finitesum_mOp_closed:\n     \"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}; a \\<in> finitesum M I f\\<rbrakk> \\<Longrightarrow>\n                  -\\<^sub>a a \\<in> finitesum M I f\"", "lemma (in Module) finitesum_pOp_closed:\n \"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; a \\<in> finitesum M I f;  b \\<in> finitesum M I f\\<rbrakk>\n           \\<Longrightarrow>  a \\<plusminus> b \\<in> finitesum M I f\"", "lemma (in Module) finitesum_sprodTr:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n       r \\<in> carrier R\\<rbrakk>  \\<Longrightarrow> g \\<in>{j. j \\<le> (n::nat)} \\<rightarrow> (finitesum_base M I f)\n              \\<longrightarrow> r \\<cdot>\\<^sub>s (nsum M g n) =  nsum M (\\<lambda>x. r \\<cdot>\\<^sub>s (g x)) n\"", "lemma (in Module) finitesum_sprod:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}; \n      r \\<in> carrier R; g \\<in>{j. j \\<le> (n::nat)} \\<rightarrow> (finitesum_base M I f) \\<rbrakk> \\<Longrightarrow>\n                       r \\<cdot>\\<^sub>s (nsum M g n) =  nsum M (\\<lambda>x. r \\<cdot>\\<^sub>s (g x)) n\"", "lemma (in Module) finitesum_subModule:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}\\<rbrakk>\n                   \\<Longrightarrow> submodule R M (finitesum M I f)\"", "lemma (in Module) sSum_cont_H:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                     H \\<subseteq>  H \\<minusplus> K\"", "lemma (in Module) sSum_commute:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                       H \\<minusplus> K =  K \\<minusplus> H\"", "lemma (in Module) Sum_of_SubmodulesTr:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n      g \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H \\<union> K \\<longrightarrow> \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\"", "lemma (in Module) sSum_two_Submodules:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                       submodule R M (H \\<minusplus> K)\"", "lemma (in Module) iotam_mHom:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n                           \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub> \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K))\"", "lemma (in Module) mhomom3Tr:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                         submodule R (mdl M (H \\<minusplus> K)) K\"", "lemma (in Module) mhomom3Tr0:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n     \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n        \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\"", "lemma (in Module) mhomom3Tr1:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n  surjec\\<^bsub>(mdl M H),((mdl M (H \\<minusplus> K))/\\<^sub>m K)\\<^esub> \n    (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>))\"", "lemma (in Module) mhomom3Tr2:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n  ker\\<^bsub>(mdl M H),((mdl M (H \\<minusplus> K)) /\\<^sub>m K)\\<^esub> \n    (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)) = H \\<inter> K\"", "lemma (in Module) mhomom_3:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                 (mdl M H) /\\<^sub>m (H \\<inter> K) \\<cong>\\<^bsub>R\\<^esub> (mdl M (H \\<minusplus> K)) /\\<^sub>m K\"", "lemma (in Module) l_comb_mem_linear_span:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n                    l_comb R M n s f \\<in> linear_span R M A H\"", "lemma (in Module) linear_comb_eqTr:\"H \\<subseteq> carrier M \\<Longrightarrow> \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R \\<and> \n      f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> \n      g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> \n      (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow> \n      l_comb R M n s f = l_comb R M n s g\"", "lemma (in Module) linear_comb_eq:\"\\<lbrakk>H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R; f \\<in> {j. j \\<le> n} \\<rightarrow> H; \n       g \\<in> {j. j \\<le> n} \\<rightarrow> H; \\<forall>j\\<in>{j. j \\<le> n}. f j = g j\\<rbrakk>  \\<Longrightarrow>\n  l_comb R M n s f = l_comb R M n s g\"", "lemma (in Module) l_comb_Suc:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A; \n       s \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier R; f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> H\\<rbrakk>  \\<Longrightarrow>\n       l_comb R M (Suc n) s f = l_comb R M n s f \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\"", "lemma (in Module) l_comb_jointfun_jj:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        nsum M (\\<lambda>j. (jointfun n s m t) j \\<cdot>\\<^sub>s (jointfun n f m g) j) n =\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\"", "lemma (in Module) l_comb_jointfun_jj1:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        l_comb R M n (jointfun n s m t) (jointfun n f m g) =\n        l_comb R M n s f\"", "lemma (in Module) l_comb_jointfun_jf:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow>\n        nsum M (\\<lambda>j. (jointfun n s m t) j \\<cdot>\\<^sub>s f j) n =\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\"", "lemma (in Module) l_comb_jointfun_jf1:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow>\n        l_comb R M n (jointfun n s m t) f = l_comb R M n s f\"", "lemma (in Module) l_comb_jointfun_fj:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (jointfun n f m g) j) n =\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\"", "lemma (in Module) l_comb_jointfun_fj1:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        l_comb R M n s (jointfun n f m g) = l_comb R M n s f\"", "lemma (in Module) linear_comb0_1Tr:\"H \\<subseteq> carrier M \\<Longrightarrow> \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>} \\<and>  \n      m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow> l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\"", "lemma (in Module) linear_comb0_1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}; m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<rbrakk> \\<Longrightarrow> \n      l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\"", "lemma (in Module) linear_comb0_2Tr:\"ideal R A \\<Longrightarrow> s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \n      \\<and>  m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>M\\<^esub>} \\<longrightarrow> l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\"", "lemma (in Module) linear_comb0_2:\"\\<lbrakk>ideal R A;  s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;\n       m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>M\\<^esub>} \\<rbrakk> \\<Longrightarrow>  l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\"", "lemma (in Module) liear_comb_memTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>\n \\<forall>s. \\<forall>m. s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n          m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow> l_comb R M n s m \\<in> carrier M\"", "lemma (in Module) l_comb_mem:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; m \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow> \n      l_comb R M n s m \\<in> carrier M\"", "lemma (in Module) l_comb_transpos:\" \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n      s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A; f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n      j < Suc n \\<rbrakk> \\<Longrightarrow> \n     \\<Sigma>\\<^sub>e M (cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n))) (Suc n) =\n       \\<Sigma>\\<^sub>e M (\\<lambda>k. (cmp s (transpos j (Suc n))) k \\<cdot>\\<^sub>s\n                  (cmp f (transpos j (Suc n))) k) (Suc n)\"", "lemma (in Module) l_comb_transpos1:\" \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n      s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A; f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n \\<rbrakk> \\<Longrightarrow> \n l_comb R M (Suc n) s f = \n  l_comb R M (Suc n) (cmp s (transpos j (Suc n))) (cmp f (transpos j (Suc n)))\"", "lemma (in Module) sc_linear_span:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n h \\<in> H\\<rbrakk> \\<Longrightarrow> a \\<cdot>\\<^sub>s h \\<in> linear_span R M A H\"", "lemma (in Module) l_span_cont_H:\"H \\<subseteq> carrier M \\<Longrightarrow> \n                      H \\<subseteq> linear_span R M (carrier R) H\"", "lemma (in Module) linear_span_inc_0:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>  \\<Longrightarrow> \n                   \\<zero> \\<in> linear_span R M A H\"", "lemma (in Module) linear_span_iOp_closedTr1:\"\\<lbrakk>ideal R A;\n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow>\n               (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) \\<in> {j. j \\<le> n} \\<rightarrow> A\"", "lemma (in Module) l_span_gen_mono:\"\\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A\\<rbrakk> \\<Longrightarrow>\n        linear_span R M A K \\<subseteq> linear_span R M A H\"", "lemma (in Module) l_comb_add:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n  l_comb R M (Suc (n + m)) (jointfun n s m t) (jointfun n f m g) =\n                                  l_comb R M n s f \\<plusminus> l_comb R M m t g\"", "lemma (in Module) l_comb_add1Tr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>\n  f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H \\<and> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and> t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n    l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. (s x) \\<plusminus>\\<^bsub>R\\<^esub> (t x)) f =\n      l_comb R M n s f \\<plusminus> l_comb R M n t f\"", "lemma (in Module) l_comb_add1:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; s \\<in> {j. j \\<le> n} \\<rightarrow> A; t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<rbrakk> \\<Longrightarrow> \n   l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. (s x) \\<plusminus>\\<^bsub>R\\<^esub> (t x)) f =\n                                l_comb R M n s f \\<plusminus> l_comb R M n t f\"", "lemma (in Module) linear_span_iOp_closedTr2:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>  \\<Longrightarrow>\n       -\\<^sub>a (l_comb R M n s f) = \n           l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) f\"", "lemma (in Module) linear_span_iOp_closed:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n a \\<in> linear_span R M A H\\<rbrakk> \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H\"", "lemma (in Module) linear_span_pOp_closed:\n \"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> linear_span R M A H; b \\<in> linear_span R M A H\\<rbrakk>\n  \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H\"", "lemma (in Module) l_comb_scTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n r \\<in> carrier R; H \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n g \\<in> {j. j \\<le> n} \\<rightarrow>  H  \\<longrightarrow> r \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k))  n) =  \n                             nsum M (\\<lambda>k. r \\<cdot>\\<^sub>s ((s k) \\<cdot>\\<^sub>s (g k))) n\"", "lemma (in Module) l_comb_sc1Tr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n r \\<in> carrier R; H \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n g \\<in> {j. j \\<le> n} \\<rightarrow>  H  \\<longrightarrow> r \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k))  n) =  \n                             nsum M (\\<lambda>k. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s (g k)) n\"", "lemma (in Module) l_comb_sc:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;  g \\<in> {j. j \\<le> n} \\<rightarrow>  H\\<rbrakk> \\<Longrightarrow>\nr \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k)) n) = nsum M (\\<lambda>k. r \\<cdot>\\<^sub>s ((s k) \\<cdot>\\<^sub>s (g k))) n\"", "lemma (in Module) l_comb_sc1:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;  g \\<in> {j. j \\<le> n} \\<rightarrow>  H\\<rbrakk> \\<Longrightarrow>\nr \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k)) n) = nsum M (\\<lambda>k. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s (g k)) n\"", "lemma (in Module) linear_span_sc_closed:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n r \\<in> carrier R; x \\<in> linear_span R M A H\\<rbrakk> \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H\"", "lemma (in Module) mem_single_l_spanTr:\"\\<lbrakk>ideal R A; h \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and>\n      f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and> l_comb R M n s f \\<in> linear_span R M A {h}\n      \\<longrightarrow> (\\<exists>a \\<in> A. l_comb R M n s f = a \\<cdot>\\<^sub>s h)\"", "lemma (in Module) mem_single_l_span:\"\\<lbrakk>ideal R A; h \\<in> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> {h}; \n       l_comb R M n s f \\<in> linear_span R M A {h}\\<rbrakk> \\<Longrightarrow>\n       \\<exists>a \\<in> A. l_comb R M n s f = a \\<cdot>\\<^sub>s h\"", "lemma (in Module) mem_single_l_span1:\"\\<lbrakk>ideal R A; h \\<in> carrier M; \n       x \\<in> linear_span R M A {h}\\<rbrakk> \\<Longrightarrow> \\<exists>a \\<in> A. x = a \\<cdot>\\<^sub>s h\"", "lemma (in Module) linear_span_subModule:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>  \\<Longrightarrow> \n                  submodule R M (linear_span R M A H)\"", "lemma (in Module) l_comb_mem_submoduleTr:\"\\<lbrakk>ideal R A; submodule R M N\\<rbrakk> \\<Longrightarrow>\n (s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n (\\<forall>j \\<le> n.(s j) \\<cdot>\\<^sub>s (f j) \\<in> N)) \\<longrightarrow> l_comb R M n s f \\<in> N\"", "lemma (in Module) l_span_sub_submodule:\"\\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow>\n       linear_span R M A H \\<subseteq> N\"", "lemma (in Module) linear_span_sub:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>  \\<Longrightarrow> \n                  (linear_span R M A H) \\<subseteq> carrier M\"", "lemma (in Module) smodule_ideal_coeff_is_Submodule:\"ideal R A  \\<Longrightarrow>\n            submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M)\"", "lemma (in Module) mem_smodule_ideal_coeff:\"\\<lbrakk>ideal R A; x \\<in> A \\<odot>\\<^bsub>R\\<^esub> M\\<rbrakk> \\<Longrightarrow>\n             \\<exists>n. \\<exists>s \\<in> {j. j \\<le> n} \\<rightarrow> A. \\<exists>g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M.\n              x = l_comb R M n s g\"", "lemma (in Module) quotient_of_submodules_inc_0:\n     \"\\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk> \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> (P \\<^bsub>R\\<ddagger>M\\<^esub> Q)\"", "lemma (in Module) quotient_of_submodules_is_ideal:\n      \"\\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk> \\<Longrightarrow> ideal R (P \\<^bsub>R\\<ddagger>M\\<^esub> Q)\"", "lemma (in Module) Ann_is_ideal:\"ideal R (Ann\\<^bsub>R\\<^esub> M)\"", "lemma (in Module) linmap_im_of_lincombTr:\"\\<lbrakk>ideal R A; R module N; \n      f \\<in> mHom R M N; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>  \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n      f (l_comb R M n s g) = l_comb R N n s (cmp f g)\"", "lemma (in Module) linmap_im_lincomb:\"\\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; \n      H \\<subseteq> carrier M; s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<rbrakk> \\<Longrightarrow> \n      f (l_comb R M n s g) = l_comb R N n s (cmp f g)\"", "lemma (in Module) linmap_im_linspan:\"\\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; \n       H \\<subseteq> carrier M; s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<rbrakk> \\<Longrightarrow> \n            f (l_comb R M n s g) \\<in> linear_span R N A (f ` H)\"", "lemma (in Module) linmap_im_linspan1:\"\\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; \n      H \\<subseteq> carrier M; h \\<in> linear_span R M A H\\<rbrakk> \\<Longrightarrow> \n                              f h \\<in> linear_span R N A (f ` H)\"", "lemma (in Module) h_in_linear_span:\"\\<lbrakk>H \\<subseteq> carrier M; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                                   h \\<in> linear_span R M (carrier R) H\"", "lemma (in Module) generator_sub_carrier:\"generator R M H \\<Longrightarrow>\n                                              H \\<subseteq> carrier M\"", "lemma (in Module) lin_span_sub_carrier:\"\\<lbrakk>ideal R A; \n       H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M\"", "lemma (in Module) lin_span_coeff_mono:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\\<Longrightarrow>  \n                        linear_span R M A H \\<subseteq> linear_span R M (carrier R) H\"", "lemma (in Module) l_span_sum_closedTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\\<Longrightarrow> \n   \\<forall>s. \\<forall>f. s\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n   f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H \\<longrightarrow>\n   (nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n \\<in> linear_span R M A H)\"", "lemma (in Module) l_span_closed:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;  f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H \\<rbrakk> \\<Longrightarrow>\n l_comb R M n s f \\<in> linear_span R M A H\"", "lemma (in Module) l_span_closed1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R;  \n      f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H \\<rbrakk> \\<Longrightarrow>\n      \\<Sigma>\\<^sub>e M (\\<lambda>j.  s j \\<cdot>\\<^sub>s (f j)) n \\<in> linear_span R M (carrier R) H\"", "lemma (in Module) l_span_closed2Tr0:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H \\<rbrakk> \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H\"", "lemma (in Module) l_span_closed2Tr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow> \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n       f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H \\<longrightarrow>\n            l_comb R M n s f \\<in> linear_span R M A H\"", "lemma (in Module) l_span_closed2:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A ; \n       f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H\\<rbrakk> \\<Longrightarrow>\n       l_comb R M n s f \\<in> linear_span R M A H\"", "lemma (in Module) l_span_l_span:\"H \\<subseteq> carrier M \\<Longrightarrow>\n       linear_span R M (carrier R) (linear_span R M (carrier R) H) =\n                                          linear_span R M (carrier R) H\"", "lemma (in Module) l_spanA_l_span:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>\n       linear_span R M A (linear_span R M (carrier R) H) =\n                                          linear_span R M A H\"", "lemma (in Module) l_span_zero:\"ideal R A \\<Longrightarrow> linear_span R M A {\\<zero>} = {\\<zero>}\"", "lemma (in Module) l_span_closed3:\"\\<lbrakk>ideal R A; generator R M H;\n       A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\\<rbrakk> \\<Longrightarrow> linear_span R M A H = carrier M\"", "lemma (in Module) generator_generator:\"\\<lbrakk>generator R M H; H1 \\<subseteq> carrier M; \n           H \\<subseteq> linear_span R M (carrier R) H1\\<rbrakk>  \\<Longrightarrow>  generator R M H1\"", "lemma (in Module) generator_elimTr:\n\"f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M \\<and> generator R M (f ` {j. j \\<le> n}) \\<and> \n(\\<forall>i\\<in>nset (Suc 0) n. f i \\<in> \n   linear_span R M (carrier R) (f ` {j. j \\<le> (i - Suc 0)})) \\<longrightarrow> \n linear_span R M (carrier R) {f 0} = carrier M\"", "lemma (in Module) generator_generator_elim:\n \"\\<lbrakk>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M; generator R M (f ` {j. j \\<le> n}); \n  (\\<forall>i\\<in>nset (Suc 0) n. f i \\<in> linear_span R M (carrier R) \n     (f ` {j. j \\<le> (i - Suc 0)}))\\<rbrakk> \\<Longrightarrow> \n   linear_span R M (carrier R) {f 0} = carrier M\"", "lemma (in Module) surjec_generator:\"\\<lbrakk>R module N; f \\<in> mHom R M N;\n surjec\\<^bsub>M,N\\<^esub> f; generator R M H\\<rbrakk> \\<Longrightarrow> generator R N (f ` H)\"", "lemma (in Module) surjec_finitely_gen:\"\\<lbrakk>R module N; f \\<in> mHom R M N;\n       surjec\\<^bsub>M,N\\<^esub> f; M fgover R\\<rbrakk>  \\<Longrightarrow> N fgover R\"", "lemma (in Module) similar_termTr:\"\\<lbrakk>ideal R A; a \\<in> A\\<rbrakk> \\<Longrightarrow>\n \\<forall>s. \\<forall>f. s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n         f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and> \n         m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n       (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A. nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n \\<plusminus> a \\<cdot>\\<^sub>s m = \n           nsum M (\\<lambda>j. t j \\<cdot>\\<^sub>s (f j)) n )\"", "lemma (in Module) similar_term1:\"\\<lbrakk>ideal R A; a \\<in> A; s \\<in> {j. j\\<le>(n::nat)} \\<rightarrow> A;\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; m \\<in> f ` {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow> \n      \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n \\<plusminus> a \\<cdot>\\<^sub>s m =\n             \\<Sigma>\\<^sub>e M (\\<lambda>j.  t j \\<cdot>\\<^sub>s (f j)) n\"", "lemma (in Module) same_togetherTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M \\<rbrakk> \\<Longrightarrow> \n \\<forall>s. \\<forall>f. s\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> A  \\<and> f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow> \n (\\<exists>t \\<in> {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow> A. \n  \\<exists>g \\<in> {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow> f ` {j. j \\<le> n}. \n   surj_to g {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} (f ` {j. j \\<le> n}) \\<and> \n  nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n = nsum M (\\<lambda>k. t k \\<cdot>\\<^sub>s (g k)) \n       (card (f ` {j. j \\<le> n}) - Suc 0))\"", "lemma (in Module) same_together:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow> \n \\<exists>t \\<in> {j. j \\<le> (card (f ` {j. j \\<le> (n::nat)}) - Suc 0)} \\<rightarrow> A. \n \\<exists>g \\<in> {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow> f ` {j. j \\<le> n}. \n       surj_to g {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} (f ` {j. j \\<le> n}) \\<and> \n  \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n = \n                  \\<Sigma>\\<^sub>e M (\\<lambda>k. t k \\<cdot>\\<^sub>s (g k)) (card (f ` {j. j \\<le> n}) - Suc 0)\"", "lemma (in Module) one_last:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n      s \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> A; f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> H; \n      bij_to f {j. j \\<le> (Suc n)} H; j \\<le> (Suc n); j \\<noteq> (Suc n)\\<rbrakk> \\<Longrightarrow> \n \\<exists>t \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> A. \\<exists>g \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> H.  \n  \\<Sigma>\\<^sub>e M (\\<lambda>k. s k  \\<cdot>\\<^sub>s (f k)) (Suc n) =  \\<Sigma>\\<^sub>e M (\\<lambda>k. t k  \\<cdot>\\<^sub>s (g k)) (Suc n) \\<and>\n  g (Suc n) = f j \\<and> t (Suc n) = s j \\<and> bij_to g {j. j \\<le> (Suc n)} H\"", "lemma (in Module) finite_lin_spanTr1:\"\\<lbrakk>ideal R A; z \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n      h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {z} \\<and> t \\<in> {j. j \\<le> n} \\<rightarrow> A  \\<longrightarrow> \n      (\\<exists>s\\<in>{0::nat} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s (h j)) n =  s 0 \\<cdot>\\<^sub>s z)\"", "lemma (in Module) single_span:\"\\<lbrakk>ideal R A; z \\<in> carrier M;\n    h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {z}; t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow> \n     \\<exists>s\\<in>{0::nat} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s (h j)) n =  s 0 \\<cdot>\\<^sub>s z\"", "lemma card_Nset_im:\"f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<Longrightarrow> \n                      (Suc 0) \\<le> card (f `{j. j \\<le> n})\"", "lemma (in Module) eSum_changeTr1:\"\\<lbrakk>ideal R A; \n  t \\<in> {k. k \\<le> (card (f ` {j. j \\<le> (n1::nat)}) - Suc 0)} \\<rightarrow> A; \n  g \\<in> {k. k \\<le> (card (f ` {j. j \\<le> n1}) - Suc 0)} \\<rightarrow> f `{j. j \\<le> n1}; \n  Suc 0 < card (f `{j. j \\<le> n1}); g x = h (Suc n); x = Suc n; \ncard (f `{j. j \\<le> n1}) - Suc 0 =  Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0)\\<rbrakk>\n  \\<Longrightarrow> \n \\<Sigma>\\<^sub>e M (\\<lambda>k. t k  \\<cdot>\\<^sub>s (g k)) (card (f ` {j. j \\<le> n1}) - Suc 0) =  \n \\<Sigma>\\<^sub>e M (\\<lambda>k. t k  \\<cdot>\\<^sub>s (g k)) (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0) \\<plusminus>  \n    (t (Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0))  \\<cdot>\\<^sub>s \n                (g ( Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0))))\"", "lemma zeroi_func:\"\\<lbrakk>Ring R; ideal R A\\<rbrakk> \\<Longrightarrow>  zeroi R \\<in> {j. j \\<le> 0} \\<rightarrow> A\"", "lemma (in Module) prep_arrTr1:\"\\<lbrakk>ideal R A; h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier M;\n f \\<in> {j. j \\<le> (n1::nat)} \\<rightarrow> h ` {j. j \\<le> (Suc n)}; s \\<in> {j. j \\<le> n1}\\<rightarrow> A; \n m = l_comb R M n1 s f\\<rbrakk> \\<Longrightarrow> \n \\<exists>l\\<in>{j. j \\<le> (Suc n)}. (\\<exists>s\\<in>{j. j \\<le> (l::nat)} \\<rightarrow> A. \n \\<exists>g\\<in> {j. j \\<le> l} \\<rightarrow> h `{j. j \\<le> (Suc n)}. m = l_comb R M l s g \\<and> \n                      bij_to g {j. j \\<le> l} (f ` {j. j \\<le> n1}))\"", "lemma two_func_imageTr:\"\\<lbrakk> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> B; \n   f \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> h ` {j. j \\<le> Suc n};  h (Suc n) \\<notin> f ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> n}\"", "lemma (in Module) finite_lin_spanTr3_0:\"\\<lbrakk>bij_to g {j. j \\<le> l} (g `{j. j \\<le> l});\n      ideal R A; \n     \\<forall>na. \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                   \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A. l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M; s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n}; \n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A; g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     0 < l; f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l\\<rbrakk>\n \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A. l_comb R M l sa g = l_comb R M (Suc n) t h\"", "lemma (in Module) finite_lin_spanTr3:\"ideal R A \\<Longrightarrow> \n       h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M \\<longrightarrow> \n      (\\<forall>na. \\<forall>s \\<in> {j. j \\<le> (na::nat)} \\<rightarrow> A. \n       \\<forall>f\\<in> {j. j \\<le> na} \\<rightarrow> (h ` {j. j \\<le> n}). (\\<exists>t \\<in> {j. j \\<le> n} \\<rightarrow> A. \n       l_comb R M na s f = l_comb R M n t h))\"", "lemma (in Module) finite_lin_span:\n\"\\<lbrakk>ideal R A;  h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M; s \\<in> {j. j \\<le> (n1::nat)} \\<rightarrow> A;\n f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n              l_comb R M n1 s f = l_comb R M n t h\"", "lemma (in Module) free_generator_generator:\"free_generator R M H \\<Longrightarrow>\n                  generator R M H\"", "lemma (in Module) free_generator_sub:\"free_generator R M H \\<Longrightarrow> \n                    H \\<subseteq> carrier M\"", "lemma (in Module) free_generator_nonzero:\"\\<lbrakk>\\<not> (zeroring R); \n                free_generator R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow> h \\<noteq> \\<zero>\"", "lemma (in Module) has_free_generator_nonzeroring:\" \\<lbrakk>free_generator R M H; \n      \\<exists>p \\<in> linear_span R M (carrier R) H. p \\<noteq> \\<zero> \\<rbrakk>  \\<Longrightarrow> \\<not> zeroring R\"", "lemma (in Module) unique_expression1:\"\\<lbrakk>H \\<subseteq> carrier M; free_generator R M H;\n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R; m \\<in> {j. j \\<le> n} \\<rightarrow> H; \n      inj_on m {j. j \\<le> n}; l_comb R M n s m = \\<zero>\\<rbrakk> \\<Longrightarrow> \n                                 \\<forall>j\\<in>{j. j \\<le> n}. s j = \\<zero>\\<^bsub>R\\<^esub>\"", "lemma (in Module) free_gen_coeff_zero:\"\\<lbrakk>H \\<subseteq> carrier M; free_generator R M H;\n       h \\<in> H; a \\<in> carrier R; a \\<cdot>\\<^sub>s h = \\<zero>\\<rbrakk> \\<Longrightarrow> a = \\<zero>\\<^bsub>R\\<^esub>\"", "lemma (in Module) unique_expression2:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk> \\<Longrightarrow>\n    \\<exists>m g t. g \\<in> ({j. j \\<le> (m::nat)} \\<rightarrow> H) \\<and> \n            bij_to g {j. j \\<le> (m::nat)} (f ` {j. j \\<le> n}) \\<and> \n            t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and> \n            l_comb R M n s f = l_comb R M m t g\"", "lemma (in Module) unique_expression3_1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {l. l \\<le> (Suc n)} \\<rightarrow> H; s \\<in> {l. l \\<le> (Suc n)} \\<rightarrow> carrier R; \n      (f (Suc n)) \\<notin> f `({l. l \\<le> (Suc n)} - {Suc n})\\<rbrakk> \\<Longrightarrow> \n     \\<exists>g m t. g \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> H \\<and> \n             inj_on g {l. l \\<le> (m::nat)} \\<and> \n             t \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> carrier R \\<and> \n             l_comb R M (Suc n) s f = \n                 l_comb R M m t g \\<and> t m = s (Suc n) \\<and> g m = f (Suc n)\"", "lemma (in Module) unique_expression3_2:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> H; s \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> carrier R; \n      l \\<le> (Suc n); (f l) \\<notin> f ` ({k. k \\<le> (Suc n)} - {l}); l \\<noteq> Suc n\\<rbrakk> \\<Longrightarrow> \n    \\<exists>g m t. g \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> H \\<and> inj_on g {l. l \\<le> (m::nat)} \\<and> \n            t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R \\<and> \n            l_comb R M (Suc n) s f = l_comb R M m t g \\<and> \n             t m = s l \\<and> g m = f l\"", "lemma (in Module) unique_expression3:\n   \"\\<lbrakk>H \\<subseteq> carrier M; f \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> carrier R; l \\<le> (Suc n);\n    (f l) \\<notin> f ` ({k. k \\<le> (Suc n)} - {l})\\<rbrakk> \\<Longrightarrow> \n   \\<exists>g m t. g \\<in> {k. k \\<le> (m::nat)} \\<rightarrow> H \\<and> \n        inj_on g {k. k \\<le> m} \\<and> \n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and> \n        l_comb R M (Suc n) s f = l_comb R M m t g \\<and> t m = s l \\<and> g m = f l\"", "lemma (in Module) unique_expression4:\"free_generator R M H \\<Longrightarrow>\n     f \\<in> {k. k \\<le> (n::nat)} \\<rightarrow> H \\<and> inj_on f {k. k \\<le> n} \\<and> \n     s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and> l_comb R M n s f \\<noteq> \\<zero>  \\<longrightarrow> \n(\\<exists>m g t. (g \\<in> {k. k \\<le> m} \\<rightarrow> H) \\<and> inj_on g {k. k \\<le> m} \\<and> \n        (g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n}) \\<and> (t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R) \\<and>\n        (\\<forall>l \\<in> {k. k \\<le> m}. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> l_comb R M n s f = l_comb R M m t g)\"", "lemma (in Module) unique_prepression5_0:\"\\<lbrakk>free_generator R M H; \n       f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n       s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; g \\<in> {j. j \\<le> m} \\<rightarrow> H; \n       inj_on g {j. j \\<le> m}; t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; \n       l_comb R M n s f = l_comb R M m t g;\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n       f n \\<notin> g ` {j. j \\<le> m}; 0 < n\\<rbrakk>  \\<Longrightarrow> False\"", "lemma (in Module) unique_expression5:\"\\<lbrakk>free_generator R M H; \n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; inj_on f {j. j \\<le> n}; \n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H; \n      inj_on g {j. j \\<le> m}; t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; \n      l_comb R M n s f = l_comb R M m t g; \n     \\<forall>j \\<in> {j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k \\<in> {j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk> \\<Longrightarrow>\n      f ` {j. j \\<le> n} \\<subseteq> g ` {j. j \\<le> m}\"", "lemma (in Module) unique_expression6:\"\\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; inj_on f {j. j \\<le> n}; \n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; \n      g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H; inj_on g {j. j \\<le> m}; \n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k\\<in> {j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk> \\<Longrightarrow> \n      f `{j. j \\<le> n} = g `  {j. j \\<le> m}\"", "lemma (in Module) unique_expression7_1:\"\\<lbrakk>free_generator R M H; \n    f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; inj_on f {j. j \\<le> n}; \n    s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; \n    g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H; inj_on g {j. j \\<le> m}; \n    t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; \n    l_comb R M n s f = l_comb R M m t g; \n   \\<forall>j \\<in> {j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k\\<in>{j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk> \\<Longrightarrow> n = m\"", "lemma (in Module) unique_expression7_2:\"\\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;  inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; \n      l_comb R M n s f = l_comb R M n t f\\<rbrakk> \\<Longrightarrow> (\\<forall>l \\<in> {j. j \\<le> n}. s l = t l)\""], "translations": [["", "lemma (in Module) module_is_ag: \"aGroup M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup M", ".."], ["", "lemma (in Module) module_inc_zero:\" \\<zero>\\<^bsub>M\\<^esub> \\<in> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> \\<in> carrier M", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "(** type of M is ('c, 'a, 'd) Module_scheme **)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(** type of M is (?'b, ?'b, ?'z) Module_scheme **)"], ["", "lemma (in Module) submodule_subset:\"submodule R M H \\<Longrightarrow> H \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> H \\<subseteq> carrier M", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_asubg:\"submodule R M H \\<Longrightarrow> M +> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> M +> H", "by (simp add:submodule_def)"], ["", "lemma (in Module) submodule_subset1:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                            h \\<in> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M \\<and>\n             M +> H \\<and>\n             (\\<forall>a m.\n                 a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n                 a \\<cdot>\\<^sub>s m \\<in> H);\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_inc_0:\"submodule R M H \\<Longrightarrow>\n                                           \\<zero>\\<^bsub>M\\<^esub> \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> \\<zero> \\<in> H", "apply (simp add:submodule_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> H", "apply (rule asubg_inc_zero, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_un:\" m \\<in> carrier M \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<in> carrier M \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = m", "apply (simp add:sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_mem:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> carrier M", "apply (simp add:sprod_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_sc_closed:\"\\<lbrakk>submodule R M H; \n a \\<in> carrier R; h \\<in> H\\<rbrakk> \\<Longrightarrow>  a \\<cdot>\\<^sub>s h \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s h \\<in> H", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_assoc:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; \n m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s m =  a \\<cdot>\\<^sub>s ( b \\<cdot>\\<^sub>s m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s\n                      m =\n                      a \\<cdot>\\<^sub>s (b \\<cdot>\\<^sub>s m)", "apply (simp add:sprod_assoc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_l_distr:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; \n m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b)\\<cdot>\\<^sub>s m = a \\<cdot>\\<^sub>s m \\<plusminus>  b \\<cdot>\\<^sub>s m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s\n                      m =\n                      a \\<cdot>\\<^sub>s m \\<plusminus> b \\<cdot>\\<^sub>s m", "apply (simp add:sprod_l_distr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_r_distr:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; n \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                 a \\<cdot>\\<^sub>s (m \\<plusminus> n) = a \\<cdot>\\<^sub>s m \\<plusminus>  a \\<cdot>\\<^sub>s n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M;\n     n \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s (m \\<plusminus> n) =\n                      a \\<cdot>\\<^sub>s m \\<plusminus> a \\<cdot>\\<^sub>s n", "apply (simp add:sprod_r_distr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_0_m:\"m \\<in> carrier M \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub>\\<cdot>\\<^sub>s m = \\<zero>\\<^bsub>M\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<in> carrier M \\<Longrightarrow>\n    \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = \\<zero>", "apply (cut_tac sc_Ring,\n       frule Ring.ring_is_ag,\n       frule aGroup.ag_inc_zero [of \"R\"],\n       frule sc_l_distr[of \"\\<zero>\\<^bsub>R\\<^esub>\" \"\\<zero>\\<^bsub>R\\<^esub>\" \"m\"], assumption+,\n       frule sc_mem [of \"\\<zero>\\<^bsub>R\\<^esub>\" m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier M; Ring R; aGroup R;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R;\n     (\\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n      \\<zero>\\<^bsub>R\\<^esub>) \\<cdot>\\<^sub>s\n     m =\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m \\<plusminus>\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m;\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = \\<zero>", "apply (simp add:aGroup.ag_l_zero, frule sym,\n       thin_tac \"\\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m \\<plusminus> \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier M; Ring R; aGroup R;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R;\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m \\<in> carrier M;\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m \\<plusminus>\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m =\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m = \\<zero>", "apply (frule ag_eq_sol1 [of \"\\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m\" \"\\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m\" \"\\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s m\"], assumption+,   \n       simp add:ag_l_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_a_0:\"a \\<in> carrier R \\<Longrightarrow> a \\<cdot>\\<^sub>s \\<zero>  = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow> a \\<cdot>\\<^sub>s \\<zero> = \\<zero>", "apply (cut_tac ag_inc_zero,\n       frule sc_r_distr[of a \\<zero> \\<zero>], assumption+,\n       frule sc_mem [of a \\<zero>], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<zero> \\<in> carrier M;\n     a \\<cdot>\\<^sub>s (\\<zero> \\<plusminus> \\<zero>) =\n     a \\<cdot>\\<^sub>s \\<zero> \\<plusminus> a \\<cdot>\\<^sub>s \\<zero>;\n     a \\<cdot>\\<^sub>s \\<zero> \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s \\<zero> = \\<zero>", "apply (simp add:ag_l_zero, frule sym,\n       thin_tac \"a \\<cdot>\\<^sub>s \\<zero> = a \\<cdot>\\<^sub>s \\<zero> \\<plusminus> a \\<cdot>\\<^sub>s \\<zero>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<zero> \\<in> carrier M;\n     a \\<cdot>\\<^sub>s \\<zero> \\<in> carrier M;\n     a \\<cdot>\\<^sub>s \\<zero> \\<plusminus> a \\<cdot>\\<^sub>s \\<zero> =\n     a \\<cdot>\\<^sub>s \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s \\<zero> = \\<zero>", "apply (frule ag_eq_sol1 [of \"a \\<cdot>\\<^sub>s \\<zero>\" \"a \\<cdot>\\<^sub>s \\<zero>\" \"a \\<cdot>\\<^sub>s \\<zero>\"], assumption+,   \n       simp add:ag_l_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_minus_am:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n                     \\<Longrightarrow> -\\<^sub>a (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s (-\\<^sub>a m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      a \\<cdot>\\<^sub>s (-\\<^sub>a m)", "apply (frule ag_mOp_closed [of m],\n       frule sc_r_distr[of a m \"-\\<^sub>a m\"], assumption+,\n       simp add:ag_r_inv1,\n       simp add:sc_a_0, frule sym,\n       thin_tac \"\\<zero> = a \\<cdot>\\<^sub>s m \\<plusminus> a \\<cdot>\\<^sub>s (-\\<^sub>a m)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M;\n     -\\<^sub>a m \\<in> carrier M;\n     a \\<cdot>\\<^sub>s m \\<plusminus> a \\<cdot>\\<^sub>s (-\\<^sub>a m) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      a \\<cdot>\\<^sub>s (-\\<^sub>a m)", "apply (frule sc_mem [of a m], assumption+,\n        frule sc_mem [of a \"-\\<^sub>a m\"], assumption+,\n        frule ag_eq_sol1 [of \"a \\<cdot>\\<^sub>s m\" \"a \\<cdot>\\<^sub>s (-\\<^sub>a m)\" \"\\<zero>\"], assumption+,\n        simp add:ag_inc_zero, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M;\n     -\\<^sub>a m \\<in> carrier M;\n     a \\<cdot>\\<^sub>s m \\<plusminus> a \\<cdot>\\<^sub>s (-\\<^sub>a m) =\n     \\<zero>;\n     a \\<cdot>\\<^sub>s m \\<in> carrier M;\n     a \\<cdot>\\<^sub>s (-\\<^sub>a m) \\<in> carrier M;\n     a \\<cdot>\\<^sub>s (-\\<^sub>a m) =\n     -\\<^sub>a a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      a \\<cdot>\\<^sub>s (-\\<^sub>a m)", "apply (frule ag_mOp_closed [of \"a \\<cdot>\\<^sub>s m\"],\n        simp add:ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_minus_am1:\"\\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n            \\<Longrightarrow> -\\<^sub>a (a \\<cdot>\\<^sub>s m) = (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m", "apply (cut_tac sc_Ring, frule Ring.ring_is_ag,\n       frule aGroup.ag_mOp_closed [of R a], assumption+,\n       frule sc_l_distr[of a \"-\\<^sub>a\\<^bsub>R\\<^esub> a\" m], assumption+,\n       simp add:aGroup.ag_r_inv1 [of \"R\"],\n       simp add:sc_0_m, frule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; Ring R; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n     \\<zero> =\n     a \\<cdot>\\<^sub>s m \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m;\n     a \\<cdot>\\<^sub>s m \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m", "apply (\n       thin_tac \"\\<zero> = a \\<cdot>\\<^sub>s m \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; Ring R; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n     a \\<cdot>\\<^sub>s m \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m", "apply (frule sc_mem [of a m], assumption+,\n        frule sc_mem [of \"-\\<^sub>a\\<^bsub>R\\<^esub> a\" m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; Ring R; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n     a \\<cdot>\\<^sub>s m \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     \\<zero>;\n     a \\<cdot>\\<^sub>s m \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m", "apply (frule ag_eq_sol1 [of \"a \\<cdot>\\<^sub>s m\" \"(-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m\" \\<zero>], assumption+,\n        simp add:ag_inc_zero, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; Ring R; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n     a \\<cdot>\\<^sub>s m \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     \\<zero>;\n     a \\<cdot>\\<^sub>s m \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     -\\<^sub>a a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m", "apply (frule ag_mOp_closed [of \"a \\<cdot>\\<^sub>s m\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; Ring R; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n     a \\<cdot>\\<^sub>s m \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     \\<zero>;\n     a \\<cdot>\\<^sub>s m \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m =\n     -\\<^sub>a a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero>;\n     -\\<^sub>a a \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>s m =\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m", "apply (thin_tac \"a \\<cdot>\\<^sub>s m \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s m = \\<zero>\",\n        simp add:ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_0:\"submodule R M {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M {\\<zero>}", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> \\<in> carrier M \\<and>\n    M +> {\\<zero>} \\<and>\n    (\\<forall>a.\n        a \\<in> carrier R \\<longrightarrow>\n        a \\<cdot>\\<^sub>s \\<zero> = \\<zero>)", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. M +> {\\<zero>} \\<and>\n    (\\<forall>a.\n        a \\<in> carrier R \\<longrightarrow>\n        a \\<cdot>\\<^sub>s \\<zero> = \\<zero>)", "apply (simp add:asubg_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a \\<in> carrier R \\<longrightarrow>\n       a \\<cdot>\\<^sub>s \\<zero> = \\<zero>", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       a \\<in> carrier R \\<Longrightarrow>\n       a \\<cdot>\\<^sub>s \\<zero> = \\<zero>", "apply (simp add:sc_a_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_whole:\"submodule R M (carrier M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M (carrier M)", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. M +> carrier M \\<and>\n    (\\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> carrier M \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> carrier M)", "apply (simp add:asubg_whole)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a m.\n       a \\<in> carrier R \\<and> m \\<in> carrier M \\<longrightarrow>\n       a \\<cdot>\\<^sub>s m \\<in> carrier M", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> carrier M", "apply (simp add:sc_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_pOp_closed:\"\\<lbrakk>submodule R M H; h \\<in> H; k \\<in> H\\<rbrakk> \\<Longrightarrow> \n                  h \\<plusminus> k \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H; k \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<plusminus> k \\<in> H", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M \\<and>\n             M +> H \\<and>\n             (\\<forall>a m.\n                 a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n                 a \\<cdot>\\<^sub>s m \\<in> H);\n     h \\<in> H; k \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<plusminus> k \\<in> H", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; k \\<in> H; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<plusminus> k \\<in> H", "apply (thin_tac \"\\<forall>a m. a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow> a \\<cdot>\\<^sub>s m \\<in> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; k \\<in> H; H \\<subseteq> carrier M; M +> H\\<rbrakk>\n    \\<Longrightarrow> h \\<plusminus> k \\<in> H", "apply (simp add:asubg_pOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_mOp_closed:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk>\n                 \\<Longrightarrow> -\\<^sub>a h \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a h \\<in> H", "apply (simp add:submodule_def,\n       (erule conjE)+,\n       thin_tac \"\\<forall>a m. a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow> a \\<cdot>\\<^sub>s m \\<in> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; H \\<subseteq> carrier M; M +> H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a h \\<in> H", "apply (rule asubg_mOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  mHom :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n                    ('c, 'b, 'm2) Module_scheme] \\<Rightarrow>  ('a \\<Rightarrow> 'c) set\"\n        (*  (\"(3HOM\\<^sub>_/ _/ _)\" [90, 90, 91]90 ) *) where\n  \"mHom R M N = {f. f \\<in> aHom M N \\<and> \n             (\\<forall>a\\<in>carrier R. \\<forall>m\\<in>carrier M. f (a \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f m))}\""], ["", "definition\n  mimg :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n           ('c, 'b, 'm2) Module_scheme, 'a \\<Rightarrow> 'c] \\<Rightarrow>  ('c, 'b) Module\" \n                 (\"(4mimg\\<^bsub>_ _,_\\<^esub>/ _)\" [88,88,88,89]88) where\n  \"mimg\\<^bsub>R M,N\\<^esub> f = mdl N (f ` (carrier M))\""], ["", "definition\n  mzeromap :: \"[('a, 'b, 'm1) Module_scheme, ('c, 'b, 'm2) Module_scheme]\n                              \\<Rightarrow> ('a \\<Rightarrow> 'c)\" where\n  \"mzeromap M N = (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\""], ["", "lemma (in Ring) mHom_func:\"f \\<in> mHom R M N \\<Longrightarrow> f \\<in> carrier M \\<rightarrow> carrier N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> mHom R M N \\<Longrightarrow>\n    f \\<in> carrier M \\<rightarrow> carrier N", "by (simp add:mHom_def aHom_def)"], ["", "lemma (in Module) mHom_test:\"\\<lbrakk>R module N; f \\<in> carrier M \\<rightarrow> carrier N \\<and> \n      f \\<in> extensional (carrier M) \\<and> \n     (\\<forall>m\\<in>carrier M. \\<forall>n\\<in>carrier M. f (m \\<plusminus>\\<^bsub>M\\<^esub> n) = f m \\<plusminus>\\<^bsub>N\\<^esub> (f n)) \\<and> \n     (\\<forall>a\\<in>carrier R. \\<forall>m\\<in>carrier M. f (a \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f m))\\<rbrakk> \\<Longrightarrow>\n     f \\<in> mHom R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>m\\<in>carrier M.\n         \\<forall>n\\<in>carrier M.\n            f (m \\<plusminus> n) =\n            f m \\<plusminus>\\<^bsub>N\\<^esub> f n) \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier M.\n            f (a \\<cdot>\\<^sub>s m) =\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>m\\<in>carrier M.\n         \\<forall>n\\<in>carrier M.\n            f (m \\<plusminus> n) =\n            f m \\<plusminus>\\<^bsub>N\\<^esub> f n) \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier M.\n            f (a \\<cdot>\\<^sub>s m) =\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M N", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_mem:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n \\<Longrightarrow> f m \\<in> carrier N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f m \\<in> carrier N", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M.\n         \\<forall>b\\<in>carrier M.\n            f (a \\<plusminus> b) =\n            f a \\<plusminus>\\<^bsub>N\\<^esub> f b) \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier M.\n            f (a \\<cdot>\\<^sub>s m) =\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m);\n     m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f m \\<in> carrier N", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M;\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     f \\<in> extensional (carrier M);\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           f (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m\\<rbrakk>\n    \\<Longrightarrow> f m \\<in> carrier N", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_add:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M; \n             n \\<in> carrier M\\<rbrakk> \\<Longrightarrow> f (m \\<plusminus> n) = f m \\<plusminus>\\<^bsub>N\\<^esub> (f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n     n \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f (m \\<plusminus> n) =\n                      f m \\<plusminus>\\<^bsub>N\\<^esub> f n", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier M.\n            f (a \\<cdot>\\<^sub>s m) =\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m);\n     m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f (m \\<plusminus> n) =\n                      f m \\<plusminus>\\<^bsub>N\\<^esub> f n", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; n \\<in> carrier M;\n     f \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           f (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m\\<rbrakk>\n    \\<Longrightarrow> f (m \\<plusminus> n) =\n                      f m \\<plusminus>\\<^bsub>N\\<^esub> f n", "apply (frule Module.module_is_ag [of N R],\n       cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; n \\<in> carrier M;\n     f \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           f (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m;\n     aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> f (m \\<plusminus> n) =\n                      f m \\<plusminus>\\<^bsub>N\\<^esub> f n", "apply (simp add:aHom_add)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_0:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> f (\\<zero>) = \\<zero>\\<^bsub>N\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:mHom_def, (erule conjE)+,\n       frule Module.module_is_ag [of N],\n       cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           f (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m;\n     aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:aHom_0_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_inv:\"\\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> \n                 f (-\\<^sub>a m) = -\\<^sub>a\\<^bsub>N\\<^esub> (f m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a m) = -\\<^sub>a\\<^bsub>N\\<^esub> f m", "apply (cut_tac module_is_ag,\n       frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N; aGroup M;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a m) = -\\<^sub>a\\<^bsub>N\\<^esub> f m", "apply (simp add:mHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; aGroup M; aGroup N;\n     f \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           f (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a m) = -\\<^sub>a\\<^bsub>N\\<^esub> f m", "apply (rule aHom_inv_inv, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_lin:\"\\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N;\n                    a \\<in> carrier R\\<rbrakk> \\<Longrightarrow> f (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; f \\<in> mHom R M N;\n     a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> f (a \\<cdot>\\<^sub>s m) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mker_inc_zero:\n           \"\\<lbrakk>R module N; f \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow> \\<zero> \\<in> (ker\\<^bsub>M,N\\<^esub> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> ker\\<^bsub>M,N\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> carrier M \\<and>\n                      f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:module_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:mHom_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_eq_ker:\"\\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M; \n      b\\<in> carrier M; a \\<plusminus> (-\\<^sub>a b) \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow> f a = f b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M;\n     a \\<plusminus> -\\<^sub>a b \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f a = f b", "apply (simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; a \\<plusminus> -\\<^sub>a b \\<in> carrier M;\n     f (a \\<plusminus> -\\<^sub>a b) = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f a = f b", "apply (cut_tac module_is_ag,\n       frule aGroup.ag_mOp_closed [of \"M\" \"b\"], assumption+,\n       simp add:mHom_add, simp add:mHom_inv,\n       thin_tac \"aGroup M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; a \\<plusminus> -\\<^sub>a b \\<in> carrier M;\n     f a \\<plusminus>\\<^bsub>N\\<^esub> -\\<^sub>a\\<^bsub>N\\<^esub> f b =\n     \\<zero>\\<^bsub>N\\<^esub>;\n     -\\<^sub>a b \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f a = f b", "apply (frule mHom_mem [of N f a], assumption+,\n       frule mHom_mem [of N f b], assumption+,\n       frule Module.module_is_ag[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; a \\<plusminus> -\\<^sub>a b \\<in> carrier M;\n     f a \\<plusminus>\\<^bsub>N\\<^esub> -\\<^sub>a\\<^bsub>N\\<^esub> f b =\n     \\<zero>\\<^bsub>N\\<^esub>;\n     -\\<^sub>a b \\<in> carrier M; f a \\<in> carrier N; f b \\<in> carrier N;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> f a = f b", "apply (subst aGroup.ag_eq_diffzero[of N], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_ker_eq:\"\\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M; \n      b\\<in> carrier M; f a = f b\\<rbrakk> \\<Longrightarrow> a \\<plusminus> (-\\<^sub>a b) \\<in> ker\\<^bsub>M,N\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; f a = f b\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b\n                      \\<in> ker\\<^bsub>M,N\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; f a = f b\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> carrier M \\<and>\n                      f (a \\<plusminus> -\\<^sub>a b) =\n                      \\<zero>\\<^bsub>N\\<^esub>", "apply (frule ag_mOp_closed[of b])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; f a = f b; -\\<^sub>a b \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> carrier M \\<and>\n                      f (a \\<plusminus> -\\<^sub>a b) =\n                      \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; f a = f b; -\\<^sub>a b \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f (a \\<plusminus> -\\<^sub>a b) =\n                      \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:mHom_add mHom_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; f a = f b; -\\<^sub>a b \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f b \\<plusminus>\\<^bsub>N\\<^esub>\n                      -\\<^sub>a\\<^bsub>N\\<^esub> f b =\n                      \\<zero>\\<^bsub>N\\<^esub>", "apply (frule mHom_mem [of N f b], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n     b \\<in> carrier M; f a = f b; -\\<^sub>a b \\<in> carrier M;\n     f b \\<in> carrier N\\<rbrakk>\n    \\<Longrightarrow> f b \\<plusminus>\\<^bsub>N\\<^esub>\n                      -\\<^sub>a\\<^bsub>N\\<^esub> f b =\n                      \\<zero>\\<^bsub>N\\<^esub>", "apply (frule_tac R = R and M = N in Module.module_is_ag,\n        simp add:aGroup.ag_r_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mker_submodule:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                                    submodule R M (ker\\<^bsub>M,N\\<^esub> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> submodule R M (ker\\<^bsub>M,N\\<^esub> f)", "apply (cut_tac module_is_ag,\n       frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> submodule R M (ker\\<^bsub>M,N\\<^esub> f)", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M \\<and>\n                      M +> ker\\<^bsub>M,N\\<^esub> f \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m\n                          \\<in> ker\\<^bsub>M,N\\<^esub> f)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> M +> ker\\<^bsub>M,N\\<^esub> f \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m\n                          \\<in> ker\\<^bsub>M,N\\<^esub> f)", "apply (rule subsetI, simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> M +> ker\\<^bsub>M,N\\<^esub> f \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m\n                          \\<in> ker\\<^bsub>M,N\\<^esub> f)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> M +> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f", "apply (simp add:mHom_def, (erule conjE)+, simp add:ker_subg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N;\n        a \\<in> carrier R; m \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f", "apply (simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N;\n        a \\<in> carrier R; m \\<in> carrier M;\n        f m = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> carrier M \\<and>\n                         f (a \\<cdot>\\<^sub>s m) = \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:sc_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N;\n        a \\<in> carrier R; m \\<in> carrier M;\n        f m = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f (a \\<cdot>\\<^sub>s m) = \\<zero>\\<^bsub>N\\<^esub>", "apply (subst mHom_lin [of N _ f], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N;\n        a \\<in> carrier R; m \\<in> carrier M;\n        f m = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         \\<zero>\\<^bsub>N\\<^esub>", "(* key *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup M; aGroup N;\n        a \\<in> carrier R; m \\<in> carrier M;\n        f m = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:Module.sc_a_0[of N])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mker_mzeromap:\"R module N \\<Longrightarrow>\n                         ker\\<^bsub>M,N\\<^esub> (mzeromap M N) = carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow>\n    ker\\<^bsub>M,N\\<^esub> mzeromap M N = carrier M", "apply (simp add:ker_def mzeromap_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mdl_carrier:\"submodule R M H \\<Longrightarrow> carrier (mdl M H) = H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> carrier (mdl M H) = H", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mdl_is_ag:\"submodule R M H \\<Longrightarrow> aGroup (mdl M H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> aGroup (mdl M H)", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> aGroup (mdl M H)", "apply (rule aGroup.intro)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>mdl M H\\<^esub>)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H); c \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>mdl M H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop (mdl M H)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 6. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>) \\<in> H \\<rightarrow> H \\<rightarrow> H\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H); c \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>mdl M H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop (mdl M H)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 6. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (clarsimp simp: submodule_def asubg_pOp_closed)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H); c \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>mdl M H\\<^esub> c)\n 2. \\<And>a b.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub> a\n 3. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop (mdl M H)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 5. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 6. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> H; b \\<in> H;\n        c \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c =\n                         a \\<plusminus> (b \\<plusminus> c)\n 2. \\<And>a b.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub> a\n 3. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop (mdl M H)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 5. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 6. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:submodule_def, (erule conjE)+,\n        frule_tac c = a in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac c = b in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac c = c in subsetD[of H \"carrier M\"], assumption+,\n        simp add:aGroup.ag_pOp_assoc)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; aGroup M; a \\<in> carrier (mdl M H);\n        b \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>mdl M H\\<^esub> a\n 2. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop (mdl M H)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 4. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:submodule_def, (erule conjE)+,\n        simp add:mdl_def,\n        frule_tac c = a in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac c = b in subsetD[of H \"carrier M\"], assumption+,\n        simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop (mdl M H)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M H)\n 2. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 3. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mop M \\<in> H \\<rightarrow> H\n 2. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 3. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:submodule_def aGroup.asubg_mOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>mdl M H\\<^esub> a \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>mdl M H\\<^esub>\n 2. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:mdl_def,\n        simp add:submodule_def, (erule conjE)+,\n        frule_tac c = a in subsetD[of H \"carrier M\"], assumption+,\n        rule aGroup.ag_l_inv1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<in> carrier (mdl M H)\n 2. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:mdl_def,\n        simp add:submodule_def, (erule conjE)+,\n        simp add:asubg_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; aGroup M;\n        a \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>mdl M H\\<^esub> \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a =\n                         a", "apply (simp add:mdl_def, simp add:submodule_def, (erule conjE)+,\n        frule_tac c = a in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>aGroup M; a \\<in> H; H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> a = a", "apply (simp add:ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mdl_is_module:\"submodule R M H \\<Longrightarrow> R module (mdl M H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> R module mdl M H", "apply (rule Module.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow> aGroup (mdl M H)\n 2. submodule R M H \\<Longrightarrow> Module_axioms (mdl M H) R", "apply (simp add:mdl_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> Module_axioms (mdl M H) R", "apply (rule Module_axioms.intro)"], ["proof (prove)\ngoal (6 subgoals):\n 1. submodule R M H \\<Longrightarrow> Ring R\n 2. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m\n                         \\<in> carrier (mdl M H)\n 3. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m\n 4. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H); n \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>mdl M H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> n\n 5. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 6. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:sc_Ring)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m\n                         \\<in> carrier (mdl M H)\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m\n 3. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H); n \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>mdl M H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> n\n 4. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 5. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> H\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m\n 3. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H); n \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>mdl M H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> n\n 4. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 5. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m\n 2. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H); n \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>mdl M H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> n\n 3. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 4. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s\n                         m =\n                         a \\<cdot>\\<^sub>s m \\<plusminus>\n                         b \\<cdot>\\<^sub>s m\n 2. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H); n \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>mdl M H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> n\n 3. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 4. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:submodule_def, (erule conjE)+,\n        frule_tac c = m in subsetD[of H \"carrier M\"], assumption+,\n        simp add:sc_l_distr)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H); n \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>mdl M H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m \\<plusminus>\\<^bsub>mdl M H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> n\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 3. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:mdl_def submodule_def, (erule conjE)+,\n       simp add:asubg_pOp_closed,\n       frule_tac c = m in subsetD[of H \"carrier M\"], assumption+,\n       frule_tac c = n in subsetD[of H \"carrier M\"], assumption+,\n       simp add:sc_r_distr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m)\n 2. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:mdl_def submodule_def, (erule conjE)+,\n       frule_tac c = m in subsetD[of H \"carrier M\"], assumption+,\n       simp add:sc_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub>\n                         m =\n                         m", "apply (simp add:mdl_def submodule_def, (erule conjE)+,\n       frule_tac c = m in subsetD[of H \"carrier M\"], assumption+,\n       simp add:sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) submodule_of_mdl:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n                   \\<Longrightarrow> submodule R (mdl M N) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> submodule R (mdl M N) H", "apply (subst submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier (mdl M N) \\<and>\n                      mdl M N +> H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m\n                          \\<in> H)", "apply (rule conjI, simp add:mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> mdl M N +> H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m\n                          \\<in> H)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> mdl M N +> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (rule aGroup.asubg_test[of \"mdl M N\" H])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> aGroup (mdl M N)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier (mdl M N)\n 3. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> H \\<noteq> {}\n 4. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>H.\n                         \\<forall>b\\<in>H.\n                            a \\<plusminus>\\<^bsub>mdl M N\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M N\\<^esub> b\n                            \\<in> H\n 5. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (frule mdl_is_module[of N],\n        simp add:Module.module_is_ag, simp add:mdl_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> H \\<noteq> {}\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>H.\n                         \\<forall>b\\<in>H.\n                            a \\<plusminus>\\<^bsub>mdl M N\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M N\\<^esub> b\n                            \\<in> H\n 3. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (simp add:submodule_def[of R M H], (erule conjE)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M N; H \\<subseteq> N; H \\<subseteq> carrier M;\n     M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<noteq> {}\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>H.\n                         \\<forall>b\\<in>H.\n                            a \\<plusminus>\\<^bsub>mdl M N\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M N\\<^esub> b\n                            \\<in> H\n 3. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (frule asubg_inc_zero[of H], simp add:nonempty)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>H.\n                         \\<forall>b\\<in>H.\n                            a \\<plusminus>\\<^bsub>mdl M N\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M N\\<^esub> b\n                            \\<in> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply ((rule ballI)+, simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> H; b \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (simp add:submodule_def[of R M H], (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M N; H \\<subseteq> N; a \\<in> H; b \\<in> H;\n        H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (frule_tac x = b in asubg_mOp_closed[of H], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M N; H \\<subseteq> N; a \\<in> H; b \\<in> H;\n        H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        -\\<^sub>a b \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (rule asubg_pOp_closed[of H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M N\\<^esub> m \\<in> H", "apply (simp add:mdl_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> H", "apply (simp add:submodule_def[of R M H])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) img_set_submodule:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n         submodule R N (f ` (carrier M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> submodule R N (f ` carrier M)", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<subseteq> carrier N \\<and>\n                      N +> f ` carrier M \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> f ` carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                          \\<in> f ` carrier M)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<subseteq> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> f ` carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                          \\<in> f ` carrier M)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        x \\<in> f ` carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> f ` carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                          \\<in> f ` carrier M)", "apply (simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        \\<exists>xa\\<in>carrier M. x = f xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> f ` carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                          \\<in> f ` carrier M)", "apply (erule bexE, simp, thin_tac \"x = f xa\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; xa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f xa \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> f ` carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                          \\<in> f ` carrier M)", "apply (simp add:mHom_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> f ` carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                          \\<in> f ` carrier M)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> N +> f ` carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (rule aGroup.asubg_test, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<subseteq> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<noteq> {}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>f ` carrier M.\n                         \\<forall>b\\<in>f ` carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b\n                            \\<in> f ` carrier M\n 4. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (rule subsetI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N;\n        x \\<in> f ` carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<noteq> {}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>f ` carrier M.\n                         \\<forall>b\\<in>f ` carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b\n                            \\<in> f ` carrier M\n 4. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (simp add:image_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N;\n        \\<exists>xa\\<in>carrier M. x = f xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<noteq> {}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>f ` carrier M.\n                         \\<forall>b\\<in>f ` carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b\n                            \\<in> f ` carrier M\n 4. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (erule bexE)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N;\n        xa \\<in> carrier M; x = f xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<noteq> {}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>f ` carrier M.\n                         \\<forall>b\\<in>f ` carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b\n                            \\<in> f ` carrier M\n 4. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (simp add:mHom_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M \\<noteq> {}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>f ` carrier M.\n                         \\<forall>b\\<in>f ` carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b\n                            \\<in> f ` carrier M\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (cut_tac ag_inc_zero,\n        simp add:mHom_mem,  simp add:nonempty)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>f ` carrier M.\n                         \\<forall>b\\<in>f ` carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b\n                            \\<in> f ` carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply ((rule ballI)+, simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N;\n        \\<exists>x\\<in>carrier M. a = f x;\n        \\<exists>x\\<in>carrier M. b = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier M.\n                            a \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> b =\n                            f x\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply ((erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N; x \\<in> carrier M;\n        a = f x; xa \\<in> carrier M; b = f xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb\\<in>carrier M.\n                            f x \\<plusminus>\\<^bsub>N\\<^esub>\n                            -\\<^sub>a\\<^bsub>N\\<^esub> f xa =\n                            f xb\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (simp add:mHom_inv[THEN sym],\n        frule_tac x = xa in ag_mOp_closed,\n        simp add:mHom_add[THEN sym, of N f],\n        frule_tac x = \"x\" and y = \"-\\<^sub>a xa\" in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; aGroup N; x \\<in> carrier M;\n        a = f x; xa \\<in> carrier M; b = f xa; -\\<^sub>a xa \\<in> carrier M;\n        x \\<plusminus> -\\<^sub>a xa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb\\<in>carrier M.\n                            f (x \\<plusminus> -\\<^sub>a xa) = f xb\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> f ` carrier M \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> f ` carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m\n                         \\<in> f ` carrier M", "apply (simp add:image_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        x \\<in> carrier M; m = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier M.\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x = f xa", "apply (simp add:mHom_lin[THEN sym, of N _ f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        x \\<in> carrier M; m = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s x) = f xa", "apply (frule_tac a = a and m = x in sc_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        x \\<in> carrier M; m = f x;\n        a \\<cdot>\\<^sub>s x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s x) = f xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mimg_module:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                                              R module (mimg R M N f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> R module mimg\\<^bsub>R M,N\\<^esub> f", "apply (simp add:mimg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> R module mdl N (f ` carrier M)", "apply (rule Module.mdl_is_module[of N R \"f ` (carrier M)\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> submodule R N (f ` carrier M)", "apply (simp add:img_set_submodule)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) surjec_to_mimg:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                                       surjec\\<^bsub>M, (mimg R M N f)\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M (mimg\\<^bsub>R M,N\\<^esub> f) \\<and>\n                      surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M (mimg\\<^bsub>R M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier M \\<rightarrow>\n                              carrier (mimg\\<^bsub>R M,N\\<^esub> f) \\<and>\n                      f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>a\\<in>carrier M.\n                          \\<forall>b\\<in>carrier M.\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f b)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier M \\<rightarrow>\n                              carrier (mimg\\<^bsub>R M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>a\\<in>carrier M.\n                          \\<forall>b\\<in>carrier M.\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f b)\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (simp add:mimg_def mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>a\\<in>carrier M.\n                          \\<forall>b\\<in>carrier M.\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f b)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier M)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier M.\n                         \\<forall>b\\<in>carrier M.\n                            f (a \\<plusminus> b) =\n                            f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f b\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (simp add:mHom_def aHom_def restrict_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier M.\n                         \\<forall>b\\<in>carrier M.\n                            f (a \\<plusminus> b) =\n                            f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply ((rule ballI)+, simp add:mimg_def mdl_def, simp add:mHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M)\n                       (carrier (mimg\\<^bsub>R M,N\\<^esub> f))", "apply (simp add:mimg_def mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M) (f ` carrier M)", "apply (simp add:surj_to_def image_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  tOp_mHom :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n    ('c, 'b, 'm2) Module_scheme] \\<Rightarrow>  ('a \\<Rightarrow> 'c) \\<Rightarrow> ('a \\<Rightarrow> 'c) \\<Rightarrow> ('a \\<Rightarrow> 'c)\" where\n  \"tOp_mHom R M N f g = (\\<lambda>x \\<in> carrier M. (f x \\<plusminus>\\<^bsub>N\\<^esub> (g x)))\""], ["", "definition\n  iOp_mHom :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n    ('c, 'b, 'm2) Module_scheme] \\<Rightarrow>  ('a \\<Rightarrow> 'c) \\<Rightarrow> ('a \\<Rightarrow> 'c)\" where\n  \"iOp_mHom R M N f = (\\<lambda>x \\<in> carrier M. (-\\<^sub>a\\<^bsub>N\\<^esub> (f x)))\""], ["", "definition\n  sprod_mHom ::\"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n    ('c, 'b, 'm2) Module_scheme] \\<Rightarrow> 'b \\<Rightarrow> ('a \\<Rightarrow> 'c) \\<Rightarrow> ('a \\<Rightarrow> 'c)\" where\n  \"sprod_mHom R M N a f = (\\<lambda>x \\<in> carrier M. a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f x))\""], ["", "definition\n  HOM :: \"[('b, 'more) Ring_scheme, ('a, 'b, 'more1) Module_scheme, \n    ('c, 'b, 'more2) Module_scheme] \\<Rightarrow> ('a \\<Rightarrow> 'c, 'b) Module\"   \n    (\"(3HOM\\<^bsub>_\\<^esub> _/ _)\" [90, 90, 91] 90) where\n \"HOM\\<^bsub>R\\<^esub> M N = \\<lparr>carrier = mHom R M N, pop = tOp_mHom R M N, \n  mop = iOp_mHom R M N, zero = mzeromap M N,  sprod =sprod_mHom R M N \\<rparr>\""], ["", "lemma (in Module) zero_HOM:\"R module N \\<Longrightarrow>\n         mzeromap M N = \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow>\n    mzeromap M N = \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) tOp_mHom_closed:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n      \\<Longrightarrow> tOp_mHom R M N f g \\<in> mHom R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g \\<in> mHom R M N", "apply (rule mHom_test, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g\n                      \\<in> carrier M \\<rightarrow> carrier N \\<and>\n                      tOp_mHom R M N f g\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g\n                      \\<in> carrier M \\<rightarrow> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N f g x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (simp add:tOp_mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f x \\<plusminus>\\<^bsub>N\\<^esub> g x\n                         \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (frule_tac f = f and m = x in mHom_mem [of N], assumption+,\n        frule_tac f = g and m = x in mHom_mem [of N], assumption+,\n        frule Module.module_is_ag [of N], \n        simp add:aGroup.ag_pOp_closed[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g \\<in> extensional (carrier M)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (simp add:tOp_mHom_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             tOp_mHom R M N f g (m \\<plusminus> n) =\n                             tOp_mHom R M N f g\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             tOp_mHom R M N f g m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         \\<forall>n\\<in>carrier M.\n                            tOp_mHom R M N f g (m \\<plusminus> n) =\n                            tOp_mHom R M N f g\n                             m \\<plusminus>\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N f g (m \\<plusminus> n) =\n                         tOp_mHom R M N f g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         tOp_mHom R M N f g n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply (simp add:tOp_mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (m \\<plusminus> n \\<in> carrier M \\<longrightarrow>\n                          f (m \\<plusminus> n) \\<plusminus>\\<^bsub>N\\<^esub>\n                          g (m \\<plusminus> n) =\n                          f m \\<plusminus>\\<^bsub>N\\<^esub>\n                          g m \\<plusminus>\\<^bsub>N\\<^esub>\n                          (f n \\<plusminus>\\<^bsub>N\\<^esub> g n)) \\<and>\n                         (m \\<plusminus> n\n                          \\<notin> carrier M \\<longrightarrow>\n                          undefined =\n                          f m \\<plusminus>\\<^bsub>N\\<^esub>\n                          g m \\<plusminus>\\<^bsub>N\\<^esub>\n                          (f n \\<plusminus>\\<^bsub>N\\<^esub> g n))\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (m \\<plusminus> n) \\<plusminus>\\<^bsub>N\\<^esub>\n                         g (m \\<plusminus> n) =\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f n \\<plusminus>\\<^bsub>N\\<^esub> g n)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+,\n       frule_tac f = f and m = n in mHom_mem [of N], assumption+,\n       frule_tac f = g and m = m in mHom_mem [of N], assumption+,\n       frule_tac f = g and m = n in mHom_mem [of N], assumption+,\n       simp add:mHom_add,\n       frule Module.module_is_ag [of N],\n       subst aGroup.pOp_assocTr43[of \"N\"], assumption+,\n       frule_tac x = \"f n\" and y = \"g m\" in aGroup.ag_pOp_commute [of \"N\"],\n                                                              assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M; f m \\<in> carrier N;\n        f n \\<in> carrier N; g m \\<in> carrier N; g n \\<in> carrier N;\n        aGroup N;\n        f n \\<plusminus>\\<^bsub>N\\<^esub> g m =\n        g m \\<plusminus>\\<^bsub>N\\<^esub> f n\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f n \\<plusminus>\\<^bsub>N\\<^esub>\n                          g m) \\<plusminus>\\<^bsub>N\\<^esub>\n                         g n =\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f n \\<plusminus>\\<^bsub>N\\<^esub> g n)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M; f m \\<in> carrier N;\n        f n \\<in> carrier N; g m \\<in> carrier N; g n \\<in> carrier N;\n        aGroup N;\n        f n \\<plusminus>\\<^bsub>N\\<^esub> g m =\n        g m \\<plusminus>\\<^bsub>N\\<^esub> f n\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g m \\<plusminus>\\<^bsub>N\\<^esub>\n                          f n) \\<plusminus>\\<^bsub>N\\<^esub>\n                         g n =\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f n \\<plusminus>\\<^bsub>N\\<^esub> g n)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply (subst aGroup.pOp_assocTr43[of \"N\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            tOp_mHom R M N f g m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N f g (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         tOp_mHom R M N f g m", "apply (simp add:tOp_mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>s m\n                          \\<in> carrier M \\<longrightarrow>\n                          f (a \\<cdot>\\<^sub>s\n                             m) \\<plusminus>\\<^bsub>N\\<^esub>\n                          g (a \\<cdot>\\<^sub>s m) =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (f m \\<plusminus>\\<^bsub>N\\<^esub> g m)) \\<and>\n                         (a \\<cdot>\\<^sub>s m\n                          \\<notin> carrier M \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (f m \\<plusminus>\\<^bsub>N\\<^esub> g m))", "apply (frule_tac a = a and m = m in sc_mem, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (a \\<cdot>\\<^sub>s\n                            m) \\<plusminus>\\<^bsub>N\\<^esub>\n                         g (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f m \\<plusminus>\\<^bsub>N\\<^esub> g m)", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+,\n       frule_tac f = g and m = m in mHom_mem [of N], assumption+,\n       frule_tac a = a and m = \"f m\" and n = \"g m\" in \n                                  Module.sc_r_distr[of N R], assumption+,\n      simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; f m \\<in> carrier N;\n        g m \\<in> carrier N;\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n        (f m \\<plusminus>\\<^bsub>N\\<^esub> g m) =\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m \\<plusminus>\\<^bsub>N\\<^esub>\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n       \\<Longrightarrow> f (a \\<cdot>\\<^sub>s\n                            m) \\<plusminus>\\<^bsub>N\\<^esub>\n                         g (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m", "apply (simp add:mHom_lin)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) iOp_mHom_closed:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n                                     \\<Longrightarrow> iOp_mHom R M N f \\<in> mHom R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> mHom R M N", "apply (rule mHom_test, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f\n                      \\<in> carrier M \\<rightarrow> carrier N \\<and>\n                      iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f\n                      \\<in> carrier M \\<rightarrow> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> iOp_mHom R M N f x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (simp add:iOp_mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (frule_tac f = f and m = x in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; x \\<in> carrier M;\n        f x \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; x \\<in> carrier M;\n        f x \\<in> carrier N; aGroup N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f x \\<in> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (simp add:aGroup.ag_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> iOp_mHom R M N f \\<in> extensional (carrier M)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (simp add:iOp_mHom_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             iOp_mHom R M N f (m \\<plusminus> n) =\n                             iOp_mHom R M N f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             iOp_mHom R M N f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         \\<forall>n\\<in>carrier M.\n                            iOp_mHom R M N f (m \\<plusminus> n) =\n                            iOp_mHom R M N f m \\<plusminus>\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> iOp_mHom R M N f (m \\<plusminus> n) =\n                         iOp_mHom R M N f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         iOp_mHom R M N f n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (simp add:iOp_mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (m \\<plusminus> n \\<in> carrier M \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>N\\<^esub> f (m \\<plusminus> n) =\n                          -\\<^sub>a\\<^bsub>N\\<^esub> f\n                m \\<plusminus>\\<^bsub>N\\<^esub>\n                          -\\<^sub>a\\<^bsub>N\\<^esub> f n) \\<and>\n                         (m \\<plusminus> n\n                          \\<notin> carrier M \\<longrightarrow>\n                          undefined =\n                          -\\<^sub>a\\<^bsub>N\\<^esub> f\n                m \\<plusminus>\\<^bsub>N\\<^esub>\n                          -\\<^sub>a\\<^bsub>N\\<^esub> f n)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f (m \\<plusminus> n) =\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (simp add:mHom_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> (f\n                m \\<plusminus>\\<^bsub>N\\<^esub>\n               f n) =\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+,\n         frule_tac f = f and m = n in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        n \\<in> carrier M; f m \\<in> carrier N; f n \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> (f\n                m \\<plusminus>\\<^bsub>N\\<^esub>\n               f n) =\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        n \\<in> carrier M; f m \\<in> carrier N; f n \\<in> carrier N;\n        aGroup N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> (f\n                m \\<plusminus>\\<^bsub>N\\<^esub>\n               f n) =\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         -\\<^sub>a\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (simp add:aGroup.ag_p_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            iOp_mHom R M N f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> iOp_mHom R M N f (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         iOp_mHom R M N f m", "apply (simp add:iOp_mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>s m\n                          \\<in> carrier M \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>N\\<^esub> f\n                (a \\<cdot>\\<^sub>s m) =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (-\\<^sub>a\\<^bsub>N\\<^esub> f m)) \\<and>\n                         (a \\<cdot>\\<^sub>s m\n                          \\<notin> carrier M \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (-\\<^sub>a\\<^bsub>N\\<^esub> f m))", "apply (simp add:sc_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f\n               (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (-\\<^sub>a\\<^bsub>N\\<^esub> f m)", "apply (simp add:mHom_lin)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n              f m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (-\\<^sub>a\\<^bsub>N\\<^esub> f m)", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n              f m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (-\\<^sub>a\\<^bsub>N\\<^esub> f m)", "apply (simp add:Module.sc_minus_am[of N])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_ex_zero:\"R module N \\<Longrightarrow>  mzeromap M N \\<in> mHom R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow> mzeromap M N \\<in> mHom R M N", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow>\n    mzeromap M N \\<in> aHom M N \\<and>\n    (\\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           mzeromap M N (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> mzeromap M N m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R module N \\<Longrightarrow> mzeromap M N \\<in> aHom M N\n 2. R module N \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mzeromap M N (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> mzeromap M N m", "apply (simp add:aHom_def,\n        rule conjI,\n        simp add:mzeromap_def, simp add:Module.module_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R module N \\<Longrightarrow>\n    mzeromap M N \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           mzeromap M N (a \\<plusminus> b) =\n           mzeromap M N a \\<plusminus>\\<^bsub>N\\<^esub> mzeromap M N b)\n 2. R module N \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mzeromap M N (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> mzeromap M N m", "apply (simp add:mzeromap_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R module N \\<Longrightarrow>\n    \\<forall>a\\<in>carrier M.\n       \\<forall>b\\<in>carrier M.\n          (a \\<plusminus> b \\<in> carrier M \\<longrightarrow>\n           \\<zero>\\<^bsub>N\\<^esub> =\n           \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n           \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n          (a \\<plusminus> b \\<notin> carrier M \\<longrightarrow>\n           undefined =\n           \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n           \\<zero>\\<^bsub>N\\<^esub>)\n 2. R module N \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mzeromap M N (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> mzeromap M N m", "apply ((rule ballI)+,\n         simp add:ag_pOp_closed,\n         frule Module.module_is_ag [of N],\n         frule aGroup.ag_inc_zero [of \"N\"],\n         simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mzeromap M N (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> mzeromap M N m", "apply ((rule ballI)+,\n       simp add:mzeromap_def,\n       simp add:sc_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:Module.sc_a_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_eq:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N; \n                            \\<forall>m\\<in>carrier M. f m = g m\\<rbrakk> \\<Longrightarrow> f = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n     \\<forall>m\\<in>carrier M. f m = g m\\<rbrakk>\n    \\<Longrightarrow> f = g", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M.\n         \\<forall>b\\<in>carrier M.\n            f (a \\<plusminus> b) =\n            g a \\<plusminus>\\<^bsub>N\\<^esub> g b) \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier M.\n            f (a \\<cdot>\\<^sub>s m) =\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m);\n     g \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     g \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M.\n         \\<forall>b\\<in>carrier M.\n            g (a \\<plusminus> b) =\n            g a \\<plusminus>\\<^bsub>N\\<^esub> g b) \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier M.\n            g (a \\<cdot>\\<^sub>s m) =\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m);\n     \\<forall>m\\<in>carrier M. f m = g m\\<rbrakk>\n    \\<Longrightarrow> f = g", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; \\<forall>m\\<in>carrier M. f m = g m;\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     g \\<in> carrier M \\<rightarrow> carrier N;\n     f \\<in> extensional (carrier M); g \\<in> extensional (carrier M);\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           f (a \\<plusminus> b) = g a \\<plusminus>\\<^bsub>N\\<^esub> g b;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           f (a \\<cdot>\\<^sub>s m) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m;\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           g (a \\<plusminus> b) = g a \\<plusminus>\\<^bsub>N\\<^esub> g b;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> f = g", "apply (rule funcset_eq, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_l_zero:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n              \\<Longrightarrow> tOp_mHom R M N (mzeromap M N) f = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (mzeromap M N) f = f", "apply (frule mHom_ex_zero [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     mzeromap M N \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (mzeromap M N) f = f", "apply (frule tOp_mHom_closed [of N \"mzeromap M N\" f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; mzeromap M N \\<in> mHom R M N;\n     tOp_mHom R M N (mzeromap M N) f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (mzeromap M N) f = f", "apply (rule mHom_eq, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; mzeromap M N \\<in> mHom R M N;\n     tOp_mHom R M N (mzeromap M N) f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         tOp_mHom R M N (mzeromap M N) f m = f m", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        mzeromap M N \\<in> mHom R M N;\n        tOp_mHom R M N (mzeromap M N) f \\<in> mHom R M N;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N (mzeromap M N) f m = f m", "apply (simp add:tOp_mHom_def, simp add:mzeromap_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M then \\<zero>\\<^bsub>N\\<^esub>\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                         f m =\n                         f m", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M then \\<zero>\\<^bsub>N\\<^esub>\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                         f m =\n                         f m", "apply (frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M then \\<zero>\\<^bsub>N\\<^esub>\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N; aGroup N\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                         f m =\n                         f m", "apply (simp add:aGroup.ag_l_zero[of N])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  (in Module) mHom_l_inv:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N (iOp_mHom R M N f) f = mzeromap M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (iOp_mHom R M N f) f = mzeromap M N", "apply (frule mHom_ex_zero [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     mzeromap M N \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (iOp_mHom R M N f) f = mzeromap M N", "apply (frule_tac f = f in iOp_mHom_closed [of N], assumption,\n       frule_tac f = \"iOp_mHom R M N f\" and g = f in tOp_mHom_closed [of N],\n        assumption+,\n       frule mHom_ex_zero [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; mzeromap M N \\<in> mHom R M N;\n     iOp_mHom R M N f \\<in> mHom R M N;\n     tOp_mHom R M N (iOp_mHom R M N f) f \\<in> mHom R M N;\n     mzeromap M N \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (iOp_mHom R M N f) f = mzeromap M N", "apply (rule mHom_eq, assumption+, rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        mzeromap M N \\<in> mHom R M N; iOp_mHom R M N f \\<in> mHom R M N;\n        tOp_mHom R M N (iOp_mHom R M N f) f \\<in> mHom R M N;\n        mzeromap M N \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N (iOp_mHom R M N f) f m =\n                         mzeromap M N m", "apply (simp add:tOp_mHom_def iOp_mHom_def, simp add:mzeromap_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. -\\<^sub>a\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M then -\\<^sub>a\\<^bsub>N\\<^esub> f x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\n        \\<in> mHom R M N;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         f m =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. -\\<^sub>a\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M then -\\<^sub>a\\<^bsub>N\\<^esub> f x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\n        \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         f m =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. -\\<^sub>a\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M then -\\<^sub>a\\<^bsub>N\\<^esub> f x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. \\<zero>\\<^bsub>N\\<^esub>)\n        \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N; aGroup N\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>N\\<^esub> f\n               m \\<plusminus>\\<^bsub>N\\<^esub>\n                         f m =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:aGroup.ag_l_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  (in Module) mHom_tOp_assoc:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        h \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> tOp_mHom R M N (tOp_mHom R M N f g) h =\n          tOp_mHom R M N f (tOp_mHom R M N g h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n     h \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (tOp_mHom R M N f g) h =\n                      tOp_mHom R M N f (tOp_mHom R M N g h)", "apply (frule_tac f = f and g = g in tOp_mHom_closed [of N], assumption+,\n       frule_tac f = \"tOp_mHom R M N f g\" and g = h in \n                      tOp_mHom_closed [of N], assumption+,\n       frule_tac f = g and g = h in tOp_mHom_closed [of N], assumption+,\n       frule_tac f = f and g = \"tOp_mHom R M N g h\" in \n                      tOp_mHom_closed [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n     h \\<in> mHom R M N; tOp_mHom R M N f g \\<in> mHom R M N;\n     tOp_mHom R M N (tOp_mHom R M N f g) h \\<in> mHom R M N;\n     tOp_mHom R M N g h \\<in> mHom R M N;\n     tOp_mHom R M N f (tOp_mHom R M N g h) \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N (tOp_mHom R M N f g) h =\n                      tOp_mHom R M N f (tOp_mHom R M N g h)", "apply (rule mHom_eq, assumption+, rule ballI,\n        thin_tac \"tOp_mHom R M N f g \\<in> mHom R M N\",\n        thin_tac \"tOp_mHom R M N (tOp_mHom R M N f g) h \\<in> mHom R M N\",\n        thin_tac \"tOp_mHom R M N g h \\<in> mHom R M N\",\n        thin_tac \"tOp_mHom R M N f (tOp_mHom R M N g h) \\<in> mHom R M N\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        h \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N (tOp_mHom R M N f g) h m =\n                         tOp_mHom R M N f (tOp_mHom R M N g h) m", "apply (simp add:tOp_mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        h \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         h m =\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g m \\<plusminus>\\<^bsub>N\\<^esub> h m)", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+,\n        frule_tac f = g and m = m in mHom_mem [of N], assumption+,\n        frule_tac f = h and m = m in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        h \\<in> mHom R M N; m \\<in> carrier M; f m \\<in> carrier N;\n        g m \\<in> carrier N; h m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         h m =\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g m \\<plusminus>\\<^bsub>N\\<^esub> h m)", "apply (frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        h \\<in> mHom R M N; m \\<in> carrier M; f m \\<in> carrier N;\n        g m \\<in> carrier N; h m \\<in> carrier N; aGroup N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         g m \\<plusminus>\\<^bsub>N\\<^esub>\n                         h m =\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g m \\<plusminus>\\<^bsub>N\\<^esub> h m)", "apply (simp add:aGroup.ag_pOp_assoc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_tOp_commute:\"\\<lbrakk>R module N; f \\<in> mHom R M N; \n        g \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> tOp_mHom R M N f g = tOp_mHom R M N g f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g = tOp_mHom R M N g f", "apply (frule_tac f = f and g = g in tOp_mHom_closed [of N], assumption+,\n       frule_tac f = g and g = f in tOp_mHom_closed [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n     tOp_mHom R M N f g \\<in> mHom R M N;\n     tOp_mHom R M N g f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> tOp_mHom R M N f g = tOp_mHom R M N g f", "apply (rule mHom_eq, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n     tOp_mHom R M N f g \\<in> mHom R M N;\n     tOp_mHom R M N g f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         tOp_mHom R M N f g m = tOp_mHom R M N g f m", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        tOp_mHom R M N f g \\<in> mHom R M N;\n        tOp_mHom R M N g f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N f g m = tOp_mHom R M N g f m", "apply (thin_tac \"tOp_mHom R M N f g \\<in> mHom R M N\",\n        thin_tac \"tOp_mHom R M N g f \\<in> mHom R M N\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N f g m = tOp_mHom R M N g f m", "apply (simp add:tOp_mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub> g m =\n                         g m \\<plusminus>\\<^bsub>N\\<^esub> f m", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+,\n        frule_tac f = g and m = m in mHom_mem [of N], assumption+,\n        frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N; g m \\<in> carrier N;\n        aGroup N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub> g m =\n                         g m \\<plusminus>\\<^bsub>N\\<^esub> f m", "apply (simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  (in Module) HOM_is_ag:\"R module N \\<Longrightarrow> aGroup (HOM\\<^bsub>R\\<^esub> M N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow> aGroup (HOM\\<^bsub>R\\<^esub> M N)", "apply (rule aGroup.intro)"], ["proof (prove)\ngoal (7 subgoals):\n 1. R module N \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        c \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          c)\n 3. \\<And>a b.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a\n 4. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 5. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 6. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 7. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (7 subgoals):\n 1. R module N \\<Longrightarrow>\n    tOp_mHom R M N\n    \\<in> mHom R M N \\<rightarrow> mHom R M N \\<rightarrow> mHom R M N\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        c \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          c)\n 3. \\<And>a b.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a\n 4. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 5. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 6. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 7. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:tOp_mHom_closed)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        c \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          c)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a\n 3. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 4. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 5. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 6. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>R module N; a \\<in> mHom R M N; b \\<in> mHom R M N;\n        c \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N (tOp_mHom R M N a b) c =\n                         tOp_mHom R M N a (tOp_mHom R M N b c)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a\n 3. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 4. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 5. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 6. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:mHom_tOp_assoc)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a\n 2. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 3. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 4. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 5. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; a \\<in> mHom R M N; b \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M N a b = tOp_mHom R M N b a\n 2. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 3. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 4. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 5. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:mHom_tOp_commute)"], ["proof (prove)\ngoal (4 subgoals):\n 1. R module N \\<Longrightarrow>\n    mop (HOM\\<^bsub>R\\<^esub> M N)\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N) \\<rightarrow>\n          carrier (HOM\\<^bsub>R\\<^esub> M N)\n 2. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 3. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 4. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. R module N \\<Longrightarrow>\n    iOp_mHom R M N \\<in> mHom R M N \\<rightarrow> mHom R M N\n 2. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 3. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 4. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:iOp_mHom_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n 2. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 3. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def,\n       simp add:mHom_l_inv)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R module N \\<Longrightarrow>\n    \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n    \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 2. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R module N \\<Longrightarrow> mzeromap M N \\<in> mHom R M N\n 2. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:mHom_ex_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub> \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a =\n                         a", "apply (simp add:HOM_def,\n       simp add:mHom_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sprod_mHom_closed:\"\\<lbrakk>R module N; a \\<in> carrier R; \n       f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> sprod_mHom R M N a f \\<in> mHom R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f \\<in> mHom R M N", "apply (rule mHom_test, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f\n                      \\<in> carrier M \\<rightarrow> carrier N \\<and>\n                      sprod_mHom R M N a f\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             sprod_mHom R M N a f (m \\<plusminus> n) =\n                             sprod_mHom R M N a f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f n) \\<and>\n                      (\\<forall>aa\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                             aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f\n                      \\<in> carrier M \\<rightarrow> carrier N\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             sprod_mHom R M N a f (m \\<plusminus> n) =\n                             sprod_mHom R M N a f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f n) \\<and>\n                      (\\<forall>aa\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                             aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f m)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> carrier M \\<longrightarrow>\n                         sprod_mHom R M N a f x \\<in> carrier N\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             sprod_mHom R M N a f (m \\<plusminus> n) =\n                             sprod_mHom R M N a f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f n) \\<and>\n                      (\\<forall>aa\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                             aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f m)", "apply (rule allI, rule impI, simp add:sprod_mHom_def,\n        frule_tac f = f and m = x in mHom_mem [of N], assumption+,\n        simp add:Module.sc_mem [of N R a])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f\n                      \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             sprod_mHom R M N a f (m \\<plusminus> n) =\n                             sprod_mHom R M N a f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f n) \\<and>\n                      (\\<forall>aa\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                             aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sprod_mHom R M N a f \\<in> extensional (carrier M)\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             sprod_mHom R M N a f (m \\<plusminus> n) =\n                             sprod_mHom R M N a f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f n) \\<and>\n                      (\\<forall>aa\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                             aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f m)", "apply (simp add:sprod_mHom_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             sprod_mHom R M N a f (m \\<plusminus> n) =\n                             sprod_mHom R M N a f\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f n) \\<and>\n                      (\\<forall>aa\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                             aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             sprod_mHom R M N a f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         \\<forall>n\\<in>carrier M.\n                            sprod_mHom R M N a f (m \\<plusminus> n) =\n                            sprod_mHom R M N a f\n                             m \\<plusminus>\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f n\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N a f (m \\<plusminus> n) =\n                         sprod_mHom R M N a f\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         sprod_mHom R M N a f n\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (frule_tac x = m and y = n in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M;\n        m \\<plusminus> n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N a f (m \\<plusminus> n) =\n                         sprod_mHom R M N a f\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         sprod_mHom R M N a f n\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (simp add:sprod_mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M;\n        m \\<plusminus> n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f (m \\<plusminus> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (subst mHom_add [of N f], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M;\n        m \\<plusminus> n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f m \\<plusminus>\\<^bsub>N\\<^esub> f n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+, \n        frule_tac f = f and m = n in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        m \\<in> carrier M; n \\<in> carrier M;\n        m \\<plusminus> n \\<in> carrier M; f m \\<in> carrier N;\n        f n \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f m \\<plusminus>\\<^bsub>N\\<^esub> f n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f n\n 2. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (simp add:Module.sc_r_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>aa\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                            aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            sprod_mHom R M N a f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        aa \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N a f (aa \\<cdot>\\<^sub>s m) =\n                         aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         sprod_mHom R M N a f m", "apply (simp add:sprod_mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        aa \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (aa \\<cdot>\\<^sub>s m\n                          \\<in> carrier M \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          f (aa \\<cdot>\\<^sub>s m) =\n                          aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m)) \\<and>\n                         (aa \\<cdot>\\<^sub>s m\n                          \\<notin> carrier M \\<longrightarrow>\n                          undefined =\n                          aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m))", "apply (frule_tac a = aa and m = m in sc_mem, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        aa \\<in> carrier R; m \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f (aa \\<cdot>\\<^sub>s m) =\n                         aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m)", "apply (simp add:mHom_lin)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        aa \\<in> carrier R; m \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m) =\n                         aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m)", "apply (frule_tac f = f and m = m in mHom_mem [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        aa \\<in> carrier R; m \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s m \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m) =\n                         aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m)", "apply (simp add:Module.sc_assoc[THEN sym, of N R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        aa \\<in> carrier R; m \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s m \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          aa) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m =\n                         (aa \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m", "apply (cut_tac sc_Ring, simp add:Ring.ring_tOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) HOM_is_module:\"R module N \\<Longrightarrow> R module (HOM\\<^bsub>R\\<^esub> M N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow> R module HOM\\<^bsub>R\\<^esub> M N", "apply (rule Module.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R module N \\<Longrightarrow> aGroup (HOM\\<^bsub>R\\<^esub> M N)\n 2. R module N \\<Longrightarrow> Module_axioms (HOM\\<^bsub>R\\<^esub> M N) R", "apply (simp add:HOM_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. R module N \\<Longrightarrow> Module_axioms (HOM\\<^bsub>R\\<^esub> M N) R", "apply (rule Module_axioms.intro)"], ["proof (prove)\ngoal (6 subgoals):\n 1. R module N \\<Longrightarrow> Ring R\n 2. \\<And>a m.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m\n                         \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m\n 4. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 5. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 6. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:sc_Ring)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m\n                         \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m\n 3. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 4. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 5. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; a \\<in> carrier R; m \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N a m \\<in> mHom R M N\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m\n 3. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 4. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 5. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:sprod_mHom_closed)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b) m =\n                         tOp_mHom R M N (sprod_mHom R M N a m)\n                          (sprod_mHom R M N b m)\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (cut_tac sc_Ring,\n        frule Ring.ring_is_ag[of R],\n        frule_tac x = a and y = b in aGroup.ag_pOp_closed[of R], assumption+,\n        frule_tac a = \"a \\<plusminus>\\<^bsub>R\\<^esub> b\" and f = m in sprod_mHom_closed[of N], \n        assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> mHom R M N; Ring R; aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R;\n        sprod_mHom R M N (a \\<plusminus>\\<^bsub>R\\<^esub> b) m\n        \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b) m =\n                         tOp_mHom R M N (sprod_mHom R M N a m)\n                          (sprod_mHom R M N b m)\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply(frule_tac a = a and f = m in sprod_mHom_closed[of N], assumption+,\n        frule_tac a = b and f = m in sprod_mHom_closed[of N], assumption+,\n        frule_tac f = \"sprod_mHom R M N a m\" and g = \"sprod_mHom R M N b m\" in\n        tOp_mHom_closed[of N], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> mHom R M N; Ring R; aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R;\n        sprod_mHom R M N (a \\<plusminus>\\<^bsub>R\\<^esub> b) m\n        \\<in> mHom R M N;\n        sprod_mHom R M N a m \\<in> mHom R M N;\n        sprod_mHom R M N b m \\<in> mHom R M N;\n        tOp_mHom R M N (sprod_mHom R M N a m) (sprod_mHom R M N b m)\n        \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b) m =\n                         tOp_mHom R M N (sprod_mHom R M N a m)\n                          (sprod_mHom R M N b m)\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (rule mHom_eq[of N], assumption+, rule ballI,\n         simp add:sprod_mHom_def tOp_mHom_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m ma.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> mHom R M N; Ring R; aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R;\n        (\\<lambda>x\\<in>carrier M.\n            (a \\<plusminus>\\<^bsub>R\\<^esub>\n             b) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n            m x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M\n             then a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier M\n             then b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m x else undefined))\n        \\<in> mHom R M N;\n        ma \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         m ma =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         m ma \\<plusminus>\\<^bsub>N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m ma\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (rename_tac a b f m)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b f m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> mHom R M N; Ring R; aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R;\n        (\\<lambda>x\\<in>carrier M.\n            (a \\<plusminus>\\<^bsub>R\\<^esub>\n             b) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M\n             then a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier M\n             then b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x else undefined))\n        \\<in> mHom R M N;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (frule_tac f = f and m = m in mHom_mem[of N], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b f m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> mHom R M N; Ring R; aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R;\n        (\\<lambda>x\\<in>carrier M.\n            (a \\<plusminus>\\<^bsub>R\\<^esub>\n             b) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n            f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M\n             then a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier M\n             then b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x else undefined))\n        \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m\n 2. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:Module.sc_l_distr[of N])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N);\n        n \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         n\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>R module N; a \\<in> carrier R; m \\<in> mHom R M N;\n        n \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N a (tOp_mHom R M N m n) =\n                         tOp_mHom R M N (sprod_mHom R M N a m)\n                          (sprod_mHom R M N a n)\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (rename_tac a f g,\n        frule_tac f = f and g = g in tOp_mHom_closed[of N], assumption+,\n        frule_tac a = a and f = \"tOp_mHom R M N f g\" in \n                                     sprod_mHom_closed[of N], assumption+,\n        frule_tac a = a and f = f in sprod_mHom_closed[of N], assumption+,\n        frule_tac a = a and f = g in sprod_mHom_closed[of N], assumption+,\n        frule_tac f = \"sprod_mHom R M N a f\" and g = \"sprod_mHom R M N a g\" \n        in tOp_mHom_closed[of N], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a f g.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; tOp_mHom R M N f g \\<in> mHom R M N;\n        sprod_mHom R M N a (tOp_mHom R M N f g) \\<in> mHom R M N;\n        sprod_mHom R M N a f \\<in> mHom R M N;\n        sprod_mHom R M N a g \\<in> mHom R M N;\n        tOp_mHom R M N (sprod_mHom R M N a f) (sprod_mHom R M N a g)\n        \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N a (tOp_mHom R M N f g) =\n                         tOp_mHom R M N (sprod_mHom R M N a f)\n                          (sprod_mHom R M N a g)\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (rule mHom_eq[of N], assumption+, rule ballI,\n        simp add:sprod_mHom_def tOp_mHom_def,\n        frule_tac f = f and m = m in mHom_mem[of N], assumption+,\n        frule_tac f = g and m = m in mHom_mem[of N], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a f g m.\n       \\<lbrakk>R module N; a \\<in> carrier R; f \\<in> mHom R M N;\n        g \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. f x \\<plusminus>\\<^bsub>N\\<^esub> g x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier M then f x \\<plusminus>\\<^bsub>N\\<^esub> g x\n             else undefined))\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M. a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g x)\n        \\<in> mHom R M N;\n        (\\<lambda>x\\<in>carrier M.\n            (if x \\<in> carrier M\n             then a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier M\n             then a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g x else undefined))\n        \\<in> mHom R M N;\n        m \\<in> carrier M; f m \\<in> carrier N; g m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f m \\<plusminus>\\<^bsub>N\\<^esub> g m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:Module.sc_r_distr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) m =\n                         sprod_mHom R M N a (sprod_mHom R M N b m)\n 2. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (rename_tac a b f)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b f.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) f =\n                         sprod_mHom R M N a (sprod_mHom R M N b f)\n 2. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (cut_tac sc_Ring,\n        frule_tac x = a and y = b in Ring.ring_tOp_closed, assumption+,\n        frule_tac a = \"a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b\" and f = f in sprod_mHom_closed[of N], \n                                                            assumption+,\n        frule_tac a = b and f = f in sprod_mHom_closed[of N], assumption+,\n        frule_tac a = a and f = \"sprod_mHom R M N b f\" in \n                                     sprod_mHom_closed[of N], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b f.\n       \\<lbrakk>R module N; a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> mHom R M N; Ring R;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b \\<in> carrier R;\n        sprod_mHom R M N (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) f\n        \\<in> mHom R M N;\n        sprod_mHom R M N b f \\<in> mHom R M N;\n        sprod_mHom R M N a (sprod_mHom R M N b f) \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) f =\n                         sprod_mHom R M N a (sprod_mHom R M N b f)\n 2. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (rule mHom_eq[of N], assumption+, rule ballI,\n        simp add:sprod_mHom_def,\n        frule_tac f = f and m = m in mHom_mem[of N], assumption+,\n        simp add:Module.sc_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> M N)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M N\\<^esub>\n                         m =\n                         m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; m \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N 1\\<^sub>r\\<^bsub>R\\<^esub> m = m", "apply (cut_tac sc_Ring,\n        frule Ring.ring_one,\n        frule_tac a = \"1\\<^sub>r\\<^bsub>R\\<^esub>\" and f = m in sprod_mHom_closed[of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; m \\<in> mHom R M N; Ring R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R;\n        sprod_mHom R M N 1\\<^sub>r\\<^bsub>R\\<^esub> m\n        \\<in> mHom R M N\\<rbrakk>\n       \\<Longrightarrow> sprod_mHom R M N 1\\<^sub>r\\<^bsub>R\\<^esub> m = m", "apply (rule mHom_eq, assumption+, rule ballI, rename_tac f m,\n        simp add:sprod_mHom_def,\n        frule_tac f = f and m = m in mHom_mem[of N], assumption+,\n        simp add:Module.sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Injective hom, surjective hom, bijective hom and inverse hom\""], ["", "definition\n  invmfun :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n              ('c, 'b, 'm2) Module_scheme, 'a \\<Rightarrow> 'c] \\<Rightarrow> 'c \\<Rightarrow> 'a\" where\n  \"invmfun R M N (f :: 'a \\<Rightarrow> 'c) =\n                    (\\<lambda>y\\<in>(carrier N). SOME x. (x \\<in> (carrier M) \\<and> f x = y))\""], ["", "definition\n  misomorphic :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n              ('c, 'b, 'm2) Module_scheme] \\<Rightarrow> bool\" where\n  \"misomorphic R M N \\<longleftrightarrow> (\\<exists>f. f \\<in> mHom R M N \\<and> bijec\\<^bsub>M,N\\<^esub> f)\""], ["", "definition\n  mId :: \"('a, 'b, 'm1) Module_scheme \\<Rightarrow> 'a \\<Rightarrow> 'a\"   (\"(mId\\<^bsub>_\\<^esub>/ )\" [89]88) where\n  \"mId\\<^bsub>M\\<^esub> = (\\<lambda>m\\<in>carrier M. m)\""], ["", "definition\n  mcompose :: \"[('a, 'r, 'm1) Module_scheme, 'b \\<Rightarrow> 'c, 'a \\<Rightarrow> 'b] \\<Rightarrow> 'a \\<Rightarrow> 'c\" where\n  \"mcompose M g f = compose (carrier M) g f\""], ["", "abbreviation\n  MISOM  (\"(3_ \\<cong>\\<^bsub>_\\<^esub> _)\" [82,82,83]82) where\n  \"M \\<cong>\\<^bsub>R\\<^esub> N == misomorphic R M N\""], ["", "lemma (in Module) minjec_inj:\"\\<lbrakk>R module N; injec\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n                            inj_on f (carrier M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; injec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> inj_on f (carrier M)", "apply (simp add:inj_on_def, (rule ballI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; injec\\<^bsub>M,N\\<^esub> f; x \\<in> carrier M;\n        y \\<in> carrier M; f x = f y\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp add:injec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M; f x = f y;\n        f \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule Module.module_is_ag[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M; f x = f y;\n        f \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> f = {\\<zero>};\n        aGroup N\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M; f x = f y;\n        f \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}; aGroup N;\n        aGroup M\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule_tac a = x in aHom_mem[of M N f], assumption+,\n        frule_tac a = y in aHom_mem[of M N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M; f x = f y;\n        f \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}; aGroup N;\n        aGroup M; f x \\<in> carrier N; f y \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp add:aGroup.ag_eq_diffzero[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f x \\<plusminus>\\<^bsub>N\\<^esub> -\\<^sub>a\\<^bsub>N\\<^esub> f y =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        f \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}; aGroup N;\n        aGroup M; f x \\<in> carrier N; f y \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp add:aHom_inv_inv[THEN sym, of M N f],\n       frule_tac x = y in aGroup.ag_mOp_closed, assumption+,\n       simp add:aHom_add[THEN sym, of M N f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f (x \\<plusminus> -\\<^sub>a y) = \\<zero>\\<^bsub>N\\<^esub>;\n        f \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}; aGroup N;\n        aGroup M; f x \\<in> carrier N; f y \\<in> carrier N;\n        -\\<^sub>a y \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f (x \\<plusminus> -\\<^sub>a y) = \\<zero>\\<^bsub>N\\<^esub>;\n        f \\<in> aHom M N;\n        {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        aGroup N; aGroup M; f x \\<in> carrier N; f y \\<in> carrier N;\n        -\\<^sub>a y \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule_tac x = x and y = \"-\\<^sub>a y\" in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f (x \\<plusminus> -\\<^sub>a y) = \\<zero>\\<^bsub>N\\<^esub>;\n        f \\<in> aHom M N;\n        {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        aGroup N; aGroup M; f x \\<in> carrier N; f y \\<in> carrier N;\n        -\\<^sub>a y \\<in> carrier M;\n        x \\<plusminus> -\\<^sub>a y \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (subgoal_tac \"(x \\<plusminus> -\\<^sub>a y) \\<in> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>}\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>; f \\<in> aHom M N;\n        {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        aGroup N; aGroup M; f x \\<in> carrier N; f y \\<in> carrier N;\n        -\\<^sub>a y \\<in> carrier M; \\<zero> \\<in> carrier M;\n        x \\<plusminus> -\\<^sub>a y = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x = y\n 2. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f (x \\<plusminus> -\\<^sub>a y) = \\<zero>\\<^bsub>N\\<^esub>;\n        f \\<in> aHom M N;\n        {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        aGroup N; aGroup M; f x \\<in> carrier N; f y \\<in> carrier N;\n        -\\<^sub>a y \\<in> carrier M;\n        x \\<plusminus> -\\<^sub>a y \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y\n                         \\<in> {a \\<in> carrier M.\n                                f a = \\<zero>\\<^bsub>N\\<^esub>}", "apply (simp add:ag_eq_diffzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>R module N; x \\<in> carrier M; y \\<in> carrier M;\n        f (x \\<plusminus> -\\<^sub>a y) = \\<zero>\\<^bsub>N\\<^esub>;\n        f \\<in> aHom M N;\n        {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        aGroup N; aGroup M; f x \\<in> carrier N; f y \\<in> carrier N;\n        -\\<^sub>a y \\<in> carrier M;\n        x \\<plusminus> -\\<^sub>a y \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y\n                         \\<in> {a \\<in> carrier M.\n                                f a = \\<zero>\\<^bsub>N\\<^esub>}", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) invmfun_l_inv:\"\\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                            (invmfun R M N f) (f m) = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f;\n     m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (simp add:bijec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (frule minjec_inj [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> f; inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (simp add:surjec_def, erule conjE, simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     inj_on f (carrier M);\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M.\n         \\<forall>b\\<in>carrier M.\n            f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b);\n     surj_to f (carrier M) (carrier N)\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (frule conjunct1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     inj_on f (carrier M);\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M.\n         \\<forall>b\\<in>carrier M.\n            f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b);\n     surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (thin_tac \"f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M. \\<forall>b\\<in>carrier M. f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     inj_on f (carrier M); surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (frule invfun_l [of \"f\" \"carrier M\" \"carrier N\" \"m\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     inj_on f (carrier M); surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     (f\\<inverse>\\<^bsub>carrier N,carrier M\\<^esub>) (f m) = m\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; m \\<in> carrier M; injec\\<^bsub>M,N\\<^esub> f;\n     inj_on f (carrier M); f ` carrier M = carrier N;\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     (f\\<inverse>\\<^bsub>carrier N,carrier M\\<^esub>) (f m) = m\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f (f m) = m", "apply (simp add:invfun_def invmfun_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) invmfun_mHom:\"\\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow>\n                 invmfun R M N f \\<in> mHom R N M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f;\n     f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> mHom R N M", "apply (frule minjec_inj [of N f])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f;\n     f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> mHom R N M", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> mHom R N M", "apply (subgoal_tac \"surjec\\<^bsub>M,N\\<^esub> f\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> mHom R N M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> mHom R N M", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> mHom R N M", "apply (rule Module.mHom_test)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module N\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M \\<and>\n                      invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M \\<and>\n                      invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (rule Module_axioms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M \\<and>\n                      invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (simp add:surjec_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); f \\<in> aHom M N;\n     surj_to f (carrier M) (carrier N)\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (simp add:aHom_def, frule conjunct1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M);\n     f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M.\n         \\<forall>b\\<in>carrier M.\n            f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b);\n     surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (thin_tac \"f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n     f \\<in> extensional (carrier M) \\<and>\n     (\\<forall>a\\<in>carrier M. \\<forall>b\\<in>carrier M. f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (frule inv_func [of \"f\" \"carrier M\" \"carrier N\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     f\\<inverse>\\<^bsub>carrier N,carrier M\\<^esub>\n     \\<in> carrier N \\<rightarrow> carrier M\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f\n                      \\<in> carrier N \\<rightarrow> carrier M\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (simp add:invmfun_def invfun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N) \\<and>\n                      (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> extensional (carrier N)\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (simp add:invmfun_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier N.\n                          \\<forall>n\\<in>carrier N.\n                             invmfun R M N f\n                              (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                             invmfun R M N f m \\<plusminus>\n                             invmfun R M N f n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier N.\n                             invmfun R M N f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s invmfun R M N f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier N.\n                         \\<forall>n\\<in>carrier N.\n                            invmfun R M N f\n                             (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                            invmfun R M N f m \\<plusminus> invmfun R M N f n\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f;\n        m \\<in> carrier N; n \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                         invmfun R M N f m \\<plusminus> invmfun R M N f n\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M);\n        f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n        m \\<in> carrier N; n \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                         invmfun R M N f m \\<plusminus> invmfun R M N f n\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (erule conjE, simp add:surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); m \\<in> carrier N; n \\<in> carrier N;\n        f \\<in> aHom M N; f ` carrier M = carrier N\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                         invmfun R M N f m \\<plusminus> invmfun R M N f n\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (frule sym, thin_tac \"f ` carrier M = carrier N\", simp,\n        thin_tac \"carrier N = f ` carrier M\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); m \\<in> f ` carrier M; n \\<in> f ` carrier M;\n        f \\<in> aHom M N\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (m \\<plusminus>\\<^bsub>N\\<^esub> n) =\n                         invmfun R M N f m \\<plusminus> invmfun R M N f n\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n x xa.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); f \\<in> aHom M N; x \\<in> carrier M; m = f x;\n        xa \\<in> carrier M; n = f xa\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (f x \\<plusminus>\\<^bsub>N\\<^esub> f xa) =\n                         invmfun R M N f (f x) \\<plusminus>\n                         invmfun R M N f (f xa)\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:mHom_add[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n x xa.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); f \\<in> aHom M N; x \\<in> carrier M; m = f x;\n        xa \\<in> carrier M; n = f xa\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f (f (x \\<plusminus> xa)) =\n                         invmfun R M N f (f x) \\<plusminus>\n                         invmfun R M N f (f xa)\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (frule_tac x = x and y = xa in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n x xa.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); f \\<in> aHom M N; x \\<in> carrier M; m = f x;\n        xa \\<in> carrier M; n = f xa;\n        x \\<plusminus> xa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f (f (x \\<plusminus> xa)) =\n                         invmfun R M N f (f x) \\<plusminus>\n                         invmfun R M N f (f xa)\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:invmfun_l_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier N.\n                            invmfun R M N f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f;\n        a \\<in> carrier R; m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                         a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:surjec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); a \\<in> carrier R; m \\<in> carrier N;\n        f \\<in> aHom M N; surj_to f (carrier M) (carrier N)\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                         a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:surj_to_def, frule sym, thin_tac \"f ` carrier M = carrier N\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); a \\<in> carrier R; m \\<in> carrier N;\n        f \\<in> aHom M N; carrier N = f ` carrier M\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n                         a \\<cdot>\\<^sub>s invmfun R M N f m", "apply (simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m x.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); a \\<in> carrier R; f \\<in> aHom M N;\n        carrier N = {y. \\<exists>x\\<in>carrier M. y = f x};\n        x \\<in> carrier M; m = f x\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f\n                          (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f x) =\n                         a \\<cdot>\\<^sub>s invmfun R M N f (f x)", "apply (simp add:mHom_lin[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m x.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); a \\<in> carrier R; f \\<in> aHom M N;\n        carrier N = {y. \\<exists>x\\<in>carrier M. y = f x};\n        x \\<in> carrier M; m = f x\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f (f (a \\<cdot>\\<^sub>s x)) =\n                         a \\<cdot>\\<^sub>s invmfun R M N f (f x)", "apply (frule_tac a = a and m = x in sc_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m x.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; f \\<in> mHom R M N;\n        inj_on f (carrier M); a \\<in> carrier R; f \\<in> aHom M N;\n        carrier N = {y. \\<exists>x\\<in>carrier M. y = f x};\n        x \\<in> carrier M; m = f x;\n        a \\<cdot>\\<^sub>s x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f (f (a \\<cdot>\\<^sub>s x)) =\n                         a \\<cdot>\\<^sub>s invmfun R M N f (f x)", "apply (simp add:invmfun_l_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) invmfun_r_inv:\"\\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> carrier N\\<rbrakk> \\<Longrightarrow>\n                           f ((invmfun R M N f) n) = n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f;\n     n \\<in> carrier N\\<rbrakk>\n    \\<Longrightarrow> f (invmfun R M N f n) = n", "apply (frule minjec_inj[of N f])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f;\n     n \\<in> carrier N\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> carrier N;\n     inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> f (invmfun R M N f n) = n", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> carrier N;\n     inj_on f (carrier M)\\<rbrakk>\n    \\<Longrightarrow> f (invmfun R M N f n) = n", "apply (unfold bijec_def, frule conjunct2, fold bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> carrier N;\n     inj_on f (carrier M); surjec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f (invmfun R M N f n) = n", "apply (simp add:surjec_def, erule conjE, simp add:surj_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> carrier N;\n     inj_on f (carrier M); f \\<in> aHom M N;\n     f ` carrier M = carrier N\\<rbrakk>\n    \\<Longrightarrow> f (invmfun R M N f n) = n", "apply (frule sym, thin_tac \"f ` carrier M = carrier N\", simp,\n        thin_tac \"carrier N = f ` carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f; n \\<in> f ` carrier M;\n     inj_on f (carrier M); f \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> f (invmfun R M N f n) = n", "apply (simp add:image_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; bijec\\<^bsub>M,N\\<^esub> f;\n        inj_on f (carrier M); f \\<in> aHom M N; x \\<in> carrier M;\n        n = f x\\<rbrakk>\n       \\<Longrightarrow> f (invmfun R M N f (f x)) = f x", "apply (simp add:invmfun_l_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_compos:\"\\<lbrakk>R module L; R module N; f \\<in> mHom R L M; \n       g \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow> compos L g f \\<in> mHom R L N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n     g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> mHom R L N", "apply (simp add:mHom_def [of \"R\" \"L\" \"N\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n     g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier L.\n                             compos L g f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             compos L g f m)", "apply (frule Module.module_is_ag [of L],\n        frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier L.\n                             compos L g f\n                              (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             compos L g f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier L.\n                            compos L g f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            compos L g f m", "apply (simp add:mHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; aGroup L; aGroup N; f \\<in> aHom L M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier L.\n           f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) = a \\<cdot>\\<^sub>s f m;\n     g \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier L.\n                            compos L g f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            compos L g f m", "apply (rule aHom_compos[of L M N f], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>R module L; R module N; aGroup L; aGroup N; f \\<in> aHom L M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier L.\n           f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) = a \\<cdot>\\<^sub>s f m;\n     g \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> aGroup M\n 2. \\<lbrakk>R module L; R module N; aGroup L; aGroup N; f \\<in> aHom L M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier L.\n           f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) = a \\<cdot>\\<^sub>s f m;\n     g \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> aGroup N\n 3. \\<lbrakk>R module L; R module N; aGroup L; aGroup N; f \\<in> aHom L M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier L.\n           f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) = a \\<cdot>\\<^sub>s f m;\n     g \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom L M\n 4. \\<lbrakk>R module L; R module N; aGroup L; aGroup N; f \\<in> aHom L M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier L.\n           f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) = a \\<cdot>\\<^sub>s f m;\n     g \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> g \\<in> aHom M N\n 5. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier L.\n                            compos L g f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            compos L g f m", "apply (cut_tac module_is_ag, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier L.\n                            compos L g f\n                             (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            compos L g f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> compos L g f\n                          (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> compos L g f m", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m\n                          \\<in> carrier L \\<longrightarrow>\n                          g (f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m)) =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)) \\<and>\n                         (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m\n                          \\<notin> carrier L \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m))", "apply (simp add:Module.sc_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g (f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m)) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)", "apply (subst Module.mHom_lin[of L R M _ f], assumption, rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g (a \\<cdot>\\<^sub>s f m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)", "(*apply (\n        simp add:Module_def, rule conjI, assumption+) *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g (a \\<cdot>\\<^sub>s f m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)", "apply (subst Module.mHom_lin[of M R N _ g], rule Module_axioms, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> f m \\<in> carrier M\n 2. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g \\<in> mHom R M N\n 3. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R\n 4. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)", "(*apply (\n        simp add:Module_def, rule conjI)*)  (** ordering **)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> f m \\<in> carrier M\n 2. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g \\<in> mHom R M N\n 3. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R\n 4. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)", "apply (rule Module.mHom_mem[of L R M f], assumption, rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; a \\<in> carrier R;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g (f m)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mcompos_inj_inj:\"\\<lbrakk>R module L; R module N; f \\<in> mHom R L M; \n       g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g \\<rbrakk> \\<Longrightarrow> injec\\<^bsub>L,N\\<^esub> (compos L g f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>L,N\\<^esub> compos L g f", "apply (frule Module.module_is_ag [of L],\n       frule Module.module_is_ag [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>L,N\\<^esub> compos L g f", "apply (simp add:injec_def [of \"L\" \"N\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N \\<and>\n                      ker\\<^bsub>L,N\\<^esub> compos L g f =\n                      {\\<zero>\\<^bsub>L\\<^esub>}", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>L,N\\<^esub> compos L g f =\n                      {\\<zero>\\<^bsub>L\\<^esub>}", "apply (simp add:injec_def, (erule conjE)+,\n        rule_tac aHom_compos[of L M N], assumption+,\n        rule module_is_ag)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; f \\<in> aHom L M;\n     ker\\<^bsub>L,M\\<^esub> f = {\\<zero>\\<^bsub>L\\<^esub>};\n     g \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> g = {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> aGroup N\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; f \\<in> aHom L M;\n     ker\\<^bsub>L,M\\<^esub> f = {\\<zero>\\<^bsub>L\\<^esub>};\n     g \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> g = {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom L M\n 3. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; f \\<in> aHom L M;\n     ker\\<^bsub>L,M\\<^esub> f = {\\<zero>\\<^bsub>L\\<^esub>};\n     g \\<in> aHom M N; ker\\<^bsub>M,N\\<^esub> g = {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> g \\<in> aHom M N\n 4. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>L,N\\<^esub> compos L g f =\n                      {\\<zero>\\<^bsub>L\\<^esub>}", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>L,N\\<^esub> compos L g f =\n                      {\\<zero>\\<^bsub>L\\<^esub>}", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier L.\n           g (f x)) =\n                      {\\<zero>\\<^bsub>L\\<^esub>}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier L.\n           g (f x))\n                      \\<subseteq> {\\<zero>\\<^bsub>L\\<^esub>}\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        injec\\<^bsub>M,N\\<^esub> g; aGroup L; aGroup N;\n        x \\<in> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier L.\n     g (f x))\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>L\\<^esub>\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (simp add:injec_def [of _ _ \"g\"], erule conjE, simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} =\n        {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>L\\<^esub>\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (subgoal_tac \"f x \\<in> {a. a \\<in> carrier M \\<and> g a = \\<zero>\\<^bsub>N\\<^esub>}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        f x\n        \\<in> {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>L\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} =\n        {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier M.\n                                g a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        f x = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>L\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} =\n        {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier M.\n                                g a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (simp add:injec_def [of _ _ \"f\"], erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        f x = \\<zero>; f \\<in> aHom L M;\n        ker\\<^bsub>L,M\\<^esub> f = {\\<zero>\\<^bsub>L\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>L\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} =\n        {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier M.\n                                g a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (subgoal_tac \"x \\<in> ker\\<^bsub>L,M\\<^esub> f\", simp, thin_tac \"ker\\<^bsub>L,M\\<^esub> f = {\\<zero>\\<^bsub>L\\<^esub>}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>};\n        f x = \\<zero>; f \\<in> aHom L M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ker\\<^bsub>L,M\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} =\n        {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier M.\n                                g a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N;\n        {a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} =\n        {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier M.\n                                g a = \\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (thin_tac \"{a \\<in> carrier M. g a = \\<zero>\\<^bsub>N\\<^esub>} = {\\<zero>}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        x \\<in> carrier L \\<and>\n        (if x \\<in> carrier L then g (f x) else undefined) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<in> aHom M N\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier M.\n                                g a = \\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (simp, erule conjE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f; aGroup L; aGroup N;\n        g \\<in> aHom M N; x \\<in> carrier L;\n        g (f x) = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> carrier M\n 2. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (rule Module.mHom_mem[of L R M f], assumption, rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     injec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> g; aGroup L;\n     aGroup N\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>L\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                    L.\n                       g (f x))", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        injec\\<^bsub>M,N\\<^esub> g; aGroup L; aGroup N;\n        x = \\<zero>\\<^bsub>L\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>L\\<^esub>\n                         \\<in> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                 L.\n                    g (f x))", "apply (frule Module.module_inc_zero [of L R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        injec\\<^bsub>M,N\\<^esub> g; aGroup L; aGroup N;\n        x = \\<zero>\\<^bsub>L\\<^esub>;\n        \\<zero>\\<^bsub>L\\<^esub> \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>L\\<^esub>\n                         \\<in> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                 L.\n                    g (f x))", "apply (frule Module.mHom_0[of L R M f], rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        injec\\<^bsub>M,N\\<^esub> g; aGroup L; aGroup N;\n        x = \\<zero>\\<^bsub>L\\<^esub>;\n        \\<zero>\\<^bsub>L\\<^esub> \\<in> carrier L;\n        f \\<zero>\\<^bsub>L\\<^esub> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>L\\<^esub>\n                         \\<in> ker\\<^bsub>L,N\\<^esub> (\\<lambda>x\\<in>carrier\n                                 L.\n                    g (f x))", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        injec\\<^bsub>M,N\\<^esub> g; aGroup L; aGroup N;\n        x = \\<zero>\\<^bsub>L\\<^esub>;\n        \\<zero>\\<^bsub>L\\<^esub> \\<in> carrier L;\n        f \\<zero>\\<^bsub>L\\<^esub> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> g \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (subst mHom_0[of N], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mcompos_surj_surj:\"\\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N \\<rbrakk> \\<Longrightarrow> \n                                        surjec\\<^bsub>L,N\\<^esub> (compos L g f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M;\n     g \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>L,N\\<^esub> compos L g f", "apply (frule Module.module_is_ag [of L],\n       frule Module.module_is_ag [of N],\n       cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>L,N\\<^esub> compos L g f", "apply (simp add:surjec_def [of \"L\" \"N\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N \\<and>\n                      surj_to (compos L g f) (carrier L) (carrier N)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N\n 2. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> surj_to (compos L g f) (carrier L) (carrier N)", "apply (simp add:mHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; aGroup L; aGroup N; aGroup M;\n     f \\<in> aHom L M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier L.\n           f (a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m) = a \\<cdot>\\<^sub>s f m;\n     g \\<in> aHom M N;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           g (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N\n 2. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> surj_to (compos L g f) (carrier L) (carrier N)", "apply (rule aHom_compos[of L M N f g], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> surj_to (compos L g f) (carrier L) (carrier N)", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> carrier L \\<rightarrow> carrier N\n 2. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier L. compos L g f a = b", "apply (cut_tac Module.mHom_compos [of M R L N f g])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M; compos L g f \\<in> mHom R L N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> carrier L \\<rightarrow> carrier N\n 2. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> R module L\n 4. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> R module N\n 5. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R L M\n 6. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> g \\<in> mHom R M N\n 7. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier L. compos L g f a = b", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> R module M\n 2. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> R module L\n 3. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> R module N\n 4. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R L M\n 5. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> g \\<in> mHom R M N\n 6. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier L. compos L g f a = b", "apply (rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n     surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n     aGroup L; aGroup N; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier L. compos L g f a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n        aGroup L; aGroup N; aGroup M; b \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. compos L g f a = b", "apply (simp add: compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        surjec\\<^bsub>M,N\\<^esub> g; f \\<in> mHom R L M; g \\<in> mHom R M N;\n        aGroup L; aGroup N; aGroup M; b \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. g (f a) = b", "apply (simp add:surjec_def [of _ _ \"g\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        g \\<in> aHom M N \\<and> surj_to g (carrier M) (carrier N);\n        f \\<in> mHom R L M; g \\<in> mHom R M N; aGroup L; aGroup N;\n        aGroup M; b \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. g (f a) = b", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        f \\<in> mHom R L M; g \\<in> mHom R M N; aGroup L; aGroup N;\n        aGroup M; b \\<in> carrier N; g \\<in> aHom M N;\n        surj_to g (carrier M) (carrier N)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. g (f a) = b", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        f \\<in> mHom R L M; g \\<in> mHom R M N; aGroup L; aGroup N;\n        aGroup M; b \\<in> carrier N; g \\<in> aHom M N;\n        g ` carrier M = carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. g (f a) = b", "apply (frule sym, thin_tac \"g ` carrier M = carrier N\", simp add:image_def,\n        thin_tac \"carrier N = {y. \\<exists>x\\<in>carrier M. y = g x}\",\n        erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>R module L; R module N; surjec\\<^bsub>L,M\\<^esub> f;\n        f \\<in> mHom R L M; g \\<in> mHom R M N; aGroup L; aGroup N;\n        aGroup M; g \\<in> aHom M N; x \\<in> carrier M; b = g x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. g (f a) = g x", "apply (simp add:surjec_def [of _ _ \"f\"], erule conjE, simp add:surj_to_def,\n         rotate_tac -1, frule sym, thin_tac \"f ` carrier L = carrier M\",\n          simp add:image_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x xa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        g \\<in> mHom R M N; aGroup L; aGroup N; aGroup M; g \\<in> aHom M N;\n        b = g (f xa); f \\<in> aHom L M;\n        carrier M = {y. \\<exists>x\\<in>carrier L. y = f x};\n        xa \\<in> carrier L; x = f xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier L. g (f a) = g (f xa)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mId_mHom:\"mId\\<^bsub>M\\<^esub> \\<in> mHom R M M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> aHom M M \\<and>\n    (\\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> aHom M M\n 2. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> carrier M \\<rightarrow> carrier M \\<and>\n    mId\\<^bsub>M\\<^esub>  \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           (mId\\<^bsub>M\\<^esub> ) (a \\<plusminus> b) =\n           (mId\\<^bsub>M\\<^esub> ) a \\<plusminus> (mId\\<^bsub>M\\<^esub> ) b)\n 2. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> carrier M \\<rightarrow> carrier M\n 2. mId\\<^bsub>M\\<^esub>  \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           (mId\\<^bsub>M\\<^esub> ) (a \\<plusminus> b) =\n           (mId\\<^bsub>M\\<^esub> ) a \\<plusminus> (mId\\<^bsub>M\\<^esub> ) b)\n 3. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (simp add:mId_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           (mId\\<^bsub>M\\<^esub> ) (a \\<plusminus> b) =\n           (mId\\<^bsub>M\\<^esub> ) a \\<plusminus> (mId\\<^bsub>M\\<^esub> ) b)\n 2. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (simp add:mId_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>a\\<in>carrier M.\n       \\<forall>b\\<in>carrier M.\n          a \\<plusminus> b \\<notin> carrier M \\<longrightarrow>\n          undefined = a \\<plusminus> b\n 2. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>a \\<in> carrier M; b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b\n                         \\<notin> carrier M \\<longrightarrow>\n                         undefined = a \\<plusminus> b\n 2. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (mId\\<^bsub>M\\<^esub> ) (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s (mId\\<^bsub>M\\<^esub> ) m", "apply (simp add:mId_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m\n                         \\<notin> carrier M \\<longrightarrow>\n                         undefined = a \\<cdot>\\<^sub>s m", "apply (simp add:sc_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_mId_bijec:\"\\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n      compose (carrier M) g f = mId\\<^bsub>M\\<^esub>; compose (carrier N) f g = mId\\<^bsub>N\\<^esub>\\<rbrakk> \\<Longrightarrow>\n      bijec\\<^bsub>M,N\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>M,N\\<^esub> f", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M,N\\<^esub> f \\<and>\n                      surjec\\<^bsub>M,N\\<^esub> f", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M N \\<and>\n                      ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f = {\\<zero>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>} =\n                      {\\<zero>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> {\\<zero>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {\\<zero>}\n                      \\<subseteq> {a \\<in> carrier M.\n                                   f a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (rule subsetI, simp, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n        compose (carrier N) f g = mId\\<^bsub>N\\<^esub> ; x \\<in> carrier M;\n        f x = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {\\<zero>}\n                      \\<subseteq> {a \\<in> carrier M.\n                                   f a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (frule_tac x = \"f x\" and y = \"\\<zero>\\<^bsub>N\\<^esub>\" and f = g in eq_elems_eq_val)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n        compose (carrier N) f g = mId\\<^bsub>N\\<^esub> ; x \\<in> carrier M;\n        f x = \\<zero>\\<^bsub>N\\<^esub>;\n        g (f x) = g \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {\\<zero>}\n                      \\<subseteq> {a \\<in> carrier M.\n                                   f a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (frule_tac f = \"compose (carrier M) g f\" and g = \"mId\\<^bsub>M\\<^esub>\" and x = x in\n        eq_fun_eq_val, thin_tac \"compose (carrier M) g f = mId\\<^bsub>M\\<^esub>\", \n        simp add:compose_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        (\\<lambda>x\\<in>carrier N. f (g x)) = mId\\<^bsub>N\\<^esub> ;\n        x \\<in> carrier M; f x = \\<zero>\\<^bsub>N\\<^esub>;\n        g \\<zero>\\<^bsub>N\\<^esub> = (mId\\<^bsub>M\\<^esub> ) x\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {\\<zero>}\n                      \\<subseteq> {a \\<in> carrier M.\n                                   f a = \\<zero>\\<^bsub>N\\<^esub>}\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (cut_tac Module.mHom_0[of N R M g], simp add:mId_def, assumption,\n   rule Module_axioms, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> {\\<zero>}\n                      \\<subseteq> {a \\<in> carrier M.\n                                   f a = \\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (rule subsetI, simp,\n       simp add:ag_inc_zero, simp add:mHom_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,N\\<^esub> f", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M N \\<and>\n                      surj_to f (carrier M) (carrier N)", "apply (rule conjI, simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> surj_to f (carrier M) (carrier N)", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier M \\<rightarrow> carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier M. f a = b", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n     compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n     compose (carrier N) f g = mId\\<^bsub>N\\<^esub> \\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier M. f a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        compose (carrier M) g f = mId\\<^bsub>M\\<^esub> ;\n        compose (carrier N) f g = mId\\<^bsub>N\\<^esub> ;\n        b \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. f a = b", "apply (frule_tac f = \"compose (carrier N) f g\" and g = \"mId\\<^bsub>N\\<^esub>\" and x = b in\n        eq_fun_eq_val, thin_tac \"compose (carrier M) g f = mId\\<^bsub>M\\<^esub>\",\n        thin_tac \"compose (carrier N) f g = mId\\<^bsub>N\\<^esub>\", \n        simp add:compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        b \\<in> carrier N; f (g b) = (mId\\<^bsub>N\\<^esub> ) b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. f a = b", "apply (simp add:mId_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        b \\<in> carrier N; f (g b) = b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. f a = b", "apply (frule_tac m = b in Module.mHom_mem [of N R M g], rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; g \\<in> mHom R N M;\n        b \\<in> carrier N; f (g b) = b; g b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. f a = b", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  sup_sharp :: \"[('r, 'n) Ring_scheme, ('b, 'r, 'm1) Module_scheme, \n    ('c, 'r, 'm2) Module_scheme, ('a, 'r, 'm) Module_scheme, 'b \\<Rightarrow> 'c] \n     \\<Rightarrow> ('c \\<Rightarrow> 'a) \\<Rightarrow> ('b \\<Rightarrow> 'a)\" where\n  \"sup_sharp R M N L u = (\\<lambda>f\\<in>mHom R N L. compos M f u)\""], ["", "definition\n  sub_sharp :: \"[('r, 'n) Ring_scheme, ('a, 'r, 'm) Module_scheme, \n    ('b, 'r, 'm1) Module_scheme, ('c, 'r, 'm2) Module_scheme, 'b \\<Rightarrow> 'c] \n     \\<Rightarrow> ('a \\<Rightarrow> 'b) \\<Rightarrow> ('a \\<Rightarrow> 'c)\" where\n  \"sub_sharp R L M N u = (\\<lambda>f\\<in>mHom R L M. compos L u f)\""], ["", "(*  L\n          f| u\n           M \\<rightarrow> N,  f \\<rightarrow> u o f   *)"], ["", "lemma (in Module) sup_sharp_homTr:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N; \n      f \\<in> mHom R N L \\<rbrakk> \\<Longrightarrow> sup_sharp R M N L u f \\<in> mHom R M L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n     f \\<in> mHom R N L\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u f \\<in> mHom R M L", "apply (simp add:sup_sharp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n     f \\<in> mHom R N L\\<rbrakk>\n    \\<Longrightarrow> compos M f u \\<in> mHom R M L", "apply (rule Module.mHom_compos, assumption, rule Module_axioms, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sup_sharp_hom:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> \n           sup_sharp R M N L u \\<in> mHom R (HOM\\<^bsub>R\\<^esub> N L) (HOM\\<^bsub>R\\<^esub> M L)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> mHom R (HOM\\<^bsub>R\\<^esub> N L)\n                             (HOM\\<^bsub>R\\<^esub> M L)", "apply (simp add:mHom_def [of \"R\" \"HOM\\<^bsub>R\\<^esub> N L\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> aHom (HOM\\<^bsub>R\\<^esub> N L)\n                             (HOM\\<^bsub>R\\<^esub> M L) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                             sup_sharp R M N L u\n                              (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                             sup_sharp R M N L u m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> aHom (HOM\\<^bsub>R\\<^esub> N L)\n                             (HOM\\<^bsub>R\\<^esub> M L)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> carrier (HOM\\<^bsub>R\\<^esub> N L) \\<rightarrow>\n                            carrier (HOM\\<^bsub>R\\<^esub> M L) \\<and>\n                      sup_sharp R M N L u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> N L)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                             sup_sharp R M N L u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                               b) =\n                             sup_sharp R M N L u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                             sup_sharp R M N L u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> carrier (HOM\\<^bsub>R\\<^esub> N L) \\<rightarrow>\n                            carrier (HOM\\<^bsub>R\\<^esub> M L)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> N L)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                             sup_sharp R M N L u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                               b) =\n                             sup_sharp R M N L u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                             sup_sharp R M N L u b)\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (simp add:HOM_def sup_sharp_homTr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> N L)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                             sup_sharp R M N L u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                               b) =\n                             sup_sharp R M N L u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                             sup_sharp R M N L u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sup_sharp R M N L u\n                      \\<in> extensional (carrier (HOM\\<^bsub>R\\<^esub> N L))\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                         \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              b) =\n                            sup_sharp R M N L u\n                             a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u b\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (simp add:sup_sharp_def extensional_def,\n        rule allI, rule impI, simp add:HOM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                         \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              b) =\n                            sup_sharp R M N L u\n                             a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u b\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> N L);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> N L)\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u\n                          (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                           b) =\n                         sup_sharp R M N L u\n                          a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                         sup_sharp R M N L u b\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (frule_tac f = a and g = b in Module.tOp_mHom_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (subgoal_tac \"R module M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (frule_tac f = a in Module.sup_sharp_homTr [of M R N L u], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (frule_tac f = b in Module.sup_sharp_homTr [of M R N L u], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L;\n        sup_sharp R M N L u b \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (frule_tac f = \"tOp_mHom R N L a b\" in \n                            Module.sup_sharp_homTr[of M R N L u], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L;\n        sup_sharp R M N L u b \\<in> mHom R M L;\n        sup_sharp R M N L u (tOp_mHom R N L a b) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule Module.mHom_eq, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L;\n        sup_sharp R M N L u b \\<in> mHom R M L;\n        sup_sharp R M N L u (tOp_mHom R N L a b) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b)\n                         \\<in> mHom R M L\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L;\n        sup_sharp R M N L u b \\<in> mHom R M L;\n        sup_sharp R M N L u (tOp_mHom R N L a b) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                            sup_sharp R M N L u (tOp_mHom R N L a b) m =\n                            tOp_mHom R M L (sup_sharp R M N L u a)\n                             (sup_sharp R M N L u b) m\n 3. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 4. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule Module.tOp_mHom_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L;\n        sup_sharp R M N L u b \\<in> mHom R M L;\n        sup_sharp R M N L u (tOp_mHom R N L a b) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                            sup_sharp R M N L u (tOp_mHom R N L a b) m =\n                            tOp_mHom R M L (sup_sharp R M N L u a)\n                             (sup_sharp R M N L u b) m\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u a \\<in> mHom R M L;\n        sup_sharp R M N L u b \\<in> mHom R M L;\n        sup_sharp R M N L u (tOp_mHom R N L a b) \\<in> mHom R M L;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (tOp_mHom R N L a b) m =\n                         tOp_mHom R M L (sup_sharp R M N L u a)\n                          (sup_sharp R M N L u b) m\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (simp add:sup_sharp_def tOp_mHom_def compose_def compos_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        (\\<lambda>x\\<in>carrier N. a x \\<plusminus>\\<^bsub>L\\<^esub> b x)\n        \\<in> mHom R N L;\n        R module M; (\\<lambda>x\\<in>carrier M. a (u x)) \\<in> mHom R M L;\n        (\\<lambda>x\\<in>carrier M. b (u x)) \\<in> mHom R M L;\n        (\\<lambda>x\\<in>carrier M.\n            if u x \\<in> carrier N\n            then a (u x) \\<plusminus>\\<^bsub>L\\<^esub> b (u x)\n            else undefined)\n        \\<in> mHom R M L;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> u m \\<notin> carrier N \\<longrightarrow>\n                         undefined =\n                         a (u m) \\<plusminus>\\<^bsub>L\\<^esub> b (u m)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R N L; b \\<in> mHom R N L;\n        tOp_mHom R N L a b \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (simp add:mHom_mem, rule Module_axioms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> N L).\n                            sup_sharp R M N L u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                            sup_sharp R M N L u m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> N L)\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u\n                          (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> N L\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> M L\\<^esub>\n                         sup_sharp R M N L u m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (sprod_mHom R N L a m) =\n                         sprod_mHom R M L a (sup_sharp R M N L u m)", "apply (frule_tac a = a and f = m in Module.sprod_mHom_closed [of N R L],\n                                                                assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (sprod_mHom R N L a m) =\n                         sprod_mHom R M L a (sup_sharp R M N L u m)", "apply (subgoal_tac \"R module M\",\n        frule_tac f = \"sprod_mHom R N L a m\" in \n                 Module.sup_sharp_homTr [of M R N L u], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u (sprod_mHom R N L a m) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (sprod_mHom R N L a m) =\n                         sprod_mHom R M L a (sup_sharp R M N L u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac f = m in Module.sup_sharp_homTr [of M R N L u], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u (sprod_mHom R N L a m) \\<in> mHom R M L;\n        sup_sharp R M N L u m \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (sprod_mHom R N L a m) =\n                         sprod_mHom R M L a (sup_sharp R M N L u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac a = a and f = \"sup_sharp R M N L u m\" in \n           Module.sprod_mHom_closed [of M R L], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u (sprod_mHom R N L a m) \\<in> mHom R M L;\n        sup_sharp R M N L u m \\<in> mHom R M L;\n        sprod_mHom R M L a (sup_sharp R M N L u m) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (sprod_mHom R N L a m) =\n                         sprod_mHom R M L a (sup_sharp R M N L u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (rule mHom_eq, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u (sprod_mHom R N L a m) \\<in> mHom R M L;\n        sup_sharp R M N L u m \\<in> mHom R M L;\n        sprod_mHom R M L a (sup_sharp R M N L u m) \\<in> mHom R M L\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ma\\<in>carrier M.\n                            sup_sharp R M N L u (sprod_mHom R N L a m) ma =\n                            sprod_mHom R M L a (sup_sharp R M N L u m) ma\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m ma.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L; R module M;\n        sup_sharp R M N L u (sprod_mHom R N L a m) \\<in> mHom R M L;\n        sup_sharp R M N L u m \\<in> mHom R M L;\n        sprod_mHom R M L a (sup_sharp R M N L u m) \\<in> mHom R M L;\n        ma \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> sup_sharp R M N L u (sprod_mHom R N L a m) ma =\n                         sprod_mHom R M L a (sup_sharp R M N L u m) ma\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (simp add:sprod_mHom_def sup_sharp_def compose_def compos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m ma.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        (\\<lambda>x\\<in>carrier N. a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m x)\n        \\<in> mHom R N L;\n        R module M;\n        (\\<lambda>x\\<in>carrier M.\n            if u x \\<in> carrier N\n            then a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m (u x) else undefined)\n        \\<in> mHom R M L;\n        (\\<lambda>x\\<in>carrier M. m (u x)) \\<in> mHom R M L;\n        (\\<lambda>x\\<in>carrier M.\n            a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub>\n            (if x \\<in> carrier M then m (u x) else undefined))\n        \\<in> mHom R M L;\n        ma \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> u ma \\<notin> carrier N \\<longrightarrow>\n                         undefined =\n                         a \\<cdot>\\<^sub>s\\<^bsub>L\\<^esub> m (u ma)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R N L;\n        sprod_mHom R N L a m \\<in> mHom R N L\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (simp add:Module.mHom_mem, rule Module_axioms)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sub_sharp_homTr:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N; \n       f \\<in> mHom R L M\\<rbrakk> \\<Longrightarrow> sub_sharp R L M N u f \\<in> mHom R L N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n     f \\<in> mHom R L M\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u f \\<in> mHom R L N", "apply (simp add:sub_sharp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n     f \\<in> mHom R L M\\<rbrakk>\n    \\<Longrightarrow> compos L u f \\<in> mHom R L N", "apply (simp add:mHom_compos)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sub_sharp_hom:\"\\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> \n          sub_sharp R L M N u \\<in> mHom R (HOM\\<^bsub>R\\<^esub> L M) (HOM\\<^bsub>R\\<^esub> L N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> mHom R (HOM\\<^bsub>R\\<^esub> L M)\n                             (HOM\\<^bsub>R\\<^esub> L N)", "apply (simp add:mHom_def [of _ \"HOM\\<^bsub>R\\<^esub> L M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> aHom (HOM\\<^bsub>R\\<^esub> L M)\n                             (HOM\\<^bsub>R\\<^esub> L N) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                             sub_sharp R L M N u\n                              (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                             sub_sharp R L M N u m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> aHom (HOM\\<^bsub>R\\<^esub> L M)\n                             (HOM\\<^bsub>R\\<^esub> L N)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> carrier (HOM\\<^bsub>R\\<^esub> L M) \\<rightarrow>\n                            carrier (HOM\\<^bsub>R\\<^esub> L N) \\<and>\n                      sub_sharp R L M N u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> L M)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                             sub_sharp R L M N u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                               b) =\n                             sub_sharp R L M N u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                             sub_sharp R L M N u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> carrier (HOM\\<^bsub>R\\<^esub> L M) \\<rightarrow>\n                            carrier (HOM\\<^bsub>R\\<^esub> L N)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> L M)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                             sub_sharp R L M N u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                               b) =\n                             sub_sharp R L M N u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                             sub_sharp R L M N u b)\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> mHom R L M \\<rightarrow> mHom R L N\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> L M)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                             sub_sharp R L M N u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                               b) =\n                             sub_sharp R L M N u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                             sub_sharp R L M N u b)\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:sub_sharp_homTr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> extensional\n                             (carrier (HOM\\<^bsub>R\\<^esub> L M)) \\<and>\n                      (\\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                          \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                             sub_sharp R L M N u\n                              (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                               b) =\n                             sub_sharp R L M N u\n                              a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                             sub_sharp R L M N u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> sub_sharp R L M N u\n                      \\<in> extensional (carrier (HOM\\<^bsub>R\\<^esub> L M))\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                         \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              b) =\n                            sub_sharp R L M N u\n                             a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u b\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:sub_sharp_def extensional_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> mHom R L M \\<longrightarrow>\n                         x \\<notin> carrier\n                                     (HOM\\<^bsub>R\\<^esub> L\n   M) \\<longrightarrow>\n                         compos L u x = undefined\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                         \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              b) =\n                            sub_sharp R L M N u\n                             a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u b\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                         \\<forall>b\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              b) =\n                            sub_sharp R L M N u\n                             a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u b\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier (HOM\\<^bsub>R\\<^esub> L M);\n        b \\<in> carrier (HOM\\<^bsub>R\\<^esub> L M)\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u\n                          (a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                           b) =\n                         sub_sharp R L M N u\n                          a \\<plusminus>\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                         sub_sharp R L M N u b\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (frule_tac f = a and g = b in Module.tOp_mHom_closed [of L R M],\n   rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b)\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (subgoal_tac \"R module M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M; R module M\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (frule_tac f = \"tOp_mHom R L M a b\" in Module.sub_sharp_homTr \n                                 [of M R N L u], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M; R module M;\n        sub_sharp R L M N u (tOp_mHom R L M a b) \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (frule_tac f = b in Module.sub_sharp_homTr[of M R N L u],\n                                                  assumption+,\n        frule_tac f = a in Module.sub_sharp_homTr[of M R N L u], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M; R module M;\n        sub_sharp R L M N u (tOp_mHom R L M a b) \\<in> mHom R L N;\n        sub_sharp R L M N u b \\<in> mHom R L N;\n        sub_sharp R L M N u a \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (frule_tac f = \"sub_sharp R L M N u a\" and \n  g = \"sub_sharp R L M N u b\" in Module.tOp_mHom_closed [of L R N],assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M; R module M;\n        sub_sharp R L M N u (tOp_mHom R L M a b) \\<in> mHom R L N;\n        sub_sharp R L M N u b \\<in> mHom R L N;\n        sub_sharp R L M N u a \\<in> mHom R L N;\n        tOp_mHom R L N (sub_sharp R L M N u a) (sub_sharp R L M N u b)\n        \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule Module.mHom_eq, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M; R module M;\n        sub_sharp R L M N u (tOp_mHom R L M a b) \\<in> mHom R L N;\n        sub_sharp R L M N u b \\<in> mHom R L N;\n        sub_sharp R L M N u a \\<in> mHom R L N;\n        tOp_mHom R L N (sub_sharp R L M N u a) (sub_sharp R L M N u b)\n        \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>m\\<in>carrier L.\n                            sub_sharp R L M N u (tOp_mHom R L M a b) m =\n                            tOp_mHom R L N (sub_sharp R L M N u a)\n                             (sub_sharp R L M N u b) m\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M; R module M;\n        sub_sharp R L M N u (tOp_mHom R L M a b) \\<in> mHom R L N;\n        sub_sharp R L M N u b \\<in> mHom R L N;\n        sub_sharp R L M N u a \\<in> mHom R L N;\n        tOp_mHom R L N (sub_sharp R L M N u a) (sub_sharp R L M N u b)\n        \\<in> mHom R L N;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (tOp_mHom R L M a b) m =\n                         tOp_mHom R L N (sub_sharp R L M N u a)\n                          (sub_sharp R L M N u b) m\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:tOp_mHom_def sub_sharp_def mcompose_def compose_def,\n        simp add:compos_def compose_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        (\\<lambda>x\\<in>carrier L. a x \\<plusminus> b x) \\<in> mHom R L M;\n        R module M;\n        (\\<lambda>x\\<in>carrier L.\n            u (if x \\<in> carrier L then a x \\<plusminus> b x\n               else undefined))\n        \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (b x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (a x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L.\n            (if x \\<in> carrier L then u (a x)\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier L then u (b x) else undefined))\n        \\<in> mHom R L N;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> u (a m \\<plusminus> b m) =\n                         u (a m) \\<plusminus>\\<^bsub>N\\<^esub> u (b m)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 3. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule Module.mHom_add [of M R], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        (\\<lambda>x\\<in>carrier L. a x \\<plusminus> b x) \\<in> mHom R L M;\n        R module M;\n        (\\<lambda>x\\<in>carrier L.\n            u (if x \\<in> carrier L then a x \\<plusminus> b x\n               else undefined))\n        \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (b x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (a x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L.\n            (if x \\<in> carrier L then u (a x)\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier L then u (b x) else undefined))\n        \\<in> mHom R L N;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> a m \\<in> carrier M\n 2. \\<And>a b m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        (\\<lambda>x\\<in>carrier L. a x \\<plusminus> b x) \\<in> mHom R L M;\n        R module M;\n        (\\<lambda>x\\<in>carrier L.\n            u (if x \\<in> carrier L then a x \\<plusminus> b x\n               else undefined))\n        \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (b x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (a x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L.\n            (if x \\<in> carrier L then u (a x)\n             else undefined) \\<plusminus>\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier L then u (b x) else undefined))\n        \\<in> mHom R L N;\n        m \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> b m \\<in> carrier M\n 3. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 4. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (simp add:Module.mHom_mem, simp add:Module.mHom_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> mHom R L M; b \\<in> mHom R L M;\n        tOp_mHom R L M a b \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M\n 2. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule Module_axioms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; R module L; u \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (HOM\\<^bsub>R\\<^esub> L M).\n                            sub_sharp R L M N u\n                             (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                            sub_sharp R L M N u m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R;\n        m \\<in> carrier (HOM\\<^bsub>R\\<^esub> L M)\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u\n                          (a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L M\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>HOM\\<^bsub>R\\<^esub> L N\\<^esub>\n                         sub_sharp R L M N u m", "apply (simp add:HOM_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) =\n                         sprod_mHom R L N a (sub_sharp R L M N u m)", "apply (subgoal_tac \"R module M\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) =\n                         sprod_mHom R L N a (sub_sharp R L M N u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac a = a and f = m in Module.sprod_mHom_closed [of L R M],\n                                          assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        sprod_mHom R L M a m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) =\n                         sprod_mHom R L N a (sub_sharp R L M N u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac f = \"sprod_mHom R L M a m\" in Module.sub_sharp_homTr \n                                 [of M R N L u], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        sprod_mHom R L M a m \\<in> mHom R L M;\n        sub_sharp R L M N u (sprod_mHom R L M a m) \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) =\n                         sprod_mHom R L N a (sub_sharp R L M N u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac f = m in Module.sub_sharp_homTr \n                                 [of M R N L u], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        sprod_mHom R L M a m \\<in> mHom R L M;\n        sub_sharp R L M N u (sprod_mHom R L M a m) \\<in> mHom R L N;\n        sub_sharp R L M N u m \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) =\n                         sprod_mHom R L N a (sub_sharp R L M N u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac a = a and f = \"sub_sharp R L M N u m\" in \n                       Module.sprod_mHom_closed [of L R N], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        sprod_mHom R L M a m \\<in> mHom R L M;\n        sub_sharp R L M N u (sprod_mHom R L M a m) \\<in> mHom R L N;\n        sub_sharp R L M N u m \\<in> mHom R L N;\n        sprod_mHom R L N a (sub_sharp R L M N u m) \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) =\n                         sprod_mHom R L N a (sub_sharp R L M N u m)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (rule Module.mHom_eq, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        sprod_mHom R L M a m \\<in> mHom R L M;\n        sub_sharp R L M N u (sprod_mHom R L M a m) \\<in> mHom R L N;\n        sub_sharp R L M N u m \\<in> mHom R L N;\n        sprod_mHom R L N a (sub_sharp R L M N u m) \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ma\\<in>carrier L.\n                            sub_sharp R L M N u (sprod_mHom R L M a m) ma =\n                            sprod_mHom R L N a (sub_sharp R L M N u m) ma\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m ma.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        sprod_mHom R L M a m \\<in> mHom R L M;\n        sub_sharp R L M N u (sprod_mHom R L M a m) \\<in> mHom R L N;\n        sub_sharp R L M N u m \\<in> mHom R L N;\n        sprod_mHom R L N a (sub_sharp R L M N u m) \\<in> mHom R L N;\n        ma \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> sub_sharp R L M N u (sprod_mHom R L M a m) ma =\n                         sprod_mHom R L N a (sub_sharp R L M N u m) ma\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (simp add:sprod_mHom_def sub_sharp_def mcompose_def compose_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m ma.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x) \\<in> mHom R L M;\n        compos L u (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x)\n        \\<in> mHom R L N;\n        compos L u m \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L.\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> compos L u m x)\n        \\<in> mHom R L N;\n        ma \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> compos L u\n                          (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x)\n                          ma =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> compos L u m ma\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (frule_tac  f = m and m = ma in Module.mHom_mem [of L R M], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m ma.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x) \\<in> mHom R L M;\n        compos L u (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x)\n        \\<in> mHom R L N;\n        compos L u m \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L.\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> compos L u m x)\n        \\<in> mHom R L N;\n        ma \\<in> carrier L; m ma \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> compos L u\n                          (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x)\n                          ma =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> compos L u m ma\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m ma.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M; R module M;\n        (\\<lambda>x\\<in>carrier L. a \\<cdot>\\<^sub>s m x) \\<in> mHom R L M;\n        (\\<lambda>x\\<in>carrier L.\n            u (if x \\<in> carrier L then a \\<cdot>\\<^sub>s m x\n               else undefined))\n        \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L. u (m x)) \\<in> mHom R L N;\n        (\\<lambda>x\\<in>carrier L.\n            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n            (if x \\<in> carrier L then u (m x) else undefined))\n        \\<in> mHom R L N;\n        ma \\<in> carrier L; m ma \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> u (a \\<cdot>\\<^sub>s m ma) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> u (m ma)\n 2. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (simp add:mHom_lin)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; R module L; u \\<in> mHom R M N;\n        a \\<in> carrier R; m \\<in> mHom R L M\\<rbrakk>\n       \\<Longrightarrow> R module M", "apply (rule Module_axioms)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mId_bijec:\"bijec\\<^bsub>M,M\\<^esub> (mId\\<^bsub>M\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bijec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. injec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>  \\<and>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (cut_tac mId_mHom)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    injec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>  \\<and>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    injec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub> \n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    mId\\<^bsub>M\\<^esub>  \\<in> aHom M M \\<and>\n    ker\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>  = {\\<zero>}\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    mId\\<^bsub>M\\<^esub>  \\<in> aHom M M\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    ker\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>  = {\\<zero>}\n 3. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    ker\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>  = {\\<zero>}\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    {a \\<in> carrier M. (mId\\<^bsub>M\\<^esub> ) a = \\<zero>} = {\\<zero>}\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (simp add:mId_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>m\\<in>carrier M. m) \\<in> mHom R M M \\<Longrightarrow>\n    {a. (a \\<in> carrier M \\<longrightarrow> a = \\<zero>) \\<and>\n        a \\<in> carrier M} =\n    {\\<zero>}\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>m\\<in>carrier M. m) \\<in> mHom R M M \\<Longrightarrow>\n    {a. (a \\<in> carrier M \\<longrightarrow> a = \\<zero>) \\<and>\n        a \\<in> carrier M}\n    \\<subseteq> {\\<zero>}\n 2. (\\<lambda>m\\<in>carrier M. m) \\<in> mHom R M M \\<Longrightarrow>\n    {\\<zero>}\n    \\<subseteq> {a. (a \\<in> carrier M \\<longrightarrow> a = \\<zero>) \\<and>\n                    a \\<in> carrier M}\n 3. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>m\\<in>carrier M. m) \\<in> mHom R M M \\<Longrightarrow>\n    {\\<zero>}\n    \\<subseteq> {a. (a \\<in> carrier M \\<longrightarrow> a = \\<zero>) \\<and>\n                    a \\<in> carrier M}\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (rule subsetI, simp, simp add:ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surjec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    mId\\<^bsub>M\\<^esub>  \\<in> aHom M M \\<and>\n    surj_to (mId\\<^bsub>M\\<^esub> ) (carrier M) (carrier M)", "apply (rule conjI, simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    surj_to (mId\\<^bsub>M\\<^esub> ) (carrier M) (carrier M)", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    mId\\<^bsub>M\\<^esub>  \\<in> carrier M \\<rightarrow> carrier M\n 2. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    \\<forall>b\\<in>carrier M.\n       \\<exists>a\\<in>carrier M. (mId\\<^bsub>M\\<^esub> ) a = b", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M \\<Longrightarrow>\n    \\<forall>b\\<in>carrier M.\n       \\<exists>a\\<in>carrier M. (mId\\<^bsub>M\\<^esub> ) a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M;\n        b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                            (mId\\<^bsub>M\\<^esub> ) a = b", "apply (simp add:mId_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) invmfun_bijec:\"\\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n                  bijec\\<^bsub>N,M\\<^esub> (invmfun R M N f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     bijec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (frule invmfun_mHom [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:bijec_def [of N M])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>N,M\\<^esub> invmfun R M N f \\<and>\n                      surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>N,M\\<^esub> invmfun R M N f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> aHom N M \\<and>\n                      ker\\<^bsub>N,M\\<^esub> invmfun R M N f =\n                      {\\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:mHom_def [of \"R\" \"N\" \"M\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M \\<and>\n     (\\<forall>a\\<in>carrier R.\n         \\<forall>m\\<in>carrier N.\n            invmfun R M N f (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n            a \\<cdot>\\<^sub>s invmfun R M N f m)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>N,M\\<^esub> invmfun R M N f =\n                      {\\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M;\n     \\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier N.\n           invmfun R M N f (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) =\n           a \\<cdot>\\<^sub>s invmfun R M N f m\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>N,M\\<^esub> invmfun R M N f =\n                      {\\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (thin_tac \"\\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier N. invmfun R M N f (a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> m) = a \\<cdot>\\<^sub>s invmfun R M N f m\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>N,M\\<^esub> invmfun R M N f =\n                      {\\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n                      \\<subseteq> {\\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M;\n        x \\<in> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {\\<zero>\\<^bsub>N\\<^esub>}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:ker_def CollectI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M;\n        x \\<in> carrier N \\<and> invmfun R M N f x = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M; x \\<in> carrier N;\n        invmfun R M N f x = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (frule_tac x = \"invmfun R M N f x\" and y = \"\\<zero>\" and f = f in \n       eq_elems_eq_val,\n       thin_tac \"invmfun R M N f x = \\<zero>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M; x \\<in> carrier N;\n        f (invmfun R M N f x) = f \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:invmfun_r_inv)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M; f \\<zero> \\<in> carrier N;\n        x = f \\<zero>\\<rbrakk>\n       \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:mHom_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> aHom N M\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M;\n        x = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub>\n                         \\<in> ker\\<^bsub>N,M\\<^esub> invmfun R M N f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M;\n        x = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N \\<and>\n                         invmfun R M N f \\<zero>\\<^bsub>N\\<^esub> = \\<zero>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:Module.module_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M;\n        x = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f \\<zero>\\<^bsub>N\\<^esub> = \\<zero>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (cut_tac ag_inc_zero,\n        frule invmfun_l_inv[of N f \\<zero>], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> aHom N M; x = \\<zero>\\<^bsub>N\\<^esub>;\n        \\<zero> \\<in> carrier M;\n        invmfun R M N f (f \\<zero>) = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f \\<zero>\\<^bsub>N\\<^esub> = \\<zero>\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:mHom_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>N,M\\<^esub> invmfun R M N f", "apply (simp add:surjec_def,\n       frule invmfun_mHom[of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f \\<in> aHom N M \\<and>\n                      surj_to (invmfun R M N f) (carrier N) (carrier M)", "apply (rule conjI, simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> surj_to (invmfun R M N f) (carrier N) (carrier M)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> invmfun R M N f ` carrier N = carrier M", "apply (rule equalityI, rule subsetI, simp add:image_def, erule bexE,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M; xa \\<in> carrier N;\n        x = invmfun R M N f xa\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f xa \\<in> carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> carrier M \\<subseteq> invmfun R M N f ` carrier N", "thm Module.mHom_mem[of N R M \"invmfun R M N f\"]"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M; xa \\<in> carrier N;\n        x = invmfun R M N f xa\\<rbrakk>\n       \\<Longrightarrow> invmfun R M N f xa \\<in> carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> carrier M \\<subseteq> invmfun R M N f ` carrier N", "apply (rule Module.mHom_mem[of N R M \"invmfun R M N f\"], assumption,\n   rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n     invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n    \\<Longrightarrow> carrier M \\<subseteq> invmfun R M N f ` carrier N", "apply (rule subsetI, simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M; x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier N. x = invmfun R M N f xa", "apply (frule_tac m = x in invmfun_l_inv[of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M; x \\<in> carrier M;\n        invmfun R M N f (f x) = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier N. x = invmfun R M N f xa", "apply (frule_tac m = x in mHom_mem[of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M; x \\<in> carrier M;\n        invmfun R M N f (f x) = x; f x \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier N. x = invmfun R M N f xa", "apply (frule sym, thin_tac \"invmfun R M N f (f x) = x\", blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) misom_self:\"M \\<cong>\\<^bsub>R\\<^esub> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M \\<cong>\\<^bsub>R\\<^esub> M", "apply (cut_tac mId_bijec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. bijec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub>  \\<Longrightarrow>\n    M \\<cong>\\<^bsub>R\\<^esub> M", "apply (cut_tac mId_mHom)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bijec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub> ;\n     mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M\\<rbrakk>\n    \\<Longrightarrow> M \\<cong>\\<^bsub>R\\<^esub> M", "apply (simp add:misomorphic_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bijec\\<^bsub>M,M\\<^esub> mId\\<^bsub>M\\<^esub> ;\n     mId\\<^bsub>M\\<^esub>  \\<in> mHom R M M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R M M \\<and>\n                         bijec\\<^bsub>M,M\\<^esub> f", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) misom_sym:\"\\<lbrakk>R module N; M \\<cong>\\<^bsub>R\\<^esub> N\\<rbrakk> \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; M \\<cong>\\<^bsub>R\\<^esub> N\\<rbrakk>\n    \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M", "apply (simp add:misomorphic_def [of \"R\" \"M\" \"N\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     \\<exists>f.\n        f \\<in> mHom R M N \\<and> bijec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M", "apply (frule_tac f = f in invmfun_mHom [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M\\<rbrakk>\n       \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M", "apply (frule_tac f = f in invmfun_bijec [of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M;\n        bijec\\<^bsub>N,M\\<^esub> invmfun R M N f\\<rbrakk>\n       \\<Longrightarrow> N \\<cong>\\<^bsub>R\\<^esub> M", "apply (simp add:misomorphic_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; bijec\\<^bsub>M,N\\<^esub> f;\n        invmfun R M N f \\<in> mHom R N M;\n        bijec\\<^bsub>N,M\\<^esub> invmfun R M N f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f.\n                            f \\<in> mHom R N M \\<and>\n                            bijec\\<^bsub>N,M\\<^esub> f", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) misom_trans:\"\\<lbrakk>R module L; R module N; L \\<cong>\\<^bsub>R\\<^esub> M; M \\<cong>\\<^bsub>R\\<^esub> N\\<rbrakk> \\<Longrightarrow> \n                               L \\<cong>\\<^bsub>R\\<^esub> N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N; L \\<cong>\\<^bsub>R\\<^esub> M;\n     M \\<cong>\\<^bsub>R\\<^esub> N\\<rbrakk>\n    \\<Longrightarrow> L \\<cong>\\<^bsub>R\\<^esub> N", "apply (simp add:misomorphic_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module L; R module N;\n     \\<exists>f. f \\<in> mHom R L M \\<and> bijec\\<^bsub>L,M\\<^esub> f;\n     \\<exists>f.\n        f \\<in> mHom R M N \\<and> bijec\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R L N \\<and>\n                         bijec\\<^bsub>L,N\\<^esub> f", "apply ((erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f.\n                            f \\<in> mHom R L N \\<and>\n                            bijec\\<^bsub>L,N\\<^esub> f", "apply (subgoal_tac  \"bijec\\<^bsub>L,N\\<^esub> (compos L fa f)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa;\n        bijec\\<^bsub>L,N\\<^esub> compos L fa f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f.\n                            f \\<in> mHom R L N \\<and>\n                            bijec\\<^bsub>L,N\\<^esub> f\n 2. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> bijec\\<^bsub>L,N\\<^esub> compos L fa f", "apply (subgoal_tac \"(compos L fa f) \\<in> mHom R L N\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa; bijec\\<^bsub>L,N\\<^esub> compos L fa f;\n        compos L fa f \\<in> mHom R L N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f.\n                            f \\<in> mHom R L N \\<and>\n                            bijec\\<^bsub>L,N\\<^esub> f\n 2. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa;\n        bijec\\<^bsub>L,N\\<^esub> compos L fa f\\<rbrakk>\n       \\<Longrightarrow> compos L fa f \\<in> mHom R L N\n 3. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> bijec\\<^bsub>L,N\\<^esub> compos L fa f", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa;\n        bijec\\<^bsub>L,N\\<^esub> compos L fa f\\<rbrakk>\n       \\<Longrightarrow> compos L fa f \\<in> mHom R L N\n 2. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> bijec\\<^bsub>L,N\\<^esub> compos L fa f", "apply (rule Module.mHom_compos[of M R L N], rule Module_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        bijec\\<^bsub>L,M\\<^esub> f; fa \\<in> mHom R M N;\n        bijec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> bijec\\<^bsub>L,N\\<^esub> compos L fa f", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        injec\\<^bsub>L,M\\<^esub> f \\<and> surjec\\<^bsub>L,M\\<^esub> f;\n        fa \\<in> mHom R M N;\n        injec\\<^bsub>M,N\\<^esub> fa \\<and>\n        surjec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> injec\\<^bsub>L,N\\<^esub> compos L fa f \\<and>\n                         surjec\\<^bsub>L,N\\<^esub> compos L fa f", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        fa \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        surjec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> fa;\n        surjec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> injec\\<^bsub>L,N\\<^esub> compos L fa f \\<and>\n                         surjec\\<^bsub>L,N\\<^esub> compos L fa f", "apply (simp add:mcompos_inj_inj)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f fa.\n       \\<lbrakk>R module L; R module N; f \\<in> mHom R L M;\n        fa \\<in> mHom R M N; injec\\<^bsub>L,M\\<^esub> f;\n        surjec\\<^bsub>L,M\\<^esub> f; injec\\<^bsub>M,N\\<^esub> fa;\n        surjec\\<^bsub>M,N\\<^esub> fa\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>L,N\\<^esub> compos L fa f", "apply (simp add:mcompos_surj_surj)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  mr_coset :: \"['a, ('a, 'b, 'more) Module_scheme, 'a set] \\<Rightarrow> 'a set\" where\n  \"mr_coset a M H = a \\<uplus>\\<^bsub>M\\<^esub> H\""], ["", "definition\n  set_mr_cos :: \"[('a, 'b, 'more) Module_scheme, 'a set] \\<Rightarrow> 'a set set\" where\n  \"set_mr_cos M H = {X. \\<exists>a\\<in>carrier M. X = a \\<uplus>\\<^bsub>M\\<^esub> H}\""], ["", "definition\n  mr_cos_sprod :: \"[('a, 'b, 'more) Module_scheme, 'a set] \\<Rightarrow> \n                                              'b \\<Rightarrow> 'a set \\<Rightarrow> 'a set\" where\n  \"mr_cos_sprod M H a X = {z. \\<exists>x\\<in>X. \\<exists>h\\<in>H. z = h \\<plusminus>\\<^bsub>M\\<^esub> (a \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> x)}\""], ["", "definition\n  mr_cospOp :: \"[('a, 'b, 'more) Module_scheme, 'a set] \\<Rightarrow> \n                                               'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set\" where\n  \"mr_cospOp M H = (\\<lambda>X. \\<lambda>Y. c_top (b_ag M) H X Y)\""], ["", "definition\n  mr_cosmOp :: \"[('a, 'b, 'more) Module_scheme, 'a set] \\<Rightarrow> \n                                                  'a set \\<Rightarrow> 'a set\" where\n  \"mr_cosmOp M H = (\\<lambda>X. c_iop (b_ag M) H X)\""], ["", "definition\n  qmodule :: \"[('a, 'r, 'more) Module_scheme, 'a set] \\<Rightarrow>\n                 ('a set, 'r) Module\" where\n  \"qmodule M H = \\<lparr> carrier = set_mr_cos M H, pop = mr_cospOp M H, \n    mop = mr_cosmOp M H, zero = H, sprod = mr_cos_sprod M H\\<rparr>\""], ["", "definition\n  sub_mr_set_cos :: \"[('a, 'r, 'more) Module_scheme, 'a set, 'a set] \\<Rightarrow>\n                            'a set set\" where\n \"sub_mr_set_cos M H N = {X. \\<exists>n\\<in>N. X = n \\<uplus>\\<^bsub>M\\<^esub> H}\""], ["", "(* N/H, where N is a submodule *)"], ["", "abbreviation\n  QMODULE  (infixl \"'/'\\<^sub>m\" 200) where\n  \"M /\\<^sub>m H == qmodule M H\""], ["", "abbreviation\n  SUBMRSET  (\"(3_/ \\<^sub>s'/'\\<^sub>_/ _)\" [82,82,83]82) where\n  \"N \\<^sub>s/\\<^sub>M H == sub_mr_set_cos M H N\""], ["", "lemma (in Module) qmodule_carr:\"submodule R M H \\<Longrightarrow>\n            carrier (qmodule M H) = set_mr_cos M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    carrier (M /\\<^sub>m H) = set_mr_cos M H", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) set_mr_cos_mem:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                         m \\<uplus>\\<^bsub>M\\<^esub> H =\n                         a \\<uplus>\\<^bsub>M\\<^esub> H", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mem_set_mr_cos:\"\\<lbrakk>submodule R M N; x \\<in> set_mr_cos M N\\<rbrakk> \\<Longrightarrow>\n                          \\<exists>m \\<in> carrier M. x = m  \\<uplus>\\<^bsub>M\\<^esub> N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M N; x \\<in> set_mr_cos M N\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m\\<in>carrier M.\n                         x = m \\<uplus>\\<^bsub>M\\<^esub> N", "by (simp add:set_mr_cos_def)"], ["", "lemma (in Module) m_in_mr_coset:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                                   m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; aGroup M\\<rbrakk>\n    \\<Longrightarrow> m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M \\<and>\n             M +> H \\<and>\n             (\\<forall>a m.\n                 a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n                 a \\<cdot>\\<^sub>s m \\<in> H);\n     m \\<in> carrier (b_ag M); aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M); aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M); aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier M; b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (rule Group.a_in_rcs [of \"b_ag M\" \"H\" \"m\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_h_stable:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                                                       H = h \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H = h \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> H = h \\<uplus>\\<^bsub>M\\<^esub> H", "apply (frule aGroup.b_ag_group [of \"M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H; aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H = h \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H; aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H = H \\<bullet>\\<^bsub>b_ag M\\<^esub> h", "apply (rule Group.rcs_Unit2[THEN sym], assumption+,\n        simp add:submodule_def, (erule conjE)+, \n        simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H; aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> h \\<in> H", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_h_stable1:\"\\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H\\<rbrakk>\n             \\<Longrightarrow> (m \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> H = m \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> (m \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H;\n     aGroup M\\<rbrakk>\n    \\<Longrightarrow> (m \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subst aGroup.ag_pOp_commute, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H;\n     aGroup M\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 2. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H;\n     aGroup M\\<rbrakk>\n    \\<Longrightarrow> (h \\<plusminus> m) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:submodule_def, (erule conjE)+, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H;\n     aGroup M\\<rbrakk>\n    \\<Longrightarrow> (h \\<plusminus> m) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (frule aGroup.b_ag_group [of \"M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> (h \\<plusminus> m) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> (h \\<plusminus> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:aGroup.agop_gop [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; h \\<in> H; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      (h \\<cdot>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier (b_ag M); h \\<in> H; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      (h \\<cdot>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:submodule_def, (erule conjE)+, simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M); h \\<in> H; aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier M; b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      (h \\<cdot>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> m", "apply (rule Group.rcs_fixed1 [THEN sym, of \"b_ag M\" \"H\" \"m\" \"h\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) x_in_mr_coset:\"\\<lbrakk>submodule R M H; m \\<in> carrier M; x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n                 \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; aGroup M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x", "apply (frule aGroup.b_ag_group [of \"M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x", "apply (simp add:submodule_def, (erule conjE)+,\n        simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier M; x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H;\n     aGroup M; Group (b_ag M); H \\<subseteq> carrier M;\n     b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M);\n     x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H. m \\<plusminus> h = x", "apply (simp add:aGroup.agop_gop [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M);\n     x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         m \\<cdot>\\<^bsub>b_ag M\\<^esub> h = x", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M);\n     x \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m; aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         m \\<cdot>\\<^bsub>b_ag M\\<^esub> h = x", "apply (frule Group.rcs_tool2[of \"b_ag M\" H m x], assumption+,\n        erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>m \\<in> carrier (b_ag M);\n        x \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m; aGroup M;\n        Group (b_ag M); H \\<subseteq> carrier (b_ag M);\n        b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        h \\<in> H; h \\<cdot>\\<^bsub>b_ag M\\<^esub> m = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            m \\<cdot>\\<^bsub>b_ag M\\<^esub> h = x", "apply (frule sym, thin_tac \"h \\<cdot>\\<^bsub>b_ag M\\<^esub> m = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>m \\<in> carrier (b_ag M);\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        aGroup M; Group (b_ag M); H \\<subseteq> carrier (b_ag M);\n        b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        h \\<in> H; x = h \\<cdot>\\<^bsub>b_ag M\\<^esub> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            m \\<cdot>\\<^bsub>b_ag M\\<^esub> ha =\n                            h \\<cdot>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:aGroup.agop_gop)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>m \\<in> carrier (b_ag M);\n        h \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        aGroup M; Group (b_ag M); H \\<subseteq> carrier (b_ag M);\n        b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        h \\<in> H; x = h \\<plusminus> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            m \\<plusminus> ha = h \\<plusminus> m", "apply (simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>m \\<in> carrier M;\n        h \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        aGroup M; Group (b_ag M); H \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        h \\<in> H; x = h \\<plusminus> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            m \\<plusminus> ha = h \\<plusminus> m", "apply (frule_tac c = h in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>m \\<in> carrier M;\n        h \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        aGroup M; Group (b_ag M); H \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        h \\<in> H; x = h \\<plusminus> m; h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            m \\<plusminus> ha = h \\<plusminus> m", "apply (subst ag_pOp_commute[of _ m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>m \\<in> carrier M;\n        h \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        aGroup M; Group (b_ag M); H \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        h \\<in> H; x = h \\<plusminus> m; h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            m \\<plusminus> ha = m \\<plusminus> h", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_sprodTr:\"\\<lbrakk>submodule R M H; a \\<in> carrier R; \n       m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> mr_cos_sprod M H a (m \\<uplus>\\<^bsub>M\\<^esub> H) = (a \\<cdot>\\<^sub>s m) \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H a (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac module_is_ag,\n       frule aGroup.b_ag_group,\n       frule sc_mem[of a m], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n     aGroup M; Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H a (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ar_coset_def,\n        simp add:mr_cos_sprod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n     aGroup M; Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n   m.\n                             \\<exists>h\\<in>H.\n                                z = h \\<plusminus> a \\<cdot>\\<^sub>s x} =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m", "apply (simp add:submodule_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; aGroup M; Group (b_ag M);\n     a \\<cdot>\\<^sub>s m \\<in> carrier M; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n   m.\n                             \\<exists>h\\<in>H.\n                                z = h \\<plusminus> a \\<cdot>\\<^sub>s x} =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym],\n        simp add:aGroup.agop_gop [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n   m.\n                             \\<exists>h\\<in>H.\n                                z =\n                                h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                                a \\<cdot>\\<^sub>s x} =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n   m.\n                             \\<exists>h\\<in>H.\n                                z =\n                                h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                                a \\<cdot>\\<^sub>s x} =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n   m.\n                             \\<exists>h\\<in>H.\n                                z =\n                                h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                                a \\<cdot>\\<^sub>s x}\n                      \\<subseteq> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                                  a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        \\<exists>xa\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n           \\<exists>h\\<in>H.\n              x =\n              h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                                 a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (erule bexE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        xa \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m; h \\<in> H;\n        x = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                                 a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (frule_tac x = xa in Group.rcs_tool2[of \"b_ag M\" H m], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        xa \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m; h \\<in> H;\n        x = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s xa;\n        \\<exists>h\\<in>H. h \\<cdot>\\<^bsub>b_ag M\\<^esub> m = xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                                 a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (erule bexE, rotate_tac -1, frule sym, thin_tac \"ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m = xa\",\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n        a \\<cdot>\\<^sub>s (ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m);\n        ha \\<in> H; xa = ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s\n                         (ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m)\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (simp add:aGroup.agop_gop, simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier M;\n        H \\<subseteq> carrier M; b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        ha \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H; x = h \\<plusminus> a \\<cdot>\\<^sub>s (ha \\<plusminus> m);\n        ha \\<in> H; xa = ha \\<plusminus> m\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus>\n                         a \\<cdot>\\<^sub>s (ha \\<plusminus> m)\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (frule_tac c = ha in subsetD[of H \"carrier M\"], assumption+,\n        simp add:sc_r_distr,\n        drule_tac x = a in spec,\n        drule_tac a = ha in forall_spec, simp,\n        frule_tac c = \"a \\<cdot>\\<^sub>s ha\" in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac c = h in subsetD[of H \"carrier M\"], assumption+,\n        subst ag_pOp_assoc[THEN sym], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier M;\n        H \\<subseteq> carrier M; b_ag M \\<guillemotright> H ;\n        ha \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<plusminus>\n        (a \\<cdot>\\<^sub>s ha \\<plusminus> a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<plusminus> m; ha \\<in> carrier M;\n        a \\<cdot>\\<^sub>s ha \\<in> H; a \\<cdot>\\<^sub>s ha \\<in> carrier M;\n        h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<cdot>\\<^sub>s ha \\<plusminus>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (simp add:aGroup.agop_gop[THEN sym], \n        simp add:aGroup.ag_carrier_carrier[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n        (a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m;\n        ha \\<in> carrier (b_ag M); a \\<cdot>\\<^sub>s ha \\<in> H;\n        a \\<cdot>\\<^sub>s ha \\<in> carrier (b_ag M);\n        h \\<in> carrier (b_ag M)\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (frule_tac x = h and y = \"a \\<cdot>\\<^sub>s ha\" in \n                  Group.sg_mult_closed[of \"b_ag M\" H], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n        (a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m;\n        ha \\<in> carrier (b_ag M); a \\<cdot>\\<^sub>s ha \\<in> H;\n        a \\<cdot>\\<^sub>s ha \\<in> carrier (b_ag M);\n        h \\<in> carrier (b_ag M);\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s ha\n        \\<in> H\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (frule_tac a = \"a \\<cdot>\\<^sub>s m\" and h = \"h \\<cdot>\\<^bsub>b_ag M\\<^esub> (a \\<cdot>\\<^sub>s ha)\" in \n                  Group.rcs_fixed1[of \"b_ag M\" H], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n        (a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m;\n        ha \\<in> carrier (b_ag M); a \\<cdot>\\<^sub>s ha \\<in> H;\n        a \\<cdot>\\<^sub>s ha \\<in> carrier (b_ag M);\n        h \\<in> carrier (b_ag M);\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s ha \\<in> H;\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m =\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n        (h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m)\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s m\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n        (a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m;\n        ha \\<in> carrier (b_ag M); a \\<cdot>\\<^sub>s ha \\<in> H;\n        a \\<cdot>\\<^sub>s ha \\<in> carrier (b_ag M);\n        h \\<in> carrier (b_ag M);\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s ha \\<in> H;\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m =\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n        (h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m)\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                               (h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                                a \\<cdot>\\<^sub>s\n                                ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                                a \\<cdot>\\<^sub>s m)\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (rule Group.a_in_rcs [of \"b_ag M\" \"H\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m\n        \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n        (a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<cdot>\\<^bsub>b_ag M\\<^esub> m;\n        ha \\<in> carrier (b_ag M); a \\<cdot>\\<^sub>s ha \\<in> H;\n        a \\<cdot>\\<^sub>s ha \\<in> carrier (b_ag M);\n        h \\<in> carrier (b_ag M);\n        h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s ha \\<in> H;\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m =\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n        (h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n         a \\<cdot>\\<^sub>s m)\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s ha \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> carrier (b_ag M)\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (simp add:aGroup.agop_gop, simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa h ha.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier M; aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier M;\n        H \\<subseteq> carrier M; b_ag M \\<guillemotright> H ;\n        ha \\<plusminus> m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m;\n        h \\<in> H;\n        x =\n        h \\<plusminus>\n        (a \\<cdot>\\<^sub>s ha \\<plusminus> a \\<cdot>\\<^sub>s m);\n        ha \\<in> H; xa = ha \\<plusminus> m; ha \\<in> carrier M;\n        a \\<cdot>\\<^sub>s ha \\<in> H; a \\<cdot>\\<^sub>s ha \\<in> carrier M;\n        h \\<in> carrier M; h \\<plusminus> a \\<cdot>\\<^sub>s ha \\<in> H;\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m =\n        H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n        (h \\<plusminus> a \\<cdot>\\<^sub>s ha \\<plusminus>\n         a \\<cdot>\\<^sub>s m)\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<cdot>\\<^sub>s ha \\<plusminus>\n                         a \\<cdot>\\<^sub>s m\n                         \\<in> carrier M\n 2. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (rule ag_pOp_closed, simp add:subsetD, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n     H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub> m.\n   \\<exists>h\\<in>H.\n      z = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s x}", "apply (rule subsetI, simp,\n       frule_tac x = x in Group.rcs_tool2[of \"b_ag M\" H \"a \\<cdot>\\<^sub>s m\"], assumption+,\n       erule bexE,\n       rotate_tac -1, frule sym, thin_tac \"h \\<cdot>\\<^bsub>b_ag M\\<^esub> (a \\<cdot>\\<^sub>s m) = x\",\n       frule Group.a_in_rcs[of \"b_ag M\" H m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (b_ag M); aGroup M;\n        Group (b_ag M); a \\<cdot>\\<^sub>s m \\<in> carrier (b_ag M);\n        H \\<subseteq> carrier (b_ag M); b_ag M \\<guillemotright> H ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H;\n        x \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m;\n        h \\<in> H; x = h \\<cdot>\\<^bsub>b_ag M\\<^esub> a \\<cdot>\\<^sub>s m;\n        m \\<in> H \\<bullet>\\<^bsub>b_ag M\\<^esub> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n   m.\n                            \\<exists>h\\<in>H.\n                               x =\n                               h \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                               a \\<cdot>\\<^sub>s xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_sprod_mem:\"\\<lbrakk>submodule R M H; a \\<in> carrier R; \n       X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> mr_cos_sprod M H a X \\<in> set_mr_cos M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R;\n     X \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H a X \\<in> set_mr_cos M H", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R;\n     \\<exists>a\\<in>carrier M. X = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                         mr_cos_sprod M H a X =\n                         aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply (erule bexE, rename_tac m, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        X = m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            mr_cos_sprod M H a\n                             (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                            aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subst mr_cos_sprodTr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        X = m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            a \\<cdot>\\<^sub>s\n                            m \\<uplus>\\<^bsub>M\\<^esub> H =\n                            aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply (frule_tac m = m in sc_mem [of a], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        X = m \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            a \\<cdot>\\<^sub>s\n                            m \\<uplus>\\<^bsub>M\\<^esub> H =\n                            aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_sprod_assoc:\"\\<lbrakk>submodule R M H; a \\<in> carrier R;\n b \\<in> carrier R; X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> mr_cos_sprod  M H (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) X = \n                           mr_cos_sprod M H a (mr_cos_sprod M H b X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n     X \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H\n                       (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) X =\n                      mr_cos_sprod M H a (mr_cos_sprod M H b X)", "apply (simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        aa \\<in> carrier M; X = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cos_sprod M H a\n                          (mr_cos_sprod M H b\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (frule_tac m = aa in sc_mem [of b], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        aa \\<in> carrier M; X = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        b \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cos_sprod M H a\n                          (mr_cos_sprod M H b\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (cut_tac sc_Ring,\n        frule Ring.ring_tOp_closed [of \"R\" \"a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        aa \\<in> carrier M; X = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        b \\<cdot>\\<^sub>s aa \\<in> carrier M; Ring R;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cos_sprod M H a\n                          (mr_cos_sprod M H b\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (subst mr_cos_sprodTr, assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        aa \\<in> carrier M; X = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        b \\<cdot>\\<^sub>s aa \\<in> carrier M; Ring R;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\n                         aa \\<uplus>\\<^bsub>M\\<^esub> H =\n                         a \\<cdot>\\<^sub>s\n                         (b \\<cdot>\\<^sub>s aa) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add: sc_assoc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_sprod_one:\"\\<lbrakk>submodule R M H; X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow>\n                   mr_cos_sprod M H (1\\<^sub>r\\<^bsub>R\\<^esub>) X = X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; X \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H 1\\<^sub>r\\<^bsub>R\\<^esub> X = X", "apply (simp add:set_mr_cos_def, erule bexE, simp,\n       thin_tac \"X = a \\<uplus>\\<^bsub>M\\<^esub> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H 1\\<^sub>r\\<^bsub>R\\<^esub>\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         a \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac sc_Ring,\n        frule Ring.ring_one[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M; Ring R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H 1\\<^sub>r\\<^bsub>R\\<^esub>\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         a \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subst mr_cos_sprodTr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M; Ring R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\n                         a \\<uplus>\\<^bsub>M\\<^esub> H =\n                         a \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cospOpTr:\"\\<lbrakk>submodule R M H; m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n        \\<Longrightarrow> mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H) (n \\<uplus>\\<^bsub>M\\<^esub> H) = (m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; n \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                       (n \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      (m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac module_is_ag, frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; n \\<in> carrier M;\n     aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                       (n \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      (m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:mr_cospOp_def mr_coset_def agop_gop [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; n \\<in> carrier M;\n     aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag M) H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                       (n \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                      n \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier (b_ag M);\n     n \\<in> carrier (b_ag M); aGroup M; Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag M) H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                       (n \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<cdot>\\<^bsub>b_ag M\\<^esub>\n                      n \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:submodule_def, (erule conjE)+,\n       frule aGroup.asubg_nsubg, assumption+, simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M); n \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M); H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H;\n     b_ag M \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag M) H (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m)\n                       (H \\<bullet>\\<^bsub>b_ag M\\<^esub> n) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      (m \\<cdot>\\<^bsub>b_ag M\\<^esub> n)", "apply (simp add:Group.c_top_welldef[THEN sym, of \"b_ag M\" H m n])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma(in Module) mr_cos_sprod_distrib1:\"\\<lbrakk>submodule R M H; a \\<in> carrier R; \n                b \\<in> carrier R;  X \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> \n                mr_cos_sprod M H (a \\<plusminus>\\<^bsub>R\\<^esub> b) X =  \n                 mr_cospOp M H (mr_cos_sprod M H a X) (mr_cos_sprod M H b X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n     X \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H (a \\<plusminus>\\<^bsub>R\\<^esub> b)\n                       X =\n                      mr_cospOp M H (mr_cos_sprod M H a X)\n                       (mr_cos_sprod M H b X)", "apply (simp add:set_mr_cos_def, erule bexE, rename_tac m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b) X =\n                         mr_cospOp M H (mr_cos_sprod M H a X)\n                          (mr_cos_sprod M H b X)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b)\n                          (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M H\n                          (mr_cos_sprod M H a\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))\n                          (mr_cos_sprod M H b\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (cut_tac sc_Ring,\n        frule Ring.ring_is_ag[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b)\n                          (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M H\n                          (mr_cos_sprod M H a\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))\n                          (mr_cos_sprod M H b\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (frule aGroup.ag_pOp_closed [of R a b], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b)\n                          (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M H\n                          (mr_cos_sprod M H a\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))\n                          (mr_cos_sprod M H b\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (subst mr_cos_sprodTr [of H], assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s\n                         m \\<uplus>\\<^bsub>M\\<^esub> H =\n                         mr_cospOp M H\n                          (a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (b \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (subst mr_cospOpTr, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> carrier M\n 2. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> b \\<cdot>\\<^sub>s m \\<in> carrier M\n 3. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s\n                         m \\<uplus>\\<^bsub>M\\<^esub> H =\n                         (a \\<cdot>\\<^sub>s m \\<plusminus>\n                          b \\<cdot>\\<^sub>s m) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:sc_mem, simp add:sc_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier M; X = m \\<uplus>\\<^bsub>M\\<^esub> H; Ring R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub> b) \\<cdot>\\<^sub>s\n                         m \\<uplus>\\<^bsub>M\\<^esub> H =\n                         (a \\<cdot>\\<^sub>s m \\<plusminus>\n                          b \\<cdot>\\<^sub>s m) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:sc_l_distr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_sprod_distrib2:\"\\<lbrakk>submodule R M H; \n a \\<in> carrier R; X \\<in> set_mr_cos M H; Y \\<in> set_mr_cos M H\\<rbrakk> \\<Longrightarrow> \n mr_cos_sprod M H a (mr_cospOp M H X Y) =  \n           mr_cospOp M H (mr_cos_sprod M H a X) (mr_cos_sprod M H a Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; a \\<in> carrier R; X \\<in> set_mr_cos M H;\n     Y \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> mr_cos_sprod M H a (mr_cospOp M H X Y) =\n                      mr_cospOp M H (mr_cos_sprod M H a X)\n                       (mr_cos_sprod M H a Y)", "apply (simp add:set_mr_cos_def, (erule bexE)+, rename_tac m n, simp,\n       thin_tac \"X = m \\<uplus>\\<^bsub>M\\<^esub> H\", thin_tac \"Y = n \\<uplus>\\<^bsub>M\\<^esub> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a\n                          (mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                            (n \\<uplus>\\<^bsub>M\\<^esub> H)) =\n                         mr_cospOp M H\n                          (mr_cos_sprod M H a\n                            (m \\<uplus>\\<^bsub>M\\<^esub> H))\n                          (mr_cos_sprod M H a\n                            (n \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (subst mr_cos_sprodTr [of H], assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a\n                          (mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                            (n \\<uplus>\\<^bsub>M\\<^esub> H)) =\n                         mr_cospOp M H\n                          (a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (a \\<cdot>\\<^sub>s n \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (subst mr_cospOpTr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a\n                          ((m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M H\n                          (a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (a \\<cdot>\\<^sub>s n \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (subst mr_cospOpTr, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> carrier M\n 2. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s n \\<in> carrier M\n 3. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a\n                          ((m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         (a \\<cdot>\\<^sub>s m \\<plusminus>\n                          a \\<cdot>\\<^sub>s n) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:sc_mem)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a\n                          ((m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         (a \\<cdot>\\<^sub>s m \\<plusminus>\n                          a \\<cdot>\\<^sub>s n) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subst mr_cos_sprodTr [of H], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> m \\<plusminus> n \\<in> carrier M\n 2. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\n                         (m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H =\n                         (a \\<cdot>\\<^sub>s m \\<plusminus>\n                          a \\<cdot>\\<^sub>s n) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (rule ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> carrier M;\n        n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\n                         (m \\<plusminus> n) \\<uplus>\\<^bsub>M\\<^esub> H =\n                         (a \\<cdot>\\<^sub>s m \\<plusminus>\n                          a \\<cdot>\\<^sub>s n) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:sc_r_distr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cosmOpTr:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> \n                mr_cosmOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H) = (-\\<^sub>a m) \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cosmOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      (-\\<^sub>a m) \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cosmOp M H (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> (-\\<^sub>a m)", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; aGroup M\\<rbrakk>\n    \\<Longrightarrow> mr_cosmOp M H (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> (-\\<^sub>a m)", "apply (frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M; aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> mr_cosmOp M H (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> (-\\<^sub>a m)", "apply (simp add:ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> mr_cosmOp M H (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub> (-\\<^sub>a m)", "apply (simp add:agiop_giop [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> mr_cosmOp M H (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      \\<rho>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:mr_cosmOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier (b_ag M); aGroup M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> c_iop (b_ag M) H\n                       (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      \\<rho>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:submodule_def, (erule conjE)+,\n        frule aGroup.asubg_nsubg[of M H], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier (b_ag M); aGroup M; Group (b_ag M);\n     H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H;\n     b_ag M \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> c_iop (b_ag M) H\n                       (H \\<bullet>\\<^bsub>b_ag M\\<^esub> m) =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      \\<rho>\\<^bsub>b_ag M\\<^esub> m", "apply (simp add:Group.c_iop_welldef[of \"b_ag M\" H m])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_oneTr:\"submodule R M H \\<Longrightarrow> H =  \\<zero> \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    H = \\<zero> \\<uplus>\\<^bsub>M\\<^esub> H", "apply (cut_tac module_is_ag,\n       cut_tac ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> H = \\<zero> \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> H = H \\<bullet>\\<^bsub>b_ag M\\<^esub> \\<zero>", "apply (frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier M;\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H = H \\<bullet>\\<^bsub>b_ag M\\<^esub> \\<zero>", "apply (simp add:ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier (b_ag M);\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H = H \\<bullet>\\<^bsub>b_ag M\\<^esub> \\<zero>", "apply (subst aGroup.agunit_gone[THEN sym, of M], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier (b_ag M);\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H =\n                      H \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                      \\<one>\\<^bsub>b_ag M\\<^esub>", "apply (subst Group.rcs_Unit1, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier (b_ag M);\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> b_ag M \\<guillemotright> H \n 2. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier (b_ag M);\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H = H", "apply (simp add:submodule_def, (erule conjE)+, simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; aGroup M; \\<zero> \\<in> carrier (b_ag M);\n     Group (b_ag M)\\<rbrakk>\n    \\<Longrightarrow> H = H", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mr_cos_oneTr1:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                            mr_cospOp M H H (m \\<uplus>\\<^bsub>M\\<^esub> H) = m \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H H (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subgoal_tac \"mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H) (m \\<uplus>\\<^bsub>M\\<^esub> H) = m \\<uplus>\\<^bsub>M\\<^esub> H\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H)\n      (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n     m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H H (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H)\n                       (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:mr_cos_oneTr [THEN sym, of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H)\n                       (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subst mr_cospOpTr, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> carrier M\n 2. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<in> carrier M\n 3. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (\\<zero> \\<plusminus> m) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<in> carrier M\n 2. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (\\<zero> \\<plusminus> m) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (\\<zero> \\<plusminus> m) \\<uplus>\\<^bsub>M\\<^esub> H =\n                      m \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) qmodule_is_ag:\"submodule R M H \\<Longrightarrow> aGroup (M /\\<^sub>m H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> aGroup (M /\\<^sub>m H)", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> aGroup (M /\\<^sub>m H)", "apply (rule aGroup.intro)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H);\n        c \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 6. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mr_cospOp M H\n                      \\<in> set_mr_cos M H \\<rightarrow>\n                            set_mr_cos M H \\<rightarrow> set_mr_cos M H\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H);\n        c \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 6. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>submodule R M H; Ring R; x \\<in> set_mr_cos M H;\n        xa \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H x xa \\<in> set_mr_cos M H\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H);\n        c \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 6. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (rename_tac X Y)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>X Y.\n       \\<lbrakk>submodule R M H; Ring R; X \\<in> set_mr_cos M H;\n        Y \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H X Y \\<in> set_mr_cos M H\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H);\n        c \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 6. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:set_mr_cos_def, (erule bexE)+, rename_tac n m, simp)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>X Y n m.\n       \\<lbrakk>submodule R M H; Ring R; n \\<in> carrier M;\n        X = n \\<uplus>\\<^bsub>M\\<^esub> H; m \\<in> carrier M;\n        Y = m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                            mr_cospOp M H (n \\<uplus>\\<^bsub>M\\<^esub> H)\n                             (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                            a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H);\n        c \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> c)\n 3. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 6. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 7. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (subst mr_cospOpTr, assumption+,\n        frule_tac x = n and y = m in ag_pOp_closed, assumption+, blast)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H);\n        c \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> c)\n 2. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 3. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 5. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 6. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> set_mr_cos M H;\n        b \\<in> set_mr_cos M H; c \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H (mr_cospOp M H a b) c =\n                         mr_cospOp M H a (mr_cospOp M H b c)\n 2. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 3. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 5. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 6. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:set_mr_cos_def, (erule bexE)+, rename_tac a b c m n n')"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b c m n n'.\n       \\<lbrakk>submodule R M H; Ring R; m \\<in> carrier M;\n        a = m \\<uplus>\\<^bsub>M\\<^esub> H; n \\<in> carrier M;\n        b = n \\<uplus>\\<^bsub>M\\<^esub> H; n' \\<in> carrier M;\n        c = n' \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H (mr_cospOp M H a b) c =\n                         mr_cospOp M H a (mr_cospOp M H b c)\n 2. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 3. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 5. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 6. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:mr_cospOpTr,\n        frule_tac x = m and y = n in ag_pOp_closed, assumption+,\n        frule_tac x = n and y = n' in ag_pOp_closed, assumption+,\n       simp add:mr_cospOpTr, simp add:ag_pOp_assoc)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> a\n 2. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> set_mr_cos M H;\n        b \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H a b = mr_cospOp M H b a\n 2. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:set_mr_cos_def, (erule bexE)+, rename_tac a b m n, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b m n.\n       \\<lbrakk>submodule R M H; Ring R; m \\<in> carrier M;\n        a = m \\<uplus>\\<^bsub>M\\<^esub> H; n \\<in> carrier M;\n        b = n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H (m \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (n \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M H (n \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (m \\<uplus>\\<^bsub>M\\<^esub> H)\n 2. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 4. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 5. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:mr_cospOpTr,\n         simp add:ag_pOp_commute)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> mop (M /\\<^sub>m H)\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m H)\n 2. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 3. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def,\n        rule Pi_I,\n        simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            mr_cosmOp M H (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                            aa \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 3. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 4. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (subst mr_cosmOpTr, assumption+,\n         frule_tac x = a in ag_mOp_closed, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>M /\\<^sub>m H\\<^esub> a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n 2. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def,\n        simp add:set_mr_cos_def, erule bexE, simp,\n        simp add:mr_cosmOpTr,\n        frule_tac x = aa in ag_mOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; Ring R; aa \\<in> carrier M;\n        a = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        -\\<^sub>a aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H\n                          ((-\\<^sub>a aa) \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         H\n 2. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 3. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:mr_cospOpTr,\n        frule_tac x = \"-\\<^sub>a aa\" and y = aa in ag_pOp_closed, assumption+,\n        simp add:ag_l_inv1, simp add:mr_cos_oneTr[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H)\n 2. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def,\n        simp add:set_mr_cos_def,\n        cut_tac mr_cos_oneTr[of H],\n        cut_tac ag_inc_zero, blast, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R;\n        a \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub> \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a =\n                         a", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; Ring R; a \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H H a = a", "apply (simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; Ring R; aa \\<in> carrier M;\n        a = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H H (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subgoal_tac \"mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H) (aa \\<uplus>\\<^bsub>M\\<^esub> H) = aa \\<uplus>\\<^bsub>M\\<^esub> H\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; Ring R; aa \\<in> carrier M;\n        a = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H)\n         (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n        aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H H (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         aa \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<And>a aa.\n       \\<lbrakk>submodule R M H; Ring R; aa \\<in> carrier M;\n        a = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply (simp add:mr_cos_oneTr[THEN sym, of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; Ring R; aa \\<in> carrier M;\n        a = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> mr_cospOp M H (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         aa \\<uplus>\\<^bsub>M\\<^esub> H", "apply (subst mr_cospOpTr, assumption+,\n        simp add:ag_inc_zero, assumption, simp add:ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) qmodule_module:\"submodule R M H \\<Longrightarrow> R module (M /\\<^sub>m H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> R module M /\\<^sub>m H", "apply (rule Module.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow> aGroup (M /\\<^sub>m H)\n 2. submodule R M H \\<Longrightarrow> Module_axioms (M /\\<^sub>m H) R", "apply (simp add:qmodule_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> Module_axioms (M /\\<^sub>m H) R", "apply (rule Module_axioms.intro)"], ["proof (prove)\ngoal (6 subgoals):\n 1. submodule R M H \\<Longrightarrow> Ring R\n 2. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m\n                         \\<in> carrier (M /\\<^sub>m H)\n 3. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m\n 4. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> n\n 5. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 6. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (cut_tac sc_Ring, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m\n                         \\<in> carrier (M /\\<^sub>m H)\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m\n 3. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> n\n 4. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 5. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a m \\<in> set_mr_cos M H\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m\n 3. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> n\n 4. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 5. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:mr_cos_sprod_mem)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m\n 2. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> n\n 3. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 4. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<plusminus>\\<^bsub>R\\<^esub> b) m =\n                         mr_cospOp M H (mr_cos_sprod M H a m)\n                          (mr_cos_sprod M H b m)\n 2. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> n\n 3. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 4. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:mr_cos_sprod_distrib1[of H])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> n\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 3. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; m \\<in> set_mr_cos M H;\n        n \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H a (mr_cospOp M H m n) =\n                         mr_cospOp M H (mr_cos_sprod M H a m)\n                          (mr_cos_sprod M H a n)\n 2. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 3. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:mr_cos_sprod_distrib2[of H])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> m)\n 2. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H\n                          (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) m =\n                         mr_cos_sprod M H a (mr_cos_sprod M H b m)\n 2. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:mr_cos_sprod_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         m =\n                         m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>submodule R M H; m \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> mr_cos_sprod M H 1\\<^sub>r\\<^bsub>R\\<^esub> m = m", "apply (simp add:mr_cos_sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  indmhom :: \"[('b, 'm) Ring_scheme, ('a, 'b, 'm1) Module_scheme, \n    ('c, 'b, 'm2) Module_scheme, 'a \\<Rightarrow> 'c] \\<Rightarrow>  'a set \\<Rightarrow> 'c\" where\n  \"indmhom R M N f = (\\<lambda>X\\<in> (set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)). f ( SOME x. x \\<in> X))\""], ["", "abbreviation\n  INDMHOM  (\"(4_\\<^sup>\\<flat>\\<^bsub>_ _, _\\<^esub>)\" [92,92,92,93]92) where\n  \"f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub> == indmhom R M N f\""], ["", "lemma (in Module) indmhom_someTr:\"\\<lbrakk>R module N; f \\<in> mHom R M N; \n      X \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk> \\<Longrightarrow> f (SOME xa. xa \\<in> X) \\<in> f `(carrier M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     X \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> f (SOME xa. xa \\<in> X) \\<in> f ` carrier M", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     \\<exists>a\\<in>carrier M.\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f (SOME xa. xa \\<in> X) \\<in> f ` carrier M", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (frule mker_submodule [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M \\<and>\n        M +> ker\\<^bsub>M,N\\<^esub> f \\<and>\n        (\\<forall>a m.\n            a \\<in> carrier R \\<and>\n            m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n            a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        M +> ker\\<^bsub>M,N\\<^esub> f;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and>\n           m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and>\n           m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (thin_tac \"\\<forall>a m. a \\<in> carrier R \\<and> m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow> a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f \\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (cut_tac module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ;\n        aGroup M\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M)\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa.\n                               xa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                         \\<in> f ` carrier M", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa.\n                            aa \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` carrier M", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa.\n                            aa \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                                     a\n 2. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` carrier M", "apply (frule_tac a = a in Group.a_in_rcs[of \"b_ag M\" \"ker\\<^bsub>M,N\\<^esub> f\"], \n        assumption+, simp add:ag_carrier_carrier [THEN sym], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` carrier M", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                a\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` carrier M", "apply (frule_tac a = a and x = x in \n                  Group.rcs_subset_elem[of \"b_ag M\" \"ker\\<^bsub>M,N\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                a\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (b_ag M)\n 2. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                a\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub>\n                                 a\n 3. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        x \\<in> carrier (b_ag M)\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` carrier M", "apply (simp add:ag_carrier_carrier, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        X = ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        b_ag M \\<guillemotright> ker\\<^bsub>M,N\\<^esub> f ; aGroup M;\n        Group (b_ag M);\n        x \\<in> ker\\<^bsub>M,N\\<^esub> f \\<bullet>\\<^bsub>b_ag M\\<^esub> a;\n        x \\<in> carrier (b_ag M)\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` carrier M", "apply (simp add:image_def,\n       simp add:ag_carrier_carrier, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhom_someTr1:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n        \\<Longrightarrow>  f (SOME xa. xa \\<in> (ar_coset m M (ker\\<^bsub>M,N\\<^esub> f))) = f m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f (SOME xa.\n                            xa \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                      f m", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         a \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f x = f m", "apply (frule mker_submodule[of N f], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n     submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         a \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f x = f m", "apply (frule_tac m_in_mr_coset[of \"ker\\<^bsub>M,N\\<^esub> f\" m], assumption+,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f x = f m", "apply (frule mker_submodule [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> f x = f m", "apply (frule_tac x = x in x_in_mr_coset [of  \"ker\\<^bsub>M,N\\<^esub> f\" \"m\"], \n                                         assumption+, erule bexE,\n        frule sym , thin_tac \"m \\<plusminus> h = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        m \\<plusminus> h\n        \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        h \\<in> ker\\<^bsub>M,N\\<^esub> f; x = m \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> f (m \\<plusminus> h) = f m", "apply (simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        m \\<plusminus> h\n        \\<in> m \\<uplus>\\<^bsub>M\\<^esub> {a \\<in> carrier M.\n     f a = \\<zero>\\<^bsub>N\\<^esub>};\n        submodule R M {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        x = m \\<plusminus> h; h \\<in> carrier M;\n        f h = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f (m \\<plusminus> h) = f m", "apply (subst mHom_add[of N f ], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        m \\<plusminus> h\n        \\<in> m \\<uplus>\\<^bsub>M\\<^esub> {a \\<in> carrier M.\n     f a = \\<zero>\\<^bsub>N\\<^esub>};\n        submodule R M {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        x = m \\<plusminus> h; h \\<in> carrier M;\n        f h = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         f m", "apply (frule Module.module_is_ag [of N R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        m \\<plusminus> h\n        \\<in> m \\<uplus>\\<^bsub>M\\<^esub> {a \\<in> carrier M.\n     f a = \\<zero>\\<^bsub>N\\<^esub>};\n        submodule R M {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        x = m \\<plusminus> h; h \\<in> carrier M;\n        f h = \\<zero>\\<^bsub>N\\<^esub>; aGroup N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         f m", "apply (frule mHom_mem [of \"N\" \"f\" \"m\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        m \\<plusminus> h\n        \\<in> m \\<uplus>\\<^bsub>M\\<^esub> {a \\<in> carrier M.\n     f a = \\<zero>\\<^bsub>N\\<^esub>};\n        submodule R M {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        x = m \\<plusminus> h; h \\<in> carrier M;\n        f h = \\<zero>\\<^bsub>N\\<^esub>; aGroup N;\n        f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         f m", "apply (simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhom_someTr2:\"\\<lbrakk>R module N; f \\<in> mHom R M N; \n       submodule R M H; m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow> \n                       f (SOME xa. xa \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H) = f m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n     m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f (SOME xa. xa \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      f m", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n     m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a. a \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> f x = f m", "apply (frule_tac m_in_mr_coset[of \"H\" m], assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> f x = f m", "apply (frule_tac x = x in x_in_mr_coset [of  H m], \n                                         assumption+, erule bexE,\n        frule sym , thin_tac \"m \\<plusminus> h = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = m \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> f (m \\<plusminus> h) = f m", "apply (frule_tac c = h in subsetD[of H \"ker\\<^bsub>M,N\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = m \\<plusminus> h; h \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (m \\<plusminus> h) = f m", "apply (frule mker_submodule [of N f], assumption+, \n         simp add:submodule_def[of R M \"ker\\<^bsub>M,N\\<^esub> f\"], (erule conjE)+,\n        frule_tac c = h in subsetD[of \"ker\\<^bsub>M,N\\<^esub> f\" \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M; H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = m \\<plusminus> h; h \\<in> ker\\<^bsub>M,N\\<^esub> f;\n        ker\\<^bsub>M,N\\<^esub> f \\<subseteq> carrier M;\n        M +> ker\\<^bsub>M,N\\<^esub> f;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and>\n           m \\<in> ker\\<^bsub>M,N\\<^esub> f \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> ker\\<^bsub>M,N\\<^esub> f;\n        h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (m \\<plusminus> h) = f m", "apply (simp add:ker_def mHom_add,\n        frule_tac m = m in mHom_mem[of \"N\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M;\n        H \\<subseteq> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = m \\<plusminus> h; f h = \\<zero>\\<^bsub>N\\<^esub>;\n        M +> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        \\<forall>a m.\n           a \\<in> carrier R \\<and>\n           m \\<in> carrier M \\<and>\n           f m = \\<zero>\\<^bsub>N\\<^esub> \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> carrier M \\<and>\n           f (a \\<cdot>\\<^sub>s m) = \\<zero>\\<^bsub>N\\<^esub>;\n        h \\<in> carrier M; f m \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         f m", "apply (frule Module.module_is_ag[of N R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; submodule R M H;\n        m \\<in> carrier M;\n        H \\<subseteq> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = m \\<plusminus> h; f h = \\<zero>\\<^bsub>N\\<^esub>;\n        M +> {a \\<in> carrier M. f a = \\<zero>\\<^bsub>N\\<^esub>};\n        \\<forall>a m.\n           a \\<in> carrier R \\<and>\n           m \\<in> carrier M \\<and>\n           f m = \\<zero>\\<^bsub>N\\<^esub> \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> carrier M \\<and>\n           f (a \\<cdot>\\<^sub>s m) = \\<zero>\\<^bsub>N\\<^esub>;\n        h \\<in> carrier M; f m \\<in> carrier N; aGroup N\\<rbrakk>\n       \\<Longrightarrow> f m \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub> =\n                         f m", "apply (simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhomTr1:\"\\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n               (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>) (m \\<uplus>\\<^bsub>M\\<^esub> (ker\\<^bsub>M,N\\<^esub> f)) = f m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                       (m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                      f m", "apply (simp add:indmhom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n                       \\<in> set_mr_cos M\n                              (ker\\<^bsub>M,N\\<^esub> f) \\<longrightarrow>\n                       f (SOME x.\n                             x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                       f m) \\<and>\n                      (m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n                       \\<notin> set_mr_cos M\n                                 (ker\\<^bsub>M,N\\<^esub> f) \\<longrightarrow>\n                       undefined = f m)", "apply (subgoal_tac \"m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n     \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> f (SOME x.\n                            x \\<in> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                      f m\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n                      \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (rule indmhom_someTr1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n                      \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (rule set_mr_cos_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> submodule R M (ker\\<^bsub>M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> m \\<in> carrier M", "apply (rule mker_submodule, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhomTr2:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \n      \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>) \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f) \\<rightarrow> carrier N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> set_mr_cos M\n                             (ker\\<^bsub>M,N\\<^esub> f) \\<rightarrow>\n                            carrier N", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        x \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x\n                         \\<in> carrier N", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        \\<exists>a\\<in>carrier M.\n           x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x\n                         \\<in> carrier N", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x\n                         \\<in> carrier N", "apply (frule_tac m = a in indmhomTr1 [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n        f a\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x\n                         \\<in> carrier N", "apply (simp add:mHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhom:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \n                           \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>) \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                             N", "apply (simp add:mHom_def [of R \"M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\" N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                             N \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> carrier\n                             (M /\\<^sub>m\n                              (ker\\<^bsub>M,N\\<^esub> f)) \\<rightarrow>\n                            carrier N \\<and>\n                      f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (M /\\<^sub>m\n                                (ker\\<^bsub>M,N\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              a \\<plusminus>\\<^bsub>N\\<^esub>\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> carrier\n                             (M /\\<^sub>m\n                              (ker\\<^bsub>M,N\\<^esub> f)) \\<rightarrow>\n                            carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (M /\\<^sub>m\n                                (ker\\<^bsub>M,N\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              a \\<plusminus>\\<^bsub>N\\<^esub>\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b)\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> set_mr_cos M\n                             (ker\\<^bsub>M,N\\<^esub> f) \\<rightarrow>\n                            carrier N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (M /\\<^sub>m\n                                (ker\\<^bsub>M,N\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              a \\<plusminus>\\<^bsub>N\\<^esub>\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b)\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:indmhomTr2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (M /\\<^sub>m\n                                (ker\\<^bsub>M,N\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                              a \\<plusminus>\\<^bsub>N\\<^esub>\n                             (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)))\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                         \\<forall>b\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              b) =\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             a \\<plusminus>\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:qmodule_def indmhom_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                         \\<forall>b\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              b) =\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             a \\<plusminus>\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        a \\<in> carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f));\n        b \\<in> carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                           b) =\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        a \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f);\n        b \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (mr_cospOp M (ker\\<^bsub>M,N\\<^esub> f) a b) =\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:set_mr_cos_def, (erule bexE)+, simp, rename_tac  m n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        a = m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        n \\<in> carrier M;\n        b = n \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (mr_cospOp M (ker\\<^bsub>M,N\\<^esub> f)\n                            (m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n                            (n \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)) =\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (n \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (frule mker_submodule [of N f], assumption+,\n        simp add:mr_cospOpTr,\n        frule_tac x = m and y = n in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m n.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; m \\<in> carrier M;\n        a = m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        n \\<in> carrier M;\n        b = n \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        m \\<plusminus> n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          ((m \\<plusminus>\n                            n) \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (m \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) \\<plusminus>\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (n \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:indmhomTr1, simp add:mHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (mr_cos_sprod M (ker\\<^bsub>M,N\\<^esub> f) a m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) m", "apply (simp add:set_mr_cos_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (mr_cos_sprod M (ker\\<^bsub>M,N\\<^esub> f) a\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)", "apply (frule mker_submodule [of N f], assumption+,\n        subst mr_cos_sprodTr [of \"ker\\<^bsub>M,N\\<^esub> f\"], assumption+,\n        frule_tac a = a and m = aa in sc_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        a \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (a \\<cdot>\\<^sub>s\n                           aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)", "apply (simp add:indmhomTr1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        a \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (a \\<cdot>\\<^sub>s aa) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f aa", "apply (simp add:mHom_lin)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhom_injec:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n       injec\\<^bsub>(M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)),N\\<^esub> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M /\\<^sub>m\n                                   (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                             N \\<and>\n                      ker\\<^bsub>M /\\<^sub>m\n                                 (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> =\n                      {\\<zero>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>}", "apply (frule indmhom [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                             N \\<and>\n                      ker\\<^bsub>M /\\<^sub>m\n                                 (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> =\n                      {\\<zero>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>}", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M /\\<^sub>m\n                                 (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> =\n                      {\\<zero>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>}", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M /\\<^sub>m\n                                 (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> =\n                      {\\<zero>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>}", "apply (simp add:ker_def [of  _ _ \"f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier\n                                (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                       (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a =\n                       \\<zero>\\<^bsub>N\\<^esub>} =\n                      {\\<zero>\\<^bsub>M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)\\<^esub>}", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R\n            \\<lparr>carrier = set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f),\n               pop = mr_cospOp M (ker\\<^bsub>M,N\\<^esub> f),\n               mop = mr_cosmOp M (ker\\<^bsub>M,N\\<^esub> f),\n               zero = ker\\<^bsub>M,N\\<^esub> f,\n               sprod = mr_cos_sprod M (ker\\<^bsub>M,N\\<^esub> f)\\<rparr>\n            N\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f).\n                       (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a =\n                       \\<zero>\\<^bsub>N\\<^esub>} =\n                      {ker\\<^bsub>M,N\\<^esub> f}", "apply (fold qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f).\n                       (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a =\n                       \\<zero>\\<^bsub>N\\<^esub>} =\n                      {ker\\<^bsub>M,N\\<^esub> f}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f).\n                       (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a =\n                       \\<zero>\\<^bsub>N\\<^esub>}\n                      \\<subseteq> {ker\\<^bsub>M,N\\<^esub> f}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x \\<in> {a \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f).\n                 (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a =\n                 \\<zero>\\<^bsub>N\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {ker\\<^bsub>M,N\\<^esub> f}\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f) \\<and>\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x =\n        \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f);\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x =\n        \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n        \\<zero>\\<^bsub>N\\<^esub>;\n        a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f =\n                         ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (simp add:indmhomTr1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f a = \\<zero>\\<^bsub>N\\<^esub>; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f =\n                         ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (frule mker_submodule [of N f], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f a = \\<zero>\\<^bsub>N\\<^esub>; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f =\n                         ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (rule_tac h1 = a in mr_cos_h_stable [THEN sym, of \"ker\\<^bsub>M,N\\<^esub> f\"], \n         assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f a = \\<zero>\\<^bsub>N\\<^esub>; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>M,N\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_mr_cos M\n      (ker\\<^bsub>M,N\\<^esub> f).\n                                   (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                    a =\n                                   \\<zero>\\<^bsub>N\\<^esub>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x \\<in> {ker\\<^bsub>M,N\\<^esub> f}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {a \\<in> set_mr_cos M\n     (ker\\<^bsub>M,N\\<^esub> f).\n                                  (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                                   a =\n                                  \\<zero>\\<^bsub>N\\<^esub>}", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f\n                         \\<in> set_mr_cos M\n                                (ker\\<^bsub>M,N\\<^esub> f) \\<and>\n                         (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f\n                         \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                            ker\\<^bsub>M,N\\<^esub> f =\n                            a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule mker_submodule [of N f], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                            ker\\<^bsub>M,N\\<^esub> f =\n                            a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule mr_cos_oneTr [of \"ker\\<^bsub>M,N\\<^esub> f\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        ker\\<^bsub>M,N\\<^esub> f =\n        \\<zero> \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                            ker\\<^bsub>M,N\\<^esub> f =\n                            a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (cut_tac  ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        ker\\<^bsub>M,N\\<^esub> f =\n        \\<zero> \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f;\n        \\<zero> \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                            ker\\<^bsub>M,N\\<^esub> f =\n                            a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule mker_submodule [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (subst mr_cos_oneTr [of \"ker\\<^bsub>M,N\\<^esub> f\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (cut_tac  ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        \\<zero> \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                          (\\<zero> \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (subst indmhomTr1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        x = ker\\<^bsub>M,N\\<^esub> f;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        \\<zero> \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:mHom_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhom_surjec1:\"\\<lbrakk>R module N; surjec\\<^bsub>M,N\\<^esub> f;\n f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow> surjec\\<^bsub>(M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)),N\\<^esub> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; surjec\\<^bsub>M,N\\<^esub> f;\n     f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m\n                                    (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                             N \\<and>\n                      surj_to (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                       (carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)))\n                       (carrier N)", "apply (frule indmhom [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                             N \\<and>\n                      surj_to (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                       (carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)))\n                       (carrier N)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\n 2. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> surj_to (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                       (carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)))\n                       (carrier N)", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> surj_to (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                       (carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)))\n                       (carrier N)", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n                      \\<in> carrier\n                             (M /\\<^sub>m\n                              (ker\\<^bsub>M,N\\<^esub> f)) \\<rightarrow>\n                            carrier N\n 2. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = b", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N;\n     f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n     f \\<in> mHom R M N;\n     f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier N.\n                         \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N;\n        f \\<in> aHom M N \\<and> surj_to f (carrier M) (carrier N);\n        f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        b \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = b", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        b \\<in> carrier N; f \\<in> aHom M N;\n        surj_to f (carrier M) (carrier N)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = b", "apply (simp add:surj_to_def, frule sym , thin_tac \"f ` carrier M = carrier N\",\n        simp,\n        thin_tac \"carrier N = f ` carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        b \\<in> f ` carrier M; f \\<in> aHom M N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = b", "apply (simp add:image_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f \\<in> aHom M N; x \\<in> carrier M; b = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = f x", "apply (frule_tac m = x in indmhomTr1 [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f \\<in> aHom M N; x \\<in> carrier M; b = f x;\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (x \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n        f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = f x", "apply (frule mker_submodule [of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f \\<in> aHom M N; x \\<in> carrier M; b = f x;\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (x \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n        f x;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = f x", "apply (simp add:qmodule_carr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f \\<in> aHom M N; x \\<in> carrier M; b = f x;\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (x \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n        f x;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>set_mr_cos M\n   (ker\\<^bsub>M,N\\<^esub> f).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = f x", "apply (frule_tac m = x in set_mr_cos_mem [of \"ker\\<^bsub>M,N\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) N;\n        f \\<in> aHom M N; x \\<in> carrier M; b = f x;\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (x \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n        f x;\n        submodule R M (ker\\<^bsub>M,N\\<^esub> f);\n        x \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\n        \\<in> set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>set_mr_cos M\n   (ker\\<^bsub>M,N\\<^esub> f).\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) a = f x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) module_homTr:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                           f \\<in> mHom R M (mimg\\<^bsub>R M,N\\<^esub> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M (mimg\\<^bsub>R M,N\\<^esub> f)", "apply (subst mHom_def, simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M (mimg\\<^bsub>R M,N\\<^esub> f) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             f (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom M (mimg\\<^bsub>R M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier M \\<rightarrow>\n                              carrier (mimg\\<^bsub>R M,N\\<^esub> f) \\<and>\n                      f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>a\\<in>carrier M.\n                          \\<forall>b\\<in>carrier M.\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f b)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier M \\<rightarrow>\n                              carrier (mimg\\<^bsub>R M,N\\<^esub> f)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>a\\<in>carrier M.\n                          \\<forall>b\\<in>carrier M.\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f b)\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (simp add:mimg_def mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>a\\<in>carrier M.\n                          \\<forall>b\\<in>carrier M.\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                             f b)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier M)\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier M.\n                         \\<forall>b\\<in>carrier M.\n                            f (a \\<plusminus> b) =\n                            f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f b\n 3. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (simp add:mHom_def aHom_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier M.\n                         \\<forall>b\\<in>carrier M.\n                            f (a \\<plusminus> b) =\n                            f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (a \\<plusminus> b) =\n                         f a \\<plusminus>\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                         f b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (simp add:mimg_def mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier M;\n        b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (a \\<plusminus> b) =\n                         f a \\<plusminus>\\<^bsub>N\\<^esub> f b\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (simp add:mHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier M.\n                            f (a \\<cdot>\\<^sub>s m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                            f m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mimg\\<^bsub>R M,N\\<^esub> f\\<^esub>\n                         f m", "apply (simp add:mimg_def mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m", "apply (simp add:mHom_lin)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) ker_to_mimg:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f = ker\\<^bsub>M,N\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f =\n                      ker\\<^bsub>M,N\\<^esub> f", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f\n                      \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f\n                      \\<subseteq> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n             f\\<^esub> f", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        x \\<in> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ker\\<^bsub>M,N\\<^esub> f\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f\n                      \\<subseteq> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n             f\\<^esub> f", "apply (simp add:ker_def mimg_def mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M,N\\<^esub> f\n                      \\<subseteq> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n             f\\<^esub> f", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        x \\<in> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n            f\\<^esub> f", "apply (simp add:ker_def mimg_def mdl_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) module_homTr1:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n   (mimg\\<^bsub>R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)),N\\<^esub> (f\\<^sup>\\<flat>\\<^bsub>R M,N\\<^esub>)) = mimg\\<^bsub>R M,N\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> mimg\\<^bsub>R M /\\<^sub>m\n                                    (ker\\<^bsub>M,N\\<^esub> f),N\\<^esub>\n                          f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> =\n                      mimg\\<^bsub>R M,N\\<^esub> f", "apply (simp add:mimg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> mdl N\n                       (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                        carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))) =\n                      mdl N (f ` carrier M)", "apply (subgoal_tac \"f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> ` carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))  = f ` carrier M \",\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                      carrier (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f)) =\n                      f ` carrier M", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                      set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f) =\n                      f ` carrier M", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                      set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\n                      \\<subseteq> f ` carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M\n                      \\<subseteq> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                                  set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        x \\<in> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> f ` carrier M\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M\n                      \\<subseteq> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                                  set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (simp add:image_def set_mr_cos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        \\<exists>xa.\n           (\\<exists>a\\<in>carrier M.\n               xa =\n               a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) \\<and>\n           x = (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>carrier M. x = f xa\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M\n                      \\<subseteq> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                                  set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (erule exE, erule conjE, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa a.\n       \\<lbrakk>R module N; f \\<in> mHom R M N;\n        x =\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f);\n        a \\<in> carrier M;\n        xa = a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier M.\n                            (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n                             (a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) =\n                            f x\n 2. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M\n                      \\<subseteq> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                                  set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (simp add:indmhomTr1, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> f ` carrier M\n                      \\<subseteq> f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub> `\n                                  set_mr_cos M (ker\\<^bsub>M,N\\<^esub> f)", "apply (rule subsetI,\n       simp add:image_def set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; xa \\<in> carrier M;\n        x = f xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>a\\<in>carrier M.\n                                x =\n                                a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) \\<and>\n                            f xa = (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x", "apply (frule_tac m1 = xa in indmhomTr1 [THEN sym, of N f], \n                                                     assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; xa \\<in> carrier M;\n        x = f xa;\n        f xa =\n        (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>)\n         (xa \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>a\\<in>carrier M.\n                                x =\n                                a \\<uplus>\\<^bsub>M\\<^esub> ker\\<^bsub>M,N\\<^esub> f) \\<and>\n                            f xa = (f\\<^sup>\\<flat>\\<^bsub>R M, N\\<^esub>) x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) module_Homth_1:\"\\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk> \\<Longrightarrow>\n                     M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f) \\<cong>\\<^bsub>R\\<^esub> mimg\\<^bsub>R M,N\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m\n                      (ker\\<^bsub>M,N\\<^esub> f) \\<cong>\\<^bsub>R\\<^esub> mimg\\<^bsub>R M,N\\<^esub>\n  f", "apply (frule surjec_to_mimg[of N f], assumption,\n       frule module_homTr[of N f], assumption,\n       frule mimg_module[of N f], assumption,\n       frule indmhom_surjec1[of \"mimg\\<^bsub>R M,N\\<^esub> f\" f], assumption+,\n       frule indmhom_injec[of \"mimg\\<^bsub>R M,N\\<^esub> f\" f], assumption+,\n       frule indmhom[of \"mimg\\<^bsub>R M,N\\<^esub> f\" f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     surjec\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f;\n     f \\<in> mHom R M (mimg\\<^bsub>R M,N\\<^esub> f);\n     R module mimg\\<^bsub>R M,N\\<^esub> f;\n     surjec\\<^bsub>M /\\<^sub>m\n                   (ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n                                     f\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub>\n                f\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub>\n                     f)\\<^esub>;\n     injec\\<^bsub>M /\\<^sub>m\n                  (ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n                                    f\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub>\n               f\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub>\n                    f)\\<^esub>;\n     f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub> f)\\<^esub>\n     \\<in> mHom R\n            (M /\\<^sub>m\n             (ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f))\n            (mimg\\<^bsub>R M,N\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m\n                      (ker\\<^bsub>M,N\\<^esub> f) \\<cong>\\<^bsub>R\\<^esub> mimg\\<^bsub>R M,N\\<^esub>\n  f", "apply (simp add:misomorphic_def,\n       simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     surjec\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f;\n     f \\<in> mHom R M (mimg\\<^bsub>R M,N\\<^esub> f);\n     R module mimg\\<^bsub>R M,N\\<^esub> f;\n     surjec\\<^bsub>M /\\<^sub>m\n                   (ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n                                     f\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub>\n                f\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub>\n                     f)\\<^esub>;\n     injec\\<^bsub>M /\\<^sub>m\n                  (ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub>\n                                    f\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub>\n               f\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub>\n                    f)\\<^esub>;\n     f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub> f)\\<^esub>\n     \\<in> mHom R\n            (M /\\<^sub>m\n             (ker\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f))\n            (mimg\\<^bsub>R M,N\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>fa.\n                         fa \\<in> mHom R\n                                   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                                   (mimg\\<^bsub>R M,N\\<^esub> f) \\<and>\n                         injec\\<^bsub>M /\\<^sub>m\n(ker\\<^bsub>M,N\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> fa \\<and>\n                         surjec\\<^bsub>M /\\<^sub>m\n (ker\\<^bsub>M,N\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> fa", "apply (simp add:ker_to_mimg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N;\n     surjec\\<^bsub>M,mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> f;\n     f \\<in> mHom R M (mimg\\<^bsub>R M,N\\<^esub> f);\n     R module mimg\\<^bsub>R M,N\\<^esub> f;\n     surjec\\<^bsub>M /\\<^sub>m\n                   (ker\\<^bsub>M,N\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub>\n            f\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub>\n                 f)\\<^esub>;\n     injec\\<^bsub>M /\\<^sub>m\n                  (ker\\<^bsub>M,N\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub>\n           f\\<^esub> f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub>\n                f)\\<^esub>;\n     f\\<^sup>\\<flat>\\<^bsub>R M, (mimg\\<^bsub>R M,N\\<^esub> f)\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n            (mimg\\<^bsub>R M,N\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>fa.\n                         fa \\<in> mHom R\n                                   (M /\\<^sub>m (ker\\<^bsub>M,N\\<^esub> f))\n                                   (mimg\\<^bsub>R M,N\\<^esub> f) \\<and>\n                         injec\\<^bsub>M /\\<^sub>m\n(ker\\<^bsub>M,N\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> fa \\<and>\n                         surjec\\<^bsub>M /\\<^sub>m\n (ker\\<^bsub>M,N\\<^esub> f),mimg\\<^bsub>R M,N\\<^esub> f\\<^esub> fa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  mpj :: \"[('a, 'r, 'm) Module_scheme, 'a set] \\<Rightarrow>  ('a => 'a set)\" where\n  \"mpj M H = (\\<lambda>x\\<in>carrier M. x \\<uplus>\\<^bsub>M\\<^esub> H)\""], ["", "lemma (in Module) elem_mpj:\"\\<lbrakk>m \\<in> carrier M; submodule R M H\\<rbrakk> \\<Longrightarrow>\n                                                 mpj M H m = m \\<uplus>\\<^bsub>M\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<in> carrier M; submodule R M H\\<rbrakk>\n    \\<Longrightarrow> mpj M H m = m \\<uplus>\\<^bsub>M\\<^esub> H", "by (simp add:mpj_def)"], ["", "lemma (in Module) mpj_mHom:\"submodule R M H \\<Longrightarrow> mpj M H \\<in> mHom R M (M /\\<^sub>m H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow> mpj M H \\<in> mHom R M (M /\\<^sub>m H)", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    mpj M H \\<in> aHom M (M /\\<^sub>m H) \\<and>\n    (\\<forall>a\\<in>carrier R.\n        \\<forall>m\\<in>carrier M.\n           mpj M H (a \\<cdot>\\<^sub>s m) =\n           a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow> mpj M H \\<in> aHom M (M /\\<^sub>m H)\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow>\n    mpj M H \\<in> carrier M \\<rightarrow> carrier (M /\\<^sub>m H) \\<and>\n    mpj M H \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           mpj M H (a \\<plusminus> b) =\n           mpj M H a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H b)\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. submodule R M H \\<Longrightarrow>\n    mpj M H \\<in> carrier M \\<rightarrow> carrier (M /\\<^sub>m H)\n 2. submodule R M H \\<Longrightarrow>\n    mpj M H \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           mpj M H (a \\<plusminus> b) =\n           mpj M H a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H b)\n 3. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (simp add:mpj_def qmodule_carr set_mr_cos_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow>\n    mpj M H \\<in> extensional (carrier M) \\<and>\n    (\\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           mpj M H (a \\<plusminus> b) =\n           mpj M H a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H b)\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. submodule R M H \\<Longrightarrow> mpj M H \\<in> extensional (carrier M)\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier M.\n       \\<forall>b\\<in>carrier M.\n          mpj M H (a \\<plusminus> b) =\n          mpj M H a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H b\n 3. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (simp add:mpj_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier M.\n       \\<forall>b\\<in>carrier M.\n          mpj M H (a \\<plusminus> b) =\n          mpj M H a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H b\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M;\n        b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mpj M H (a \\<plusminus> b) =\n                         mpj M H a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         mpj M H b\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M;\n        b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mpj M H (a \\<plusminus> b) =\n                         mr_cospOp M H (mpj M H a) (mpj M H b)\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (simp add:mpj_def, simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M;\n        b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus> b) \\<uplus>\\<^bsub>M\\<^esub> H =\n                         mr_cospOp M H (a \\<uplus>\\<^bsub>M\\<^esub> H)\n                          (b \\<uplus>\\<^bsub>M\\<^esub> H)\n 2. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (simp add:mr_cospOpTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    \\<forall>a\\<in>carrier R.\n       \\<forall>m\\<in>carrier M.\n          mpj M H (a \\<cdot>\\<^sub>s m) =\n          a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub> mpj M H m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> mpj M H (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         mpj M H m", "apply (simp add:mpj_def sc_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                         (m \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; a \\<in> carrier R;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<uplus>\\<^bsub>M\\<^esub> H =\n                         mr_cos_sprod M H a (m \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (simp add:mr_cos_sprodTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mpj_mem:\"\\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n                                mpj M H m \\<in> carrier (M /\\<^sub>m H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mpj M H m \\<in> carrier (M /\\<^sub>m H)", "apply (frule mpj_mHom[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> mpj M H m \\<in> carrier (M /\\<^sub>m H)", "apply (rule mHom_mem [of \"M /\\<^sub>m H\" \"mpj M H\" \"m\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> R module M /\\<^sub>m H\n 2. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> mpj M H \\<in> mHom R M (M /\\<^sub>m H)\n 3. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> m \\<in> carrier M", "apply (simp add:qmodule_module)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> mpj M H \\<in> mHom R M (M /\\<^sub>m H)\n 2. \\<lbrakk>submodule R M H; m \\<in> carrier M;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> m \\<in> carrier M", "apply assumption+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mpj_surjec:\"submodule R M H \\<Longrightarrow>\n                             surjec\\<^bsub>M,(M /\\<^sub>m H)\\<^esub> (mpj M H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    surjec\\<^bsub>M,M /\\<^sub>m H\\<^esub> mpj M H", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    mpj M H \\<in> aHom M (M /\\<^sub>m H) \\<and>\n    surj_to (mpj M H) (carrier M) (carrier (M /\\<^sub>m H))", "apply (frule mpj_mHom [of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> mpj M H \\<in> aHom M (M /\\<^sub>m H) \\<and>\n                      surj_to (mpj M H) (carrier M)\n                       (carrier (M /\\<^sub>m H))", "apply (rule conjI, simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> surj_to (mpj M H) (carrier M)\n                       (carrier (M /\\<^sub>m H))", "apply (rule surj_to_test,\n       simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H;\n     mpj M H \\<in> mHom R M (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier (M /\\<^sub>m H).\n                         \\<exists>a\\<in>carrier M. mpj M H a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; mpj M H \\<in> mHom R M (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. mpj M H a = b", "apply (thin_tac \"mpj M H \\<in> mHom R M (M /\\<^sub>m H)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. mpj M H a = b", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; b \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier M. mpj M H a = b", "apply (simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; a \\<in> carrier M;\n        b = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            mpj M H aa = a \\<uplus>\\<^bsub>M\\<^esub> H", "apply (frule_tac m = a in elem_mpj[of _ H], assumption, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mpj_0:\"\\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                                 mpj M H h  = \\<zero>\\<^bsub>(M /\\<^sub>m H)\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> mpj M H h = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (simp add:submodule_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n    \\<Longrightarrow> mpj M H h = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (frule_tac c = h in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H;\n     h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> mpj M H h = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (subst elem_mpj[of _ H], assumption+,\n        simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H;\n     h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> h \\<uplus>\\<^bsub>M\\<^esub> H =\n                      \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; H \\<subseteq> carrier M; M +> H;\n     \\<forall>a m.\n        a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n        a \\<cdot>\\<^sub>s m \\<in> H;\n     h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> h \\<uplus>\\<^bsub>M\\<^esub> H = H", "apply (rule mr_cos_h_stable[THEN sym],\n        simp add:submodule_def, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mker_of_mpj:\"submodule R M H \\<Longrightarrow>\n                                 ker\\<^bsub>M,(M /\\<^sub>m H)\\<^esub> (mpj M H) = H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    ker\\<^bsub>M,M /\\<^sub>m H\\<^esub> mpj M H = H", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    {a \\<in> carrier M. mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>} =\n    H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M H \\<Longrightarrow>\n    {a \\<in> carrier M. mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}\n    \\<subseteq> H\n 2. submodule R M H \\<Longrightarrow>\n    H \\<subseteq> {a \\<in> carrier M.\n                   mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}", "apply (rule subsetI, simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; x \\<in> carrier M;\n        mpj M H x = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H\n 2. submodule R M H \\<Longrightarrow>\n    H \\<subseteq> {a \\<in> carrier M.\n                   mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}", "apply (simp add:elem_mpj, simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; x \\<in> carrier M;\n        x \\<uplus>\\<^bsub>M\\<^esub> H = H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H\n 2. submodule R M H \\<Longrightarrow>\n    H \\<subseteq> {a \\<in> carrier M.\n                   mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}", "apply (frule_tac m = x in m_in_mr_coset [of H], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; x \\<in> carrier M;\n        x \\<uplus>\\<^bsub>M\\<^esub> H = H;\n        x \\<in> x \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H\n 2. submodule R M H \\<Longrightarrow>\n    H \\<subseteq> {a \\<in> carrier M.\n                   mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M H \\<Longrightarrow>\n    H \\<subseteq> {a \\<in> carrier M.\n                   mpj M H a = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {a \\<in> carrier M.\n                                  mpj M H a =\n                                  \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M \\<and>\n                         mpj M H x = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (simp add:submodule_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> H; H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M \\<and>\n                         mpj M H x = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> H; H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> mpj M H x = \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (subst elem_mpj,\n        simp add:subsetD, simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> H; H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>M\\<^esub> H =\n                         \\<zero>\\<^bsub>M /\\<^sub>m H\\<^esub>", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> H; H \\<subseteq> carrier M; M +> H;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> H \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>M\\<^esub> H = H", "apply (rule mr_cos_h_stable[THEN sym],\n        simp add:submodule_def, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) indmhom1:\"\\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;  H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk> \\<Longrightarrow> \\<exists>!g. g \\<in> (mHom R (M /\\<^sub>m H) N) \\<and> (compos M g (mpj M H)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!g.\n                         g \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n                         compos M g (mpj M H) = f", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g.\n                         g \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n                         compos M g (mpj M H) = f\n 2. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (subgoal_tac \"(\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X)) \\<in> mHom R  (M /\\<^sub>m H) N \\<and> compos M (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X)) (mpj M H) = f\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n     (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n     \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n     compos M (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n      (mpj M H) =\n     f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g.\n                         g \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n                         compos M g (mpj M H) = f\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n                      compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n                      compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 2. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> mHom R (M /\\<^sub>m H) N\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule Module.mHom_test)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module M /\\<^sub>m H\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 4. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 5. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:qmodule_module, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow> carrier N\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule Pi_I)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        x \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H.\n                             f (SOME x. x \\<in> X))\n                          x\n                         \\<in> carrier N\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:qmodule_def, simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> f (SOME x. x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H)\n                         \\<in> carrier N\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:indmhom_someTr2, simp add:mHom_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H))\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI, (rule ballI)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        m \\<in> carrier (M /\\<^sub>m H);\n        n \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H.\n                             f (SOME x. x \\<in> X))\n                          (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> n) =\n                         (\\<lambda>X\\<in>set_mr_cos M H.\n                             f (SOME x. x \\<in> X))\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (\\<lambda>X\\<in>set_mr_cos M H.\n                             f (SOME x. x \\<in> X))\n                          n\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:qmodule_def, simp add:set_mr_cos_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m n a aa.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f; a \\<in> carrier M;\n        m = a \\<uplus>\\<^bsub>M\\<^esub> H; aa \\<in> carrier M;\n        n = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> ((\\<exists>ab\\<in>carrier M.\n                              mr_cospOp M H (a \\<uplus>\\<^bsub>M\\<^esub> H)\n                               (aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                              ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                          f (SOME x.\n                                x \\<in> mr_cospOp M H\n   (a \\<uplus>\\<^bsub>M\\<^esub> H) (aa \\<uplus>\\<^bsub>M\\<^esub> H)) =\n                          f (SOME x.\n                                x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H) \\<plusminus>\\<^bsub>N\\<^esub>\n                          f (SOME x.\n                                x \\<in> aa \\<uplus>\\<^bsub>M\\<^esub> H)) \\<and>\n                         ((\\<forall>ab\\<in>carrier M.\n                              mr_cospOp M H (a \\<uplus>\\<^bsub>M\\<^esub> H)\n                               (aa \\<uplus>\\<^bsub>M\\<^esub> H) \\<noteq>\n                              ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                          undefined =\n                          f (SOME x.\n                                x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H) \\<plusminus>\\<^bsub>N\\<^esub>\n                          f (SOME x.\n                                x \\<in> aa \\<uplus>\\<^bsub>M\\<^esub> H))\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:mr_cospOpTr,\n        frule_tac x = a and y = aa in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m n a aa.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f; a \\<in> carrier M;\n        m = a \\<uplus>\\<^bsub>M\\<^esub> H; aa \\<in> carrier M;\n        n = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<plusminus> aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> ((\\<exists>ab\\<in>carrier M.\n                              (a \\<plusminus>\n                               aa) \\<uplus>\\<^bsub>M\\<^esub> H =\n                              ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                          f (SOME x.\n                                x \\<in> (a \\<plusminus>\n   aa) \\<uplus>\\<^bsub>M\\<^esub> H) =\n                          f (SOME x.\n                                x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H) \\<plusminus>\\<^bsub>N\\<^esub>\n                          f (SOME x.\n                                x \\<in> aa \\<uplus>\\<^bsub>M\\<^esub> H)) \\<and>\n                         ((\\<forall>ab\\<in>carrier M.\n                              (a \\<plusminus>\n                               aa) \\<uplus>\\<^bsub>M\\<^esub> H \\<noteq>\n                              ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                          undefined =\n                          f (SOME x.\n                                x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H) \\<plusminus>\\<^bsub>N\\<^esub>\n                          f (SOME x.\n                                x \\<in> aa \\<uplus>\\<^bsub>M\\<^esub> H))\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:indmhom_someTr2, simp add:mHom_add)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m n a aa.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f; a \\<in> carrier M;\n        m = a \\<uplus>\\<^bsub>M\\<^esub> H; aa \\<in> carrier M;\n        n = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<plusminus> aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>ab\\<in>carrier M.\n                             (a \\<plusminus>\n                              aa) \\<uplus>\\<^bsub>M\\<^esub> H \\<noteq>\n                             ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                         undefined = f a \\<plusminus>\\<^bsub>N\\<^esub> f aa\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule impI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m n a aa.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f; a \\<in> carrier M;\n        m = a \\<uplus>\\<^bsub>M\\<^esub> H; aa \\<in> carrier M;\n        n = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<plusminus> aa \\<in> carrier M;\n        \\<forall>ab\\<in>carrier M.\n           (a \\<plusminus> aa) \\<uplus>\\<^bsub>M\\<^esub> H \\<noteq>\n           ab \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> undefined = f a \\<plusminus>\\<^bsub>N\\<^esub> f aa\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (frule_tac x = \"a \\<plusminus> aa\" in bspec, assumption+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply ((rule ballI)+,\n        simp add:qmodule_def, simp add:set_mr_cos_def, erule bexE, simp,\n        simp add:mr_cos_sprodTr,\n        frule_tac a = a and m = aa in sc_mem, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m aa.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f; a \\<in> carrier R;\n        aa \\<in> carrier M; m = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> ((\\<exists>ab\\<in>carrier M.\n                              a \\<cdot>\\<^sub>s\n                              aa \\<uplus>\\<^bsub>M\\<^esub> H =\n                              ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                          f (SOME x.\n                                x \\<in> a \\<cdot>\\<^sub>s\n  aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          f (SOME x.\n                                x \\<in> aa \\<uplus>\\<^bsub>M\\<^esub> H)) \\<and>\n                         ((\\<forall>ab\\<in>carrier M.\n                              a \\<cdot>\\<^sub>s\n                              aa \\<uplus>\\<^bsub>M\\<^esub> H \\<noteq>\n                              ab \\<uplus>\\<^bsub>M\\<^esub> H) \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          f (SOME x.\n                                x \\<in> aa \\<uplus>\\<^bsub>M\\<^esub> H))\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 3. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (simp add:indmhom_someTr2, simp add:mHom_lin,\n        rule impI,\n        frule_tac x = \"a \\<cdot>\\<^sub>s aa\" in bspec, assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H) =\n                      f\n 2. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule mHom_eq[of N _ f], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> compos M\n                       (\\<lambda>X\\<in>set_mr_cos M H.\n                           f (SOME x. x \\<in> X))\n                       (mpj M H)\n                      \\<in> mHom R M N\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule Module.mHom_compos[of \"M /\\<^sub>m H\" R M N \"mpj M H\" \n         \"\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X)\"])"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module M /\\<^sub>m H\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module M\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> R module N\n 4. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> mpj M H \\<in> mHom R M (M /\\<^sub>m H)\n 5. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> mHom R (M /\\<^sub>m H) N\n 6. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 7. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 8. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (\n        simp add:qmodule_module, rule Module_axioms, assumption,\n        simp add:mpj_mHom)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> mHom R (M /\\<^sub>m H) N\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule Module.mHom_test,\n        simp add:qmodule_module, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI,\n        rule Pi_I,\n        clarsimp simp: qmodule_def set_mr_cos_def indmhom_someTr2 mHom_mem)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_mr_cos M H. f (SOME x. x \\<in> X))\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI,\n       simp add:qmodule_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>n\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (m \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               n) =\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>X\\<in>set_mr_cos M H.\n                                 f (SOME x. x \\<in> X))\n                              m)\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule conjI,\n        (rule ballI)+, simp add:qmodule_def, simp add:set_mr_cos_def,\n        (erule bexE)+, simp add:mr_cospOpTr,\n        frule_tac x = a and y = aa in ag_pOp_closed, assumption+,\n        simp add:indmhom_someTr2 mHom_add,\n        rule impI, \n        frule_tac x = \"a \\<plusminus> aa\" in bspec, assumption, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>X\\<in>set_mr_cos M H.\n                                f (SOME x. x \\<in> X))\n                             m\n 2. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> mHom R M N\n 3. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 4. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply ((rule ballI)+, simp add:qmodule_def set_mr_cos_def, erule bexE, simp,\n        simp add:mr_cos_sprodTr,\n        frule_tac a = a and m = aa in sc_mem, assumption,\n        simp add:indmhom_someTr2 mHom_lin,\n        rule impI,\n        frule_tac x = \"a \\<cdot>\\<^sub>s aa\" in bspec, assumption, simp, \n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M.\n                         compos M\n                          (\\<lambda>X\\<in>set_mr_cos M H.\n                              f (SOME x. x \\<in> X))\n                          (mpj M H) m =\n                         f m\n 2. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule ballI, simp add:compos_def compose_def elem_mpj,\n        simp add:indmhom_someTr2,\n        rule impI, simp add:set_mr_cos_def,\n        frule_tac x = m in bspec, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N \\<and> compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N \\<and>\n        compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N; compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N; compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule_tac f = g and g = y in Module.mHom_eq[of \"M /\\<^sub>m H\" R N],\n        simp add:qmodule_module, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N; compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N; compos M y (mpj M H) = f\\<rbrakk>\n       \\<Longrightarrow> \\<forall>m\\<in>carrier (M /\\<^sub>m H). g m = y m", "apply (rule ballI, simp add:qmodule_def, fold qmodule_def,\n        simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y m a.\n       \\<lbrakk>submodule R M H; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> f;\n        g \\<in> mHom R (M /\\<^sub>m H) N; compos M g (mpj M H) = f;\n        y \\<in> mHom R (M /\\<^sub>m H) N; compos M y (mpj M H) = f;\n        a \\<in> carrier M; m = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> g (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         y (a \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (rotate_tac -3, frule sym, thin_tac \"compos M y (mpj M H) = f\", \n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y m a.\n       \\<lbrakk>a \\<in> carrier M; m = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        submodule R M H; R module N; compos M y (mpj M H) \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> compos M y (mpj M H);\n        g \\<in> mHom R (M /\\<^sub>m H) N;\n        compos M g (mpj M H) = compos M y (mpj M H);\n        y \\<in> mHom R (M /\\<^sub>m H) N; f = compos M y (mpj M H)\\<rbrakk>\n       \\<Longrightarrow> g (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         y (a \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (frule_tac f = \"compos M g (mpj M H)\" and g = \"compos M y (mpj M H)\"\n        and x = a in eq_fun_eq_val,\n        thin_tac \"compos M g (mpj M H) = compos M y (mpj M H)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y m a.\n       \\<lbrakk>a \\<in> carrier M; m = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        submodule R M H; R module N; compos M y (mpj M H) \\<in> mHom R M N;\n        H \\<subseteq> ker\\<^bsub>M,N\\<^esub> compos M y (mpj M H);\n        g \\<in> mHom R (M /\\<^sub>m H) N; y \\<in> mHom R (M /\\<^sub>m H) N;\n        f = compos M y (mpj M H);\n        compos M g (mpj M H) a = compos M y (mpj M H) a\\<rbrakk>\n       \\<Longrightarrow> g (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         y (a \\<uplus>\\<^bsub>M\\<^esub> H)", "apply (simp add:compos_def compose_def elem_mpj)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  mQmp :: \"[('a, 'r, 'm) Module_scheme, 'a set, 'a set] \\<Rightarrow> \n                                                   ('a set \\<Rightarrow> 'a set)\" where\n  \"mQmp M H N = (\\<lambda>X\\<in> set_mr_cos M H. {z. \\<exists> x \\<in> X. \\<exists> y \\<in> N. (y \\<plusminus>\\<^bsub>M\\<^esub> x = z)})\""], ["", "(* H \\<subseteq> N *)"], ["", "abbreviation\n  MQP  (\"(3Mp\\<^bsub>_  _,_\\<^esub>)\" [82,82,83]82) where\n  \"Mp\\<^bsub>M H,N\\<^esub> == mQmp M H N\""], ["", "(* \"\\<lbrakk> R Module M; H \\<subseteq> N \\<rbrakk> \\<Longrightarrow> Mp\\<^bsub>M H,N\\<^esub> \\<in> rHom (M /\\<^sub> m H) (M /\\<^sub>m N)\"  *)"], ["", "lemma (in Module) mQmpTr0:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>  mQmp M H N (m \\<uplus>\\<^bsub>M\\<^esub> H) = m \\<uplus>\\<^bsub>M\\<^esub> N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                       (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<uplus>\\<^bsub>M\\<^esub> N", "apply (frule set_mr_cos_mem [of H m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                       (m \\<uplus>\\<^bsub>M\\<^esub> H) =\n                      m \\<uplus>\\<^bsub>M\\<^esub> N", "apply (simp add:mQmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n                             \\<exists>y\\<in>N. y \\<plusminus> x = z} =\n                      m \\<uplus>\\<^bsub>M\\<^esub> N", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n                             \\<exists>y\\<in>N. y \\<plusminus> x = z}\n                      \\<subseteq> m \\<uplus>\\<^bsub>M\\<^esub> N\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n   \\<exists>y\\<in>N. y \\<plusminus> x = z}", "apply (rule subsetI, simp, (erule bexE)+, rotate_tac -1, frule sym,\n        thin_tac \"y \\<plusminus> xa = x\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        m \\<in> carrier M;\n        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H;\n        xa \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; y \\<in> N;\n        x = y \\<plusminus> xa\\<rbrakk>\n       \\<Longrightarrow> y \\<plusminus> xa\n                         \\<in> m \\<uplus>\\<^bsub>M\\<^esub> N\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n   \\<exists>y\\<in>N. y \\<plusminus> x = z}", "apply (frule_tac x = xa in x_in_mr_coset[of H m], assumption+, erule bexE,\n        rotate_tac -1, frule sym, thin_tac \"m \\<plusminus> h = xa\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        m \\<in> carrier M;\n        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; y \\<in> N;\n        x = y \\<plusminus> (m \\<plusminus> h); h \\<in> H;\n        xa = m \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> y \\<plusminus> (m \\<plusminus> h)\n                         \\<in> m \\<uplus>\\<^bsub>M\\<^esub> N\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n   \\<exists>y\\<in>N. y \\<plusminus> x = z}", "apply (unfold submodule_def, frule conjunct1, rotate_tac 1, frule conjunct1,\n        fold submodule_def,\n        frule_tac c = y in subsetD[of N \"carrier M\"], assumption+,\n        frule_tac c = h in subsetD[of H \"carrier M\"], assumption+,\n        simp add:ag_pOp_assoc[THEN sym],\n        simp add:ag_pOp_commute[of _ m], simp add:ag_pOp_assoc,\n        frule_tac c = h in subsetD[of H N], assumption+,\n        frule_tac h = y and k = h in submodule_pOp_closed[of N], assumption+,\n        frule_tac h1 = \"y \\<plusminus> h\" in mr_cos_h_stable1[THEN sym, of N m], \n        assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>submodule R M N; H \\<subseteq> N; m \\<in> carrier M;\n        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H; y \\<in> N;\n        x = m \\<plusminus> (y \\<plusminus> h); h \\<in> H;\n        xa = m \\<plusminus> h; H \\<subseteq> carrier M; submodule R M H;\n        N \\<subseteq> carrier M; y \\<in> carrier M; h \\<in> carrier M;\n        h \\<in> N; y \\<plusminus> h \\<in> N;\n        m \\<uplus>\\<^bsub>M\\<^esub> N =\n        (m \\<plusminus>\n         (y \\<plusminus> h)) \\<uplus>\\<^bsub>M\\<^esub> N\\<rbrakk>\n       \\<Longrightarrow> m \\<plusminus> (y \\<plusminus> h)\n                         \\<in> (m \\<plusminus>\n                                (y \\<plusminus>\n                                 h)) \\<uplus>\\<^bsub>M\\<^esub> N\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n   \\<exists>y\\<in>N. y \\<plusminus> x = z}", "apply (rule m_in_mr_coset, assumption+,\n        rule ag_pOp_closed, assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n   \\<exists>y\\<in>N. y \\<plusminus> x = z}", "apply (rule subsetI, simp,\n        frule_tac x = x in x_in_mr_coset[of N m], assumption+,\n        erule bexE, frule sym, thin_tac \"m \\<plusminus> h = x\", simp,\n        simp add:submodule_def[of R M N], frule conjunct1, fold submodule_def,\n        frule_tac c = h in subsetD[of N \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        m \\<in> carrier M;\n        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> N; h \\<in> N;\n        x = m \\<plusminus> h; N \\<subseteq> carrier M;\n        h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n                            \\<exists>y\\<in>N.\n                               y \\<plusminus> x = m \\<plusminus> h", "apply (frule_tac m_in_mr_coset[of H m], assumption+,\n        subst ag_pOp_commute[of m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        m \\<in> carrier M;\n        m \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H;\n        m \\<plusminus> h \\<in> m \\<uplus>\\<^bsub>M\\<^esub> N; h \\<in> N;\n        x = m \\<plusminus> h; N \\<subseteq> carrier M; h \\<in> carrier M;\n        m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>m \\<uplus>\\<^bsub>M\\<^esub> H.\n                            \\<exists>y\\<in>N.\n                               y \\<plusminus> x = h \\<plusminus> m", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* show mQmp M H N is a welldefined map from M/H to M/N. step2 *)"], ["", "lemma (in Module) mQmpTr1:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n m \\<in> carrier M; n \\<in> carrier M; m \\<uplus>\\<^bsub>M\\<^esub> H = n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk> \\<Longrightarrow>  m \\<uplus>\\<^bsub>M\\<^esub> N = n \\<uplus>\\<^bsub>M\\<^esub> N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M; n \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H = n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N =\n                      n \\<uplus>\\<^bsub>M\\<^esub> N", "apply (frule_tac m_in_mr_coset [of H m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M; n \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H = n \\<uplus>\\<^bsub>M\\<^esub> H;\n     m \\<in> m \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N =\n                      n \\<uplus>\\<^bsub>M\\<^esub> N", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M; n \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H = n \\<uplus>\\<^bsub>M\\<^esub> H;\n     m \\<in> n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N =\n                      n \\<uplus>\\<^bsub>M\\<^esub> N", "apply (frule_tac x_in_mr_coset [of H n m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     m \\<in> carrier M; n \\<in> carrier M;\n     m \\<uplus>\\<^bsub>M\\<^esub> H = n \\<uplus>\\<^bsub>M\\<^esub> H;\n     m \\<in> n \\<uplus>\\<^bsub>M\\<^esub> H;\n     \\<exists>h\\<in>H. n \\<plusminus> h = m\\<rbrakk>\n    \\<Longrightarrow> m \\<uplus>\\<^bsub>M\\<^esub> N =\n                      n \\<uplus>\\<^bsub>M\\<^esub> N", "apply (erule bexE, rotate_tac -1, frule sym, thin_tac \"n \\<plusminus> h = m\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        n \\<plusminus> h \\<in> carrier M; n \\<in> carrier M;\n        (n \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> H =\n        n \\<uplus>\\<^bsub>M\\<^esub> H;\n        n \\<plusminus> h \\<in> n \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        m = n \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> (n \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> N =\n                         n \\<uplus>\\<^bsub>M\\<^esub> N", "apply (frule_tac c = h in subsetD [of \"H\" \"N\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        n \\<plusminus> h \\<in> carrier M; n \\<in> carrier M;\n        (n \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> H =\n        n \\<uplus>\\<^bsub>M\\<^esub> H;\n        n \\<plusminus> h \\<in> n \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        m = n \\<plusminus> h; h \\<in> N\\<rbrakk>\n       \\<Longrightarrow> (n \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> N =\n                         n \\<uplus>\\<^bsub>M\\<^esub> N", "apply (rule mr_cos_h_stable1[of N n], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mQmpTr2:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N ; \n        X \\<in> carrier (M /\\<^sub>m H)\\<rbrakk> \\<Longrightarrow> (mQmp M H N) X \\<in> carrier (M /\\<^sub>m N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     X \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) X\n                      \\<in> carrier (M /\\<^sub>m N)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     X \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) X \\<in> set_mr_cos M N", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     \\<exists>a\\<in>carrier M. X = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>carrier M.\n                         (Mp\\<^bsub>M  H,N\\<^esub>) X =\n                         a \\<uplus>\\<^bsub>M\\<^esub> N", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                            aa \\<uplus>\\<^bsub>M\\<^esub> N", "apply (frule_tac m = a in mQmpTr0 [of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        (Mp\\<^bsub>M  H,N\\<^esub>) (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n        a \\<uplus>\\<^bsub>M\\<^esub> N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier M.\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                            aa \\<uplus>\\<^bsub>M\\<^esub> N", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mQmpTr2_1:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N \\<rbrakk>\n \\<Longrightarrow> mQmp M H N \\<in> carrier (M /\\<^sub>m H) \\<rightarrow> carrier (M /\\<^sub>m N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m N)", "by (simp add:mQmpTr2)"], ["", "lemma (in Module) mQmpTr3:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N ; \nX \\<in> carrier (M /\\<^sub>m H); Y \\<in> carrier (M /\\<^sub>m H)\\<rbrakk> \\<Longrightarrow> (mQmp M H N) (mr_cospOp M H X Y) = mr_cospOp M N ((mQmp M H N) X) ((mQmp M H N) Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     X \\<in> carrier (M /\\<^sub>m H);\n     Y \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) (mr_cospOp M H X Y) =\n                      mr_cospOp M N ((Mp\\<^bsub>M  H,N\\<^esub>) X)\n                       ((Mp\\<^bsub>M  H,N\\<^esub>) Y)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     X \\<in> set_mr_cos M H; Y \\<in> set_mr_cos M H\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) (mr_cospOp M H X Y) =\n                      mr_cospOp M N ((Mp\\<^bsub>M  H,N\\<^esub>) X)\n                       ((Mp\\<^bsub>M  H,N\\<^esub>) Y)", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     \\<exists>a\\<in>carrier M. X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n     \\<exists>a\\<in>carrier M. Y = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n    \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) (mr_cospOp M H X Y) =\n                      mr_cospOp M N ((Mp\\<^bsub>M  H,N\\<^esub>) X)\n                       ((Mp\\<^bsub>M  H,N\\<^esub>) Y)", "apply ((erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        aa \\<in> carrier M; Y = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (mr_cospOp M H (a \\<uplus>\\<^bsub>M\\<^esub> H)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H)) =\n                         mr_cospOp M N\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (a \\<uplus>\\<^bsub>M\\<^esub> H))\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (simp add:mr_cospOpTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        aa \\<in> carrier M; Y = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          ((a \\<plusminus>\n                            aa) \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M N\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (a \\<uplus>\\<^bsub>M\\<^esub> H))\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (frule_tac x = a and y = aa in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        aa \\<in> carrier M; Y = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<plusminus> aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          ((a \\<plusminus>\n                            aa) \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cospOp M N\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (a \\<uplus>\\<^bsub>M\\<^esub> H))\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (subst mQmpTr0, assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        aa \\<in> carrier M; Y = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<plusminus> aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus> aa) \\<uplus>\\<^bsub>M\\<^esub> N =\n                         mr_cospOp M N (a \\<uplus>\\<^bsub>M\\<^esub> N)\n                          (aa \\<uplus>\\<^bsub>M\\<^esub> N)", "apply (subst mr_cospOpTr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; X = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        aa \\<in> carrier M; Y = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<plusminus> aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus> aa) \\<uplus>\\<^bsub>M\\<^esub> N =\n                         (a \\<plusminus> aa) \\<uplus>\\<^bsub>M\\<^esub> N", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mQmpTr4:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n                            a \\<in> N\\<rbrakk> \\<Longrightarrow> mr_coset a (mdl M N) H = mr_coset a M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     a \\<in> N\\<rbrakk>\n    \\<Longrightarrow> mr_coset a (mdl M N) H = mr_coset a M H", "apply (simp add:mr_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     a \\<in> N\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H =\n                      a \\<uplus>\\<^bsub>M\\<^esub> H", "apply (unfold submodule_def[of R M N], frule conjunct1, fold submodule_def,\n        frule subsetD[of N \"carrier M\" a], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H =\n                      a \\<uplus>\\<^bsub>M\\<^esub> H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule mdl_is_module[of N])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule_tac x = x in Module.x_in_mr_coset[of \"mdl M N\" R H a])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> submodule R (mdl M N) H\n 2. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (mdl M N)\n 3. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 4. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        \\<exists>h\\<in>H.\n           a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 5. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (simp add:submodule_of_mdl)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (mdl M N)\n 2. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 3. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        \\<exists>h\\<in>H.\n           a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 4. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        \\<exists>h\\<in>H.\n           a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 3. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        \\<exists>h\\<in>H.\n           a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        h \\<in> H; a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (unfold submodule_def[of R M H], frule conjunct1, fold submodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        h \\<in> H; a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x;\n        H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule_tac c = h in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H; R module mdl M N;\n        h \\<in> H; a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h = x;\n        H \\<subseteq> carrier M; h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (thin_tac \"x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\", thin_tac \"R module mdl M N\",\n        simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M; h \\<in> H;\n        a \\<plusminus> h = x; H \\<subseteq> carrier M;\n        h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule sym, thin_tac \"a \\<plusminus> h = x\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M; h \\<in> H;\n        H \\<subseteq> carrier M; h \\<in> carrier M;\n        x = a \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (subst mr_cos_h_stable1[THEN sym, of H a], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M; h \\<in> H;\n        H \\<subseteq> carrier M; h \\<in> carrier M;\n        x = a \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> (a \\<plusminus>\n                                h) \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule_tac x = a and y = h in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M; h \\<in> H;\n        H \\<subseteq> carrier M; h \\<in> carrier M; x = a \\<plusminus> h;\n        a \\<plusminus> h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> (a \\<plusminus>\n                                h) \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (rule m_in_mr_coset, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N; a \\<in> N;\n     N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                      \\<subseteq> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule_tac x = x in x_in_mr_coset[of H a], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        x \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H;\n        \\<exists>h\\<in>H. a \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (erule bexE, frule sym, thin_tac \"a \\<plusminus> h = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule mdl_is_module[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule submodule_of_mdl[of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N;\n        submodule R (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (subst Module.mr_cos_h_stable1[THEN sym, of \"mdl M N\" R H a],\n         assumption+, simp add:mdl_carrier, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N;\n        submodule R (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h\n                         \\<in> (a \\<plusminus>\\<^bsub>mdl M N\\<^esub>\n                                h) \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (subgoal_tac \"a \\<plusminus> h = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\n        \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H;\n        h \\<in> H; x = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h;\n        R module mdl M N; submodule R (mdl M N) H;\n        a \\<plusminus> h = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\n                         \\<in> (a \\<plusminus>\\<^bsub>mdl M N\\<^esub>\n                                h) \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N;\n        submodule R (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h =\n                         a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h", "apply (rule Module.m_in_mr_coset[of \"mdl M N\" R H], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\n        \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H;\n        h \\<in> H; x = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h;\n        R module mdl M N; submodule R (mdl M N) H;\n        a \\<plusminus> h = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\n                         \\<in> carrier (mdl M N)\n 2. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N;\n        submodule R (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h =\n                         a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h", "apply (frule Module.module_is_ag[of \"mdl M N\" R])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\n        \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H;\n        h \\<in> H; x = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h;\n        R module mdl M N; submodule R (mdl M N) H;\n        a \\<plusminus> h = a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h;\n        aGroup (mdl M N)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h\n                         \\<in> carrier (mdl M N)\n 2. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N;\n        submodule R (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h =\n                         a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h", "apply (rule aGroup.ag_pOp_closed, assumption,\n        simp add:mdl_carrier, simp add:mdl_carrier subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; N \\<subseteq> carrier M; a \\<in> carrier M;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>M\\<^esub> H; h \\<in> H;\n        x = a \\<plusminus> h; R module mdl M N;\n        submodule R (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h =\n                         a \\<plusminus>\\<^bsub>mdl M N\\<^esub> h", "apply (subst mdl_def, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mQmp_mHom:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow>\n                  (Mp\\<^bsub>M H,N\\<^esub>) \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m H) (M /\\<^sub>m N) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                             (Mp\\<^bsub>M  H,N\\<^esub>)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                             (Mp\\<^bsub>M  H,N\\<^esub>) m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m H) (M /\\<^sub>m N)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m N) \\<and>\n                      Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>a\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>b\\<in>carrier (M /\\<^sub>m H).\n                             (Mp\\<^bsub>M  H,N\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               b) =\n                             (Mp\\<^bsub>M  H,N\\<^esub>)\n                              a \\<plusminus>\\<^bsub>M /\\<^sub>m N\\<^esub>\n                             (Mp\\<^bsub>M  H,N\\<^esub>) b)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (simp add:mQmpTr2_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> extensional (carrier (M /\\<^sub>m H)) \\<and>\n                      (\\<forall>a\\<in>carrier (M /\\<^sub>m H).\n                          \\<forall>b\\<in>carrier (M /\\<^sub>m H).\n                             (Mp\\<^bsub>M  H,N\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                               b) =\n                             (Mp\\<^bsub>M  H,N\\<^esub>)\n                              a \\<plusminus>\\<^bsub>M /\\<^sub>m N\\<^esub>\n                             (Mp\\<^bsub>M  H,N\\<^esub>) b)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> extensional (carrier (M /\\<^sub>m H))\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (M /\\<^sub>m H).\n                         \\<forall>b\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              b) =\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             a \\<plusminus>\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) b\n 3. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (simp add:mQmp_def extensional_def qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (M /\\<^sub>m H).\n                         \\<forall>b\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              b) =\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             a \\<plusminus>\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) b\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (M /\\<^sub>m H);\n        b \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b) =\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          a \\<plusminus>\\<^bsub>M /\\<^sub>m N\\<^esub>\n                         (Mp\\<^bsub>M  H,N\\<^esub>) b\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (frule_tac X1 = a and Y1 = b in mQmpTr3 [THEN sym, of H N],\n                                               assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (M /\\<^sub>m H); b \\<in> carrier (M /\\<^sub>m H);\n        mr_cospOp M N ((Mp\\<^bsub>M  H,N\\<^esub>) a)\n         ((Mp\\<^bsub>M  H,N\\<^esub>) b) =\n        (Mp\\<^bsub>M  H,N\\<^esub>) (mr_cospOp M H a b)\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>M /\\<^sub>m H\\<^esub> b) =\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          a \\<plusminus>\\<^bsub>M /\\<^sub>m N\\<^esub>\n                         (Mp\\<^bsub>M  H,N\\<^esub>) b\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; m \\<in> carrier (M /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m H\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M /\\<^sub>m N\\<^esub>\n                         (Mp\\<^bsub>M  H,N\\<^esub>) m", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; m \\<in> set_mr_cos M H\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) (mr_cos_sprod M H a m) =\n                         mr_cos_sprod M N a ((Mp\\<^bsub>M  H,N\\<^esub>) m)", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R;\n        \\<exists>a\\<in>carrier M. m = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>) (mr_cos_sprod M H a m) =\n                         mr_cos_sprod M N a ((Mp\\<^bsub>M  H,N\\<^esub>) m)", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (mr_cos_sprod M H a\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H)) =\n                         mr_cos_sprod M N a\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (subst mr_cos_sprodTr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<cdot>\\<^sub>s\n                           aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cos_sprod M N a\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (frule_tac a = a and m = aa in sc_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<cdot>\\<^sub>s\n                           aa \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         mr_cos_sprod M N a\n                          ((Mp\\<^bsub>M  H,N\\<^esub>)\n                            (aa \\<uplus>\\<^bsub>M\\<^esub> H))", "apply (simp add:mQmpTr0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s aa \\<uplus>\\<^bsub>M\\<^esub> N =\n                         mr_cos_sprod M N a (aa \\<uplus>\\<^bsub>M\\<^esub> N)", "apply (subst mr_cos_sprodTr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m aa.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier R; aa \\<in> carrier M;\n        m = aa \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<cdot>\\<^sub>s aa \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s aa \\<uplus>\\<^bsub>M\\<^esub> N =\n                         a \\<cdot>\\<^sub>s aa \\<uplus>\\<^bsub>M\\<^esub> N", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Mp_surjec:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> \n                surjec\\<^bsub>(M /\\<^sub>m H),(M /\\<^sub>m N)\\<^esub> (Mp\\<^bsub>M H,N\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m\n                                    H,M /\\<^sub>m\nN\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m H) (M /\\<^sub>m N) \\<and>\n                      surj_to (Mp\\<^bsub>M  H,N\\<^esub>)\n                       (carrier (M /\\<^sub>m H)) (carrier (M /\\<^sub>m N))", "apply (frule mQmp_mHom [of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m H) (M /\\<^sub>m N) \\<and>\n                      surj_to (Mp\\<^bsub>M  H,N\\<^esub>)\n                       (carrier (M /\\<^sub>m H)) (carrier (M /\\<^sub>m N))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> aHom (M /\\<^sub>m H) (M /\\<^sub>m N)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> surj_to (Mp\\<^bsub>M  H,N\\<^esub>)\n                       (carrier (M /\\<^sub>m H)) (carrier (M /\\<^sub>m N))", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> surj_to (Mp\\<^bsub>M  H,N\\<^esub>)\n                       (carrier (M /\\<^sub>m H)) (carrier (M /\\<^sub>m N))", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> Mp\\<^bsub>M  H,N\\<^esub>\n                      \\<in> carrier (M /\\<^sub>m H) \\<rightarrow>\n                            carrier (M /\\<^sub>m N)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier (M /\\<^sub>m N).\n                         \\<exists>a\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>) a = b", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier (M /\\<^sub>m N).\n                         \\<exists>a\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>) a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        Mp\\<^bsub>M  H,N\\<^esub>\n        \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n        b \\<in> carrier (M /\\<^sub>m N)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>) a = b", "apply (thin_tac \"Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        b \\<in> carrier (M /\\<^sub>m N)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (M /\\<^sub>m H).\n                            (Mp\\<^bsub>M  H,N\\<^esub>) a = b", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        b \\<in> set_mr_cos M N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>set_mr_cos M H.\n                            (Mp\\<^bsub>M  H,N\\<^esub>) a = b", "apply (simp add:set_mr_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; b = a \\<uplus>\\<^bsub>M\\<^esub> N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa.\n                            (\\<exists>a\\<in>carrier M.\n                                aa = a \\<uplus>\\<^bsub>M\\<^esub> H) \\<and>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) aa =\n                            a \\<uplus>\\<^bsub>M\\<^esub> N", "apply (frule_tac m = a in mQmpTr0 [of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier M; b = a \\<uplus>\\<^bsub>M\\<^esub> N;\n        (Mp\\<^bsub>M  H,N\\<^esub>) (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n        a \\<uplus>\\<^bsub>M\\<^esub> N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa.\n                            (\\<exists>a\\<in>carrier M.\n                                aa = a \\<uplus>\\<^bsub>M\\<^esub> H) \\<and>\n                            (Mp\\<^bsub>M  H,N\\<^esub>) aa =\n                            a \\<uplus>\\<^bsub>M\\<^esub> N", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) kerQmp:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \n \\<Longrightarrow> ker\\<^bsub>(M /\\<^sub>m H),(M /\\<^sub>m N)\\<^esub> (Mp\\<^bsub>M H,N\\<^esub>) = carrier ((mdl M N) /\\<^sub>m H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>M /\\<^sub>m\n                                 H,M /\\<^sub>m\n                                   N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>) =\n                      carrier (mdl M N /\\<^sub>m H)", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier (M /\\<^sub>m H).\n                       (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                       \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>} =\n                      carrier (mdl M N /\\<^sub>m H)", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier (M /\\<^sub>m H).\n                       (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                       \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> {a \\<in> carrier (M /\\<^sub>m H).\n                 (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                 \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (mdl M N /\\<^sub>m H)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (simp add:CollectI, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> carrier (M /\\<^sub>m H);\n        (Mp\\<^bsub>M  H,N\\<^esub>) x =\n        \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (mdl M N /\\<^sub>m H)\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> set_mr_cos M H; (Mp\\<^bsub>M  H,N\\<^esub>) x = N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> set_mr_cos (mdl M N) H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (simp add:set_mr_cos_def [of \"mdl M N\" \"H\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> set_mr_cos M H; (Mp\\<^bsub>M  H,N\\<^esub>) x = N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M N).\n                            x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        \\<exists>a\\<in>carrier M. x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        (Mp\\<^bsub>M  H,N\\<^esub>) x = N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M N).\n                            x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        (Mp\\<^bsub>M  H,N\\<^esub>) (a \\<uplus>\\<^bsub>M\\<^esub> H) = N;\n        a \\<in> carrier M; x = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier (mdl M N).\n                            a \\<uplus>\\<^bsub>M\\<^esub> H =\n                            aa \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (simp add:mQmpTr0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<uplus>\\<^bsub>M\\<^esub> N = N; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier (mdl M N).\n                            a \\<uplus>\\<^bsub>M\\<^esub> H =\n                            aa \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (frule_tac m = a in m_in_mr_coset[of N], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<uplus>\\<^bsub>M\\<^esub> N = N; a \\<in> carrier M;\n        x = a \\<uplus>\\<^bsub>M\\<^esub> H; a \\<in> N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier (mdl M N).\n                            a \\<uplus>\\<^bsub>M\\<^esub> H =\n                            aa \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (frule_tac a = a in mQmpTr4[of H N], assumption+,\n        simp add:mr_coset_def,\n        rotate_tac -1, frule sym,thin_tac \"a \\<uplus>\\<^bsub>mdl M N\\<^esub> H = a \\<uplus>\\<^bsub>M\\<^esub> H\",\n        simp only:mdl_carrier, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> {a \\<in> carrier (M /\\<^sub>m H).\n                                   (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                   \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> carrier (mdl M N /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {a \\<in> carrier (M /\\<^sub>m H).\n                                  (Mp\\<^bsub>M  H,N\\<^esub>) a =\n                                  \\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> set_mr_cos (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>) x = N", "apply (simp add:set_mr_cos_def [of \"mdl M N\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        \\<exists>a\\<in>carrier (mdl M N).\n           x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>) x = N", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N);\n        x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n                         \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>mdl M N\\<^esub> H) =\n                         N", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n                         \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>mdl M N\\<^esub> H) =\n                         N", "apply (frule_tac a = a in mQmpTr4[of H N], assumption+,\n         simp add:mr_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<uplus>\\<^bsub>mdl M N\\<^esub> H =\n        a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                         \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         N", "apply (thin_tac \"a \\<uplus>\\<^bsub>mdl M N\\<^esub> H = a \\<uplus>\\<^bsub>M\\<^esub> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                         \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         N", "apply (unfold submodule_def[of R M N], frule conjunct1, fold submodule_def,\n        frule_tac c = a in subsetD[of N \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                         \\<in> set_mr_cos M H \\<and>\n                         (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         N", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H \\<in> set_mr_cos M H\n 2. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         N", "apply (simp add:set_mr_cos_def, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (Mp\\<^bsub>M  H,N\\<^esub>)\n                          (a \\<uplus>\\<^bsub>M\\<^esub> H) =\n                         N", "apply (simp add:mQmpTr0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> N; x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        N \\<subseteq> carrier M; a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> N = N", "apply (simp add:mr_cos_h_stable [THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) misom2Tr:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> \n            (M /\\<^sub>m H) /\\<^sub>m (carrier ((mdl M N) /\\<^sub>m H)) \\<cong>\\<^bsub>R\\<^esub> (M /\\<^sub>m N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (frule mQmp_mHom [of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (frule qmodule_module [of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (frule qmodule_module [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "thm Module.indmhom"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (frule Module.indmhom [of \"M /\\<^sub>m H\" R \"M /\\<^sub>m N\" \"Mp\\<^bsub>M H,N\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R\n            (M /\\<^sub>m H /\\<^sub>m\n             (ker\\<^bsub>M /\\<^sub>m\n                         H,M /\\<^sub>m\n                           N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (simp add:kerQmp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (subgoal_tac \"bijec\\<^bsub>((M /\\<^sub>m H) /\\<^sub>m (carrier((mdl M N) /\\<^sub>m H))),(M /\\<^sub>m N)\n\\<^esub> (indmhom R (M /\\<^sub>m H) (M /\\<^sub>m N) (mQmp M H N))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N);\n     bijec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                  carrier\n                   (mdl M N /\\<^sub>m\n                    H),M /\\<^sub>m\n                       N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n       H, M /\\<^sub>m N\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      carrier\n                       (mdl M N /\\<^sub>m\n                        H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                   carrier\n                                    (mdl M N /\\<^sub>m\n                                     H),M /\\<^sub>m\n  N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                        H, M /\\<^sub>m N\\<^esub>", "apply (simp add:misomorphic_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N);\n     bijec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                  carrier\n                   (mdl M N /\\<^sub>m\n                    H),M /\\<^sub>m\n                       N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n       H, M /\\<^sub>m N\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R\n                                  (M /\\<^sub>m H /\\<^sub>m\n                                   carrier (mdl M N /\\<^sub>m H))\n                                  (M /\\<^sub>m N) \\<and>\n                         bijec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\ncarrier (mdl M N /\\<^sub>m H),M /\\<^sub>m N\\<^esub> f\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                   carrier\n                                    (mdl M N /\\<^sub>m\n                                     H),M /\\<^sub>m\n  N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                        H, M /\\<^sub>m N\\<^esub>", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                   carrier\n                                    (mdl M N /\\<^sub>m\n                                     H),M /\\<^sub>m\n  N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                        H, M /\\<^sub>m N\\<^esub>", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                   carrier\n                                    (mdl M N /\\<^sub>m\n                                     H),M /\\<^sub>m\n  N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                        H, M /\\<^sub>m N\\<^esub> \\<and>\n                      surjec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                    carrier\n                                     (mdl M N /\\<^sub>m\nH),M /\\<^sub>m\n   N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                         H, M /\\<^sub>m N\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                   carrier\n                                    (mdl M N /\\<^sub>m\n                                     H),M /\\<^sub>m\n  N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                        H, M /\\<^sub>m N\\<^esub>\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                    carrier\n                                     (mdl M N /\\<^sub>m\nH),M /\\<^sub>m\n   N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                         H, M /\\<^sub>m N\\<^esub>", "apply (simp add:kerQmp [THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R\n            (M /\\<^sub>m H /\\<^sub>m\n             (ker\\<^bsub>M /\\<^sub>m\n                         H,M /\\<^sub>m\n                           N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                   (ker\\<^bsub>M /\\<^sub>m\n         H,M /\\<^sub>m\n           N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)),M /\\<^sub>m\n           N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                                 H, M /\\<^sub>m N\\<^esub>\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                    carrier\n                                     (mdl M N /\\<^sub>m\nH),M /\\<^sub>m\n   N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                         H, M /\\<^sub>m N\\<^esub>", "apply (rule Module.indmhom_injec [of \"M /\\<^sub>m H\" R \"M /\\<^sub>m N\" \"Mp\\<^bsub>M H,N\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                    carrier\n                                     (mdl M N /\\<^sub>m\nH),M /\\<^sub>m\n   N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                         H, M /\\<^sub>m N\\<^esub>", "apply (frule Mp_surjec [of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R (M /\\<^sub>m H /\\<^sub>m carrier (mdl M N /\\<^sub>m H))\n            (M /\\<^sub>m N);\n     surjec\\<^bsub>M /\\<^sub>m\n                   H,M /\\<^sub>m\n                     N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                    carrier\n                                     (mdl M N /\\<^sub>m\nH),M /\\<^sub>m\n   N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                         H, M /\\<^sub>m N\\<^esub>", "apply (simp add:kerQmp [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     Mp\\<^bsub>M  H,N\\<^esub> \\<in> mHom R (M /\\<^sub>m H) (M /\\<^sub>m N);\n     R module M /\\<^sub>m H; R module M /\\<^sub>m N;\n     (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                 H, M /\\<^sub>m N\\<^esub>\n     \\<in> mHom R\n            (M /\\<^sub>m H /\\<^sub>m\n             (ker\\<^bsub>M /\\<^sub>m\n                         H,M /\\<^sub>m\n                           N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)))\n            (M /\\<^sub>m N);\n     surjec\\<^bsub>M /\\<^sub>m\n                   H,M /\\<^sub>m\n                     N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M /\\<^sub>m H /\\<^sub>m\n                                    (ker\\<^bsub>M /\\<^sub>m\n          H,M /\\<^sub>m\n            N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)),M /\\<^sub>m\n            N\\<^esub> (Mp\\<^bsub>M  H,N\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R M /\\<^sub>m\n                                  H, M /\\<^sub>m N\\<^esub>", "apply (rule Module.indmhom_surjec1, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) eq_class_of_Submodule:\"\\<lbrakk>submodule R M H; submodule R M N; \n         H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> carrier ((mdl M N) /\\<^sub>m H) = N \\<^sub>s/\\<^sub>M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H) = N \\<^sub>s/\\<^sub>M H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> carrier (mdl M N /\\<^sub>m H)\n                      \\<subseteq> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> carrier (mdl M N /\\<^sub>m H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> set_mr_cos (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        \\<exists>a\\<in>carrier (mdl M N).\n           x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N);\n        x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n                         \\<in> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (frule_tac a = a in mQmpTr4 [of H N], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N);\n        x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<in> N\n 2. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N); x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        mr_coset a (mdl M N) H = mr_coset a M H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n                         \\<in> N \\<^sub>s/\\<^sub>M H\n 3. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N); x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        mr_coset a (mdl M N) H = mr_coset a M H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>mdl M N\\<^esub> H\n                         \\<in> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:mr_coset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N); x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<uplus>\\<^bsub>mdl M N\\<^esub> H =\n        a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>M\\<^esub> H\n                         \\<in> N \\<^sub>s/\\<^sub>M H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:sub_mr_set_cos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        a \\<in> carrier (mdl M N); x = a \\<uplus>\\<^bsub>M\\<^esub> H;\n        a \\<uplus>\\<^bsub>mdl M N\\<^esub> H =\n        a \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n\\<in>N.\n                            a \\<uplus>\\<^bsub>M\\<^esub> H =\n                            n \\<uplus>\\<^bsub>M\\<^esub> H\n 2. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:mdl_carrier, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> N \\<^sub>s/\\<^sub>M H\n                      \\<subseteq> carrier (mdl M N /\\<^sub>m H)", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> N \\<^sub>s/\\<^sub>M H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (mdl M N /\\<^sub>m H)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> N \\<^sub>s/\\<^sub>M H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> set_mr_cos (mdl M N) H", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        x \\<in> N \\<^sub>s/\\<^sub>M H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M N).\n                            x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (simp add:sub_mr_set_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        \\<exists>n\\<in>N. x = n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M N).\n                            x = a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (erule bexE, simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        n \\<in> N; x = n \\<uplus>\\<^bsub>M\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>N.\n                            n \\<uplus>\\<^bsub>M\\<^esub> H =\n                            a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (frule_tac a1 = n in mQmpTr4[THEN sym, of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        n \\<in> N; x = n \\<uplus>\\<^bsub>M\\<^esub> H;\n        mr_coset n M H = mr_coset n (mdl M N) H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>N.\n                            n \\<uplus>\\<^bsub>M\\<^esub> H =\n                            a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply (simp add:mr_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n        n \\<in> N; x = n \\<uplus>\\<^bsub>mdl M N\\<^esub> H;\n        n \\<uplus>\\<^bsub>M\\<^esub> H =\n        n \\<uplus>\\<^bsub>mdl M N\\<^esub> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>N.\n                            n \\<uplus>\\<^bsub>mdl M N\\<^esub> H =\n                            a \\<uplus>\\<^bsub>mdl M N\\<^esub> H", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "theorem (in Module) misom2:\"\\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow> \n                           (M /\\<^sub>m H) /\\<^sub>m (N \\<^sub>s/\\<^sub>M H) \\<cong>\\<^bsub>R\\<^esub> (M /\\<^sub>m N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      (N \\<^sub>s/\\<^sub>M\n                          H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (frule misom2Tr [of H N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M N; H \\<subseteq> N;\n     M /\\<^sub>m H /\\<^sub>m\n     carrier\n      (mdl M N /\\<^sub>m H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m H /\\<^sub>m\n                      (N \\<^sub>s/\\<^sub>M\n                          H) \\<cong>\\<^bsub>R\\<^esub> M /\\<^sub>m N", "apply (simp add:eq_class_of_Submodule)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "primrec natm :: \"('a, 'm) aGroup_scheme  => nat \\<Rightarrow> 'a  => 'a\"\nwhere\n  natm_0:  \"natm M 0 x = \\<zero>\\<^bsub>M\\<^esub>\"\n| natm_Suc:  \"natm M (Suc n) x = (natm M n x) \\<plusminus>\\<^bsub>M\\<^esub> x\""], ["", "definition\n  finitesum_base :: \"[('a, 'r, 'm) Module_scheme, 'b set, 'b \\<Rightarrow> 'a set]\n                      \\<Rightarrow> 'a set \" where\n  \"finitesum_base M I f = \\<Union>{f i | i. i \\<in> I}\""], ["", "definition\n  finitesum :: \"[('a, 'r, 'm) Module_scheme, 'b set, 'b \\<Rightarrow> 'a set]\n                      \\<Rightarrow> 'a set \" where\n  \"finitesum M I f = {x. \\<exists>n. \\<exists>g. g \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> finitesum_base M I f\n                                           \\<and> x =  nsum M g n}\""], ["", "lemma (in Module) finitesumbase_sub_carrier:\"f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n             finitesum_base M I f \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n    finitesum_base M I f \\<subseteq> carrier M", "apply (simp add:finitesum_base_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n    \\<Union> {f i |i. i \\<in> I} \\<subseteq> carrier M", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        x \\<in> \\<Union> {f i |i. i \\<in> I}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        \\<exists>xa.\n           (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (erule exE, erule conjE, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; x \\<in> xa;\n        xa = f i; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (frule_tac x = i in funcset_mem[of f I \"{X. submodule R M X}\"], \n         assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; x \\<in> f i;\n        xa = f i; i \\<in> I; submodule R M (f i)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (thin_tac \"f \\<in> I \\<rightarrow> {X. submodule R M X}\", unfold submodule_def,\n        frule conjunct1, fold submodule_def, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_sub_carrier:\"f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n                       finitesum M I f \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> I \\<rightarrow> {X. submodule R M X} \\<Longrightarrow>\n    finitesum M I f \\<subseteq> carrier M", "apply (rule subsetI, simp add:finitesum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        \\<exists>n g.\n           g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f \\<and>\n           x = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply ((erule exE)+, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        x = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M g n \\<in> carrier M", "apply (frule finitesumbase_sub_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        x = \\<Sigma>\\<^sub>e M g n;\n        finitesum_base M I f \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M g n \\<in> carrier M", "apply (rule nsum_mem, rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n g j.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        x = \\<Sigma>\\<^sub>e M g n;\n        finitesum_base M I f \\<subseteq> carrier M; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g j \\<in> carrier M", "apply (frule_tac x = j and f = g and A = \"{j. j \\<le> n}\" and\n        B = \"finitesum_base M I f\" in funcset_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n g j.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        x = \\<Sigma>\\<^sub>e M g n;\n        finitesum_base M I f \\<subseteq> carrier M; j \\<le> n;\n        g j \\<in> finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> g j \\<in> carrier M", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_inc_zero:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}\\<rbrakk>\n      \\<Longrightarrow>   \\<zero> \\<in> finitesum M I f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> finitesum M I f", "apply (simp add:finitesum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n g.\n                         g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 finitesum_base M I f \\<and>\n                         \\<zero> = \\<Sigma>\\<^sub>e M g n", "apply (frule nonempty_ex)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     \\<exists>x. x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n g.\n                         g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 finitesum_base M I f \\<and>\n                         \\<zero> = \\<Sigma>\\<^sub>e M g n", "apply (subgoal_tac \"\\<forall>i. i\\<in>I \\<longrightarrow> (\\<exists>n g. g \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \n                    finitesum_base M I f \\<and> \\<zero>\\<^bsub>M\\<^esub> = \\<Sigma>\\<^sub>e M g n)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     \\<exists>x. x \\<in> I;\n     \\<forall>i.\n        i \\<in> I \\<longrightarrow>\n        (\\<exists>n g.\n            g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f \\<and>\n            \\<zero> = \\<Sigma>\\<^sub>e M g n)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n g.\n                         g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 finitesum_base M I f \\<and>\n                         \\<zero> = \\<Sigma>\\<^sub>e M g n\n 2. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     \\<exists>x. x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                         i \\<in> I \\<longrightarrow>\n                         (\\<exists>n g.\n                             g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                             \\<zero> = \\<Sigma>\\<^sub>e M g n)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     \\<exists>x. x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                         i \\<in> I \\<longrightarrow>\n                         (\\<exists>n g.\n                             g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                             \\<zero> = \\<Sigma>\\<^sub>e M g n)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            \\<zero> = \\<Sigma>\\<^sub>e M g n", "apply (subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> (0::nat)}. \\<zero>) \\<in> \n                    {j. j \\<le> (0::nat)} \\<rightarrow> finitesum_base M I f \\<and>\n                    \\<zero>\\<^bsub>M\\<^esub> = \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> (0::nat)}. \\<zero>) 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I;\n        (\\<lambda>x\\<in>{j. j \\<le> 0}. \\<zero>)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> finitesum_base M I f \\<and>\n        \\<zero> =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n                               \\<zero>) 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            \\<zero> = \\<Sigma>\\<^sub>e M g n\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> 0}. \\<zero>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow>\n                               finitesum_base M I f \\<and>\n                         \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> 0}. \\<zero>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow>\n                               finitesum_base M I f \\<and>\n                         \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> 0}. \\<zero>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow>\n                               finitesum_base M I f\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I; x \\<in> {j. j \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> 0}. \\<zero>) x\n                         \\<in> finitesum_base M I f\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply (simp add:finitesum_base_def, thin_tac \"\\<exists>x. x \\<in> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        i \\<in> I; x = 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i. x = f i \\<and> i \\<in> I) \\<and>\n                            \\<zero> \\<in> x\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply (frule_tac x = i in funcset_mem[of f I \"{X. submodule R M X}\"], \n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        i \\<in> I; x = 0; f i \\<in> {X. submodule R M X}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i. x = f i \\<and> i \\<in> I) \\<and>\n                            \\<zero> \\<in> x\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply (frule_tac x = i in funcset_mem [of \"f\" \"I\" \"{X. submodule R M X}\"],\n                                              assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        i \\<in> I; x = 0; submodule R M (f i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i. x = f i \\<and> i \\<in> I) \\<and>\n                            \\<zero> \\<in> x\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply (frule_tac H = \"f i\" in submodule_inc_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        i \\<in> I; x = 0; submodule R M (f i); \\<zero> \\<in> f i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i. x = f i \\<and> i \\<in> I) \\<and>\n                            \\<zero> \\<in> x\n 2. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        \\<exists>x. x \\<in> I; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> 0}.\n          \\<zero>) 0", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_mOp_closed:\n     \"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}; a \\<in> finitesum M I f\\<rbrakk> \\<Longrightarrow>\n                  -\\<^sub>a a \\<in> finitesum M I f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     a \\<in> finitesum M I f\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> finitesum M I f", "apply (simp add:finitesum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     \\<exists>n g.\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f \\<and>\n        a = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n g.\n                         g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 finitesum_base M I f \\<and>\n                         -\\<^sub>a a = \\<Sigma>\\<^sub>e M g n", "apply ((erule exE)+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            -\\<^sub>a a = \\<Sigma>\\<^sub>e M g n", "apply (frule finitesumbase_sub_carrier [of f I])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        finitesum_base M I f \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            -\\<^sub>a a = \\<Sigma>\\<^sub>e M g n", "apply (frule_tac f = g and A = \"{j. j \\<le> n}\" and B = \"finitesum_base M I f\"\n          and ?B1.0 = \"carrier M\" in extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            -\\<^sub>a a = \\<Sigma>\\<^sub>e M g n", "apply (frule sym, thin_tac \"a = \\<Sigma>\\<^sub>e M g n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            -\\<^sub>a a = \\<Sigma>\\<^sub>e M g n", "apply (cut_tac n = n and f = g in nsum_minus,\n         rule allI, simp add:Pi_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}.\n                               -\\<^sub>a g x) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na ga.\n                            ga \\<in> {j. j \\<le> na} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j.\n                          j \\<le> n}.\n             -\\<^sub>a g x) n =\n                            \\<Sigma>\\<^sub>e M ga na", "apply (subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a (g x)) \\<in> {j. j \\<le> n} \\<rightarrow> \n                                                 finitesum_base M I f\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na ga.\n                            ga \\<in> {j. j \\<le> na} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j.\n                          j \\<le> n}.\n             -\\<^sub>a g x) n =\n                            \\<Sigma>\\<^sub>e M ga na\n 2. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}.\n                               -\\<^sub>a g x) n\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow>\n                               finitesum_base M I f", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}.\n                               -\\<^sub>a g x) n\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow>\n                               finitesum_base M I f", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a g x \\<in> finitesum_base M I f", "apply (frule_tac f = g and A = \"{j. j \\<le> n}\" and B = \"finitesum_base M I f\" \n        and  x = x in funcset_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n; g x \\<in> finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a g x \\<in> finitesum_base M I f", "apply (simp add:finitesum_base_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> \\<Union> {f i |i. i \\<in> I};\n        \\<Union> {f i |i. i \\<in> I} \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n;\n        \\<exists>xa.\n           (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n           g x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            -\\<^sub>a g x \\<in> xa", "apply (erule exE, erule conjE, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x xa i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> \\<Union> {f i |i. i \\<in> I};\n        \\<Union> {f i |i. i \\<in> I} \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n; g x \\<in> xa; xa = f i; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            -\\<^sub>a g x \\<in> xa", "apply (frule_tac f = f and A = I and B = \"{X. submodule R M X}\" and\n  x = i in funcset_mem, assumption+, simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x xa i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> \\<Union> {f i |i. i \\<in> I};\n        \\<Union> {f i |i. i \\<in> I} \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n; g x \\<in> f i; xa = f i; i \\<in> I;\n        submodule R M (f i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            -\\<^sub>a g x \\<in> xa", "apply (thin_tac \"f \\<in> I \\<rightarrow> {X. submodule R M X}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x xa i.\n       \\<lbrakk>I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> \\<Union> {f i |i. i \\<in> I};\n        \\<Union> {f i |i. i \\<in> I} \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n; g x \\<in> f i; xa = f i; i \\<in> I;\n        submodule R M (f i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            -\\<^sub>a g x \\<in> xa", "apply (simp add:submodule_def, (erule conjE)+,\n        frule_tac H = \"f i\" and x = \"g x\" in asubg_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n g x xa i.\n       \\<lbrakk>I \\<noteq> {};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> \\<Union> {f i |i. i \\<in> I};\n        \\<Union> {f i |i. i \\<in> I} \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n = a;\n        -\\<^sub>a a =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a g x) n;\n        x \\<le> n; g x \\<in> f i; xa = f i; i \\<in> I;\n        f i \\<subseteq> carrier M; M +> f i;\n        \\<forall>a m.\n           a \\<in> carrier R \\<and> m \\<in> f i \\<longrightarrow>\n           a \\<cdot>\\<^sub>s m \\<in> f i;\n        -\\<^sub>a g x \\<in> f i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            -\\<^sub>a g x \\<in> xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_pOp_closed:\n \"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; a \\<in> finitesum M I f;  b \\<in> finitesum M I f\\<rbrakk>\n           \\<Longrightarrow>  a \\<plusminus> b \\<in> finitesum M I f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     a \\<in> finitesum M I f; b \\<in> finitesum M I f\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> finitesum M I f", "apply (simp add:finitesum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     \\<exists>n g.\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f \\<and>\n        a = \\<Sigma>\\<^sub>e M g n;\n     \\<exists>n g.\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f \\<and>\n        b = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n g.\n                         g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 finitesum_base M I f \\<and>\n                         a \\<plusminus> b = \\<Sigma>\\<^sub>e M g n", "apply ((erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na g ga.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        ga \\<in> {j. j \\<le> na} \\<rightarrow> finitesum_base M I f;\n        b = \\<Sigma>\\<^sub>e M ga na\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n g.\n                            g \\<in> {j. j \\<le> n} \\<rightarrow>\n                                    finitesum_base M I f \\<and>\n                            a \\<plusminus> b = \\<Sigma>\\<^sub>e M g n", "apply (frule_tac f = g and n = n and A = \"finitesum_base M I f\" and\n       g = ga and m = na and B = \"finitesum_base M I f\" in jointfun_hom0,\n       assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na g ga.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        ga \\<in> {j. j \\<le> na} \\<rightarrow> finitesum_base M I f;\n        b = \\<Sigma>\\<^sub>e M ga na;\n        jointfun n g na ga\n        \\<in> {l. l \\<le> Suc (n + na)} \\<rightarrow>\n              finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>nb gb.\n                            gb \\<in> {j. j \\<le> nb} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                            \\<Sigma>\\<^sub>e M g n \\<plusminus>\n                            \\<Sigma>\\<^sub>e M ga na =\n                            \\<Sigma>\\<^sub>e M gb nb", "apply (cut_tac finitesumbase_sub_carrier[of f I],\n       cut_tac n1 = n and f1 = g and m1 = na and g1 = ga in \n                 nsum_add_nm[THEN sym], rule allI, rule impI,\n       frule_tac x = j and f = g and A = \"{j. j \\<le> n}\" and\n        B = \"finitesum_base M I f\" in funcset_mem, simp,\n       simp add:subsetD,\n       rule allI, rule impI,\n       frule_tac x = j and f = ga and A = \"{j. j \\<le> na}\" and\n        B = \"finitesum_base M I f\" in funcset_mem, simp,\n       simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na g ga.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        ga \\<in> {j. j \\<le> na} \\<rightarrow> finitesum_base M I f;\n        b = \\<Sigma>\\<^sub>e M ga na;\n        jointfun n g na ga\n        \\<in> {l. l \\<le> Suc (n + na)} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M g n \\<plusminus> \\<Sigma>\\<^sub>e M ga na =\n        \\<Sigma>\\<^sub>e M jointfun n g na ga Suc (n + na)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>nb gb.\n                            gb \\<in> {j. j \\<le> nb} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                            \\<Sigma>\\<^sub>e M g n \\<plusminus>\n                            \\<Sigma>\\<^sub>e M ga na =\n                            \\<Sigma>\\<^sub>e M gb nb\n 2. \\<And>n na g ga.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        ga \\<in> {j. j \\<le> na} \\<rightarrow> finitesum_base M I f;\n        b = \\<Sigma>\\<^sub>e M ga na;\n        jointfun n g na ga\n        \\<in> {l. l \\<le> Suc (n + na)} \\<rightarrow>\n              finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> I \\<rightarrow> {X. submodule R M X}", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na g ga.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        a = \\<Sigma>\\<^sub>e M g n;\n        ga \\<in> {j. j \\<le> na} \\<rightarrow> finitesum_base M I f;\n        b = \\<Sigma>\\<^sub>e M ga na;\n        jointfun n g na ga\n        \\<in> {l. l \\<le> Suc (n + na)} \\<rightarrow>\n              finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> I \\<rightarrow> {X. submodule R M X}", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_sprodTr:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n       r \\<in> carrier R\\<rbrakk>  \\<Longrightarrow> g \\<in>{j. j \\<le> (n::nat)} \\<rightarrow> (finitesum_base M I f)\n              \\<longrightarrow> r \\<cdot>\\<^sub>s (nsum M g n) =  nsum M (\\<lambda>x. r \\<cdot>\\<^sub>s (g x)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> g \\<in> {j. j \\<le> n} \\<rightarrow>\n                              finitesum_base M I f \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>x.\n       r \\<cdot>\\<^sub>s g x) n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> g \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              finitesum_base M I f \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g 0 =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>x.\n       r \\<cdot>\\<^sub>s g x) 0\n 2. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow>\n                finitesum_base M I f \\<longrightarrow>\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 finitesum_base M I f \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) Suc n", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     r \\<in> carrier R;\n     g \\<in> {j. j \\<le> 0} \\<rightarrow> finitesum_base M I f\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g 0 =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>x.\n       r \\<cdot>\\<^sub>s g x) 0\n 2. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow>\n                finitesum_base M I f \\<longrightarrow>\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 finitesum_base M I f \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow>\n                finitesum_base M I f \\<longrightarrow>\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 finitesum_base M I f \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) Suc n", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow>\n                finitesum_base M I f \\<longrightarrow>\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) Suc n", "apply (frule func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow>\n                finitesum_base M I f \\<longrightarrow>\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> finitesum_base M I f;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> finitesum_base M I f;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (frule finitesumbase_sub_carrier [of f I])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> finitesum_base M I f;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (frule_tac f = g and A = \"{j. j \\<le> Suc n}\" in extend_fun [of _ _ \"finitesum_base M I f\" \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> finitesum_base M I f;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (thin_tac \"g \\<in> {j. j \\<le> Suc n} \\<rightarrow> finitesum_base M I f\",\n        thin_tac \"g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\",\n        frule func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (cut_tac n = n in nsum_mem [of _ g])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. g j \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (rule allI, simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (frule_tac x = \"Suc n\" in funcset_mem [of \"g\" _ \"carrier M\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n \\<in> carrier M;\n        g (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply (subst sc_r_distr, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        r \\<in> carrier R;\n        r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>x. r \\<cdot>\\<^sub>s g x) n;\n        finitesum_base M I f \\<subseteq> carrier M;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M g n \\<in> carrier M;\n        g (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M g n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>x.\n          r \\<cdot>\\<^sub>s g x) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s g (Suc n)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_sprod:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}; \n      r \\<in> carrier R; g \\<in>{j. j \\<le> (n::nat)} \\<rightarrow> (finitesum_base M I f) \\<rbrakk> \\<Longrightarrow>\n                       r \\<cdot>\\<^sub>s (nsum M g n) =  nsum M (\\<lambda>x. r \\<cdot>\\<^sub>s (g x)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n     r \\<in> carrier R;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>x.\n       r \\<cdot>\\<^sub>s g x) n", "apply (simp add:finitesum_sprodTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finitesum_subModule:\"\\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {}\\<rbrakk>\n                   \\<Longrightarrow> submodule R M (finitesum M I f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> submodule R M (finitesum M I f)", "apply (simp add:submodule_def [of _ _ \"(finitesum M I f)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> finitesum M I f \\<subseteq> carrier M \\<and>\n                      M +> finitesum M I f \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> finitesum M I f \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> finitesum M I f)", "apply (simp add:finitesum_sub_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> finitesum M I f \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> finitesum M I f \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> finitesum M I f)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> finitesum M I f\n 2. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> finitesum M I f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply (rule asubg_test)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> finitesum M I f \\<subseteq> carrier M\n 2. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> finitesum M I f \\<noteq> {}\n 3. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>finitesum M I f.\n                         \\<forall>b\\<in>finitesum M I f.\n                            a \\<plusminus> -\\<^sub>a b \\<in> finitesum M I f\n 4. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> finitesum M I f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply (simp add:finitesum_sub_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> finitesum M I f \\<noteq> {}\n 2. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>finitesum M I f.\n                         \\<forall>b\\<in>finitesum M I f.\n                            a \\<plusminus> -\\<^sub>a b \\<in> finitesum M I f\n 3. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> finitesum M I f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply (frule finitesum_inc_zero, assumption, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>finitesum M I f.\n                         \\<forall>b\\<in>finitesum M I f.\n                            a \\<plusminus> -\\<^sub>a b \\<in> finitesum M I f\n 2. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> finitesum M I f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> finitesum M I f; b \\<in> finitesum M I f\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> finitesum M I f\n 2. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> finitesum M I f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply (rule finitesum_pOp_closed, assumption+,\n        rule finitesum_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X};\n     I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> finitesum M I f \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R; m \\<in> finitesum M I f\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> finitesum M I f", "apply (simp add:finitesum_def, (erule exE)+, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        m = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na ga.\n                            ga \\<in> {j. j \\<le> na} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                            a \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M g n =\n                            \\<Sigma>\\<^sub>e M ga na", "apply (simp add:finitesum_sprod)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        m = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na ga.\n                            ga \\<in> {j. j \\<le> na} \\<rightarrow>\n                                     finitesum_base M I f \\<and>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>x.\n             a \\<cdot>\\<^sub>s g x) n =\n                            \\<Sigma>\\<^sub>e M ga na", "apply (subgoal_tac \"(\\<lambda>x. a \\<cdot>\\<^sub>s g x) \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\",\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m n g.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        m = \\<Sigma>\\<^sub>e M g n\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x. a \\<cdot>\\<^sub>s g x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow>\n                               finitesum_base M I f", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m n g x.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f;\n        m = \\<Sigma>\\<^sub>e M g n; x \\<in> {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s g x \\<in> finitesum_base M I f", "apply (frule_tac x = x and f = g and A = \"{j. j \\<le> n}\" in \n                  funcset_mem[of _ _ \"finitesum_base M I f\"], assumption+,\n        thin_tac \"g \\<in> {j. j \\<le> n} \\<rightarrow> finitesum_base M I f\",\n        simp add:finitesum_base_def, erule exE, erule conjE, erule exE,\n        erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m n g x xa i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R; m = \\<Sigma>\\<^sub>e M g n; x \\<le> n;\n        g x \\<in> f i; xa = f i; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            a \\<cdot>\\<^sub>s g x \\<in> xa", "apply (frule_tac x = i and f = f and A = I in \n        funcset_mem[of _ _ \"{X. submodule R M X}\"], assumption+, simp,\n        frule_tac H = \"f i\" and a = a and h = \"g x\" in submodule_sc_closed,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m n g x xa i.\n       \\<lbrakk>f \\<in> I \\<rightarrow> {X. submodule R M X}; I \\<noteq> {};\n        a \\<in> carrier R; m = \\<Sigma>\\<^sub>e M g n; x \\<le> n;\n        g x \\<in> f i; xa = f i; i \\<in> I; submodule R M (f i);\n        a \\<cdot>\\<^sub>s g x \\<in> f i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i. xa = f i \\<and> i \\<in> I) \\<and>\n                            a \\<cdot>\\<^sub>s g x \\<in> xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sSum_cont_H:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                     H \\<subseteq>  H \\<minusplus> K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> H \\<minusplus> K", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<minusplus> K", "apply (unfold submodule_def[of R M H], frule conjunct1, fold submodule_def,\n       unfold submodule_def[of R M K], frule conjunct1, fold submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<minusplus> K", "apply (simp add:set_sum)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K. x = h \\<plusminus> k", "apply (frule submodule_inc_0 [of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M;\n        \\<zero> \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K. x = h \\<plusminus> k", "apply (cut_tac t = x in ag_r_zero [THEN sym],\n       rule submodule_subset1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M; \\<zero> \\<in> K;\n        x = x \\<plusminus> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K. x = h \\<plusminus> k", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sSum_commute:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                       H \\<minusplus> K =  K \\<minusplus> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K = K \\<minusplus> H", "apply (unfold submodule_def[of R M H], frule conjunct1, fold submodule_def,\n       unfold submodule_def[of R M K], frule conjunct1, fold submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K = K \\<minusplus> H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K \\<subseteq> K \\<minusplus> H\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; x \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K \\<minusplus> H\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply (simp add:set_sum)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M;\n        \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>K.\n                            \\<exists>k\\<in>H. x = h \\<plusminus> k\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply ((erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>K.\n                            \\<exists>ka\\<in>H.\n                               h \\<plusminus> k = ha \\<plusminus> ka\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply (frule_tac c = h in subsetD[of H \"carrier M\"], assumption+,\n       frule_tac c = k in subsetD[of K \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; x = h \\<plusminus> k;\n        h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>K.\n                            \\<exists>ka\\<in>H.\n                               h \\<plusminus> k = ha \\<plusminus> ka\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply (subst ag_pOp_commute, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; x = h \\<plusminus> k;\n        h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>K.\n                            \\<exists>ka\\<in>H.\n                               k \\<plusminus> h = ha \\<plusminus> ka\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> K \\<minusplus> H \\<subseteq> H \\<minusplus> K", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; x \\<in> K \\<minusplus> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<minusplus> K", "apply (simp add:set_sum)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M;\n        \\<exists>h\\<in>K. \\<exists>k\\<in>H. x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K. x = h \\<plusminus> k", "apply ((erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> K; k \\<in> H;\n        x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k = ha \\<plusminus> ka", "apply (frule_tac h = h in submodule_subset1[of K ], assumption+,\n       frule_tac h = k in submodule_subset1[of H ], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> K; k \\<in> H; x = h \\<plusminus> k;\n        h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k = ha \\<plusminus> ka", "apply (subst ag_pOp_commute, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> K; k \\<in> H; x = h \\<plusminus> k;\n        h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               k \\<plusminus> h = ha \\<plusminus> ka", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Sum_of_SubmodulesTr:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n      g \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H \\<union> K \\<longrightarrow> \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> g \\<in> {j. j \\<le> n} \\<rightarrow>\n                              H \\<union> K \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> g \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              H \\<union> K \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e M g 0 \\<in> H \\<minusplus> K\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     g \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<union> K\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M g 0 \\<in> H \\<minusplus> K\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     g 0 \\<in> H \\<or> g 0 \\<in> K\\<rbrakk>\n    \\<Longrightarrow> g 0 \\<in> H \\<minusplus> K\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (frule submodule_subset[of H],\n        frule submodule_subset[of K])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     g 0 \\<in> H \\<or> g 0 \\<in> K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> g 0 \\<in> H \\<minusplus> K\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (simp add:set_sum)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     g 0 \\<in> H \\<or> g 0 \\<in> K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (erule disjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M; g 0 \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M; g 0 \\<in> K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 3. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (frule_tac c = \"g 0\" in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac t = \"g 0\" in ag_r_zero[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M; g 0 \\<in> H; g 0 \\<in> carrier M;\n     g 0 = g 0 \\<plusminus> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 2. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M; g 0 \\<in> K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 3. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (\n        frule submodule_inc_0[of K], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M; g 0 \\<in> K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (frule_tac c = \"g 0\" in subsetD[of K \"carrier M\"], assumption+,\n        frule_tac t = \"g 0\" in ag_l_zero[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n     K \\<subseteq> carrier M; g 0 \\<in> K; g 0 \\<in> carrier M;\n     g 0 = \\<zero> \\<plusminus> g 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. g 0 = h \\<plusminus> k\n 2. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply (\n        frule submodule_inc_0[of H], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g Suc n \\<in> H \\<minusplus> K", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<union> K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)\n                         \\<in> H \\<minusplus> K", "apply (rule impI, frule func_pre, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<union> K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)\n                         \\<in> H \\<minusplus> K", "apply (frule submodule_subset[of H],\n        frule submodule_subset[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        \\<Sigma>\\<^sub>e M g n \\<in> H \\<minusplus> K;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<union> K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M g n \\<plusminus> g (Suc n)\n                         \\<in> H \\<minusplus> K", "apply (simp add:set_sum[of H K], (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<union> K;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M; h \\<in> H;\n        k \\<in> K; \\<Sigma>\\<^sub>e M g n = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (frule_tac x = \"Suc n\" and f = g and A = \"{j. j \\<le> Suc n}\" and\n        B = \"H \\<union> K\" in funcset_mem, simp,\n        thin_tac \"g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<union> K\",\n        thin_tac \"g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<union> K\",\n        thin_tac \"\\<Sigma>\\<^sub>e M g n = h \\<plusminus> k\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> H \\<or> g (Suc n) \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka\n 2. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (frule_tac h = h in submodule_subset1[of H], assumption,\n        frule_tac h = \"g (Suc n)\" in submodule_subset1[of H], assumption,\n        frule_tac h = k in submodule_subset1[of K], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; g (Suc n) \\<in> H;\n        h \\<in> carrier M; g (Suc n) \\<in> carrier M;\n        k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka\n 2. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (subst ag_pOp_assoc, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; g (Suc n) \\<in> H;\n        h \\<in> carrier M; g (Suc n) \\<in> carrier M;\n        k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> (k \\<plusminus> g (Suc n)) =\n                               ha \\<plusminus> ka\n 2. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (frule_tac x = k and y = \"g (Suc n)\" in ag_pOp_commute, assumption+,\n         simp, subst ag_pOp_assoc[THEN sym], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; g (Suc n) \\<in> H;\n        h \\<in> carrier M; g (Suc n) \\<in> carrier M; k \\<in> carrier M;\n        k \\<plusminus> g (Suc n) = g (Suc n) \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> g (Suc n) \\<plusminus> k =\n                               ha \\<plusminus> ka\n 2. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (frule_tac h = h and k = \"g (Suc n)\" in submodule_pOp_closed[of H],\n         assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        g (Suc n) \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (frule_tac h = h in submodule_subset1[of H], assumption,\n        frule_tac h = \"g (Suc n)\" in submodule_subset1[of K], assumption,\n        frule_tac h = k in submodule_subset1[of K], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n h k.\n       \\<lbrakk>submodule R M H; submodule R M K; H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; g (Suc n) \\<in> K;\n        h \\<in> carrier M; g (Suc n) \\<in> carrier M;\n        k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               h \\<plusminus> k \\<plusminus> g (Suc n) =\n                               ha \\<plusminus> ka", "apply (subst ag_pOp_assoc, assumption+,\n        frule_tac h = k and k = \"g (Suc n)\" in submodule_pOp_closed[of K],\n         assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sSum_two_Submodules:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                       submodule R M (H \\<minusplus> K)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> submodule R M (H \\<minusplus> K)", "apply (subst submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K \\<subseteq> carrier M \\<and>\n                      M +> H \\<minusplus> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> H \\<minusplus> K)", "apply (frule submodule_asubg[of H],\n        frule submodule_asubg[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K \\<subseteq> carrier M \\<and>\n                      M +> H \\<minusplus> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> H \\<minusplus> K)", "apply (frule plus_subgs[of H K], assumption, simp add:asubg_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K;\n     M +> H \\<minusplus> K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> H \\<minusplus> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> H \\<minusplus> K", "apply (rule allI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K;\n        M +> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R \\<and>\n                         m \\<in> H \\<minusplus> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> H \\<minusplus> K", "apply (rule impI, erule conjE, frule asubg_subset[of H], \n       frule asubg_subset[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K;\n        M +> H \\<minusplus> K; a \\<in> carrier R; m \\<in> H \\<minusplus> K;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<in> H \\<minusplus> K", "apply (simp add:set_sum[of H K], (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m h k.\n       \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K;\n        M +> {x. \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k};\n        a \\<in> carrier R; H \\<subseteq> carrier M; K \\<subseteq> carrier M;\n        h \\<in> H; k \\<in> K; m = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               a \\<cdot>\\<^sub>s (h \\<plusminus> k) =\n                               ha \\<plusminus> ka", "apply (frule_tac H = H and a = a and h = h in submodule_sc_closed, \n                  assumption+,\n        frule_tac H = K and a = a and h = k in submodule_sc_closed, \n                  assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m h k.\n       \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K;\n        M +> {x. \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k};\n        a \\<in> carrier R; H \\<subseteq> carrier M; K \\<subseteq> carrier M;\n        h \\<in> H; k \\<in> K; m = h \\<plusminus> k;\n        a \\<cdot>\\<^sub>s h \\<in> H; a \\<cdot>\\<^sub>s k \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               a \\<cdot>\\<^sub>s (h \\<plusminus> k) =\n                               ha \\<plusminus> ka", "apply (frule_tac c = h in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac c = k in subsetD[of K \"carrier M\"], assumption+,\n        simp add:sc_r_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m h k.\n       \\<lbrakk>submodule R M H; submodule R M K; M +> H; M +> K;\n        M +> {x. \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k};\n        a \\<in> carrier R; H \\<subseteq> carrier M; K \\<subseteq> carrier M;\n        h \\<in> H; k \\<in> K; m = h \\<plusminus> k;\n        a \\<cdot>\\<^sub>s h \\<in> H; a \\<cdot>\\<^sub>s k \\<in> K;\n        h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>H.\n                            \\<exists>ka\\<in>K.\n                               a \\<cdot>\\<^sub>s h \\<plusminus>\n                               a \\<cdot>\\<^sub>s k =\n                               ha \\<plusminus> ka", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  iotam :: \"[('a, 'r, 'm) Module_scheme, 'a set, 'a set] \\<Rightarrow> ('a \\<Rightarrow> 'a)\"\n      (\"(3\\<iota>m\\<^bsub>_ _,_\\<^esub>)\" [82, 82, 83]82) where\n  \"\\<iota>m\\<^bsub>M H,K\\<^esub> = (\\<lambda>x\\<in>H. (x \\<plusminus>\\<^bsub>M\\<^esub> \\<zero>\\<^bsub>M\\<^esub>))\""], ["", "(** later we define miota. This is not \n equal to iotam **)"], ["", "lemma (in Module) iotam_mHom:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n                           \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub> \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K))", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> aHom (mdl M H) (mdl M (H \\<minusplus> K)) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (mdl M H).\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> aHom (mdl M H) (mdl M (H \\<minusplus> K))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M (H \\<minusplus> K)) \\<and>\n                      \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional (carrier (mdl M H)) \\<and>\n                      (\\<forall>a\\<in>carrier (mdl M H).\n                          \\<forall>b\\<in>carrier (mdl M H).\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>mdl M H\\<^esub> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> H \\<rightarrow> H \\<minusplus> K \\<and>\n                      \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> H \\<rightarrow> H \\<minusplus> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (rule Pi_I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> (\\<iota>m\\<^bsub>M H,K\\<^esub>) x\n                         \\<in> H \\<minusplus> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (simp add:iotam_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (frule submodule_subset[of H], frule submodule_subset[of K],\n        simp add:set_sum)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K.\n                               x \\<plusminus> \\<zero> = h \\<plusminus> k\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (frule submodule_inc_0 [of K])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M;\n        \\<zero> \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K.\n                               x \\<plusminus> \\<zero> = h \\<plusminus> k\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> extensional H \\<and>\n                      (\\<forall>a\\<in>H.\n                          \\<forall>b\\<in>H.\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                              (a \\<plusminus> b) =\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) b)\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub> \\<in> extensional H\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>H.\n                         \\<forall>b\\<in>H.\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<plusminus> b) =\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) b\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (simp add:iotam_def extensional_def mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>H.\n                         \\<forall>b\\<in>H.\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<plusminus> b) =\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) b\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H;\n        b \\<in> H\\<rbrakk>\n       \\<Longrightarrow> (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                          (a \\<plusminus> b) =\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>) a \\<plusminus>\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>) b\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (simp add:mdl_def iotam_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H;\n        b \\<in> H\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus> b \\<in> H \\<longrightarrow>\n                          a \\<plusminus> b \\<plusminus> \\<zero> =\n                          a \\<plusminus> \\<zero> \\<plusminus>\n                          (b \\<plusminus> \\<zero>)) \\<and>\n                         (a \\<plusminus> b \\<notin> H \\<longrightarrow>\n                          undefined =\n                          a \\<plusminus> \\<zero> \\<plusminus>\n                          (b \\<plusminus> \\<zero>))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (frule_tac h = a and k = b in submodule_pOp_closed [of H],\n                                     assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H; b \\<in> H;\n        a \\<plusminus> b \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> \\<zero> =\n                         a \\<plusminus> \\<zero> \\<plusminus>\n                         (b \\<plusminus> \\<zero>)\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (frule submodule_subset[of H], \n        frule_tac c = a in subsetD[of H \"carrier M\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H; b \\<in> H;\n        a \\<plusminus> b \\<in> H; H \\<subseteq> carrier M;\n        a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> \\<zero> =\n                         a \\<plusminus> \\<zero> \\<plusminus>\n                         (b \\<plusminus> \\<zero>)\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (\n        simp add:ag_r_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H; b \\<in> H;\n        a \\<plusminus> b \\<in> H; H \\<subseteq> carrier M;\n        a \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> \\<zero> =\n                         a \\<plusminus> (b \\<plusminus> \\<zero>)\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply ( frule_tac c = b in subsetD[of H \"carrier M\"], assumption,\n        subst ag_pOp_assoc, assumption+,\n        simp add:ag_inc_zero, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier (mdl M H).\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> carrier (mdl M H)\\<rbrakk>\n       \\<Longrightarrow> (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                          (a \\<cdot>\\<^sub>s\\<^bsub>mdl M H\\<^esub> m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>) m", "apply (simp add:iotam_def mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>s m \\<in> H \\<longrightarrow>\n                          (m \\<plusminus> \\<zero>\n                           \\<in> H \\<minusplus> K \\<longrightarrow>\n                           a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                           a \\<cdot>\\<^sub>s\n                           (m \\<plusminus> \\<zero>)) \\<and>\n                          (m \\<plusminus> \\<zero>\n                           \\<notin> H \\<minusplus> K \\<longrightarrow>\n                           a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                           undefined)) \\<and>\n                         (a \\<cdot>\\<^sub>s m \\<notin> H \\<longrightarrow>\n                          m \\<plusminus> \\<zero>\n                          \\<in> H \\<minusplus> K \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s (m \\<plusminus> \\<zero>))", "apply (simp add:submodule_sc_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> H\\<rbrakk>\n       \\<Longrightarrow> (m \\<plusminus> \\<zero>\n                          \\<in> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                          a \\<cdot>\\<^sub>s (m \\<plusminus> \\<zero>)) \\<and>\n                         (m \\<plusminus> \\<zero>\n                          \\<notin> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                          undefined)", "apply (frule submodule_inc_0[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> H; \\<zero> \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (m \\<plusminus> \\<zero>\n                          \\<in> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                          a \\<cdot>\\<^sub>s (m \\<plusminus> \\<zero>)) \\<and>\n                         (m \\<plusminus> \\<zero>\n                          \\<notin> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                          undefined)", "apply (frule submodule_asubg[of H], frule submodule_asubg[of K],\n        simp add:mem_sum_subgs)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> H; \\<zero> \\<in> K; M +> H; M +> K\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                         a \\<cdot>\\<^sub>s (m \\<plusminus> \\<zero>)", "apply (frule_tac a = a and h = m in submodule_sc_closed, assumption+,\n        frule submodule_subset[of H],\n        frule_tac c = m in subsetD[of H \"carrier M\"], assumption+,\n        frule_tac c = \"a \\<cdot>\\<^sub>s m\" in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> H; \\<zero> \\<in> K; M +> H; M +> K;\n        a \\<cdot>\\<^sub>s m \\<in> H; H \\<subseteq> carrier M;\n        m \\<in> carrier M; a \\<cdot>\\<^sub>s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s m \\<plusminus> \\<zero> =\n                         a \\<cdot>\\<^sub>s (m \\<plusminus> \\<zero>)", "apply (simp add:ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mhomom3Tr:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                         submodule R (mdl M (H \\<minusplus> K)) K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> submodule R (mdl M (H \\<minusplus> K)) K", "apply (subst submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> carrier\n                                     (mdl M (H \\<minusplus> K)) \\<and>\n                      mdl M (H \\<minusplus> K) +> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                          m\n                          \\<in> K)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> carrier (mdl M (H \\<minusplus> K))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> mdl M (H \\<minusplus> K) +> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                          m\n                          \\<in> K)", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> H \\<minusplus> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> mdl M (H \\<minusplus> K) +> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                          m\n                          \\<in> K)", "apply (subst sSum_commute, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> K \\<minusplus> H\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> mdl M (H \\<minusplus> K) +> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                          m\n                          \\<in> K)", "apply (simp add:sSum_cont_H)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> mdl M (H \\<minusplus> K) +> K \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                          m\n                          \\<in> K)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> mdl M (H \\<minusplus> K) +> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (rule aGroup.asubg_test)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> aGroup (mdl M (H \\<minusplus> K))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> carrier (mdl M (H \\<minusplus> K))\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 4. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 5. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (frule sSum_two_Submodules [of H K], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K)\\<rbrakk>\n    \\<Longrightarrow> aGroup (mdl M (H \\<minusplus> K))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> carrier (mdl M (H \\<minusplus> K))\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 4. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 5. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (frule mdl_is_module [of  \"(H \\<minusplus> K)\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K);\n     R module mdl M (H \\<minusplus> K)\\<rbrakk>\n    \\<Longrightarrow> aGroup (mdl M (H \\<minusplus> K))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> carrier (mdl M (H \\<minusplus> K))\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 4. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 5. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (rule Module.module_is_ag, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> carrier (mdl M (H \\<minusplus> K))\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 4. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> H \\<minusplus> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 4. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (subst sSum_commute, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<subseteq> K \\<minusplus> H\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 4. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (simp add:sSum_cont_H)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (frule submodule_inc_0 [of K])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; \\<zero> \\<in> K\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (simp add:nonempty)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>K.\n                         \\<forall>b\\<in>K.\n                            a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                            -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                            \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> K;\n        b \\<in> K\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         -\\<^sub>a\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> b\n                         \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> K;\n        b \\<in> K\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (rule submodule_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> K;\n        b \\<in> K\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a b \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (rule submodule_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> K \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply ((rule allI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        a \\<in> carrier R \\<and> m \\<in> K\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n                         m\n                         \\<in> K", "apply (simp add:mdl_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (m \\<in> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> K) \\<and>\n                         (m \\<notin> H \\<minusplus> K \\<longrightarrow>\n                          undefined \\<in> K)", "apply (frule sSum_cont_H[of K H], assumption,\n        simp add:sSum_commute[of K H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> carrier R;\n        m \\<in> K; K \\<subseteq> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> (m \\<in> H \\<minusplus> K \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> K) \\<and>\n                         (m \\<notin> H \\<minusplus> K \\<longrightarrow>\n                          undefined \\<in> K)", "apply (simp add:subsetD submodule_sc_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mhomom3Tr0:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n     \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n        \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (frule mdl_is_module [of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (frule mhomom3Tr[of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (frule sSum_two_Submodules [of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K)\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (frule mdl_is_module [of  \"H \\<minusplus> K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K);\n     R module mdl M (H \\<minusplus> K)\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (frule iotam_mHom [of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K))\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "thm Module.mpj_mHom"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K))\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (frule Module.mpj_mHom [of \"mdl M (H \\<minusplus> K)\" R \"K\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K));\n     mpj (mdl M (H \\<minusplus> K)) K\n     \\<in> mHom R (mdl M (H \\<minusplus> K))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> mHom R (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (rule  Module.mHom_compos[of \"mdl M (H \\<minusplus> K)\" R \"mdl M H\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K));\n     mpj (mdl M (H \\<minusplus> K)) K\n     \\<in> mHom R (mdl M (H \\<minusplus> K))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> R module mdl M (H \\<minusplus> K) /\\<^sub>m K\n 2. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K));\n     mpj (mdl M (H \\<minusplus> K)) K\n     \\<in> mHom R (mdl M (H \\<minusplus> K))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> \\<iota>m\\<^bsub>M H,K\\<^esub>\n                      \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K))\n 3. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K));\n     mpj (mdl M (H \\<minusplus> K)) K\n     \\<in> mHom R (mdl M (H \\<minusplus> K))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> mpj (mdl M (H \\<minusplus> K)) K\n                      \\<in> mHom R (mdl M (H \\<minusplus> K))\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (simp add:Module.qmodule_module, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K; R module mdl M H;\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n     \\<iota>m\\<^bsub>M H,K\\<^esub>\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K));\n     mpj (mdl M (H \\<minusplus> K)) K\n     \\<in> mHom R (mdl M (H \\<minusplus> K))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> mpj (mdl M (H \\<minusplus> K)) K\n                      \\<in> mHom R (mdl M (H \\<minusplus> K))\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)", "apply (simp add:mpj_mHom)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mhomom3Tr1:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n  surjec\\<^bsub>(mdl M H),((mdl M (H \\<minusplus> K))/\\<^sub>m K)\\<^esub> \n    (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>mdl M\n                                     H,mdl M (H \\<minusplus> K) /\\<^sub>m\n K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n            (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> aHom (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K) \\<and>\n                      surj_to\n                       (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>))\n                       (carrier (mdl M H))\n                       (carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K))", "apply (frule mhomom3Tr0 [of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> aHom (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K) \\<and>\n                      surj_to\n                       (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>))\n                       (carrier (mdl M H))\n                       (carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> aHom (mdl M H)\n                             (mdl M (H \\<minusplus> K) /\\<^sub>m K)\n 2. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> surj_to\n                       (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>))\n                       (carrier (mdl M H))\n                       (carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K))", "apply (simp add:mHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> surj_to\n                       (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                         (\\<iota>m\\<^bsub>M H,K\\<^esub>))\n                       (carrier (mdl M H))\n                       (carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K))", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                       (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<in> carrier (mdl M H) \\<rightarrow>\n                            carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K)\n 2. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier\n(mdl M (H \\<minusplus> K) /\\<^sub>m K).\n                         \\<exists>a\\<in>carrier (mdl M H).\n                            compos (mdl M H)\n                             (mpj (mdl M (H \\<minusplus> K)) K)\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a =\n                            b", "apply (simp add:mHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier\n(mdl M (H \\<minusplus> K) /\\<^sub>m K).\n                         \\<exists>a\\<in>carrier (mdl M H).\n                            compos (mdl M H)\n                             (mpj (mdl M (H \\<minusplus> K)) K)\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a =\n                            b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n         (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n        \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n        b \\<in> carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M H).\n                            compos (mdl M H)\n                             (mpj (mdl M (H \\<minusplus> K)) K)\n                             (\\<iota>m\\<^bsub>M H,K\\<^esub>) a =\n                            b", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        (\\<lambda>x\\<in>carrier (mdl M H).\n            mpj (mdl M (H \\<minusplus> K)) K\n             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) x))\n        \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n        b \\<in> carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M H).\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) a) =\n                            b", "apply (thin_tac \"(\\<lambda>x\\<in>carrier (mdl M H). mpj (mdl M (H \\<minusplus> K)) K ((\\<iota>m\\<^bsub>M H,K\\<^esub>) x))\n         \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b \\<in> carrier (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M H).\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) a) =\n                            b", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b \\<in> set_mr_cos (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M H).\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) a) =\n                            b", "apply (simp add:set_mr_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        \\<exists>a\\<in>carrier (mdl M (H \\<minusplus> K)).\n           b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (mdl M H).\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) a) =\n                            b", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        a \\<in> carrier (mdl M (H \\<minusplus> K));\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>carrier (mdl M H).\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) aa) =\n                            a \\<uplus>\\<^bsub>mdl M\n         (H \\<minusplus> K)\\<^esub> K", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        a \\<in> carrier (mdl M (H \\<minusplus> K));\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             ((\\<iota>m\\<^bsub>M H,K\\<^esub>) aa) =\n                            a \\<uplus>\\<^bsub>mdl M\n         (H \\<minusplus> K)\\<^esub> K", "apply (simp add:iotam_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        a \\<in> carrier (mdl M (H \\<minusplus> K));\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            mpj (mdl M (H \\<minusplus> K)) K\n                             (aa \\<plusminus> \\<zero>) =\n                            a \\<uplus>\\<^bsub>mdl M\n         (H \\<minusplus> K)\\<^esub> K", "apply (simp add:mpj_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        a \\<in> carrier (mdl M (H \\<minusplus> K));\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            (aa \\<plusminus> \\<zero>\n                             \\<in> carrier\n                                    (mdl M\n(H \\<minusplus> K)) \\<longrightarrow>\n                             (aa \\<plusminus>\n                              \\<zero>) \\<uplus>\\<^bsub>mdl M\n                  (H \\<minusplus> K)\\<^esub> K =\n                             a \\<uplus>\\<^bsub>mdl M\n          (H \\<minusplus> K)\\<^esub> K) \\<and>\n                            (aa \\<plusminus> \\<zero>\n                             \\<notin> carrier\n (mdl M (H \\<minusplus> K)) \\<longrightarrow>\n                             undefined =\n                             a \\<uplus>\\<^bsub>mdl M\n          (H \\<minusplus> K)\\<^esub> K)", "apply (frule sSum_two_Submodules[of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        a \\<in> carrier (mdl M (H \\<minusplus> K));\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            (aa \\<plusminus> \\<zero>\n                             \\<in> carrier\n                                    (mdl M\n(H \\<minusplus> K)) \\<longrightarrow>\n                             (aa \\<plusminus>\n                              \\<zero>) \\<uplus>\\<^bsub>mdl M\n                  (H \\<minusplus> K)\\<^esub> K =\n                             a \\<uplus>\\<^bsub>mdl M\n          (H \\<minusplus> K)\\<^esub> K) \\<and>\n                            (aa \\<plusminus> \\<zero>\n                             \\<notin> carrier\n (mdl M (H \\<minusplus> K)) \\<longrightarrow>\n                             undefined =\n                             a \\<uplus>\\<^bsub>mdl M\n          (H \\<minusplus> K)\\<^esub> K)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            (aa \\<plusminus> \\<zero>\n                             \\<in> H \\<minusplus> K \\<longrightarrow>\n                             (aa \\<plusminus>\n                              \\<zero>) \\<uplus>\\<^bsub>mdl M\n                  (H \\<minusplus> K)\\<^esub> K =\n                             a \\<uplus>\\<^bsub>mdl M\n          (H \\<minusplus> K)\\<^esub> K) \\<and>\n                            (aa \\<plusminus> \\<zero>\n                             \\<notin> H \\<minusplus> K \\<longrightarrow>\n                             undefined =\n                             a \\<uplus>\\<^bsub>mdl M\n          (H \\<minusplus> K)\\<^esub> K)", "apply (subgoal_tac \"\\<forall>aa\\<in>H. aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K);\n        \\<forall>aa\\<in>H.\n           aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            (aa \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            a \\<uplus>\\<^bsub>mdl M\n         (H \\<minusplus> K)\\<^esub> K\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (frule submodule_subset[of H], frule submodule_subset[of K],\n        thin_tac \"\\<forall>aa\\<in>H. aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\",\n        simp add:set_sum, (erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        a \\<uplus>\\<^bsub>mdl M\n                           {x. \\<exists>h\\<in>H.\n                                  \\<exists>k\\<in>K.\n                                     x = h \\<plusminus> k}\\<^esub> K;\n        submodule R M\n         {x. \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k};\n        H \\<subseteq> carrier M; K \\<subseteq> carrier M; h \\<in> H;\n        k \\<in> K; a = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>H.\n                            (aa \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 {x. \\<exists>h\\<in>H.\n                        \\<exists>k\\<in>K. x = h \\<plusminus> k}\\<^esub> K =\n                            a \\<uplus>\\<^bsub>mdl M\n         {x. \\<exists>h\\<in>H.\n                \\<exists>k\\<in>K. x = h \\<plusminus> k}\\<^esub> K\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (simp add:set_sum[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K;\n        a = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>H.\n                            (a \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            (h \\<plusminus>\n                             k) \\<uplus>\\<^bsub>mdl M\n           (H \\<minusplus> K)\\<^esub> K\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (frule mdl_is_module[of \"H \\<minusplus> K\"],\n        frule mhomom3Tr[of H K], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>H.\n                            (a \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            (h \\<plusminus>\n                             k) \\<uplus>\\<^bsub>mdl M\n           (H \\<minusplus> K)\\<^esub> K\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (frule_tac m = h and h = k in Module.mr_cos_h_stable1[of \"mdl M (H \\<minusplus> K)\"\n        R K], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> h \\<in> carrier (mdl M (H \\<minusplus> K))\n 2. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> K\n 3. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        (h \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>H.\n                            (a \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            (h \\<plusminus>\n                             k) \\<uplus>\\<^bsub>mdl M\n           (H \\<minusplus> K)\\<^esub> K\n 4. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> h \\<in> H \\<minusplus> K\n 2. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> K\n 3. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        (h \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>H.\n                            (a \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            (h \\<plusminus>\n                             k) \\<uplus>\\<^bsub>mdl M\n           (H \\<minusplus> K)\\<^esub> K\n 4. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (frule sSum_cont_H[of H K], assumption+, simp add:subsetD, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b =\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        (h \\<plusminus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>H.\n                            (a \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            (h \\<plusminus>\n                             k) \\<uplus>\\<^bsub>mdl M\n           (H \\<minusplus> K)\\<^esub> K\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b = h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>H.\n                            (a \\<plusminus>\n                             \\<zero>) \\<uplus>\\<^bsub>mdl M\n                 (H \\<minusplus> K)\\<^esub> K =\n                            h \\<uplus>\\<^bsub>mdl M\n         (H \\<minusplus> K)\\<^esub> K\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (subgoal_tac \"\\<forall>a\\<in>H. a \\<plusminus> \\<zero> = a\", simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b = h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>a\\<in>H. a \\<plusminus> \\<zero> = a\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b a h k aa.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        b = h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); H \\<subseteq> carrier M;\n        K \\<subseteq> carrier M; h \\<in> H; k \\<in> K; a = h \\<plusminus> k;\n        R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        (h \\<plusminus>\n         k) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        h \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        aa \\<in> H\\<rbrakk>\n       \\<Longrightarrow> aa \\<plusminus> \\<zero> = aa\n 2. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (frule_tac c = aa in subsetD[of H \"carrier M\"], assumption+,\n        simp add:ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>aa\\<in>H.\n                            aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a aa.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); aa \\<in> H\\<rbrakk>\n       \\<Longrightarrow> aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (frule submodule_inc_0[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b a aa.\n       \\<lbrakk>submodule R M H; submodule R M K; a \\<in> H \\<minusplus> K;\n        b = a \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K;\n        submodule R M (H \\<minusplus> K); aa \\<in> H;\n        \\<zero> \\<in> K\\<rbrakk>\n       \\<Longrightarrow> aa \\<plusminus> \\<zero> \\<in> H \\<minusplus> K", "apply (rule mem_sum_subgs,\n       simp add:submodule_def, simp add:submodule_def, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mhomom3Tr2:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n  ker\\<^bsub>(mdl M H),((mdl M (H \\<minusplus> K)) /\\<^sub>m K)\\<^esub> \n    (compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)) = H \\<inter> K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>mdl M\n                                  H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                    K\\<^esub> compos (mdl M H)\n         (mpj (mdl M (H \\<minusplus> K)) K)\n         (\\<iota>m\\<^bsub>M H,K\\<^esub>) =\n                      H \\<inter> K", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>mdl M\n                                  H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                    K\\<^esub> compos (mdl M H)\n         (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n                      \\<subseteq> H \\<inter> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> ker\\<^bsub>mdl M\n                            H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                              K\\<^esub> compos (mdl M H)\n   (mpj (mdl M (H \\<minusplus> K)) K)\n   (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<inter> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> carrier (mdl M H);\n        compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n         (\\<iota>m\\<^bsub>M H,K\\<^esub>) x =\n        \\<zero>\\<^bsub>mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<and> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> carrier (mdl M H);\n        compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n         (\\<iota>m\\<^bsub>M H,K\\<^esub>) x =\n        K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<and> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n         (\\<iota>m\\<^bsub>M H,K\\<^esub>) x =\n        K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:compos_def compose_def mdl_def iotam_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        mpj \\<lparr>carrier = H \\<minusplus> K, pop = (\\<plusminus>),\n               mop = mop M, zero = \\<zero>,\n               sprod =\n                 \\<lambda>a.\n                    restrict ((\\<cdot>\\<^sub>s) a)\n                     (H \\<minusplus> K)\\<rparr>\n         K (x \\<plusminus> \\<zero>) =\n        K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (fold mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        mpj (mdl M (H \\<minusplus> K)) K (x \\<plusminus> \\<zero>) =\n        K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:iotam_def mpj_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (if x \\<plusminus> \\<zero> \\<in> carrier (mdl M (H \\<minusplus> K))\n         then (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\n         else undefined) =\n        K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule  sSum_two_Submodules[of H K], assumption+, simp add:mdl_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (if x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\n         then (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\n         else undefined) =\n        K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule submodule_asubg[of H], frule submodule_asubg[of K])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (if x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\n         then (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\n         else undefined) =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule_tac h = x and k = \\<zero> in mem_sum_subgs[of H K], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (if x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\n         then (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\n         else undefined) =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> K\n 2. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (if x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\n         then (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\n         else undefined) =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:submodule_inc_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (if x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\n         then (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K\n         else undefined) =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule mhomom3Tr[of H K], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "(*thm Module.m_in_mr_coset[of \"mdl M (H \\<minusplus> K)\" R K]\n apply (frule_tac m = \"x \\<plusminus> \\<zero>\" in Module.m_in_mr_coset[of \"mdl M (H \\<minusplus> K)\" R K])*)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule sSum_two_Submodules[of H K], assumption,\n       frule mdl_is_module [of  \"H \\<minusplus> K\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        submodule R M (H \\<minusplus> K);\n        R module mdl M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule_tac m = \"x \\<plusminus> \\<zero>\" in Module.m_in_mr_coset[of \"mdl M (H \\<minusplus> K)\" R K],\n                          assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        submodule R M (H \\<minusplus> K);\n        R module mdl M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> \\<zero>\n                         \\<in> carrier (mdl M (H \\<minusplus> K))\n 2. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        submodule R M (H \\<minusplus> K); M +> H; M +> K;\n        x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n        x \\<plusminus> \\<zero>\n        \\<in> (x \\<plusminus>\n               \\<zero>) \\<uplus>\\<^bsub>mdl M\n   (H \\<minusplus> K)\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 3. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:mdl_carrier, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        M +> H; M +> K; x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n        x \\<plusminus> \\<zero> \\<in> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (frule submodule_subset[of H], \n        frule_tac c = x in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K; x \\<in> H;\n        (x \\<plusminus>\n         \\<zero>) \\<uplus>\\<^bsub>mdl M (H \\<minusplus> K)\\<^esub> K =\n        K;\n        M +> H; M +> K; x \\<plusminus> \\<zero> \\<in> H \\<minusplus> K;\n        submodule R (mdl M (H \\<minusplus> K)) K;\n        submodule R M (H \\<minusplus> K); R module mdl M (H \\<minusplus> K);\n        x \\<plusminus> \\<zero> \\<in> K; H \\<subseteq> carrier M;\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> K\n 2. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> H \\<inter> K\n                      \\<subseteq> ker\\<^bsub>mdl M\n        H,mdl M (H \\<minusplus> K) /\\<^sub>m\n          K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                     (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<inter> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ker\\<^bsub>mdl M\n       H,mdl M (H \\<minusplus> K) /\\<^sub>m\n         K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                    (\\<iota>m\\<^bsub>M H,K\\<^esub>)", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (mdl M H) \\<and>\n                         compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                          (\\<iota>m\\<^bsub>M H,K\\<^esub>) x =\n                         \\<zero>\\<^bsub>mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                          (\\<iota>m\\<^bsub>M H,K\\<^esub>) x =\n                         \\<zero>\\<^bsub>mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n                          (\\<iota>m\\<^bsub>M H,K\\<^esub>) x =\n                         K", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (x \\<in> carrier (mdl M H) \\<longrightarrow>\n                          mpj (mdl M (H \\<minusplus> K)) K\n                           ((\\<iota>m\\<^bsub>M H,K\\<^esub>) x) =\n                          K) \\<and>\n                         (x \\<notin> carrier (mdl M H) \\<longrightarrow>\n                          undefined = K)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> mpj (mdl M (H \\<minusplus> K)) K\n                          ((\\<iota>m\\<^bsub>M H,K\\<^esub>) x) =\n                         K", "apply (simp add:iotam_def mpj_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> \\<zero>\n                          \\<in> carrier\n                                 (mdl M\n                                   (H \\<minusplus> K)) \\<longrightarrow>\n                          (x \\<plusminus>\n                           \\<zero>) \\<uplus>\\<^bsub>mdl M\n               (H \\<minusplus> K)\\<^esub> K =\n                          K) \\<and>\n                         (x \\<plusminus> \\<zero>\n                          \\<notin> carrier\n                                    (mdl M\n(H \\<minusplus> K)) \\<longrightarrow>\n                          undefined = K)", "apply (frule sSum_two_Submodules[of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> \\<zero>\n                          \\<in> carrier\n                                 (mdl M\n                                   (H \\<minusplus> K)) \\<longrightarrow>\n                          (x \\<plusminus>\n                           \\<zero>) \\<uplus>\\<^bsub>mdl M\n               (H \\<minusplus> K)\\<^esub> K =\n                          K) \\<and>\n                         (x \\<plusminus> \\<zero>\n                          \\<notin> carrier\n                                    (mdl M\n(H \\<minusplus> K)) \\<longrightarrow>\n                          undefined = K)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        x \\<in> H \\<and> x \\<in> K;\n        submodule R M (H \\<minusplus> K)\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> \\<zero>\n                          \\<in> H \\<minusplus> K \\<longrightarrow>\n                          (x \\<plusminus>\n                           \\<zero>) \\<uplus>\\<^bsub>mdl M\n               (H \\<minusplus> K)\\<^esub> K =\n                          K) \\<and>\n                         (x \\<plusminus> \\<zero>\n                          \\<notin> H \\<minusplus> K \\<longrightarrow>\n                          undefined = K)", "apply (erule conjE,\n        frule submodule_inc_0[of K],\n        frule submodule_asubg[of H], frule submodule_asubg[of K],\n       simp add:mem_sum_subgs)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        submodule R M (H \\<minusplus> K); x \\<in> H; x \\<in> K;\n        \\<zero> \\<in> K; M +> H; M +> K\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus>\n                          \\<zero>) \\<uplus>\\<^bsub>mdl M\n              (H \\<minusplus> K)\\<^esub> K =\n                         K", "apply (frule submodule_subset[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        submodule R M (H \\<minusplus> K); x \\<in> H; x \\<in> K;\n        \\<zero> \\<in> K; M +> H; M +> K; K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus>\n                          \\<zero>) \\<uplus>\\<^bsub>mdl M\n              (H \\<minusplus> K)\\<^esub> K =\n                         K", "apply (\n        frule_tac c = x in subsetD[of K \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        submodule R M (H \\<minusplus> K); x \\<in> H; x \\<in> K;\n        \\<zero> \\<in> K; M +> H; M +> K; K \\<subseteq> carrier M;\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus>\n                          \\<zero>) \\<uplus>\\<^bsub>mdl M\n              (H \\<minusplus> K)\\<^esub> K =\n                         K", "apply (simp add:ag_r_zero,\n        frule mdl_is_module [of  \"H \\<minusplus> K\"],\n        frule mhomom3Tr[of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M H; submodule R M K;\n        submodule R M (H \\<minusplus> K); x \\<in> H; x \\<in> K;\n        \\<zero> \\<in> K; M +> H; M +> K; K \\<subseteq> carrier M;\n        x \\<in> carrier M; R module mdl M (H \\<minusplus> K);\n        submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>mdl M\n      (H \\<minusplus> K)\\<^esub> K =\n                         K", "apply (frule_tac h1 = x in Module.mr_cos_h_stable[THEN sym, of \"mdl M (H \\<minusplus> K)\"\n         R K], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mhomom_3:\"\\<lbrakk>submodule R M H; submodule R M K\\<rbrakk> \\<Longrightarrow>\n                 (mdl M H) /\\<^sub>m (H \\<inter> K) \\<cong>\\<^bsub>R\\<^esub> (mdl M (H \\<minusplus> K)) /\\<^sub>m K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (frule sSum_two_Submodules [of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K)\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (frule mdl_is_module [of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (frule mdl_is_module [of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H;\n     R module mdl M K\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (frule mdl_is_module [of \"H \\<minusplus> K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K)\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (frule mhomom3Tr [of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (frule Module.qmodule_module [of \"mdl M (H \\<minusplus> K)\" R K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K\\<rbrakk>\n    \\<Longrightarrow> mdl M H /\\<^sub>m\n                      (H \\<inter>\n                       K) \\<cong>\\<^bsub>R\\<^esub> mdl M\n              (H \\<minusplus> K) /\\<^sub>m\n             K", "apply (simp add:misomorphic_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         bijec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (frule mhomom3Tr0[of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         bijec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (frule mhomom3Tr1[of H K], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     surjec\\<^bsub>mdl M\n                    H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         bijec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (frule Module.indmhom [of \"mdl M H\" R \"mdl M (H \\<minusplus> K) /\\<^sub>m K\" \"compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     surjec\\<^bsub>mdl M\n                    H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>);\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                        H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\n     \\<in> mHom R\n            (mdl M H /\\<^sub>m\n             (ker\\<^bsub>mdl M\n                          H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                            K\\<^esub> compos (mdl M H)\n (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         bijec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (frule Module.indmhom_injec[of \"mdl M H\" R \"mdl M (H \\<minusplus> K) /\\<^sub>m K\"\n     \"compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     surjec\\<^bsub>mdl M\n                    H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>);\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                        H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\n     \\<in> mHom R\n            (mdl M H /\\<^sub>m\n             (ker\\<^bsub>mdl M\n                          H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                            K\\<^esub> compos (mdl M H)\n (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     injec\\<^bsub>mdl M H /\\<^sub>m\n                  (ker\\<^bsub>mdl M\n                               H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                 K\\<^esub> compos (mdl M H)\n      (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)),mdl M (H \\<minusplus> K) /\\<^sub>m\n K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                              H, mdl M (H \\<minusplus> K) /\\<^sub>m\n                                 K\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         bijec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (frule Module.indmhom_surjec1[of  \"mdl M H\" R \"mdl M (H \\<minusplus> K) /\\<^sub>m K\" \"compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     surjec\\<^bsub>mdl M\n                    H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>);\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                        H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\n     \\<in> mHom R\n            (mdl M H /\\<^sub>m\n             (ker\\<^bsub>mdl M\n                          H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                            K\\<^esub> compos (mdl M H)\n (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     injec\\<^bsub>mdl M H /\\<^sub>m\n                  (ker\\<^bsub>mdl M\n                               H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                 K\\<^esub> compos (mdl M H)\n      (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)),mdl M (H \\<minusplus> K) /\\<^sub>m\n K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                              H, mdl M (H \\<minusplus> K) /\\<^sub>m\n                                 K\\<^esub>;\n     surjec\\<^bsub>mdl M H /\\<^sub>m\n                   (ker\\<^bsub>mdl M\n                                H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                  K\\<^esub> compos (mdl M H)\n       (mpj (mdl M (H \\<minusplus> K)) K)\n       (\\<iota>m\\<^bsub>M H,K\\<^esub>)),mdl M (H \\<minusplus> K) /\\<^sub>m\n  K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                               H, mdl M (H \\<minusplus> K) /\\<^sub>m\n                                  K\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         bijec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     surjec\\<^bsub>mdl M\n                    H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>);\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                        H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\n     \\<in> mHom R\n            (mdl M H /\\<^sub>m\n             (ker\\<^bsub>mdl M\n                          H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                            K\\<^esub> compos (mdl M H)\n (mpj (mdl M (H \\<minusplus> K)) K) (\\<iota>m\\<^bsub>M H,K\\<^esub>)))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     injec\\<^bsub>mdl M H /\\<^sub>m\n                  (ker\\<^bsub>mdl M\n                               H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                 K\\<^esub> compos (mdl M H)\n      (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)),mdl M (H \\<minusplus> K) /\\<^sub>m\n K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n            (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                              H, mdl M (H \\<minusplus> K) /\\<^sub>m\n                                 K\\<^esub>;\n     surjec\\<^bsub>mdl M H /\\<^sub>m\n                   (ker\\<^bsub>mdl M\n                                H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                                  K\\<^esub> compos (mdl M H)\n       (mpj (mdl M (H \\<minusplus> K)) K)\n       (\\<iota>m\\<^bsub>M H,K\\<^esub>)),mdl M (H \\<minusplus> K) /\\<^sub>m\n  K\\<^esub> compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n             (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                               H, mdl M (H \\<minusplus> K) /\\<^sub>m\n                                  K\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         injec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f \\<and>\n                         surjec\\<^bsub>mdl M H /\\<^sub>m\n (H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply (simp add:mhomom3Tr2[of H K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M H; submodule R M K;\n     submodule R M (H \\<minusplus> K); R module mdl M H; R module mdl M K;\n     R module mdl M (H \\<minusplus> K);\n     submodule R (mdl M (H \\<minusplus> K)) K;\n     R module mdl M (H \\<minusplus> K) /\\<^sub>m K;\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\n     \\<in> mHom R (mdl M H) (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     surjec\\<^bsub>mdl M\n                    H,mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>);\n     compos (mdl M H) (mpj (mdl M (H \\<minusplus> K)) K)\n      (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl M\n                        H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\n     \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n            (mdl M (H \\<minusplus> K) /\\<^sub>m K);\n     injec\\<^bsub>mdl M H /\\<^sub>m\n                  (H \\<inter>\n                   K),mdl M (H \\<minusplus> K) /\\<^sub>m\n                      K\\<^esub> compos (mdl M H)\n                                 (mpj (mdl M (H \\<minusplus> K)) K)\n                                 (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl\n             M H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>;\n     surjec\\<^bsub>mdl M H /\\<^sub>m\n                   (H \\<inter>\n                    K),mdl M (H \\<minusplus> K) /\\<^sub>m\n                       K\\<^esub> compos (mdl M H)\n                                  (mpj (mdl M (H \\<minusplus> K)) K)\n                                  (\\<iota>m\\<^bsub>M H,K\\<^esub>)\\<^sup>\\<flat>\\<^bsub>R mdl\n              M H, mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> mHom R (mdl M H /\\<^sub>m (H \\<inter> K))\n                                  (mdl M (H \\<minusplus> K) /\\<^sub>m\n                                   K) \\<and>\n                         injec\\<^bsub>mdl M H /\\<^sub>m\n(H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f \\<and>\n                         surjec\\<^bsub>mdl M H /\\<^sub>m\n (H \\<inter> K),mdl M (H \\<minusplus> K) /\\<^sub>m K\\<^esub> f", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  l_comb :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, nat] \\<Rightarrow>\n    (nat \\<Rightarrow> 'r) \\<Rightarrow> (nat \\<Rightarrow> 'a) \\<Rightarrow> 'a\" where\n  \"l_comb R M n s m = nsum M (\\<lambda>j. (s j) \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> (m j)) n\""], ["", "definition\n  linear_span :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, 'r set,\n              'a set] \\<Rightarrow> 'a set\" where\n  \"linear_span R M A H = (if H = {} then {\\<zero>\\<^bsub>M\\<^esub>} else \n                           {x. \\<exists>n. \\<exists>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H.\n         \\<exists>s\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> A.  x = l_comb R M n s f})\""], ["", "definition\n  coefficient :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme,\n               nat, nat \\<Rightarrow> 'r, nat \\<Rightarrow> 'a] \\<Rightarrow> nat \\<Rightarrow> 'r\" where\n  \"coefficient R M n s m j = s j\""], ["", "definition\n  body :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, nat, nat \\<Rightarrow> 'r, \n         nat \\<Rightarrow> 'a] \\<Rightarrow> nat \\<Rightarrow> 'a\" where\n  \"body R M n s m j = m j\""], ["", "lemma (in Module) l_comb_mem_linear_span:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n                    l_comb R M n s f \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H", "apply (frule_tac x = 0 in funcset_mem[of f \"{j. j \\<le> n}\" H], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H; f 0 \\<in> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H", "apply (frule nonempty[of \"f 0\" H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H; f 0 \\<in> H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H; f 0 \\<in> H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>na.\n                         \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                            \\<exists>sa\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               l_comb R M n s f = l_comb R M na sa fa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_comb_eqTr:\"H \\<subseteq> carrier M \\<Longrightarrow> \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R \\<and> \n      f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> \n      g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> \n      (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow> \n      l_comb R M n s f = l_comb R M n s g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n    f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n    g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n    (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n    l_comb R M n s f = l_comb R M n s g", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n    f \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n    g \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n    (\\<forall>j\\<in>{j. j \\<le> 0}. f j = g j) \\<longrightarrow>\n    l_comb R M 0 s f = l_comb R M 0 s g\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                             f j = g j) \\<longrightarrow>\n                         l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     g \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     (\\<forall>j\\<in>{j. j \\<le> 0}. f j = g j)\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f = l_comb R M 0 s g\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                             f j = g j) \\<longrightarrow>\n                         l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n     \\<forall>j\\<in>{j. j \\<le> 0}. f j = g j\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f = l_comb R M 0 s g\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                             f j = g j) \\<longrightarrow>\n                         l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                             f j = g j) \\<longrightarrow>\n                         l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> Suc n}. f j = g j)\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        \\<forall>j\\<in>{j. j \\<le> Suc n}. f j = g j\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (frule_tac f = s in func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        \\<forall>j\\<in>{j. j \\<le> Suc n}. f j = g j;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (frule_tac f = f in func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        \\<forall>j\\<in>{j. j \\<le> Suc n}. f j = g j;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (frule_tac f = g in func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> n}. f j = g j) \\<longrightarrow>\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        \\<forall>j\\<in>{j. j \\<le> Suc n}. f j = g j;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        \\<forall>j\\<le>Suc n. f j = g j;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n        thin_tac \"f \\<in> {j. j \\<le> n} \\<rightarrow> H\",\n        thin_tac \"g \\<in> {j. j \\<le> n} \\<rightarrow> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R M n s f = l_comb R M n s g;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        \\<forall>j\\<le>Suc n. f j = g j\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f = l_comb R M (Suc n) s g", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_comb_eq:\"\\<lbrakk>H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R; f \\<in> {j. j \\<le> n} \\<rightarrow> H; \n       g \\<in> {j. j \\<le> n} \\<rightarrow> H; \\<forall>j\\<in>{j. j \\<le> n}. f j = g j\\<rbrakk>  \\<Longrightarrow>\n  l_comb R M n s f = l_comb R M n s g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     \\<forall>j\\<in>{j. j \\<le> n}. f j = g j\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s f = l_comb R M n s g", "apply (simp add:linear_comb_eqTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_Suc:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A; \n       s \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier R; f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> H\\<rbrakk>  \\<Longrightarrow>\n       l_comb R M (Suc n) s f = l_comb R M n s f \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M (Suc n) s f =\n                      l_comb R M n s f \\<plusminus>\n                      s (Suc n) \\<cdot>\\<^sub>s f (Suc n)", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_jointfun_jj:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        nsum M (\\<lambda>j. (jointfun n s m t) j \\<cdot>\\<^sub>s (jointfun n f m g) j) n =\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j\n                         \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, rule impI, simp add:jointfun_def,\n        rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, rule impI, \n        rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, simp add:jointfun_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_jointfun_jj1:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        l_comb R M n (jointfun n s m t) (jointfun n f m g) =\n        l_comb R M n s f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n (jointfun n s m t) (jointfun n f m g) =\n                      l_comb R M n s f", "by (simp add:l_comb_def, simp add:l_comb_jointfun_jj)"], ["", "lemma (in Module) l_comb_jointfun_jf:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow>\n        nsum M (\\<lambda>j. (jointfun n s m t) j \\<cdot>\\<^sub>s f j) n =\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s f j) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s f j) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s f j\n                         \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s f j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, rule impI, simp add:jointfun_def,\n        rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s f j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, rule impI, \n        rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         jointfun n s m t j \\<cdot>\\<^sub>s f j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, simp add:jointfun_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_jointfun_jf1:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow>\n        l_comb R M n (jointfun n s m t) f = l_comb R M n s f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n (jointfun n s m t) f = l_comb R M n s f", "by (simp add:l_comb_def l_comb_jointfun_jf)"], ["", "lemma (in Module) l_comb_jointfun_fj:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (jointfun n f m g) j) n =\n        nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s jointfun n f m g j) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s jointfun n f m g j) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s jointfun n f m g j\n                         \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s jointfun n f m g j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, rule impI, simp add:jointfun_def,\n        rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s jointfun n f m g j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, rule impI, \n        rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         s j \\<cdot>\\<^sub>s jointfun n f m g j =\n                         s j \\<cdot>\\<^sub>s f j", "apply (rule allI, simp add:jointfun_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_jointfun_fj1:\"\\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n        s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A; f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n        l_comb R M n s (jointfun n f m g) = l_comb R M n s f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; ideal R A;\n     s \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s (jointfun n f m g) = l_comb R M n s f", "by (simp add:l_comb_def l_comb_jointfun_fj)"], ["", "lemma (in Module) linear_comb0_1Tr:\"H \\<subseteq> carrier M \\<Longrightarrow> \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>} \\<and>  \n      m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow> l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n    m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n    l_comb R M n s m = \\<zero>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    s \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n    m \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<longrightarrow>\n    l_comb R M 0 s m = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n     m \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s m = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     m \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s m = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (simp add:l_comb_def subsetD sc_0_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (frule func_pre [of _ _ \"{\\<zero>\\<^bsub>R\\<^esub>}\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (frule func_pre [of _ _ \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>} \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\",\n        thin_tac \"m \\<in> {j. j \\<le> n} \\<rightarrow> H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n =\n        \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s m (Suc n) =\n                         \\<zero>", "apply (frule_tac x = \"Suc n\" and f = s and A = \"{j. j \\<le> Suc n}\" in \n        funcset_mem[of _ _ \"{\\<zero>\\<^bsub>R\\<^esub>}\"], simp, simp,\n        frule_tac x = \"Suc n\" and f = m and A = \"{j. j \\<le> Suc n}\" in \n        funcset_mem[of _ _ H], simp,\n        frule_tac c = \"m (Suc n)\" in subsetD[of H \"carrier M\"], assumption+,\n        simp add:sc_0_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n =\n        \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>; m (Suc n) \\<in> H;\n        m (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (cut_tac ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n =\n        \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>; m (Suc n) \\<in> H;\n        m (Suc n) \\<in> carrier M; \\<zero> \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (simp add:ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_comb0_1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}; m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<rbrakk> \\<Longrightarrow> \n      l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     m \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s m = \\<zero>", "apply (simp add:linear_comb0_1Tr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_comb0_2Tr:\"ideal R A \\<Longrightarrow> s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \n      \\<and>  m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>M\\<^esub>} \\<longrightarrow> l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n    m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n    l_comb R M n s m = \\<zero>", "apply (induct_tac n )"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n    m \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n    l_comb R M 0 s m = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>} \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n     m \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s m = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>} \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     m \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s m = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>} \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (simp add:l_comb_def sc_a_0 sc_Ring Ring.ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n        l_comb R M n s m = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {\\<zero>} \\<longrightarrow>\n                         l_comb R M (Suc n) s m = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n        l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>} \\<longrightarrow>\n        l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (frule func_pre [of \"s\"],\n        frule func_pre [of \"m\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> A\",\n         thin_tac \"m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; l_comb R M n s m = \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m = \\<zero>", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n =\n        \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s m (Suc n) =\n                         \\<zero>", "apply (frule_tac A = \"{j. j \\<le> Suc n}\" and x = \"Suc n\" in \n         funcset_mem [of \"m\" _ \"{\\<zero>}\"], simp+,\n         frule_tac A = \"{j. j \\<le> Suc n}\" and x = \"Suc n\" in \n         funcset_mem[of s _ A], simp+,\n         cut_tac sc_Ring,\n         frule_tac h = \"s (Suc n)\" in Ring.ideal_subset[of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n =\n        \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>};\n        m (Suc n) = \\<zero>; s (Suc n) \\<in> A; Ring R;\n        s (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s \\<zero> =\n                         \\<zero>", "apply (cut_tac ag_inc_zero, simp add:sc_a_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n =\n        \\<zero>;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> {\\<zero>};\n        m (Suc n) = \\<zero>; s (Suc n) \\<in> A; Ring R;\n        s (Suc n) \\<in> carrier R; \\<zero> \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (simp add:ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_comb0_2:\"\\<lbrakk>ideal R A;  s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;\n       m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>M\\<^esub>} \\<rbrakk> \\<Longrightarrow>  l_comb R M n s m = \\<zero>\\<^bsub>M\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     m \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s m = \\<zero>", "apply (simp add:linear_comb0_2Tr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) liear_comb_memTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>\n \\<forall>s. \\<forall>m. s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n          m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow> l_comb R M n s m \\<in> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s m.\n                         s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M n s m \\<in> carrier M", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s m.\n                         s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M 0 s m \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s m.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            l_comb R M (Suc n) s m \\<in> carrier M", "apply (rule allI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M 0 s m \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s m.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            l_comb R M (Suc n) s m \\<in> carrier M", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0 s m \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s m.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            l_comb R M (Suc n) s m \\<in> carrier M", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0 s m \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s m.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            l_comb R M (Suc n) s m \\<in> carrier M", "apply (simp add: l_comb_def sc_mem Ring.ideal_subset[of R A] subsetD sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s m.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            l_comb R M (Suc n) s m \\<in> carrier M", "apply (rule allI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         m \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         l_comb R M (Suc n) s m \\<in> carrier M", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m \\<in> carrier M", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s m.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           l_comb R M n s m \\<in> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m \\<in> carrier M", "apply (frule func_pre [of _ _ \"A\"],\n        frule func_pre [of _ _ \"H\"],\n        drule_tac x = s in spec,\n        drule_tac x = m in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        l_comb R M n s m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s m \\<in> carrier M", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s m j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s m (Suc n)\n                         \\<in> carrier M", "apply (rule ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<cdot>\\<^sub>s m (Suc n) \\<in> carrier M", "apply (rule sc_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<in> carrier R\n 2. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> m (Suc n) \\<in> carrier M", "apply (cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s m j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> m (Suc n) \\<in> carrier M", "apply (simp add:Pi_def subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_mem:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; m \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow> \n      l_comb R M n s m \\<in> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     m \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s m \\<in> carrier M", "apply (simp add:liear_comb_memTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_transpos:\" \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n      s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A; f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n      j < Suc n \\<rbrakk> \\<Longrightarrow> \n     \\<Sigma>\\<^sub>e M (cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n))) (Suc n) =\n       \\<Sigma>\\<^sub>e M (\\<lambda>k. (cmp s (transpos j (Suc n))) k \\<cdot>\\<^sub>s\n                  (cmp f (transpos j (Suc n))) k) (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n)) Suc n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n       cmp f (transpos j (Suc n)) k) Suc n", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n)) Suc n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n       cmp f (transpos j (Suc n)) k) Suc n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja\n                         \\<in> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ja.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R;\n        ja \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> s (transpos j (Suc n) ja) \\<cdot>\\<^sub>s\n                         f (transpos j (Suc n) ja)\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja\n                         \\<in> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (cut_tac l = ja in transpos_mem[of j \"Suc n\" \"Suc n\"],\n        simp add:less_imp_le, simp, simp, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ja.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R;\n        ja \\<le> Suc n; transpos j (Suc n) ja \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> s (transpos j (Suc n) ja) \\<cdot>\\<^sub>s\n                         f (transpos j (Suc n) ja)\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja\n                         \\<in> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ja.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R;\n        ja \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> s (transpos j (Suc n) ja) \\<cdot>\\<^sub>s\n                         f (transpos j (Suc n) ja)\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (frule less_imp_le[of j \"Suc n\"],\n        frule_tac l = ja in transpos_mem[of j \"Suc n\" \"Suc n\"], simp,\n        simp, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ja.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R;\n        ja \\<le> Suc n; j \\<le> Suc n;\n        transpos j (Suc n) ja \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> s (transpos j (Suc n) ja) \\<cdot>\\<^sub>s\n                         f (transpos j (Suc n) ja)\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>Suc n.\n                         cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                          (transpos j (Suc n)) ja =\n                         cmp s (transpos j (Suc n)) ja \\<cdot>\\<^sub>s\n                         cmp f (transpos j (Suc n)) ja", "apply (rule allI, rule impI,\n        simp add:cmp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_transpos1:\" \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n      s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A; f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n \\<rbrakk> \\<Longrightarrow> \n l_comb R M (Suc n) s f = \n  l_comb R M (Suc n) (cmp s (transpos j (Suc n))) (cmp f (transpos j (Suc n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n\\<rbrakk>\n    \\<Longrightarrow> l_comb R M (Suc n) s f =\n                      l_comb R M (Suc n) (cmp s (transpos j (Suc n)))\n                       (cmp f (transpos j (Suc n)))", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M (Suc n) s f =\n                      l_comb R M (Suc n) (cmp s (transpos j (Suc n)))\n                       (cmp f (transpos j (Suc n)))", "apply (frule l_comb_transpos[THEN sym, of A H s n f j], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n =\n     \\<Sigma>\\<^sub>e M cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                         (transpos j (Suc n)) Suc n\\<rbrakk>\n    \\<Longrightarrow> l_comb R M (Suc n) s f =\n                      l_comb R M (Suc n) (cmp s (transpos j (Suc n)))\n                       (cmp f (transpos j (Suc n)))", "apply (simp del:nsum_suc add:l_comb_def,\n        thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>k. (cmp s (transpos j (Suc n))) k \\<cdot>\\<^sub>s\n               (cmp f (transpos j (Suc n))) k) (Suc n) =\n     \\<Sigma>\\<^sub>e M (cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n))) (Suc n)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) Suc n =\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) (transpos j (Suc n)) Suc n", "apply (cut_tac addition2[of \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" n \"transpos j (Suc n)\"],\n         simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> transpos j (Suc n)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                            {j. j \\<le> Suc n}\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos j (Suc n)) {j. j \\<le> Suc n}", "apply (rule Pi_I, rule sc_mem,\n          simp add:Pi_def Ring.ideal_subset,\n          simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> transpos j (Suc n)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                            {j. j \\<le> Suc n}\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos j (Suc n)) {j. j \\<le> Suc n}", "apply (rule_tac i = j and n = \"Suc n\" and j = \"Suc n\" in transpos_hom,\n        simp add:less_imp_le, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H; j < Suc n; Ring R\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos j (Suc n)) {j. j \\<le> Suc n}", "apply (rule_tac i = j and n = \"Suc n\" and j = \"Suc n\" in transpos_inj,\n         simp add:less_imp_le, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sc_linear_span:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n h \\<in> H\\<rbrakk> \\<Longrightarrow> a \\<cdot>\\<^sub>s h \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s h \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> (H = {} \\<longrightarrow>\n                       a \\<cdot>\\<^sub>s h = \\<zero>) \\<and>\n                      (H \\<noteq> {} \\<longrightarrow>\n                       (\\<exists>n.\n                           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                 a \\<cdot>\\<^sub>s h = l_comb R M n s f))", "apply (simp add:nonempty)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               a \\<cdot>\\<^sub>s h = l_comb R M n s f", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               a \\<cdot>\\<^sub>s h =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) n", "apply (subgoal_tac \"(\\<lambda>k\\<in>{j. j \\<le> (0::nat)}. a) \\<in>{j. j \\<le> 0} \\<rightarrow> A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               a \\<cdot>\\<^sub>s h =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) n\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> A", "apply (subgoal_tac \"(\\<lambda>k\\<in>{j. j \\<le> 0}. h) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> H\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               a \\<cdot>\\<^sub>s h =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) n\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> A", "apply (subgoal_tac \"a \\<cdot>\\<^sub>s h = \n \\<Sigma>\\<^sub>e M (\\<lambda>j. (\\<lambda>k\\<in>{j. j \\<le> (0::nat)}. a) j \\<cdot>\\<^sub>s (\\<lambda>k\\<in>{j. j \\<le> (0::nat)}. h) j) 0\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n     a \\<cdot>\\<^sub>s h =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n                             j \\<cdot>\\<^sub>s\n                            (\\<lambda>k\\<in>{j. j \\<le> 0}. h) j) 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               a \\<cdot>\\<^sub>s h =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) n\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s h =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       (\\<lambda>k\\<in>{j. j \\<le> 0}. a) j \\<cdot>\\<^sub>s\n       (\\<lambda>k\\<in>{j. j \\<le> 0}. h) j) 0\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> A", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>s h =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       (\\<lambda>k\\<in>{j. j \\<le> 0}. a) j \\<cdot>\\<^sub>s\n       (\\<lambda>k\\<in>{j. j \\<le> 0}. h) j) 0\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A; h \\<in> H;\n     (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. h)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> A;\n     h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> 0}. a)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> A", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_cont_H:\"H \\<subseteq> carrier M \\<Longrightarrow> \n                      H \\<subseteq> linear_span R M (carrier R) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    H \\<subseteq> linear_span R M (carrier R) H", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R) H", "apply (cut_tac sc_Ring,\n       cut_tac Ring.whole_ideal[of R])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R) H\n 2. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R\\<rbrakk>\n       \\<Longrightarrow> Ring R", "apply (frule_tac A = \"carrier R\" and H = H and a = \"1\\<^sub>r\\<^bsub>R\\<^esub>\" \n       and h = x in sc_linear_span, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\n 2. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H\n 3. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R;\n        ideal R (carrier R);\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s x\n        \\<in> linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R) H\n 4. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R\\<rbrakk>\n       \\<Longrightarrow> Ring R", "apply (simp add:Ring.ring_one, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R;\n        ideal R (carrier R);\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s x\n        \\<in> linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R) H\n 2. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> H; Ring R\\<rbrakk>\n       \\<Longrightarrow> Ring R", "apply (frule_tac c = x in subsetD[of H \"carrier M\"], assumption+,\n        simp add:sprod_one, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_inc_0:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>  \\<Longrightarrow> \n                   \\<zero> \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H = {}\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H", "apply (frule nonempty_ex[of H], erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H", "apply (frule_tac h = x in sc_linear_span[of A H \"\\<zero>\\<^bsub>R\\<^esub>\"], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> A\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H\n 3. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> H;\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s x\n        \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H", "apply (cut_tac sc_Ring, simp add:Ring.ideal_zero, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> H;\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s x\n        \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> linear_span R M A H", "apply (frule_tac c = x in subsetD[of H \"carrier M\"], assumption,\n        simp add:sc_0_m)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_iOp_closedTr1:\"\\<lbrakk>ideal R A;\n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow>\n               (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) \\<in> {j. j \\<le> n} \\<rightarrow> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow> A", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x \\<in> {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                          x\n                         \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> s x \\<in> A", "apply (cut_tac sc_Ring,\n        rule Ring.ideal_inv1_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x \\<le> n; Ring R\\<rbrakk>\n       \\<Longrightarrow> s x \\<in> A", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_gen_mono:\"\\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A\\<rbrakk> \\<Longrightarrow>\n        linear_span R M A K \\<subseteq> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A K \\<subseteq> linear_span R M A H", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A;\n        x \\<in> linear_span R M A K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (case_tac \"K = {}\", simp add:linear_span_def[of _ _ _ \"{}\"],\n       simp add:linear_span_inc_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A;\n        x \\<in> linear_span R M A K; K \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (frule nonempty_ex[of K], erule exE,\n       frule_tac c = xa in subsetD[of K H], assumption+,\n       frule nonempty[of _ H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A;\n        x \\<in> linear_span R M A K; K \\<noteq> {}; xa \\<in> K; xa \\<in> H;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (simp add:linear_span_def[of _ _ _ K],\n       erule exE, (erule bexE)+, simp,\n       frule extend_fun[of _ _ K H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa n f s.\n       \\<lbrakk>K \\<subseteq> H; H \\<subseteq> carrier M; ideal R A;\n        K \\<noteq> {}; xa \\<in> K; xa \\<in> H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H", "apply (simp add: l_comb_mem_linear_span)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_add:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow>\n  l_comb R M (Suc (n + m)) (jointfun n s m t) (jointfun n f m g) =\n                                  l_comb R M n s f \\<plusminus> l_comb R M m t g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M (Suc (n + m)) (jointfun n s m t)\n                       (jointfun n f m g) =\n                      l_comb R M n s f \\<plusminus> l_comb R M m t g", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M (Suc (n + m)) (jointfun n s m t)\n                       (jointfun n f m g) =\n                      l_comb R M n s f \\<plusminus> l_comb R M m t g", "apply (simp del:nsum_suc add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) Suc (n + m) =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (subst nsum_split)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                         jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R;\n        j \\<le> Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (case_tac \"j \\<le> n\", simp add:jointfun_def,\n        rule sc_mem, simp add:Pi_def Ring.ideal_subset,\n       simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R; j \\<le> Suc (n + m);\n        \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R; j \\<le> Suc (n + m);\n        \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> t (j - Suc n) \\<cdot>\\<^sub>s g (j - Suc n)\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (frule_tac m = j and n = \"Suc (n + m)\" and l = \"Suc n\" in diff_le_mono,\n        thin_tac \"j \\<le> Suc (n + m)\", simp,\n        rule sc_mem, simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (simp add:l_comb_jointfun_jj[of H A s n f t m g])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M cmp\n    (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       t j \\<cdot>\\<^sub>s g j) m", "apply (cut_tac nsum_eq[of m \"cmp (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s \n        jointfun n f m g j) (slide (Suc n))\" \"\\<lambda>j. t j \\<cdot>\\<^sub>s g j\"], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (\\<lambda>j.\n                                 jointfun n s m t j \\<cdot>\\<^sub>s\n                                 jointfun n f m g j)\n                          (slide (Suc n)) j\n                         \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         t j \\<cdot>\\<^sub>s g j \\<in> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (\\<lambda>j.\n                                 jointfun n s m t j \\<cdot>\\<^sub>s\n                                 jointfun n f m g j)\n                          (slide (Suc n)) j =\n                         t j \\<cdot>\\<^sub>s g j", "apply (rule allI, rule impI, simp add:cmp_def,\n        simp add:jointfun_def sliden_def slide_def,\n        rule sc_mem, simp add:Pi_def Ring.ideal_subset,\n       simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         t j \\<cdot>\\<^sub>s g j \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (\\<lambda>j.\n                                 jointfun n s m t j \\<cdot>\\<^sub>s\n                                 jointfun n f m g j)\n                          (slide (Suc n)) j =\n                         t j \\<cdot>\\<^sub>s g j", "apply (rule allI, rule impI,\n        rule sc_mem, simp add:Pi_def Ring.ideal_subset,\n       simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (\\<lambda>j.\n                                 jointfun n s m t j \\<cdot>\\<^sub>s\n                                 jointfun n f m g j)\n                          (slide (Suc n)) j =\n                         t j \\<cdot>\\<^sub>s g j", "apply (simp add:cmp_def jointfun_def sliden_def slide_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_add1Tr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>\n  f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H \\<and> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and> t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n    l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. (s x) \\<plusminus>\\<^bsub>R\\<^esub> (t x)) f =\n      l_comb R M n s f \\<plusminus> l_comb R M n t f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n                      s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      t \\<in> {j. j \\<le> n} \\<rightarrow>\n                              A \\<longrightarrow>\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n                       f =\n                      l_comb R M n s f \\<plusminus> l_comb R M n t f", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      t \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              A \\<longrightarrow>\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{j. j \\<le> 0}.\n                           s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n                       f =\n                      l_comb R M 0 s f \\<plusminus> l_comb R M 0 t f\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n         f =\n        l_comb R M n s f \\<plusminus> l_comb R M n t f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         t \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 A \\<longrightarrow>\n                         l_comb R M (Suc n)\n                          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                              s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n                          f =\n                         l_comb R M (Suc n) s f \\<plusminus>\n                         l_comb R M (Suc n) t f", "apply (simp add:l_comb_def sc_Ring Ring.ideal_subset subsetD sc_l_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n         f =\n        l_comb R M n s f \\<plusminus> l_comb R M n t f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         t \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 A \\<longrightarrow>\n                         l_comb R M (Suc n)\n                          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                              s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n                          f =\n                         l_comb R M (Suc n) s f \\<plusminus>\n                         l_comb R M (Suc n) t f", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n         f =\n        l_comb R M n s f \\<plusminus> l_comb R M n t f;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n)\n                          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                              s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n                          f =\n                         l_comb R M (Suc n) s f \\<plusminus>\n                         l_comb R M (Suc n) t f", "apply (frule func_pre[of f], frule func_pre[of s], frule func_pre[of t],\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        l_comb R M n\n         (\\<lambda>a.\n             if a \\<le> n then s a \\<plusminus>\\<^bsub>R\\<^esub> t a\n             else undefined)\n         f =\n        l_comb R M n s f \\<plusminus> l_comb R M n t f;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n)\n                          (\\<lambda>a.\n                              if a \\<le> Suc n\n                              then s a \\<plusminus>\\<^bsub>R\\<^esub> t a\n                              else undefined)\n                          f =\n                         l_comb R M (Suc n) s f \\<plusminus>\n                         l_comb R M (Suc n) t f", "apply (simp add:l_comb_def, cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n           else undefined) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (cut_tac n = n and f = \"\\<lambda>j. (if j \\<le> n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j else undefined) \\<cdot>\\<^sub>s f j\" and g = \"\\<lambda>j. (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j else undefined) \\<cdot>\\<^sub>s\n                     f j\" in nsum_eq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> Suc n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j =\n                            (if j \\<le> Suc n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> Suc n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n           else undefined) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (rule allI, rule impI, simp,\n         rule sc_mem, frule Ring.ring_is_ag,\n         rule aGroup.ag_pOp_closed[of R], assumption,\n         simp add:Pi_def Ring.ideal_subset,\n         simp add:Pi_def Ring.ideal_subset,\n         simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> Suc n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j =\n                            (if j \\<le> Suc n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> Suc n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n           else undefined) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (rule allI, rule impI, simp,\n         rule sc_mem, frule Ring.ring_is_ag,\n         rule aGroup.ag_pOp_closed[of R], assumption,\n         simp add:Pi_def Ring.ideal_subset,\n         simp add:Pi_def Ring.ideal_subset,\n         simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j =\n                            (if j \\<le> Suc n\n                             then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                             else undefined) \\<cdot>\\<^sub>s\n                            f j\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> Suc n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n           else undefined) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> Suc n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n           else undefined) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> Suc n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then s j \\<plusminus>\\<^bsub>R\\<^esub> t j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. (if j \\<le> n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j else undefined) \\<cdot>\\<^sub>s f j)\n        n =  \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\",\n        thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. (if j \\<le> Suc n then s j \\<plusminus>\\<^bsub>R\\<^esub> t j else undefined) \\<cdot>\\<^sub>s \n        f j) n = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (frule_tac x = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" in \n        funcset_mem[of s _ A], simp,\n        frule_tac x = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" in \n        funcset_mem[of t _ A], simp,\n        frule_tac x = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" in\n        funcset_mem[of f _ H], simp,\n        cut_tac sc_Ring,\n        frule_tac h = \"s (Suc n)\" in Ring.ideal_subset, assumption+,\n        frule_tac h = \"t (Suc n)\" in Ring.ideal_subset, assumption+,\n        frule_tac c = \"f (Suc n)\" in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; Ring R; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (simp add:sc_l_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (cut_tac n = n and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" in nsum_mem,\n        rule allI, rule impI,  rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (cut_tac n = n and f = \"\\<lambda>j. t j \\<cdot>\\<^sub>s f j\" in nsum_mem,\n        rule allI, rule impI,  rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (cut_tac a = \"s (Suc n)\" and m = \"f (Suc n)\" in sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (cut_tac a = \"t (Suc n)\" and m = \"f (Suc n)\" in sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (subst pOp_assocTr41[THEN sym], assumption+,\n        subst pOp_assocTr42, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s f (Suc n)) \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (frule_tac x = \"\\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\" and \n         y = \"s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\" in ag_pOp_commute, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s (Suc n) \\<in> A;\n        t (Suc n) \\<in> A; f (Suc n) \\<in> H; Ring R;\n        s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                          \\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n) \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                          t (Suc n) \\<cdot>\\<^sub>s f (Suc n))", "apply (subst pOp_assocTr42[THEN sym], assumption+,\n         subst pOp_assocTr41, assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_add1:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; s \\<in> {j. j \\<le> n} \\<rightarrow> A; t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<rbrakk> \\<Longrightarrow> \n   l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. (s x) \\<plusminus>\\<^bsub>R\\<^esub> (t x)) f =\n                                l_comb R M n s f \\<plusminus> l_comb R M n t f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           s x \\<plusminus>\\<^bsub>R\\<^esub> t x)\n                       f =\n                      l_comb R M n s f \\<plusminus> l_comb R M n t f", "apply (simp add:l_comb_add1Tr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_iOp_closedTr2:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>  \\<Longrightarrow>\n       -\\<^sub>a (l_comb R M n s f) = \n           l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" and B = H and x = 0 in \n       funcset_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f", "apply (frule_tac A = A and s = s in linear_span_iOp_closedTr1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f", "apply (frule l_comb_add1[of A H f n s \"\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)\"], \n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f", "apply (cut_tac linear_comb0_1[of H \"\\<lambda>x\\<in>{j. j \\<le> n}. s x \\<plusminus>\\<^bsub>R\\<^esub> \n                  (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) x\" n f])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (simp,\n       thin_tac \"l_comb R M n\n (\\<lambda>x\\<in>{j. j \\<le> n}. s x \\<plusminus>\\<^bsub>R\\<^esub> (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> (s x) else undefined)) f = \\<zero>\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (frule l_comb_mem[of A H s n f], assumption+,\n        frule l_comb_mem[of A H \"\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)\" n f], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f =\n     \\<zero>;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (frule ag_mOp_closed[of \"l_comb R M n s f\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f =\n     \\<zero>;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M n s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (frule ag_pOp_assoc[of \"-\\<^sub>a (l_comb R M n s f)\" \"l_comb R M n s f\" \"l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) f\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f =\n     \\<zero>;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M n s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M n s f \\<plusminus> l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f =\n     -\\<^sub>a l_comb R M n s f \\<plusminus>\n     (l_comb R M n s f \\<plusminus>\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n       f)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a l_comb R M n s f =\n                      l_comb R M n\n                       (\\<lambda>x\\<in>{j. j \\<le> n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                       f\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (simp, simp add:ag_l_inv1, simp add:ag_l_zero, simp add:ag_r_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                           x)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n        (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub>\n             (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> s x\n              else undefined))\n         f =\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f;\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> s x =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (frule_tac x = x in funcset_mem[of s \"{j. j \\<le> n}\" A], simp,\n        cut_tac sc_Ring,\n        frule_tac h = \"s x\" in Ring.ideal_subset[of R A], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n        (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub>\n             (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> s x\n              else undefined))\n         f =\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f;\n        x \\<le> n; s x \\<in> A; Ring R; s x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> s x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> s x =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (frule Ring.ring_is_ag[of R],\n        simp add:aGroup.ag_r_inv1[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A; f 0 \\<in> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) x)\n      f =\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_iOp_closed:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n a \\<in> linear_span R M A H\\<rbrakk> \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; H = {}\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; a = \\<zero>; H = {}\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<zero> = \\<zero>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H", "apply (simp add:ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> linear_span R M A H", "apply (simp add:linear_span_def, erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                  -\\<^sub>a a = l_comb R M n s f", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  -\\<^sub>a l_comb R M n s f =\n                                  l_comb R M na sa fa", "apply (frule_tac f = f and n = n and s = s in \n                 linear_span_iOp_closedTr2[of A H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        -\\<^sub>a l_comb R M n s f =\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  -\\<^sub>a l_comb R M n s f =\n                                  l_comb R M na sa fa", "apply (subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) \\<in> {j. j \\<le> n} \\<rightarrow> A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        -\\<^sub>a l_comb R M n s f =\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f;\n        (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  -\\<^sub>a l_comb R M n s f =\n                                  l_comb R M na sa fa\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        -\\<^sub>a l_comb R M n s f =\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         f\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow> A", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        -\\<^sub>a l_comb R M n s f =\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         f\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow> A", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        -\\<^sub>a l_comb R M n s f =\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> s x) f;\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> s x \\<in> A", "apply(cut_tac sc_Ring,\n      rule Ring.ideal_inv1_closed, assumption+,\n      simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_pOp_closed:\n \"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; a \\<in> linear_span R M A H; b \\<in> linear_span R M A H\\<rbrakk>\n  \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; b \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; b \\<in> linear_span R M A H;\n     H = {}\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; b \\<in> linear_span R M A H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; a = \\<zero>; b = \\<zero>; H = {}\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; b \\<in> linear_span R M A H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H", "apply (cut_tac ag_inc_zero, simp add:ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     a \\<in> linear_span R M A H; b \\<in> linear_span R M A H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n           \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n              a = l_comb R M n s f;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n           \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n              b = l_comb R M n s f;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               a \\<plusminus> b = l_comb R M n s f", "apply ((erule exE)+, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na f fa s sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        fa \\<in> {j. j \\<le> na} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        sa \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        b = l_comb R M na sa fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                  a \\<plusminus> b = l_comb R M n s f", "apply (rename_tac n m f g s t)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; a = l_comb R M n s f;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                  a \\<plusminus> b = l_comb R M n s f", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   t j \\<cdot>\\<^sub>s g j) m =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (cut_tac n = n and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" and m = m and \n                g = \"\\<lambda>j. t j \\<cdot>\\<^sub>s g j\" in nsum_add_nm)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>m.\n                            t j \\<cdot>\\<^sub>s g j \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   t j \\<cdot>\\<^sub>s g j) m =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI, rule sc_mem,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>m.\n                            t j \\<cdot>\\<^sub>s g j \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   t j \\<cdot>\\<^sub>s g j) m =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI, rule sc_mem,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   t j \\<cdot>\\<^sub>s g j) m =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rotate_tac -1, frule sym, \n        thin_tac \"\\<Sigma>\\<^sub>e M (jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j)) \n                     (Suc (n + m)) =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\",\n         simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (cut_tac n = \"Suc (n + m)\" and f = \"jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m \n  (\\<lambda>j. t j \\<cdot>\\<^sub>s g j)\" and g = \"\\<lambda>j. (jointfun n s m t) j \\<cdot>\\<^sub>s (jointfun n f m g) j\"\n   in nsum_eq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j\n                            \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        j \\<le> Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                          (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j\n                         \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp add:jointfun_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> n \\<longrightarrow>\n                          s j \\<cdot>\\<^sub>s f j \\<in> carrier M) \\<and>\n                         (\\<not> j \\<le> n \\<longrightarrow>\n                          t (sliden (Suc n) j) \\<cdot>\\<^sub>s\n                          g (sliden (Suc n) j)\n                          \\<in> carrier M)\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (case_tac \"j \\<le> n\", simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> n \\<longrightarrow>\n                          s j \\<cdot>\\<^sub>s f j \\<in> carrier M) \\<and>\n                         (\\<not> j \\<le> n \\<longrightarrow>\n                          t (sliden (Suc n) j) \\<cdot>\\<^sub>s\n                          g (sliden (Suc n) j)\n                          \\<in> carrier M)\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 5. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule sc_mem,\n         cut_tac sc_Ring,\n         simp add:Pi_def Ring.ideal_subset,\n         simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> n \\<longrightarrow>\n                          s j \\<cdot>\\<^sub>s f j \\<in> carrier M) \\<and>\n                         (\\<not> j \\<le> n \\<longrightarrow>\n                          t (sliden (Suc n) j) \\<cdot>\\<^sub>s\n                          g (sliden (Suc n) j)\n                          \\<in> carrier M)\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp, rule sc_mem)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> t (sliden (Suc n) j) \\<in> carrier R\n 2. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g (sliden (Suc n) j) \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 5. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp add:sliden_def,\n         frule_tac m = j and n = \"Suc (n + m)\" and l = \"Suc n\" in diff_le_mono,\n         thin_tac \"j \\<le> Suc (n + m)\", simp,\n         cut_tac sc_Ring,\n         simp add:Pi_def Ring.ideal_subset)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g (sliden (Suc n) j) \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp add:sliden_def,\n         frule_tac m = j and n = \"Suc (n + m)\" and l = \"Suc n\" in diff_le_mono,\n         thin_tac \"j \\<le> Suc (n + m)\", simp,\n         cut_tac sc_Ring,\n         simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n                            \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        j \\<le> Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> jointfun n s m t j \\<cdot>\\<^sub>s\n                         jointfun n f m g j\n                         \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp add:jointfun_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> n \\<longrightarrow>\n                          s j \\<cdot>\\<^sub>s f j \\<in> carrier M) \\<and>\n                         (\\<not> j \\<le> n \\<longrightarrow>\n                          t (sliden (Suc n) j) \\<cdot>\\<^sub>s\n                          g (sliden (Suc n) j)\n                          \\<in> carrier M)\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (case_tac \"j \\<le> n\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> n \\<longrightarrow>\n                          s j \\<cdot>\\<^sub>s f j \\<in> carrier M) \\<and>\n                         (\\<not> j \\<le> n \\<longrightarrow>\n                          t (sliden (Suc n) j) \\<cdot>\\<^sub>s\n                          g (sliden (Suc n) j)\n                          \\<in> carrier M)\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 4. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule sc_mem,\n         cut_tac sc_Ring,\n         simp add:Pi_def Ring.ideal_subset,\n         simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t (sliden (Suc n) (Suc (n + m))) \\<cdot>\\<^sub>s\n        g (sliden (Suc n) (Suc (n + m)));\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> n \\<longrightarrow>\n                          s j \\<cdot>\\<^sub>s f j \\<in> carrier M) \\<and>\n                         (\\<not> j \\<le> n \\<longrightarrow>\n                          t (sliden (Suc n) j) \\<cdot>\\<^sub>s\n                          g (sliden (Suc n) j)\n                          \\<in> carrier M)\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp, simp add:sliden_def,\n         rule sc_mem,\n         frule_tac m = j and n = \"Suc (n + m)\" and l = \"Suc n\" in diff_le_mono,\n         thin_tac \"j \\<le> Suc (n + m)\", simp,\n         cut_tac sc_Ring,\n         simp add:Pi_def Ring.ideal_subset)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g s t j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>i.\n                               if i \\<le> n then s i \\<cdot>\\<^sub>s f i\n                               else t (sliden (Suc n) i) \\<cdot>\\<^sub>s\n                                    g (sliden (Suc n)\n  i)) (n + m) \\<plusminus>\n        t m \\<cdot>\\<^sub>s g m;\n        j \\<le> Suc (n + m); \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g (j - Suc n) \\<in> carrier M\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 3. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (frule_tac m = j and n = \"Suc (n + m)\" and l = \"Suc n\" in diff_le_mono,\n         thin_tac \"j \\<le> Suc (n + m)\", simp,\n         cut_tac sc_Ring,\n         simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                            jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                             m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) j =\n                            jointfun n s m t j \\<cdot>\\<^sub>s\n                            jointfun n f m g j\n 2. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI,\n         simp add:jointfun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m);\n        \\<Sigma>\\<^sub>e M jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j)\n                            m (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n s m t j \\<cdot>\\<^sub>s\n                               jointfun n f m g j) Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M jointfun n\n                (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m\n                (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp del:nsum_suc,\n       thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) (Suc (n + m))\",\n       thin_tac \"\\<Sigma>\\<^sub>e M (jointfun n (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) m (\\<lambda>j. t j \\<cdot>\\<^sub>s g j))\n                        (Suc (n + m)) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n s m t j \\<cdot>\\<^sub>s jointfun n f m g j) (Suc (n + m))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   jointfun n s m t j \\<cdot>\\<^sub>s\n                   jointfun n f m g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (frule_tac f = s and n = n and A = A and g = t and m = m and B = A in\n                  jointfun_hom0, assumption+, simp del:nsum_suc,\n        frule_tac f = f and n = n and A = H and g = g and m = m and B = H in\n                  jointfun_hom0, assumption+, simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g s t.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        a = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        b = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m;\n        jointfun n s m t \\<in> {l. l \\<le> Suc (n + m)} \\<rightarrow> A;\n        jointfun n f m g\n        \\<in> {l. l \\<le> Suc (n + m)} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   jointfun n s m t j \\<cdot>\\<^sub>s\n                   jointfun n f m g j) Suc (n + m) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_scTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n r \\<in> carrier R; H \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n g \\<in> {j. j \\<le> n} \\<rightarrow>  H  \\<longrightarrow> r \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k))  n) =  \n                             nsum M (\\<lambda>k. r \\<cdot>\\<^sub>s ((s k) \\<cdot>\\<^sub>s (g k))) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> n} \\<rightarrow>\n                              H \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              H \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) 0 =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) Suc n", "apply (rule impI, (erule conjE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) Suc n", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) Suc n", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) Suc n", "apply (frule func_pre [of _ _ \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) Suc n", "apply (frule func_pre [of _ _ \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) Suc n", "apply (simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>k.\n           s k \\<cdot>\\<^sub>s g k) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s\n                         (s (Suc n) \\<cdot>\\<^sub>s g (Suc n))", "apply (cut_tac n = n and f = \"\\<lambda>k. s k \\<cdot>\\<^sub>s g k\" in nsum_mem,\n        rule allI, rule impI,\n        cut_tac sc_Ring, rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>k.\n           s k \\<cdot>\\<^sub>s g k) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s\n                         (s (Suc n) \\<cdot>\\<^sub>s g (Suc n))", "apply (cut_tac a = \"s (Suc n)\" and m = \"g (Suc n)\" in sc_mem,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {};\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               r \\<cdot>\\<^sub>s\n                               (s k \\<cdot>\\<^sub>s g k)) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>k.\n           s k \\<cdot>\\<^sub>s g k) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s\n                         (s (Suc n) \\<cdot>\\<^sub>s g (Suc n))", "apply (simp add:sc_r_distr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_sc1Tr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n r \\<in> carrier R; H \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n g \\<in> {j. j \\<le> n} \\<rightarrow>  H  \\<longrightarrow> r \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k))  n) =  \n                             nsum M (\\<lambda>k. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s (g k)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> n} \\<rightarrow>\n                              H \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     H \\<noteq> {}; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> n} \\<rightarrow>\n                              H \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     H \\<noteq> {}; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              H \\<longrightarrow>\n                      r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) 0 =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) Suc n", "apply (rule impI, (erule conjE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     H \\<noteq> {}; Ring R; s 0 \\<in> A; g 0 \\<in> H\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s (s 0 \\<cdot>\\<^sub>s g 0) =\n                      (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                       s 0) \\<cdot>\\<^sub>s\n                      g 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) Suc n", "apply (subst sc_assoc, assumption+,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) Suc n", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) Suc n", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) Suc n", "apply (frule func_pre [of _ _ \"A\"], frule func_pre [of _ _ \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          s k \\<cdot>\\<^sub>s g k) Suc n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>k.\n           s k \\<cdot>\\<^sub>s g k) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) n \\<plusminus>\n                         (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          s (Suc n)) \\<cdot>\\<^sub>s\n                         g (Suc n)", "apply (cut_tac n = n and f = \"\\<lambda>k. s k \\<cdot>\\<^sub>s g k\" in nsum_mem,\n        rule allI, rule impI,\n        cut_tac sc_Ring, rule sc_mem,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n\n        \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>k.\n           s k \\<cdot>\\<^sub>s g k) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) n \\<plusminus>\n                         (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          s (Suc n)) \\<cdot>\\<^sub>s\n                         g (Suc n)", "apply (cut_tac a = \"s (Suc n)\" and m = \"g (Suc n)\" in sc_mem,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                         (\\<Sigma>\\<^sub>e M (\\<lambda>k.\n           s k \\<cdot>\\<^sub>s g k) n \\<plusminus>\n                          s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) n \\<plusminus>\n                         (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          s (Suc n)) \\<cdot>\\<^sub>s\n                         g (Suc n)", "apply (simp add:sc_r_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; Ring R;\n        r \\<cdot>\\<^sub>s\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s k) \\<cdot>\\<^sub>s\n                               g k) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s g k) n\n        \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) n \\<plusminus>\n                         r \\<cdot>\\<^sub>s\n                         (s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n          g k) n \\<plusminus>\n                         (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          s (Suc n)) \\<cdot>\\<^sub>s\n                         g (Suc n)", "apply (subst  sc_assoc, assumption+,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_sc:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;  g \\<in> {j. j \\<le> n} \\<rightarrow>  H\\<rbrakk> \\<Longrightarrow>\nr \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k)) n) = nsum M (\\<lambda>k. r \\<cdot>\\<^sub>s ((s k) \\<cdot>\\<^sub>s (g k))) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n", "apply (case_tac \"H \\<noteq> {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H; \\<not> H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n", "apply (simp add:l_comb_scTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H; \\<not> H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {}; H = {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n", "apply (frule_tac x = 0 in funcset_mem[of g \" {j. j \\<le> n}\" \"{}\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {}; H = {}; g 0 \\<in> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       r \\<cdot>\\<^sub>s (s k \\<cdot>\\<^sub>s g k)) n", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_sc1:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;  g \\<in> {j. j \\<le> n} \\<rightarrow>  H\\<rbrakk> \\<Longrightarrow>\nr \\<cdot>\\<^sub>s (nsum M (\\<lambda>k. (s k) \\<cdot>\\<^sub>s (g k)) n) = nsum M (\\<lambda>k. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s (g k)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply (case_tac \"H \\<noteq> {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H; \\<not> H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply (simp add:l_comb_sc1Tr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H; \\<not> H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {}; H = {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply (frule_tac x = 0 in funcset_mem[of g \" {j. j \\<le> n}\" \"{}\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; r \\<in> carrier R;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {}; H = {}; g 0 \\<in> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       s k \\<cdot>\\<^sub>s g k) n =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s g k) n", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_sc_closed:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n r \\<in> carrier R; x \\<in> linear_span R M A H\\<rbrakk> \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     x \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     x \\<in> linear_span R M A H; H = {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     x \\<in> linear_span R M A H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; r \\<in> carrier R; x = \\<zero>; H = {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s \\<zero> = \\<zero>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     x \\<in> linear_span R M A H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H", "apply (simp add:sc_a_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     x \\<in> linear_span R M A H; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>s x \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n           \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n              x = l_comb R M n s f;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               r \\<cdot>\\<^sub>s x = l_comb R M n s f", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                  r \\<cdot>\\<^sub>s x = l_comb R M n s f", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  r \\<cdot>\\<^sub>s\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (simp add:l_comb_sc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (cut_tac n = n and f = \"\\<lambda>j. r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)\" and \n       g = \"\\<lambda>j. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (s j)) \\<cdot>\\<^sub>s f j\" in nsum_eq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)\n                            \\<in> carrier M\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 3. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j) =\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               r \\<cdot>\\<^sub>s\n                               (s j \\<cdot>\\<^sub>s f j)) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI,\n        rule sc_mem, assumption, rule sc_mem,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j) =\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j\n 3. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               r \\<cdot>\\<^sub>s\n                               (s j \\<cdot>\\<^sub>s f j)) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI,\n        rule sc_mem,\n        cut_tac sc_Ring,\n        rule Ring.ring_tOp_closed, assumption+,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j) =\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               r \\<cdot>\\<^sub>s\n                               (s j \\<cdot>\\<^sub>s f j)) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI,\n        subst sc_assoc, assumption,\n        cut_tac sc_Ring, \n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD, simp,\n        simp,\n    thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. r \\<cdot>\\<^sub>s (s j \\<cdot>\\<^sub>s f j)) n = \n                                \\<Sigma>\\<^sub>e M (\\<lambda>j. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s f j) n\",\n    thin_tac \"x = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (cut_tac n = n and f = \"\\<lambda>j. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s f j\" and \n       g = \"\\<lambda>j. (\\<lambda>x\\<in>{j. j \\<le> n}. r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (s x)) j \\<cdot>\\<^sub>s f j\" in nsum_eq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 3. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI,\n        rule sc_mem,\n        cut_tac sc_Ring,\n        rule Ring.ring_tOp_closed, assumption+,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 3. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI,\n         rule sc_mem, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j\n                         \\<in> carrier R\n 2. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier M\n 3. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (\n          cut_tac sc_Ring,\n        rule Ring.ring_tOp_closed, assumption+,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             s j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          s j) \\<cdot>\\<^sub>s\n                         f j =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                          j \\<cdot>\\<^sub>s\n                         f j\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sa j \\<cdot>\\<^sub>s fa j) na", "apply (subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> n}. r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x) \\<in> {j. j \\<le> n} \\<rightarrow> A\",\n         blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow> A", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; r \\<in> carrier R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                s j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n\n                                then r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j\n                                else undefined) \\<cdot>\\<^sub>s\n                               f j) n;\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s x \\<in> A", "apply (thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j) \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. (if j \\<le> n then r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> s j else undefined) \\<cdot>\\<^sub>s f j) n\",\n        cut_tac sc_Ring,\n        rule Ring.ideal_ring_multiple, assumption+, simp add:Pi_def,\n        assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mem_single_l_spanTr:\"\\<lbrakk>ideal R A; h \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and>\n      f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and> l_comb R M n s f \\<in> linear_span R M A {h}\n      \\<longrightarrow> (\\<exists>a \\<in> A. l_comb R M n s f = a \\<cdot>\\<^sub>s h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and>\n                      l_comb R M n s f\n                      \\<in> linear_span R M A {h} \\<longrightarrow>\n                      (\\<exists>a\\<in>A.\n                          l_comb R M n s f = a \\<cdot>\\<^sub>s h)", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and>\n                      l_comb R M n s f\n                      \\<in> linear_span R M A {h} \\<longrightarrow>\n                      (\\<exists>a\\<in>A.\n                          l_comb R M n s f = a \\<cdot>\\<^sub>s h)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> 0} \\<rightarrow> {h} \\<and>\n                      l_comb R M 0 s f\n                      \\<in> linear_span R M A {h} \\<longrightarrow>\n                      (\\<exists>a\\<in>A.\n                          l_comb R M 0 s f = a \\<cdot>\\<^sub>s h)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and>\n        l_comb R M n s f \\<in> linear_span R M A {h} \\<longrightarrow>\n        (\\<exists>a\\<in>A. l_comb R M n s f = a \\<cdot>\\<^sub>s h)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h} \\<and>\n                         l_comb R M (Suc n) s f\n                         \\<in> linear_span R M A {h} \\<longrightarrow>\n                         (\\<exists>a\\<in>A.\n                             l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h)", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> {h};\n     l_comb R M 0 s f \\<in> linear_span R M A {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>A.\n                         l_comb R M 0 s f = a \\<cdot>\\<^sub>s h\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and>\n        l_comb R M n s f \\<in> linear_span R M A {h} \\<longrightarrow>\n        (\\<exists>a\\<in>A. l_comb R M n s f = a \\<cdot>\\<^sub>s h)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h} \\<and>\n                         l_comb R M (Suc n) s f\n                         \\<in> linear_span R M A {h} \\<longrightarrow>\n                         (\\<exists>a\\<in>A.\n                             l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h)", "apply (simp add:l_comb_def Ring.ideal_subset[of R A] bexI[of _ \"s 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h} \\<and>\n        l_comb R M n s f \\<in> linear_span R M A {h} \\<longrightarrow>\n        (\\<exists>a\\<in>A. l_comb R M n s f = a \\<cdot>\\<^sub>s h)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h} \\<and>\n                         l_comb R M (Suc n) s f\n                         \\<in> linear_span R M A {h} \\<longrightarrow>\n                         (\\<exists>a\\<in>A.\n                             l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h)", "apply (rule impI, (erule conjE)+,\n       frule func_pre[of _ _ A], frule func_pre[of _ _ \"{h}\"],\n       frule_tac n = n in l_comb_mem_linear_span[of A \"{h}\" s _ f],\n       rule subsetI, simp, assumption+, simp,\n       erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h};\n        l_comb R M (Suc n) s f \\<in> linear_span R M A {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        l_comb R M n s f \\<in> linear_span R M A {h}; a \\<in> A;\n        l_comb R M n s f = a \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>A.\n                            l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h", "apply (frule singleton_sub[of h \"carrier M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h};\n        l_comb R M (Suc n) s f \\<in> linear_span R M A {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        l_comb R M n s f \\<in> linear_span R M A {h}; a \\<in> A;\n        l_comb R M n s f = a \\<cdot>\\<^sub>s h;\n        {h} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>A.\n                            l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h", "apply (frule Ring.ideal_subset1[of R A], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h};\n        l_comb R M (Suc n) s f \\<in> linear_span R M A {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        l_comb R M n s f \\<in> linear_span R M A {h}; a \\<in> A;\n        l_comb R M n s f = a \\<cdot>\\<^sub>s h; {h} \\<subseteq> carrier M;\n        A \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>A.\n                            l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h", "apply (frule extend_fun[of s _ A \"carrier R\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h};\n        l_comb R M (Suc n) s f \\<in> linear_span R M A {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        l_comb R M n s f \\<in> linear_span R M A {h}; a \\<in> A;\n        l_comb R M n s f = a \\<cdot>\\<^sub>s h; {h} \\<subseteq> carrier M;\n        A \\<subseteq> carrier R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>A.\n                            l_comb R M (Suc n) s f = a \\<cdot>\\<^sub>s h", "apply (frule_tac n = n in l_comb_Suc[of \"{h}\" A s _ f], assumption+,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h};\n        a \\<cdot>\\<^sub>s h \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n        \\<in> linear_span R M A {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        a \\<cdot>\\<^sub>s h \\<in> linear_span R M A {h}; a \\<in> A;\n        l_comb R M n s f = a \\<cdot>\\<^sub>s h; A \\<subseteq> carrier R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f =\n        a \\<cdot>\\<^sub>s h \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>A.\n                            a \\<cdot>\\<^sub>s h \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                            aa \\<cdot>\\<^sub>s h", "apply (frule_tac A = \"{j. j \\<le> Suc n}\" and x = \"Suc n\" in \n        funcset_mem[of f _ \"{h}\"], simp, simp,\n        frule_tac A = \"{j. j \\<le> Suc n}\" and x = \"Suc n\" in \n        funcset_mem[of s _ A], simp,\n        frule_tac h = \"s (Suc n)\" in Ring.ideal_subset[of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>ideal R A; h \\<in> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> {h};\n        a \\<cdot>\\<^sub>s h \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s h\n        \\<in> linear_span R M A {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        a \\<cdot>\\<^sub>s h \\<in> linear_span R M A {h}; a \\<in> A;\n        l_comb R M n s f = a \\<cdot>\\<^sub>s h; A \\<subseteq> carrier R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f =\n        a \\<cdot>\\<^sub>s h \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s h;\n        f (Suc n) = h; s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa\\<in>A.\n                            a \\<cdot>\\<^sub>s h \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s h =\n                            aa \\<cdot>\\<^sub>s h", "apply (frule_tac h = a in Ring.ideal_subset[of R A], assumption+,\n        frule_tac h = \"s (Suc n)\" in Ring.ideal_subset[of R A], assumption+,\n        simp add:sc_l_distr[THEN sym],\n        frule_tac x = a and y = \"s (Suc n)\" in Ring.ideal_pOp_closed[of R A],\n        assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mem_single_l_span:\"\\<lbrakk>ideal R A; h \\<in> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> {h}; \n       l_comb R M n s f \\<in> linear_span R M A {h}\\<rbrakk> \\<Longrightarrow>\n       \\<exists>a \\<in> A. l_comb R M n s f = a \\<cdot>\\<^sub>s h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n     l_comb R M n s f \\<in> linear_span R M A {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>A.\n                         l_comb R M n s f = a \\<cdot>\\<^sub>s h", "apply (simp add:mem_single_l_spanTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mem_single_l_span1:\"\\<lbrakk>ideal R A; h \\<in> carrier M; \n       x \\<in> linear_span R M A {h}\\<rbrakk> \\<Longrightarrow> \\<exists>a \\<in> A. x = a \\<cdot>\\<^sub>s h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> carrier M;\n     x \\<in> linear_span R M A {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>A. x = a \\<cdot>\\<^sub>s h", "apply (simp add:linear_span_def, erule exE, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; h \\<in> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>A.\n                            l_comb R M n s f = a \\<cdot>\\<^sub>s h", "apply (frule_tac s = s and n = n and f = f in mem_single_l_span[of A h],\n       assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; h \\<in> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A {h}\n 2. \\<And>n f s.\n       \\<lbrakk>ideal R A; h \\<in> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        \\<exists>a\\<in>A. l_comb R M n s f = a \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>A.\n                            l_comb R M n s f = a \\<cdot>\\<^sub>s h", "apply (frule singleton_sub[of h \"carrier M\"],\n      rule_tac s = s and f = f in l_comb_mem_linear_span[of A \"{h}\"],\n      assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_subModule:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>  \\<Longrightarrow> \n                  submodule R M (linear_span R M A H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> submodule R M (linear_span R M A H)", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H = {}\\<rbrakk>\n    \\<Longrightarrow> submodule R M (linear_span R M A H)\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> submodule R M (linear_span R M A H)", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H = {}\\<rbrakk>\n    \\<Longrightarrow> submodule R M {\\<zero>}\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> submodule R M (linear_span R M A H)", "apply (simp add:submodule_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> submodule R M (linear_span R M A H)", "apply (simp add:submodule_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M \\<and>\n                      M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f}\n                      \\<subseteq> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> {x. \\<exists>n.\n                       \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                          \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                             x = l_comb R M n s f}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (simp add:l_comb_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H \\<and>\n                      (\\<forall>a m.\n                          a \\<in> carrier R \\<and>\n                          m \\<in> linear_span R M A H \\<longrightarrow>\n                          a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> M +> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (rule asubg_test)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<noteq> {}\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>linear_span R M A H.\n                         \\<forall>b\\<in>linear_span R M A H.\n                            a \\<plusminus> -\\<^sub>a b\n                            \\<in> linear_span R M A H\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (rule subsetI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        x \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<noteq> {}\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>linear_span R M A H.\n                         \\<forall>b\\<in>linear_span R M A H.\n                            a \\<plusminus> -\\<^sub>a b\n                            \\<in> linear_span R M A H\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<noteq> {}\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>linear_span R M A H.\n                         \\<forall>b\\<in>linear_span R M A H.\n                            a \\<plusminus> -\\<^sub>a b\n                            \\<in> linear_span R M A H\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<noteq> {}\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>linear_span R M A H.\n                         \\<forall>b\\<in>linear_span R M A H.\n                            a \\<plusminus> -\\<^sub>a b\n                            \\<in> linear_span R M A H\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (simp add:l_comb_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<noteq> {}\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>linear_span R M A H.\n                         \\<forall>b\\<in>linear_span R M A H.\n                            a \\<plusminus> -\\<^sub>a b\n                            \\<in> linear_span R M A H\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (frule linear_span_inc_0[of A H], assumption, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>linear_span R M A H.\n                         \\<forall>b\\<in>linear_span R M A H.\n                            a \\<plusminus> -\\<^sub>a b\n                            \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        a \\<in> linear_span R M A H; b \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b\n                         \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (rule linear_span_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {};\n        a \\<in> linear_span R M A H; b \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a b \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (rule linear_span_iOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a m.\n                         a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (rule allI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R \\<and>\n                         m \\<in> linear_span R M A H \\<longrightarrow>\n                         a \\<cdot>\\<^sub>s m \\<in> linear_span R M A H", "apply (simp add:linear_span_sc_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_comb_mem_submoduleTr:\"\\<lbrakk>ideal R A; submodule R M N\\<rbrakk> \\<Longrightarrow>\n (s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n (\\<forall>j \\<le> n.(s j) \\<cdot>\\<^sub>s (f j) \\<in> N)) \\<longrightarrow> l_comb R M n s f \\<in> N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; submodule R M N\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n                      (\\<forall>j\\<le>n.\n                          s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n                      l_comb R M n s f \\<in> N", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; submodule R M N\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M \\<and>\n                      (\\<forall>j\\<le>0.\n                          s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n                      l_comb R M 0 s f \\<in> N\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; submodule R M N;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n        l_comb R M n s f \\<in> N\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<and>\n                         (\\<forall>j\\<le>Suc n.\n                             s j \\<cdot>\\<^sub>s f j\n                             \\<in> N) \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> N", "apply (simp add:l_comb_def, rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; submodule R M N;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n        l_comb R M n s f \\<in> N;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<forall>j\\<le>Suc n. s j \\<cdot>\\<^sub>s f j \\<in> N\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f \\<in> N", "apply (frule func_pre[of _ _ A], frule func_pre[of _ _ \"carrier M\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; submodule R M N; l_comb R M n s f \\<in> N;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<forall>j\\<le>Suc n. s j \\<cdot>\\<^sub>s f j \\<in> N;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f \\<in> N", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; submodule R M N;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<in> N;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<forall>j\\<le>Suc n. s j \\<cdot>\\<^sub>s f j \\<in> N;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n                         \\<in> N", "apply (frule_tac a = \"Suc n\" in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; submodule R M N;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<in> N;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<forall>j\\<le>Suc n. s j \\<cdot>\\<^sub>s f j \\<in> N;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> N\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n                         \\<in> N", "apply (rule submodule_pOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_sub_submodule:\"\\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N\\<rbrakk> \\<Longrightarrow>\n       linear_span R M A H \\<subseteq> N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> N", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> N", "apply (rule subsetI, simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f})\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N", "apply (case_tac \"H = {}\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; submodule R M N; Ring R; x = \\<zero>;\n        H = {}\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> N\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N", "apply (simp add:submodule_inc_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 x = l_comb R M n s f;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N", "apply (cut_tac s = s and A = A and f = f and N = N and n = n in \n        l_comb_mem_submoduleTr, assumption+,\n        frule submodule_subset[of N],\n        frule subset_trans[of H N \"carrier M\"], assumption+,\n        frule_tac f = f and A = \"{j. j \\<le> n}\" and B = H and ?B1.0 = \"carrier M\"\n        in extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n        l_comb R M n s f \\<in> N;\n        N \\<subseteq> carrier M; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N", "apply (subgoal_tac \"\\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j \\<in> N\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n        l_comb R M n s f \\<in> N;\n        N \\<subseteq> carrier M; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j \\<in> N", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s j.\n       \\<lbrakk>ideal R A; submodule R M N; H \\<subseteq> N; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> N) \\<longrightarrow>\n        l_comb R M n s f \\<in> N;\n        N \\<subseteq> carrier M; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j \\<in> N", "apply (rule submodule_sc_closed[of N], assumption,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linear_span_sub:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>  \\<Longrightarrow> \n                  (linear_span R M A H) \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M", "apply (frule linear_span_subModule[of A H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     submodule R M (linear_span R M A H)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M", "apply (simp add:submodule_subset)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  smodule_ideal_coeff :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme,\n       'r set] \\<Rightarrow> 'a set\" where\n  \"smodule_ideal_coeff R M A = linear_span R M A (carrier M)\""], ["", "abbreviation\n  SMLIDEALCOEFF  (\"(3_/ \\<odot>\\<^bsub>_\\<^esub> _)\" [64,64,65]64) where\n  \"A \\<odot>\\<^bsub>R\\<^esub> M == smodule_ideal_coeff R M A\""], ["", "lemma (in Module) smodule_ideal_coeff_is_Submodule:\"ideal R A  \\<Longrightarrow>\n            submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow> submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M)", "apply (simp add:smodule_ideal_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    submodule R M (linear_span R M A (carrier M))", "apply (simp add:linear_span_subModule)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mem_smodule_ideal_coeff:\"\\<lbrakk>ideal R A; x \\<in> A \\<odot>\\<^bsub>R\\<^esub> M\\<rbrakk> \\<Longrightarrow>\n             \\<exists>n. \\<exists>s \\<in> {j. j \\<le> n} \\<rightarrow> A. \\<exists>g \\<in> {j. j \\<le> n} \\<rightarrow> carrier M.\n              x = l_comb R M n s g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; x \\<in> A \\<odot>\\<^bsub>R\\<^esub> M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                            \\<exists>g\\<in>{j. j \\<le> n} \\<rightarrow>\n     carrier M.\n                               x = l_comb R M n s g", "apply (cut_tac ag_inc_zero,\n       frule nonempty[of \"\\<zero>\" \"carrier M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; x \\<in> A \\<odot>\\<^bsub>R\\<^esub> M;\n     \\<zero> \\<in> carrier M; carrier M \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                            \\<exists>g\\<in>{j. j \\<le> n} \\<rightarrow>\n     carrier M.\n                               x = l_comb R M n s g", "apply (simp add:smodule_ideal_coeff_def linear_span_def,\n       erule exE, (erule bexE)+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  quotient_of_submodules :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme,\n            'a set, 'a set] \\<Rightarrow> 'r set\" where\n  \"quotient_of_submodules R M N P = {x | x. x\\<in>carrier R \\<and> \n                                    (linear_span R M (Rxa R x)  P) \\<subseteq> N}\""], ["", "definition\n  Annihilator :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme]\n    \\<Rightarrow> 'r set\" (\"(Ann\\<^bsub>_\\<^esub> _)\" [82,83]82) where\n  \"Ann\\<^bsub>R\\<^esub> M = quotient_of_submodules R M {\\<zero>\\<^bsub>M\\<^esub>} (carrier M)\""], ["", "abbreviation\n  QOFSUBMDS  (\"(4_ \\<^bsub>_\\<ddagger>_\\<^esub> _)\" [82,82,82,83]82) where\n  \"N \\<^bsub>R\\<ddagger>M\\<^esub> P == quotient_of_submodules R M N P\""], ["", "lemma (in Module) quotient_of_submodules_inc_0:\n     \"\\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk> \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> (P \\<^bsub>R\\<ddagger>M\\<^esub> Q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub>\n                      \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:quotient_of_submodules_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R \\<and>\n                      linear_span R M\n                       (R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>) Q\n                      \\<subseteq> P", "apply (cut_tac sc_Ring, simp add:Ring.ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M\n                       (R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>) Q\n                      \\<subseteq> P", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q; Ring R\\<rbrakk>\n    \\<Longrightarrow> (Q = {} \\<longrightarrow> \\<zero> \\<in> P) \\<and>\n                      (Q \\<noteq> {} \\<longrightarrow>\n                       {x. \\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow>\n         R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>.\n                                    x = l_comb R M n s f}\n                       \\<subseteq> P)", "apply (frule submodule_inc_0[of Q], simp add:nonempty)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q; Ring R;\n     \\<zero> \\<in> Q\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow>\n        R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>.\n                                   x = l_comb R M n s f}\n                      \\<subseteq> P", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        x \\<in> {x. \\<exists>n.\n                       \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n                          \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n   R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>.\n                             x = l_comb R M n s f}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> P", "apply (simp, erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> P", "apply (simp, thin_tac \"x = l_comb R M n s f\", simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P", "apply (cut_tac n = n and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" in nsum_zeroA)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j = \\<zero>\n 2. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P", "apply (rule allI, rule impI,\n       frule_tac x = j and f = s and A = \"{j. j \\<le> n}\" in \n       funcset_mem[of _ _ \"R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s j.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        j \\<le> n;\n        s j \\<in> R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j = \\<zero>\n 2. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P", "apply (simp add:Rxa_def, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {x. \\<exists>r\\<in>carrier R.\n                       x =\n                       r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                       \\<zero>\\<^bsub>R\\<^esub>};\n        j \\<le> n; r \\<in> carrier R;\n        s j =\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<cdot>\\<^sub>s\n                         f j =\n                         \\<zero>\n 2. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P", "apply (\n        simp add:Ring.ring_times_x_0,\n        rule sc_0_m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {x. x = \\<zero>\\<^bsub>R\\<^esub> \\<and>\n                    (\\<exists>r. r \\<in> carrier R)};\n        j \\<le> n; r \\<in> carrier R;\n        s j = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier M\n 2. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P", "apply (\n        frule submodule_subset[of Q],\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P", "apply (simp add:submodule_inc_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) quotient_of_submodules_is_ideal:\n      \"\\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk> \\<Longrightarrow> ideal R (P \\<^bsub>R\\<ddagger>M\\<^esub> Q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q\\<rbrakk>\n    \\<Longrightarrow> ideal R (P \\<^bsub>R\\<ddagger>M\\<^esub> Q)", "apply (frule quotient_of_submodules_inc_0 [of P Q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub>\n     \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\\<rbrakk>\n    \\<Longrightarrow> ideal R (P \\<^bsub>R\\<ddagger>M\\<^esub> Q)", "apply (cut_tac sc_Ring,\n       rule Ring.ideal_condition[of R], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> P \\<^bsub>R\\<ddagger>M\\<^esub> Q \\<subseteq> carrier R\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> P \\<^bsub>R\\<ddagger>M\\<^esub> Q \\<noteq> {}\n 3. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                         \\<forall>y\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\n 4. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:quotient_of_submodules_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> P \\<^bsub>R\\<ddagger>M\\<^esub> Q \\<noteq> {}\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                         \\<forall>y\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\n 3. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:nonempty)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                         \\<forall>y\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (thin_tac \"\\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>submodule R M P; submodule R M Q; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                         \\<forall>y\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R;\n        x \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n        y \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:quotient_of_submodules_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R;\n        x \\<in> carrier R \\<and>\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R \\<and>\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R \\<and>\n                         linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y))\n                          Q\n                         \\<subseteq> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R \\<and>\n                         linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y))\n                          Q\n                         \\<subseteq> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y))\n                          Q\n                         \\<subseteq> P\n 3. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule Ring.ring_is_ag,\n        rule aGroup.ag_pOp_closed[of R], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y))\n                          Q\n                         \\<subseteq> P\n 3. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y))\n                          Q\n                         \\<subseteq> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (subst linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> (if Q = {} then {\\<zero>}\n                          else {xa.\n                                \\<exists>n.\n                                   \\<exists>f\n      \\<in>{j. j \\<le> n} \\<rightarrow> Q.\n\\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n               R \\<diamondsuit>\\<^sub>p\n               (x \\<plusminus>\\<^bsub>R\\<^esub>\n                -\\<^sub>a\\<^bsub>R\\<^esub> y).\n   xa = l_comb R M n s f})\n                         \\<subseteq> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule submodule_inc_0 [of Q], simp add:nonempty)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q\\<rbrakk>\n       \\<Longrightarrow> {xa.\n                          \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow>\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y).\n                                   xa = l_comb R M n s f}\n                         \\<subseteq> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (rule subsetI, simp,\n        erule exE, (erule bexE)+, simp add:l_comb_def,\n        thin_tac \"xa = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (cut_tac s = s and n = n and f = f in \n           l_comb_mem_submoduleTr[of \"carrier R\" P])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y)\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 2. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y)\\<rbrakk>\n       \\<Longrightarrow> submodule R M P\n 3. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y);\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> P) \\<longrightarrow>\n        l_comb R M n s f \\<in> P\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P\n 4. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:Ring.whole_ideal, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y);\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> P) \\<longrightarrow>\n        l_comb R M n s f \\<in> P\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule Ring.ring_is_ag[of R],\n        frule_tac x = y in aGroup.ag_mOp_closed[of R], assumption+,\n        frule_tac x = x and y = \"-\\<^sub>a\\<^bsub>R\\<^esub> y\" in aGroup.ag_pOp_closed, assumption+,\n        frule_tac a = \"x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\" in Ring.principal_ideal[of R], assumption+,\n        frule_tac I = \"R \\<diamondsuit>\\<^sub>p (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\" in Ring.ideal_subset1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y);\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> P) \\<longrightarrow>\n        l_comb R M n s f \\<in> P;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        ideal R\n         (R \\<diamondsuit>\\<^sub>p\n          (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y));\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule_tac f = s and A = \"{j. j \\<le> n}\" and B = \"R \\<diamondsuit>\\<^sub>p (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\" \n         and ?B1.0 = \"carrier R\" in extend_fun, assumption+,\n         frule_tac submodule_subset[of Q],\n         frule_tac f = f and A = \"{j. j \\<le> n}\" and B = Q  \n         and ?B1.0 = \"carrier M\" in extend_fun, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y);\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<forall>j\\<le>n.\n            s j \\<cdot>\\<^sub>s f j \\<in> P) \\<longrightarrow>\n        l_comb R M n s f \\<in> P;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        ideal R\n         (R \\<diamondsuit>\\<^sub>p\n          (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y));\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        Q \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (subgoal_tac \"\\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j \\<in> P\", simp add:l_comb_def,\n         thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and> (\\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j \\<in> P) \\<longrightarrow>\n        l_comb R M n s f \\<in> P\",\n         thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n         thin_tac \"f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (x \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> y);\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        ideal R\n         (R \\<diamondsuit>\\<^sub>p\n          (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y));\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (rule allI, rule impI,\n         frule_tac x = j and f = s and A = \"{j. j \\<le> n}\" and \n         B = \"R \\<diamondsuit>\\<^sub>p (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\" in funcset_mem, simp, \n         thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> R \\<diamondsuit>\\<^sub>p (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\",\n         thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa n f s j.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n;\n        s j\n        \\<in> R \\<diamondsuit>\\<^sub>p\n              (x \\<plusminus>\\<^bsub>R\\<^esub>\n               -\\<^sub>a\\<^bsub>R\\<^esub> y)\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:Rxa_def, fold Rxa_def, erule bexE, simp,\n         thin_tac \"s j = r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f s j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (simp add:Ring.ring_distrib1,\n         frule_tac x = r and y = x in Ring.ring_tOp_closed, assumption+, \n         frule_tac x = r and y = \"-\\<^sub>a\\<^bsub>R\\<^esub> y\" in Ring.ring_tOp_closed, assumption+,\n         frule_tac x = j and A = \"{j. j \\<le> n}\" and B = Q in funcset_mem,\n         simp,\n         frule_tac c = \"f j\" in subsetD[of Q \"carrier M\"], assumption+,\n         simp add:sc_l_distr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<in> carrier R;\n        f j \\<in> Q; f j \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          x) \\<cdot>\\<^sub>s\n                         f j \\<plusminus>\n                         (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          (-\\<^sub>a\\<^bsub>R\\<^esub> y)) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (subst Ring.ring_inv1_2[THEN sym], assumption+,\n         subst Ring.ring_inv1_1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<in> carrier R;\n        f j \\<in> Q; f j \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          x) \\<cdot>\\<^sub>s\n                         f j \\<plusminus>\n                         ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          y) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule_tac a = x in Ring.principal_ideal[of R], assumption+,\n         frule_tac a = x in Ring.principal_ideal[of R], assumption+,\n         frule_tac A = \"R \\<diamondsuit>\\<^sub>p x\" and H = Q and a = \"r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\" and h = \"f j\" in\n         sc_linear_span, assumption+, simp add:Rxa_def, blast,\n         simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<in> carrier R;\n        f j \\<in> Q; f j \\<in> carrier M;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          x) \\<cdot>\\<^sub>s\n                         f j \\<plusminus>\n                         ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          y) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule_tac x = r in aGroup.ag_mOp_closed[of R], assumption+,\n         frule_tac a = y in Ring.principal_ideal[of R], assumption+,\n         frule_tac a = y in Ring.principal_ideal[of R], assumption+,\n         frule_tac A = \"R \\<diamondsuit>\\<^sub>p y\" and H = Q and a = \"(-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y\" and\n         h = \"f j\" in sc_linear_span, assumption+, simp add:Rxa_def,\n         blast,\n         simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<in> carrier R;\n        f j \\<in> Q; f j \\<in> carrier M;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q;\n        -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n         y) \\<cdot>\\<^sub>s\n        f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          x) \\<cdot>\\<^sub>s\n                         f j \\<plusminus>\n                         ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          y) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (frule_tac c = \"(r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j\" and A = \"linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q\" \n         and B = P in subsetD, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<in> carrier R;\n        f j \\<in> Q; f j \\<in> carrier M;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q;\n        -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n         y) \\<cdot>\\<^sub>s\n        f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q;\n        (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j\n        \\<in> P\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          x) \\<cdot>\\<^sub>s\n                         f j \\<plusminus>\n                         ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          y) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (\n         frule_tac c = \"((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) \\<cdot>\\<^sub>s f j\" and \n         A = \"linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q\" and B = P in subsetD, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n f j r.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        y \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y\n        \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p\n        (x \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<subseteq> carrier R;\n        Q \\<subseteq> carrier M; j \\<le> n; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> carrier R;\n        r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n        \\<in> carrier R;\n        f j \\<in> Q; f j \\<in> carrier M;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q;\n        -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n         y) \\<cdot>\\<^sub>s\n        f j\n        \\<in> linear_span R M (R \\<diamondsuit>\\<^sub>p y) Q;\n        (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x) \\<cdot>\\<^sub>s f j \\<in> P;\n        ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n         y) \\<cdot>\\<^sub>s\n        f j\n        \\<in> P\\<rbrakk>\n       \\<Longrightarrow> (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          x) \\<cdot>\\<^sub>s\n                         f j \\<plusminus>\n                         ((-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          y) \\<cdot>\\<^sub>s\n                         f j\n                         \\<in> P\n 2. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply (rule submodule_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>submodule R M P; submodule R M Q;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>P \\<^bsub>R\\<ddagger>M\\<^esub> Q.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q", "apply ((rule ballI)+,\n         thin_tac \"\\<zero>\\<^bsub>R\\<^esub> \\<in> P \\<^bsub>R\\<ddagger>M\\<^esub> Q\",\n         simp add:quotient_of_submodules_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                         \\<in> carrier R \\<and>\n                         linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x))\n                          Q\n                         \\<subseteq> P", "apply (simp add:Ring.ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> linear_span R M\n                          (R \\<diamondsuit>\\<^sub>p\n                           (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x))\n                          Q\n                         \\<subseteq> P", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R;\n        linear_span R M (R \\<diamondsuit>\\<^sub>p x) Q \\<subseteq> P;\n        xa \\<in> linear_span R M\n                  (R \\<diamondsuit>\\<^sub>p\n                   (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x))\n                  Q\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> P", "apply (frule submodule_inc_0[of Q],\n         simp add:linear_span_def nonempty)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R;\n        {xa.\n         \\<exists>n.\n            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n               \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n                              R \\<diamondsuit>\\<^sub>p x.\n                  xa = l_comb R M n s f}\n        \\<subseteq> P;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n                             R \\<diamondsuit>\\<^sub>p\n                             (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x).\n                 xa = l_comb R M n s f;\n        \\<zero> \\<in> Q\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> P", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R;\n        {xa.\n         \\<exists>n.\n            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n               \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n                              R \\<diamondsuit>\\<^sub>p x.\n                  xa = l_comb R M n s f}\n        \\<subseteq> P;\n        \\<zero> \\<in> Q; f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x);\n        xa = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> P", "apply (rule_tac c = xa and A = \"{xa. \\<exists>n. \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n                \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> R \\<diamondsuit>\\<^sub>p x. xa = l_comb R M n s f}\" in\n          subsetD[of _ P], assumption+,\n          thin_tac \"{xa. \\<exists>n. \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n                \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> R \\<diamondsuit>\\<^sub>p x. xa = l_comb R M n s f} \\<subseteq> P\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x);\n        xa = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> {xa.\n                                   \\<exists>n.\n\\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> Q.\n   \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> R \\<diamondsuit>\\<^sub>p x.\n      xa = l_comb R M n s f}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x);\n        xa = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> Q.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> R \\<diamondsuit>\\<^sub>p x.\n                                  l_comb R M n s f = l_comb R M na sa fa", "apply (frule_tac a = r and b = x in Ring.Rxa_mult_smaller[of R], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x);\n        xa = l_comb R M n s f;\n        R \\<diamondsuit>\\<^sub>p (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\n        \\<subseteq> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> Q.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> R \\<diamondsuit>\\<^sub>p x.\n                                  l_comb R M n s f = l_comb R M na sa fa", "apply (frule_tac f = s and A = \"{j. j \\<le> n}\" and B = \"R \\<diamondsuit>\\<^sub>p (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\" and\n          ?B1.0 = \"R \\<diamondsuit>\\<^sub>p x\" in extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa n f s.\n       \\<lbrakk>submodule R M P; submodule R M Q; Ring R; r \\<in> carrier R;\n        x \\<in> carrier R; \\<zero> \\<in> Q;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> Q;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p\n                (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x);\n        xa = l_comb R M n s f;\n        R \\<diamondsuit>\\<^sub>p (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\n        \\<subseteq> R \\<diamondsuit>\\<^sub>p x;\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> Q.\n                               \\<exists>sa\n  \\<in>{j. j \\<le> na} \\<rightarrow> R \\<diamondsuit>\\<^sub>p x.\n                                  l_comb R M n s f = l_comb R M na sa fa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Ann_is_ideal:\"ideal R (Ann\\<^bsub>R\\<^esub> M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R (Ann\\<^bsub>R\\<^esub> M)", "apply (simp add:Annihilator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R ({\\<zero>} \\<^bsub>R\\<ddagger>M\\<^esub> carrier M)", "apply (rule quotient_of_submodules_is_ideal)"], ["proof (prove)\ngoal (2 subgoals):\n 1. submodule R M {\\<zero>}\n 2. submodule R M (carrier M)", "apply (simp add:submodule_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. submodule R M (carrier M)", "apply (simp add:submodule_whole)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linmap_im_of_lincombTr:\"\\<lbrakk>ideal R A; R module N; \n      f \\<in> mHom R M N; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>  \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n      f (l_comb R M n s g) = l_comb R N n s (cmp f g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> n} \\<rightarrow>\n                              H \\<longrightarrow>\n                      f (l_comb R M n s g) = l_comb R N n s (cmp f g)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      g \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              H \\<longrightarrow>\n                      f (l_comb R M 0 s g) = l_comb R N 0 s (cmp f g)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n     g \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> f (l_comb R M 0 s g) = l_comb R N 0 s (cmp f g)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> f (l_comb R M 0 s g) = l_comb R N 0 s (cmp f g)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s 0 \\<in> A; g 0 \\<in> H\\<rbrakk>\n    \\<Longrightarrow> f (s 0 \\<cdot>\\<^sub>s g 0) =\n                      s 0 \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> cmp f g 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (cut_tac m = \"g 0\" and f = f and a = \"s 0\" in mHom_lin [of N],\n        assumption+,\n        simp add:Pi_def subsetD, assumption,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset, simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         g \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (frule_tac f = s in func_pre,\n        frule_tac f = g in func_pre, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (l_comb R M n s g) = l_comb R N n s (cmp f g);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> f (l_comb R M (Suc n) s g) =\n                         l_comb R N (Suc n) s (cmp f g)", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> f (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s g j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e N (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n          cmp f g j) n \\<plusminus>\\<^bsub>N\\<^esub>\n                         s (Suc n) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         cmp f g (Suc n)", "apply (subst mHom_add[of N f], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s g j) n\n                         \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> f (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s g j) n) \\<plusminus>\\<^bsub>N\\<^esub>\n                         f (s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e N (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n          cmp f g j) n \\<plusminus>\\<^bsub>N\\<^esub>\n                         s (Suc n) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         cmp f g (Suc n)", "apply (rule nsum_mem,\n        rule allI, rule impI, rule sc_mem,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> f (\\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s g j) n) \\<plusminus>\\<^bsub>N\\<^esub>\n                         f (s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e N (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n          cmp f g j) n \\<plusminus>\\<^bsub>N\\<^esub>\n                         s (Suc n) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         cmp f g (Suc n)", "apply (rule sc_mem,\n         cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD, simp,\n        frule_tac x = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" and f = s and \n                  B = A in funcset_mem, simp,\n        cut_tac sc_Ring,\n        frule_tac h = \"s (Suc n)\" in Ring.ideal_subset[of R A], assumption+,\n        frule_tac x = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" and f = g and \n                  B = H in funcset_mem, simp,\n        frule_tac c = \"g (Suc n)\" in subsetD[of H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M;\n        f (\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s g j) n) =\n        \\<Sigma>\\<^sub>e N (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                               cmp f g j) n;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H; s (Suc n) \\<in> A; Ring R;\n        s (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n        g (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e N (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n          cmp f g j) n \\<plusminus>\\<^bsub>N\\<^esub>\n                         f (s (Suc n) \\<cdot>\\<^sub>s g (Suc n)) =\n                         \\<Sigma>\\<^sub>e N (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n          cmp f g j) n \\<plusminus>\\<^bsub>N\\<^esub>\n                         s (Suc n) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         cmp f g (Suc n)", "apply (simp add:mHom_lin cmp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linmap_im_lincomb:\"\\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; \n      H \\<subseteq> carrier M; s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<rbrakk> \\<Longrightarrow> \n      f (l_comb R M n s g) = l_comb R N n s (cmp f g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> f (l_comb R M n s g) = l_comb R N n s (cmp f g)", "apply (simp add:linmap_im_of_lincombTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linmap_im_linspan:\"\\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; \n       H \\<subseteq> carrier M; s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<rbrakk> \\<Longrightarrow> \n            f (l_comb R M n s g) \\<in> linear_span R N A (f ` H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> f (l_comb R M n s g) \\<in> linear_span R N A (f ` H)", "apply (frule l_comb_mem_linear_span[of A H s n g], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     l_comb R M n s g \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> f (l_comb R M n s g) \\<in> linear_span R N A (f ` H)", "apply (simp add:linmap_im_lincomb)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     l_comb R M n s g \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> l_comb R N n s (cmp f g)\n                      \\<in> linear_span R N A (f ` H)", "apply (rule Module.l_comb_mem_linear_span[of N R A \"f ` H\" s n \"cmp f g\"],\n        assumption+,\n        rule subsetI,\n        simp add:image_def, erule bexE, simp,\n        frule_tac c = xa in subsetD[of H \"carrier M\"], assumption+,\n        simp add:mHom_mem[of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     l_comb R M n s g \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> cmp f g \\<in> {j. j \\<le> n} \\<rightarrow> f ` H", "apply (rule Pi_I, simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        l_comb R M n s g \\<in> linear_span R M A H; x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (g x) \\<in> f ` H", "apply (frule_tac f = g and A = \"{j. j \\<le> n}\" and B = H and x = x in \n        funcset_mem, simp, simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        l_comb R M n s g \\<in> linear_span R M A H; x \\<le> n;\n        g x \\<in> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>H. f (g x) = f xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) linmap_im_linspan1:\"\\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; \n      H \\<subseteq> carrier M; h \\<in> linear_span R M A H\\<rbrakk> \\<Longrightarrow> \n                              f h \\<in> linear_span R N A (f ` H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M; h \\<in> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> f h \\<in> linear_span R N A (f ` H)", "apply (simp add:linear_span_def [of \"R\" \"M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M;\n     h \\<in> (if H = {} then {\\<zero>}\n              else {x. \\<exists>n.\n                          \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                             \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                x = l_comb R M n s f})\\<rbrakk>\n    \\<Longrightarrow> f h \\<in> linear_span R N A (f ` H)", "apply (case_tac \"H = {}\", simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N; h = \\<zero>;\n     H = {}\\<rbrakk>\n    \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M;\n     h \\<in> (if H = {} then {\\<zero>}\n              else {x. \\<exists>n.\n                          \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                             \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                x = l_comb R M n s f});\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> f h \\<in> linear_span R N A (f ` H)", "apply (simp add:mHom_0, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n     H \\<subseteq> carrier M;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n           \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n              h = l_comb R M n s f;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> f h \\<in> linear_span R N A (f ` H)", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n fa s.\n       \\<lbrakk>ideal R A; R module N; f \\<in> mHom R M N;\n        H \\<subseteq> carrier M; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        h = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> f h \\<in> linear_span R N A (f ` H)", "apply (simp add:linmap_im_linspan)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*\nsection \"A module over two rings\"\n\nrecord ('a, 'r, 's) bModule = \"'a aGroup\" +\n  sc_l  :: \"'r \\<Rightarrow> 'a \\<Rightarrow> 'a\"    (infixl \"\\<cdot>\\<^bsub>sl\\<^esub>\\<index>\" 70)\n  sc_r  :: \"'a \\<Rightarrow> 's \\<Rightarrow> 'a\"    (infixl \"\\<cdot>\\<^bsub>sr\\<^esub>\\<index>\" 70)\n\nlocale bModule = aGroup M +\n  fixes R (structure)\n  fixes S (structure)\n  assumes  scl_Ring: \"Ring R\"\n  and      scr_Ring: \"Ring S\" \n  and  scl_closed :\n      \"\\<lbrakk> a \\<in> carrier R; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> a \\<cdot>\\<^bsub>sl\\<^esub> m \\<in> carrier M\"\n  and scr_closed :\n      \"\\<lbrakk> b \\<in> carrier S; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow> m \\<cdot>\\<^bsub>sr\\<^esub> b \\<in> carrier M\" \n  and scl_l_distr:\n      \"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n       (a \\<plusminus>\\<^bsub>R\\<^esub> b) \\<cdot>\\<^bsub>sl\\<^esub> m = a \\<cdot>\\<^bsub>sl\\<^esub> m \\<plusminus> b \\<cdot>\\<^bsub>sl\\<^esub> m\"\n  and scr_l_distr:\n      \"\\<lbrakk>a \\<in> carrier S; m \\<in> carrier M; n \\<in> carrier M \\<rbrakk> \\<Longrightarrow>\n        (m \\<plusminus> n) \\<cdot>\\<^bsub>sr\\<^esub> a = m \\<cdot>\\<^bsub>sr\\<^esub> a \\<plusminus>  n \\<cdot>\\<^bsub>sr\\<^esub> a\"\n  and scl_r_distr:\n      \"\\<lbrakk> a \\<in> carrier R; m \\<in> carrier M; n \\<in> carrier M \\<rbrakk> \\<Longrightarrow>\n      a \\<cdot>\\<^bsub>sl\\<^esub> (m \\<plusminus> n) = a \\<cdot>\\<^bsub>sl\\<^esub> m \\<plusminus> a \\<cdot>\\<^bsub>sl\\<^esub> n\"\n  and scr_r_distr:\n        \"\\<lbrakk>a \\<in> carrier S; b \\<in> carrier S; m \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n          m \\<cdot>\\<^bsub>sr\\<^esub> (a \\<plusminus>\\<^bsub>S\\<^esub> b) = m \\<cdot>\\<^bsub>sr\\<^esub> a \\<plusminus>  m \\<cdot>\\<^bsub>sr\\<^esub> b\"\n  and scl_assoc:\n      \"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R; m \\<in> carrier M \\<rbrakk> \\<Longrightarrow>\n      (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b) \\<cdot>\\<^bsub>sl\\<^esub> m = a \\<cdot>\\<^bsub>sl\\<^esub> (b \\<cdot>\\<^bsub>sl\\<^esub> m)\"\n  and scr_assoc:\n      \"\\<lbrakk>a \\<in> carrier S; b \\<in> carrier S; m \\<in> carrier M \\<rbrakk> \\<Longrightarrow>\n       m \\<cdot>\\<^bsub>sr\\<^esub> (a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b)  =  (m \\<cdot>\\<^bsub>sr\\<^esub> a) \\<cdot>\\<^bsub>sr\\<^esub> b\"\n  and scl_one:\n      \"m \\<in> carrier M \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub>) \\<cdot>\\<^bsub>sl\\<^esub> m = m\" \n  and scr_one:\n       \"m \\<in> carrier M \\<Longrightarrow> m \\<cdot>\\<^bsub>sr\\<^esub> (1\\<^sub>r\\<^bsub>S\\<^esub>) = m\" \n\ndefinition lModule :: \"('a, 'r, 's, 'more) bModule_scheme \\<Rightarrow> ('a, 'r) Module\" where\n       (\"(_\\<^sub>l)\" [1000]999)\n  \"M\\<^sub>l == \\<lparr>carrier = carrier M, pop = pop M, mop = mop M, \n    zero = zero M, sprod = sc_l M \\<rparr>\"\n\ndefinition scr_re :: \"('a, 'b, 'c, 'more) bModule_scheme \\<Rightarrow> 'c \\<Rightarrow> 'a \\<Rightarrow> 'a\" where \n                  \n \"scr_re M r m == sc_r M m r\"\n\ndefinition rModule :: \"('a, 'r, 's, 'more) bModule_scheme \\<Rightarrow> ('a, 's) Module\" where\n        (\"(_\\<^sub>r)\" [1000]999) \n  \"M\\<^sub>r == \\<lparr>carrier = carrier M, pop = pop M, mop = mop M, \n    zero = zero M, sprod = scr_re M \\<rparr>\"\n\nlemma (in bModule) bmodule_is_ag:\"aGroup M\"  \napply assumption\ndone\n\nlemma (in bModule) lModule_is_Module:\"R module M\\<^sub>l\"\napply (subgoal_tac \"aGroup M\")\napply (rule Module.intro)\n apply (rule aGroup.intro)\n apply (simp add:lModule_def, simp add:aGroup.pop_closed[of M])\n apply (simp add:lModule_def, simp add:aGroup.ag_pOp_assoc)\n apply (simp add:lModule_def, simp add:aGroup.ag_pOp_commute)\n apply (simp add:lModule_def, rule mop_closed)\n apply (simp add:lModule_def, rule l_m, assumption+)\n apply (simp add:lModule_def, rule ex_zero)\n apply (simp add:lModule_def, rule l_zero, assumption)\napply (rule Module_axioms.intro)\n apply (simp add:scl_Ring)\n apply (simp add:lModule_def, rule  scl_closed, assumption+)\n apply (simp add:lModule_def, rule  scl_l_distr, assumption+)\n apply (simp add:lModule_def, rule  scl_r_distr, assumption+)\n apply (simp add:lModule_def, rule  scl_assoc, assumption+)\n apply (simp add:lModule_def, rule scl_one, assumption+)\ndone\n\n\nlemma (in bModule) rModule_is_Module:\"S module M\\<^sub>r\"\napply (subgoal_tac \"aGroup M\")\napply (rule Module.intro)\n apply (rule aGroup.intro)\n apply (simp add:rModule_def, simp add:aGroup.pop_closed[of M])\n apply (simp add:rModule_def, simp add:aGroup.ag_pOp_assoc)\n apply (simp add:rModule_def, simp add:aGroup.ag_pOp_commute)\n apply (simp add:rModule_def, rule mop_closed)\n apply (simp add:rModule_def, rule l_m, assumption+)\n apply (simp add:rModule_def, rule ex_zero)\n apply (simp add:rModule_def, rule l_zero, assumption)\napply (rule Module_axioms.intro,\n       simp add:scr_Ring)\napply (simp add:rModule_def, simp add:scr_re_def scr_closed)\napply (simp add:rModule_def, simp add:scr_re_def, simp add:scr_r_distr)\napply (simp add:rModule_def, simp add:scr_re_def, rule scr_l_distr, \n        assumption+)\napply (simp add:rModule_def scr_re_def,\n       subst scr_assoc[THEN sym], assumption+,\n       cut_tac scr_Ring,\n       simp add:Ring.ring_tOp_commute)\napply (simp add:rModule_def scr_re_def) \napply (cut_tac m = m in scr_one, simp)\napply assumption+\ndone\n\nlemma (in Module) sprodr_welldefTr1:\"\\<lbrakk>ideal R A; A \\<subseteq> Ann\\<^bsub>R\\<^esub> M; a \\<in> A;\n       m \\<in> carrier M\\<rbrakk>  \\<Longrightarrow> a \\<cdot>\\<^sub>s m = \\<zero>\" \napply (simp add:Annihilator_def quotient_of_submodules_def)\napply (frule subsetD, assumption+)\n apply (simp add:CollectI, erule conjE, \n        thin_tac \"A \\<subseteq> {u \\<in> carrier R.\n                   linear_span R M (R \\<diamondsuit>\\<^sub>p u) (carrier M) \\<subseteq> {\\<zero>}}\")\n apply (cut_tac sc_Ring,\n        cut_tac a = a and A = \"Rxa R a\" in \n                         sc_linear_span[of  _ \"carrier M\" _ \"m\"],\n                simp add:Ring.principal_ideal, simp, \n                simp add:Ring.a_in_principal, assumption)\n apply (frule subsetD[of \"linear_span R M (R \\<diamondsuit>\\<^sub>p a) (carrier M)\" \"{\\<zero>}\"\n                             \"a \\<cdot>\\<^sub>s m\"], assumption)\n apply simp\ndone\n\nlemma (in Module) sprodr_welldefTr2:\"\\<lbrakk>ideal R A; A \\<subseteq> Ann\\<^bsub>R\\<^esub> M; a \\<in> carrier R; \n      x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> A; m \\<in> carrier M\\<rbrakk>  \\<Longrightarrow> a \\<cdot>\\<^sub>s m = x \\<cdot>\\<^sub>s m\"\napply (cut_tac sc_Ring,\n       frule Ring.mem_ar_coset1 [of R A a x], assumption+, erule bexE,\n       rotate_tac -1, frule sym, thin_tac \"h \\<plusminus>\\<^bsub>R\\<^esub> a = x\", simp)\napply (subst sc_l_distr)\n apply (simp add:Ring.ideal_subset, assumption+)\napply (simp add:sprodr_welldefTr1)\napply (frule sc_mem [of a m], assumption+)\napply (simp add:ag_l_zero)\ndone\n\ndefinition cos_scr :: \"[('r, 'm) Ring_scheme, 'r set, ('a, 'r, 'm1) Module_scheme] \\<Rightarrow>\n               'a \\<Rightarrow> 'r set \\<Rightarrow> 'a\" where\n  \"cos_scr R A M == \\<lambda>m. \\<lambda>X. (SOME x. x \\<in> X) \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> m\"\n\nlemma (in Module) cos_scr_welldef:\"\\<lbrakk>ideal R A; A \\<subseteq> Ann\\<^bsub>R\\<^esub> M; a \\<in> carrier R; \n       X = a \\<uplus>\\<^bsub>R\\<^esub> A; m \\<in> carrier M\\<rbrakk>  \\<Longrightarrow> cos_scr R A M m X = a \\<cdot>\\<^sub>s m\" \napply (cut_tac sc_Ring,\n       frule Ring.a_in_ar_coset [of R A a], assumption+)\n apply (simp add:cos_scr_def,\n        rule sprodr_welldefTr2[THEN sym], assumption+) \n prefer 2 apply simp\napply (rule someI2_ex, blast, assumption)\ndone\n\ndefinition r_qr_bmod :: \"[('r, 'm) Ring_scheme, 'r set, ('a, 'r, 'm1) Module_scheme] \\<Rightarrow> \n    ('a, 'r, 'r set) bModule\" where \n \"r_qr_bmod R A M == \\<lparr>carrier = carrier M, pop = pop M, mop = mop M, \n  zero = zero M, sc_l = sprod M, sc_r = cos_scr R A M \\<rparr>\" *)\n (* Remark. A should be an ideal contained in Ann\\<^sub>R M. *)"], ["", "definition\n  faithful :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme]\n                             \\<Rightarrow> bool\" where\n  \"faithful R M \\<longleftrightarrow> Ann\\<^bsub>R\\<^esub> M = {\\<zero>\\<^bsub>R\\<^esub>}\""], ["", "section \"nsum and Generators\""], ["", "definition\n  generator :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme,\n               'a set] \\<Rightarrow> bool\" where\n \"generator R M H == H \\<subseteq> carrier M \\<and> \n                      linear_span R M (carrier R) H = carrier M\""], ["", "definition\n  finite_generator :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme,\n               'a set] \\<Rightarrow> bool\" where\n  \"finite_generator R M H \\<longleftrightarrow> finite H \\<and> generator R M H\""], ["", "definition\n  fGOver :: \"[('a, 'r, 'm1) Module_scheme, ('r, 'm) Ring_scheme]  \\<Rightarrow>  bool\"\n              (*(infixl 70)*)  where\n  \"fGOver M R \\<longleftrightarrow> (\\<exists>H. finite_generator R M H)\""], ["", "abbreviation\n  FGENOVER  (infixl \"fgover\" 70) where\n  \"M fgover R == fGOver M R\""], ["", "lemma (in Module) h_in_linear_span:\"\\<lbrakk>H \\<subseteq> carrier M; h \\<in> H\\<rbrakk> \\<Longrightarrow>\n                                   h \\<in> linear_span R M (carrier R) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<in> linear_span R M (carrier R) H", "apply (subst sprod_one [THEN sym, of h])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h\n                      \\<in> linear_span R M (carrier R) H", "apply (simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h\n                      \\<in> linear_span R M (carrier R) H", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h\n                      \\<in> linear_span R M (carrier R) H", "apply (frule Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h\n                      \\<in> linear_span R M (carrier R) H", "apply (rule sc_linear_span [of \"carrier R\" \"H\" \"1\\<^sub>r\\<^bsub>R\\<^esub>\" \"h\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 2. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\n 4. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> h \\<in> H", "apply (simp add:Ring.whole_ideal)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 2. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\n 3. \\<lbrakk>H \\<subseteq> carrier M; h \\<in> H; Ring R;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> h \\<in> H", "apply assumption+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) generator_sub_carrier:\"generator R M H \\<Longrightarrow>\n                                              H \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. generator R M H \\<Longrightarrow> H \\<subseteq> carrier M", "apply (simp add:generator_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) lin_span_sub_carrier:\"\\<lbrakk>ideal R A; \n       H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f})\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H = {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; Ring R; x = \\<zero>; H = {}\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier M\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (simp add:module_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 x = l_comb R M n s f;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (erule exE, (erule bexE)+, simp,\n       thin_tac \"x = l_comb R M n s f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f \\<in> carrier M", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> carrier M", "apply (rule_tac n = n in nsum_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            s j \\<cdot>\\<^sub>s f j \\<in> carrier M", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j \\<in> carrier M", "apply (rule sc_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s j \\<in> carrier R\n 2. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier M", "apply (simp add:Pi_def Ring.ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s j.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier M", "apply (simp add:Pi_def subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) lin_span_coeff_mono:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\\<Longrightarrow>  \n                        linear_span R M A H \\<subseteq> linear_span R M (carrier R) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M (carrier R) H", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M (carrier R) H", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R) H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f})\\<rbrakk>\n       \\<Longrightarrow> (H = {} \\<longrightarrow> x = \\<zero>) \\<and>\n                         (H \\<noteq> {} \\<longrightarrow>\n                          (\\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    x = l_comb R M n s f))", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H = {}\\<rbrakk>\n       \\<Longrightarrow> (H = {} \\<longrightarrow> x = \\<zero>) \\<and>\n                         (H \\<noteq> {} \\<longrightarrow>\n                          (\\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    x = l_comb R M n s f))\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (H = {} \\<longrightarrow> x = \\<zero>) \\<and>\n                         (H \\<noteq> {} \\<longrightarrow>\n                          (\\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    x = l_comb R M n s f))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        x \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (H = {} \\<longrightarrow> x = \\<zero>) \\<and>\n                         (H \\<noteq> {} \\<longrightarrow>\n                          (\\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    x = l_comb R M n s f))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 x = l_comb R M n s f;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply (frule Ring.ideal_subset1 [of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        A \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply (frule_tac  f = s in extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A; x = l_comb R M n s f;\n        A \\<subseteq> carrier R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_sum_closedTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\\<Longrightarrow> \n   \\<forall>s. \\<forall>f. s\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n   f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H \\<longrightarrow>\n   (nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n \\<in> linear_span R M A H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 linear_span R M A H \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> linear_span R M A H", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 linear_span R M A H \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n\n                         \\<in> linear_span R M A H", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 linear_span R M A H \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) 0\n                         \\<in> linear_span R M A H\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    linear_span R M A H \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n\n                            \\<in> linear_span R M A H", "apply ((rule allI)+, rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s 0 \\<in> A \\<and> f 0 \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s 0 \\<cdot>\\<^sub>s f 0 \\<in> linear_span R M A H\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    linear_span R M A H \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n\n                            \\<in> linear_span R M A H", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s 0 \\<in> A;\n        f 0 \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s 0 \\<cdot>\\<^sub>s f 0 \\<in> linear_span R M A H\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    linear_span R M A H \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n\n                            \\<in> linear_span R M A H", "apply (rule linear_span_sc_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s 0 \\<in> A;\n        f 0 \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s 0 \\<in> carrier R\n 2. \\<And>s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s 0 \\<in> A;\n        f 0 \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> f 0 \\<in> linear_span R M A H\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    linear_span R M A H \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n\n                            \\<in> linear_span R M A H", "apply (simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    linear_span R M A H \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n\n                            \\<in> linear_span R M A H", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) Suc n\n                         \\<in> linear_span R M A H", "apply (frule func_pre [of _ _ \"A\"],\n        frule func_pre [of _ _ \"linear_span R M A H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   linear_span R M A H \\<longrightarrow>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n           \\<in> linear_span R M A H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> linear_span R M A H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) Suc n\n                         \\<in> linear_span R M A H", "apply (drule_tac x = s in spec,\n        drule_tac x = f in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> linear_span R M A H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M A H \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) Suc n\n                         \\<in> linear_span R M A H", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> linear_span R M A H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n                         \\<in> linear_span R M A H", "apply (rule linear_span_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> linear_span R M A H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n                         \\<in> linear_span R M A H", "apply (rule linear_span_sc_closed, assumption+,\n        simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_closed:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A;  f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H \\<rbrakk> \\<Longrightarrow>\n l_comb R M n s f \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M A H\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n\n                      \\<in> linear_span R M A H", "apply (simp add: l_span_sum_closedTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_closed1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R;  \n      f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H \\<rbrakk> \\<Longrightarrow>\n      \\<Sigma>\\<^sub>e M (\\<lambda>j.  s j \\<cdot>\\<^sub>s (f j)) n \\<in> linear_span R M (carrier R) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow>\n             linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n\n                      \\<in> linear_span R M (carrier R) H", "apply (cut_tac sc_Ring,\n       frule Ring.whole_ideal [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H;\n     Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n\n                      \\<in> linear_span R M (carrier R) H", "apply (frule l_span_sum_closedTr[of \"carrier R\" H n], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H;\n     Ring R; ideal R (carrier R);\n     \\<forall>s f.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) n\n                      \\<in> linear_span R M (carrier R) H", "apply (drule_tac x = s in spec,\n       drule_tac x = f in spec,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_closed2Tr0:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H \\<rbrakk> \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H; Ring R; H = {}\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H; Ring R; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; s \\<in> A; f = \\<zero>; Ring R; H = {}\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s \\<zero> = \\<zero>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H; Ring R; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H", "apply (rule sc_a_0,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R; s \\<in> A;\n     f \\<in> linear_span R M (carrier R) H; Ring R; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>s f \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A;\n     \\<exists>n.\n        \\<exists>fa\\<in>{j. j \\<le> n} \\<rightarrow> H.\n           \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n              f = l_comb R M n s fa;\n     Ring R; H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>fa\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                            \\<exists>sa\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                               s \\<cdot>\\<^sub>s f = l_comb R M n sa fa", "apply (erule exE, (erule bexE)+, simp,\n        thin_tac \"f = l_comb R M n sa fa\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  s \\<cdot>\\<^sub>s l_comb R M n sa f =\n                                  l_comb R M na sb fa", "apply (frule Ring.whole_ideal[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  s \\<cdot>\\<^sub>s l_comb R M n sa f =\n                                  l_comb R M na sb fa", "apply (frule_tac h = s in Ring.ideal_subset[of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  s \\<cdot>\\<^sub>s l_comb R M n sa f =\n                                  l_comb R M na sb fa", "apply (frule_tac s = sa and g = f in l_comb_sc1[of \"carrier R\" H s],\n        assumption+, simp add:l_comb_def,\n        thin_tac \"s \\<cdot>\\<^sub>s \\<Sigma>\\<^sub>e M (\\<lambda>k. sa k \\<cdot>\\<^sub>s f k) n = \n                                    \\<Sigma>\\<^sub>e M (\\<lambda>k. (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa k) \\<cdot>\\<^sub>s f k) n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sb j \\<cdot>\\<^sub>s fa j) na", "apply (cut_tac n = n and f = \"\\<lambda>j. (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s f j\" and \n        g = \"\\<lambda>j. ((\\<lambda>x\\<in>{j. j \\<le> n}. (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)) j) \\<cdot>\\<^sub>s f j\" in nsum_eq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             sa j) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 3. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             sa j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                sa j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sb j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI, rule sc_mem,\n               rule Ring.ring_tOp_closed, assumption+,\n               simp add:Pi_def,\n               simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             sa j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 3. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                sa j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sb j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI, simp,\n                rule sc_mem,\n               rule Ring.ring_tOp_closed, assumption+,\n               simp add:Pi_def,\n               simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             sa j) \\<cdot>\\<^sub>s\n                            f j =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                             j \\<cdot>\\<^sub>s\n                            f j\n 2. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                sa j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sb j \\<cdot>\\<^sub>s fa j) na", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                                sa j) \\<cdot>\\<^sub>s\n                               f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                   s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                                j \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow> H.\n                               \\<exists>sb\n  \\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s\n                   f j) n =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   sb j \\<cdot>\\<^sub>s fa j) na", "apply (subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> n}. (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)) \\<in> {j. j \\<le> n} \\<rightarrow> A\",\n        blast,\n        thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. (s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa j) \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. (\\<lambda>x\\<in>{j. j \\<le> n}. s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x) j \\<cdot>\\<^sub>s f j) n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> sa x)\n                         \\<in> {j. j \\<le> n} \\<rightarrow> A", "apply (rule Pi_I, simp,\n               rule_tac x = s and r = \"sa x\" in \n               Ring.ideal_ring_multiple1[of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f sa x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; s \\<in> A; Ring R;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        sa \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R); s \\<in> carrier R; x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> sa x \\<in> carrier R", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_closed2Tr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow> \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n       f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H \\<longrightarrow>\n            l_comb R M n s f \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> n} \\<rightarrow>\n                              linear_span R M (carrier R)\n                               H \\<longrightarrow>\n                      l_comb R M n s f \\<in> linear_span R M A H", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> n} \\<rightarrow>\n                              linear_span R M (carrier R)\n                               H \\<longrightarrow>\n                      l_comb R M n s f \\<in> linear_span R M A H", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                      f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              linear_span R M (carrier R)\n                               H \\<longrightarrow>\n                      l_comb R M 0 s f \\<in> linear_span R M A H\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow>\n             linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f \\<in> linear_span R M A H\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (case_tac \"H = {}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> linear_span R M (carrier R) H;\n     H = {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> linear_span R M (carrier R) H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f \\<in> linear_span R M A H\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; Ring R; s 0 \\<in> A; f 0 = \\<zero>; H = {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f = \\<zero>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> linear_span R M (carrier R) H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f \\<in> linear_span R M A H\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; Ring R; s 0 \\<in> A; f 0 = \\<zero>; H = {}\\<rbrakk>\n    \\<Longrightarrow> s 0 \\<cdot>\\<^sub>s \\<zero> = \\<zero>\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> linear_span R M (carrier R) H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f \\<in> linear_span R M A H\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (rule sc_a_0,\n        cut_tac sc_Ring,\n        simp add:Pi_def Ring.ideal_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> linear_span R M (carrier R) H;\n     H \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 s f \\<in> linear_span R M A H\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (simp add:l_comb_def l_span_closed2Tr0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H \\<longrightarrow>\n        l_comb R M n s f \\<in> linear_span R M A H\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 linear_span R M (carrier R)\n                                  H \\<longrightarrow>\n                         l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (rule impI, erule conjE,\n       frule func_pre[of s], frule func_pre[of f], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        l_comb R M n s f \\<in> linear_span R M A H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                linear_span R M (carrier R) H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) s f \\<in> linear_span R M A H", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> linear_span R M A H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                linear_span R M (carrier R) H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n                         \\<in> linear_span R M A H", "apply (rule linear_span_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> linear_span R M A H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                linear_span R M (carrier R) H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n                         \\<in> linear_span R M A H", "apply (rule_tac s = \"s (Suc n)\" and f = \"f (Suc n)\" in \n                 l_span_closed2Tr0[of A H], assumption+,\n       (simp add:Pi_def)+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_closed2:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A ; \n       f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H\\<rbrakk> \\<Longrightarrow>\n       l_comb R M n s f \\<in> linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow>\n             linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H", "apply (simp add:l_span_closed2Tr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_l_span:\"H \\<subseteq> carrier M \\<Longrightarrow>\n       linear_span R M (carrier R) (linear_span R M (carrier R) H) =\n                                          linear_span R M (carrier R) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    linear_span R M (carrier R) (linear_span R M (carrier R) H) =\n    linear_span R M (carrier R) H", "apply (cut_tac sc_Ring, frule Ring.whole_ideal[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R)\n                       (linear_span R M (carrier R) H) =\n                      linear_span R M (carrier R) H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R)\n                       (linear_span R M (carrier R) H)\n                      \\<subseteq> linear_span R M (carrier R) H\n 2. \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R) H\n                      \\<subseteq> linear_span R M (carrier R)\n                                   (linear_span R M (carrier R) H)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R);\n        x \\<in> linear_span R M (carrier R)\n                 (linear_span R M (carrier R) H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R) H\n 2. \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R) H\n                      \\<subseteq> linear_span R M (carrier R)\n                                   (linear_span R M (carrier R) H)", "apply (frule linear_span_inc_0[of \"carrier R\" H], assumption+,\n        frule nonempty[of _ \"linear_span R M (carrier R) H\"],\n        simp add:linear_span_def[of R M \"carrier R\" \n                            \"linear_span R M (carrier R) H\"],\n        erule exE, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R);\n        \\<zero> \\<in> linear_span R M (carrier R) H;\n        linear_span R M (carrier R) H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f\n                         \\<in> linear_span R M (carrier R) H\n 2. \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R) H\n                      \\<subseteq> linear_span R M (carrier R)\n                                   (linear_span R M (carrier R) H)", "apply (frule_tac s = s and n = n and f = f in l_span_closed2[of \"carrier R\"],\n        assumption+,\n        frule lin_span_sub_carrier[of \"carrier R\" \"H\"], assumption+,\n        rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; Ring R; ideal R (carrier R);\n        linear_span R M (carrier R) H \\<subseteq> carrier M;\n        x \\<in> linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R)\n                                  (linear_span R M (carrier R) H)", "apply (rule_tac h = x in h_in_linear_span[of \"linear_span R M (carrier R) H\"],\n        assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_spanA_l_span:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk> \\<Longrightarrow>\n       linear_span R M A (linear_span R M (carrier R) H) =\n                                          linear_span R M A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A (linear_span R M (carrier R) H) =\n                      linear_span R M A H", "apply (cut_tac sc_Ring, frule Ring.whole_ideal[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A (linear_span R M (carrier R) H) =\n                      linear_span R M A H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A (linear_span R M (carrier R) H)\n                      \\<subseteq> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M A\n                                   (linear_span R M (carrier R) H)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        x \\<in> linear_span R M A (linear_span R M (carrier R) H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M A\n                                   (linear_span R M (carrier R) H)", "apply (frule linear_span_inc_0[of \"carrier R\" H], assumption+,\n        frule nonempty[of _ \"linear_span R M (carrier R) H\"],\n        simp add:linear_span_def[of R M A \n                            \"linear_span R M (carrier R) H\"],\n        erule exE, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R); \\<zero> \\<in> linear_span R M (carrier R) H;\n        linear_span R M (carrier R) H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f \\<in> linear_span R M A H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M A\n                                   (linear_span R M (carrier R) H)", "apply (frule_tac s = s and n = n and f = f in l_span_closed2[of A],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M A\n                                   (linear_span R M (carrier R) H)", "apply (frule l_span_cont_H[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R);\n     H \\<subseteq> linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M A\n                                   (linear_span R M (carrier R) H)", "apply (frule l_span_gen_mono[of \"H\" \"linear_span R M (carrier R) H\" A],\n        simp add:lin_span_sub_carrier[of \"carrier R\" H], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M; Ring R;\n     ideal R (carrier R); H \\<subseteq> linear_span R M (carrier R) H;\n     linear_span R M A H\n     \\<subseteq> linear_span R M A (linear_span R M (carrier R) H)\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H\n                      \\<subseteq> linear_span R M A\n                                   (linear_span R M (carrier R) H)", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_zero:\"ideal R A \\<Longrightarrow> linear_span R M A {\\<zero>} = {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow> linear_span R M A {\\<zero>} = {\\<zero>}", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A {\\<zero>} = {\\<zero>}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A {\\<zero>} \\<subseteq> {\\<zero>}\n 2. \\<lbrakk>ideal R A; Ring R\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>} \\<subseteq> linear_span R M A {\\<zero>}", "apply (rule subsetI,\n        frule_tac x = x in mem_single_l_span1[of A \\<zero>],\n        simp add:ag_inc_zero, assumption,\n        erule bexE, frule_tac h = a in Ring.ideal_subset[of R A], assumption+,\n        simp add:sc_a_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; Ring R\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>} \\<subseteq> linear_span R M A {\\<zero>}", "apply (rule subsetI, simp, rule linear_span_inc_0, assumption,\n        rule subsetI, simp add:ag_inc_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) l_span_closed3:\"\\<lbrakk>ideal R A; generator R M H;\n       A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\\<rbrakk> \\<Longrightarrow> linear_span R M A H = carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; generator R M H;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H = carrier M", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; generator R M H;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H = carrier M", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; generator R M H;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> linear_span R M A H \\<subseteq> carrier M\n 2. \\<lbrakk>ideal R A; generator R M H;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> carrier M \\<subseteq> linear_span R M A H", "apply (cut_tac linear_span_subModule[of A H],\n        simp add:submodule_subset, assumption,\n        simp add:generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; generator R M H;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R\\<rbrakk>\n    \\<Longrightarrow> carrier M \\<subseteq> linear_span R M A H", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; generator R M H;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R;\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (simp add:generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A;\n        H \\<subseteq> carrier M \\<and>\n        linear_span R M (carrier R) H = carrier M;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R;\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R;\n        x \\<in> carrier M; H \\<subseteq> carrier M;\n        linear_span R M (carrier R) H = carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (case_tac \"H = {}\", simp, simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; Ring R;\n        x \\<in> carrier M; H \\<subseteq> carrier M;\n        linear_span R M (carrier R) H = carrier M; H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (simp add:smodule_ideal_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; linear_span R M A (carrier M) = carrier M;\n        Ring R; x \\<in> carrier M; H \\<subseteq> carrier M;\n        linear_span R M (carrier R) H = carrier M; H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (rotate_tac -2, frule sym,\n        thin_tac \"linear_span R M (carrier R) H = carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A;\n        linear_span R M A (carrier M) = carrier M; Ring R;\n        x \\<in> carrier M; H \\<subseteq> carrier M;\n        carrier M = linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A;\n        linear_span R M A (linear_span R M (carrier R) H) =\n        linear_span R M (carrier R) H;\n        Ring R; x \\<in> linear_span R M (carrier R) H;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        carrier M = linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (frule sym, \n        thin_tac \"linear_span R M A (linear_span R M (carrier R) H) =\n                  linear_span R M (carrier R) H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A; Ring R;\n        x \\<in> linear_span R M (carrier R) H;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        carrier M = linear_span R M (carrier R) H;\n        linear_span R M (carrier R) H =\n        linear_span R M A (linear_span R M (carrier R) H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (frule_tac a = x in eq_set_inc[of _ \"linear_span R M (carrier R) H\"\n        \"linear_span R M A (linear_span R M (carrier R) H)\"], assumption+,\n        thin_tac \"x \\<in> linear_span R M (carrier R) H\",\n        thin_tac \"linear_span R M (carrier R) H =\n         linear_span R M A (linear_span R M (carrier R) H)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A; Ring R;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        carrier M = linear_span R M (carrier R) H;\n        x \\<in> linear_span R M A (linear_span R M (carrier R) H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (frule sym, \n        thin_tac \"carrier M = linear_span R M (carrier R) H\",\n        frule subset_trans[of H \"linear_span R M (carrier R) H\" \"carrier M\"],\n        simp,\n        thin_tac \"linear_span R M (carrier R) H = carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A; Ring R;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        x \\<in> linear_span R M A (linear_span R M (carrier R) H);\n        H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (frule Ring.whole_ideal,\n        frule linear_span_inc_0 [of \"carrier R\" \"H\"], assumption+,\n        frule nonempty [of \"\\<zero>\" \"linear_span R M (carrier R) H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A; Ring R;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        x \\<in> linear_span R M A (linear_span R M (carrier R) H);\n        H \\<subseteq> carrier M; ideal R (carrier R);\n        \\<zero> \\<in> linear_span R M (carrier R) H;\n        linear_span R M (carrier R) H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (simp add:linear_span_def [of _ _ _ \"linear_span R M (carrier R) H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<noteq> {}; ideal R A; Ring R;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          linear_span R M (carrier R) H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 x = l_comb R M n s f;\n        H \\<subseteq> carrier M; ideal R (carrier R);\n        \\<zero> \\<in> linear_span R M (carrier R) H;\n        linear_span R M (carrier R) H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<noteq> {}; ideal R A; Ring R;\n        H \\<subseteq> linear_span R M (carrier R) H;\n        H \\<subseteq> carrier M; ideal R (carrier R);\n        \\<zero> \\<in> linear_span R M (carrier R) H;\n        linear_span R M (carrier R) H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> linear_span R M (carrier R) H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M A H", "apply (simp add:l_span_closed2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) generator_generator:\"\\<lbrakk>generator R M H; H1 \\<subseteq> carrier M; \n           H \\<subseteq> linear_span R M (carrier R) H1\\<rbrakk>  \\<Longrightarrow>  generator R M H1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>generator R M H; H1 \\<subseteq> carrier M;\n     H \\<subseteq> linear_span R M (carrier R) H1\\<rbrakk>\n    \\<Longrightarrow> generator R M H1", "apply (cut_tac sc_Ring,\n       frule Ring.whole_ideal[of R],\n       frule linear_span_subModule[of \"carrier R\" H1], assumption,\n       frule l_span_sub_submodule[of \"carrier R\" \n            \"linear_span R M (carrier R) H1\" H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>generator R M H; H1 \\<subseteq> carrier M;\n     H \\<subseteq> linear_span R M (carrier R) H1; Ring R;\n     ideal R (carrier R); submodule R M (linear_span R M (carrier R) H1);\n     linear_span R M (carrier R) H\n     \\<subseteq> linear_span R M (carrier R) H1\\<rbrakk>\n    \\<Longrightarrow> generator R M H1", "apply (simp add:generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M \\<and>\n             linear_span R M (carrier R) H = carrier M;\n     H1 \\<subseteq> carrier M; H \\<subseteq> linear_span R M (carrier R) H1;\n     Ring R; ideal R (carrier R);\n     submodule R M (linear_span R M (carrier R) H1);\n     carrier M \\<subseteq> linear_span R M (carrier R) H1\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R) H1 = carrier M", "apply (rule equalityI,\n       simp add:submodule_subset, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) generator_elimTr:\n\"f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M \\<and> generator R M (f ` {j. j \\<le> n}) \\<and> \n(\\<forall>i\\<in>nset (Suc 0) n. f i \\<in> \n   linear_span R M (carrier R) (f ` {j. j \\<le> (i - Suc 0)})) \\<longrightarrow> \n linear_span R M (carrier R) {f 0} = carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n    generator R M (f ` {j. j \\<le> n}) \\<and>\n    (\\<forall>i\\<in>nset (Suc 0) n.\n        f i\n        \\<in> linear_span R M (carrier R)\n               (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n    linear_span R M (carrier R) {f 0} = carrier M", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M \\<and>\n    generator R M (f ` {j. j \\<le> 0}) \\<and>\n    (\\<forall>i\\<in>nset (Suc 0) 0.\n        f i\n        \\<in> linear_span R M (carrier R)\n               (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n    linear_span R M (carrier R) {f 0} = carrier M\n 2. \\<And>n.\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n       generator R M (f ` {j. j \\<le> n}) \\<and>\n       (\\<forall>i\\<in>nset (Suc 0) n.\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n       linear_span R M (carrier R) {f 0} = carrier M \\<Longrightarrow>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M \\<and>\n       generator R M (f ` {j. j \\<le> Suc n}) \\<and>\n       (\\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n       linear_span R M (carrier R) {f 0} = carrier M", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M;\n     generator R M (f ` {j. j \\<le> 0});\n     \\<forall>i\\<in>nset (Suc 0) 0.\n        f i\n        \\<in> linear_span R M (carrier R)\n               (f ` {j. j \\<le> i - Suc 0})\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M\n 2. \\<And>n.\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n       generator R M (f ` {j. j \\<le> n}) \\<and>\n       (\\<forall>i\\<in>nset (Suc 0) n.\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n       linear_span R M (carrier R) {f 0} = carrier M \\<Longrightarrow>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M \\<and>\n       generator R M (f ` {j. j \\<le> Suc n}) \\<and>\n       (\\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n       linear_span R M (carrier R) {f 0} = carrier M", "apply (simp add:nset_def generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n       generator R M (f ` {j. j \\<le> n}) \\<and>\n       (\\<forall>i\\<in>nset (Suc 0) n.\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n       linear_span R M (carrier R) {f 0} = carrier M \\<Longrightarrow>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M \\<and>\n       generator R M (f ` {j. j \\<le> Suc n}) \\<and>\n       (\\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n       linear_span R M (carrier R) {f 0} = carrier M", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n                generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M \\<and>\n        generator R M (f ` {j. j \\<le> Suc n}) \\<and>\n        (\\<forall>i\\<in>nset (Suc 0) (Suc n).\n            f i\n            \\<in> linear_span R M (carrier R)\n                   (f ` {j. j \\<le> i - Suc 0}))\\<rbrakk>\n       \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n                generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M", "apply (frule func_pre [of _ _ \"carrier M\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M", "apply (subgoal_tac \"generator R M (f ` {j. j \\<le> n})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M\n 2. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (subgoal_tac \"\\<forall>i\\<in>nset (Suc 0) n.\n         f i \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> (i - Suc 0)})\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> n});\n        \\<forall>i\\<in>nset (Suc 0) n.\n           f i\n           \\<in> linear_span R M (carrier R)\n                  (f ` {j. j \\<le> i - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M\n 2. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>nset (Suc 0) n.\n                            f i\n                            \\<in> linear_span R M (carrier R)\n                                   (f ` {j. j \\<le> i - Suc 0})\n 3. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>nset (Suc 0) n.\n                            f i\n                            \\<in> linear_span R M (carrier R)\n                                   (f ` {j. j \\<le> i - Suc 0})\n 2. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (thin_tac \"generator R M (f ` {j. j \\<le> n}) \\<and>\n     (\\<forall>i\\<in>nset (Suc 0) n. f i \\<in> linear_span R M (carrier R) \n              (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n         linear_span R M (carrier R) {f 0} = carrier M\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>nset (Suc 0) n.\n                            f i\n                            \\<in> linear_span R M (carrier R)\n                                   (f ` {j. j \\<le> i - Suc 0})\n 2. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n i.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> n}); i \\<in> nset (Suc 0) n\\<rbrakk>\n       \\<Longrightarrow> f i\n                         \\<in> linear_span R M (carrier R)\n                                (f ` {j. j \\<le> i - Suc 0})\n 2. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (frule_tac x = i in bspec, simp add:nset_def, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>generator R M (f ` {j. j \\<le> n}) \\<and>\n                (\\<forall>i\\<in>nset (Suc 0) n.\n                    f i\n                    \\<in> linear_span R M (carrier R)\n                           (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n                linear_span R M (carrier R) {f 0} = carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (thin_tac \"generator R M (f ` {j. j \\<le> n}) \\<and>\n         (\\<forall>i\\<in>nset (Suc 0) n.\n         f i \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0})) \\<longrightarrow>\n         linear_span R M (carrier R) {f 0} = carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        \\<forall>i\\<in>nset (Suc 0) (Suc n).\n           f i\n           \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (frule_tac x = \"Suc n\" in bspec, simp add:nset_def,\n        thin_tac \"\\<forall>i\\<in>nset (Suc 0) (Suc n).\n            f i \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> i - Suc 0})\",\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})", "apply (subgoal_tac \"f ` {j. j \\<le> Suc n} \\<subseteq> linear_span R M (carrier R) (f ` {j. j \\<le> n})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n) \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n});\n        f ` {j. j \\<le> Suc n}\n        \\<subseteq> linear_span R M (carrier R)\n                     (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})\n 2. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> Suc n}\n                         \\<subseteq> linear_span R M (carrier R)\n(f ` {j. j \\<le> n})", "apply (frule_tac H = \"f ` {j. j \\<le> Suc n}\" and ?H1.0 = \"f ` {j. j \\<le> n}\"\n        in generator_generator,\n        rule subsetI, simp add:image_def, erule exE, erule conjE, simp,\n        simp add:Pi_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n) \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n});\n        f ` {j. j \\<le> Suc n}\n        \\<subseteq> linear_span R M (carrier R)\n                     (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> Suc n}\n                         \\<subseteq> linear_span R M (carrier R)\n(f ` {j. j \\<le> n})\n 2. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n) \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n});\n        f ` {j. j \\<le> Suc n}\n        \\<subseteq> linear_span R M (carrier R) (f ` {j. j \\<le> n});\n        generator R M (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> generator R M (f ` {j. j \\<le> n})\n 3. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> Suc n}\n                         \\<subseteq> linear_span R M (carrier R)\n(f ` {j. j \\<le> n})", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M (f ` {j. j \\<le> Suc n});\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> Suc n}\n                         \\<subseteq> linear_span R M (carrier R)\n(f ` {j. j \\<le> n})", "apply (rule subsetI, simp add:image_def, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M {y. \\<exists>x\\<le>Suc n. y = f x};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) {y. \\<exists>x\\<le>n. y = f x};\n        xa \\<le> Suc n; x = f xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R)\n                                  {y. \\<exists>x\\<le>n. y = f x}", "apply (case_tac \"xa = Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M {y. \\<exists>x\\<le>Suc n. y = f x};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) {y. \\<exists>x\\<le>n. y = f x};\n        xa \\<le> Suc n; x = f xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R)\n                                  {y. \\<exists>x\\<le>n. y = f x}", "apply (frule_tac m = xa and n = \"Suc n\" in noteq_le_less, assumption,\n        thin_tac \"xa \\<le> Suc n\",\n        frule_tac x = xa and n = \"Suc n\" in less_le_diff, \n        thin_tac \"xa < Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M {y. \\<exists>x\\<le>Suc n. y = f x};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) {y. \\<exists>x\\<le>n. y = f x};\n        x = f xa; xa \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f xa\n                         \\<in> linear_span R M (carrier R)\n                                {y. \\<exists>x\\<le>n. y = f x}", "apply (rule_tac H = \"{y. \\<exists>x\\<le>n. y = f x}\" and h = \"f xa\" in \n                       h_in_linear_span,\n        rule subsetI, simp add:image_def, erule exE, erule conjE,\n        simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        generator R M {y. \\<exists>x\\<le>Suc n. y = f x};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        f (Suc n)\n        \\<in> linear_span R M (carrier R) {y. \\<exists>x\\<le>n. y = f x};\n        x = f xa; xa \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f xa \\<in> {y. \\<exists>x\\<le>n. y = f x}", "apply (simp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) generator_generator_elim:\n \"\\<lbrakk>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M; generator R M (f ` {j. j \\<le> n}); \n  (\\<forall>i\\<in>nset (Suc 0) n. f i \\<in> linear_span R M (carrier R) \n     (f ` {j. j \\<le> (i - Suc 0)}))\\<rbrakk> \\<Longrightarrow> \n   linear_span R M (carrier R) {f 0} = carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (f ` {j. j \\<le> n});\n     \\<forall>i\\<in>nset (Suc 0) n.\n        f i\n        \\<in> linear_span R M (carrier R)\n               (f ` {j. j \\<le> i - Suc 0})\\<rbrakk>\n    \\<Longrightarrow> linear_span R M (carrier R) {f 0} = carrier M", "apply (simp add:generator_elimTr [of f n])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) surjec_generator:\"\\<lbrakk>R module N; f \\<in> mHom R M N;\n surjec\\<^bsub>M,N\\<^esub> f; generator R M H\\<rbrakk> \\<Longrightarrow> generator R N (f ` H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n     generator R M H\\<rbrakk>\n    \\<Longrightarrow> generator R N (f ` H)", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n     generator R M H; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> generator R N (f ` H)", "apply (simp add:generator_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     linear_span R M (carrier R) H = carrier M\\<rbrakk>\n    \\<Longrightarrow> f ` H \\<subseteq> carrier N \\<and>\n                      linear_span R N (carrier R) (f ` H) = carrier N", "apply (simp add:surjec_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n     f \\<in> aHom M N; surj_to f (carrier M) (carrier N)\\<rbrakk>\n    \\<Longrightarrow> f ` H \\<subseteq> carrier N \\<and>\n                      linear_span R N (carrier R) (f ` H) = carrier N", "apply (simp add:aHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n     surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     f \\<in> extensional (carrier M);\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           f (a \\<plusminus> b) =\n           f a \\<plusminus>\\<^bsub>N\\<^esub> f b\\<rbrakk>\n    \\<Longrightarrow> f ` H \\<subseteq> carrier N \\<and>\n                      linear_span R N (carrier R) (f ` H) = carrier N", "apply (simp add:image_sub [of \"f\" \"carrier M\" \"carrier N\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n     surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     f \\<in> extensional (carrier M);\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           f (a \\<plusminus> b) =\n           f a \\<plusminus>\\<^bsub>N\\<^esub> f b\\<rbrakk>\n    \\<Longrightarrow> linear_span R N (carrier R) (f ` H) = carrier N", "apply (frule Module.lin_span_sub_carrier[of N R \"carrier R\" \"f ` H\"],\n       assumption,\n       simp add:image_sub [of \"f\" \"carrier M\" \"carrier N\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n     surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     f \\<in> extensional (carrier M);\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b;\n     linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N\\<rbrakk>\n    \\<Longrightarrow> linear_span R N (carrier R) (f ` H) = carrier N", "apply (rule equalityI, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n     surj_to f (carrier M) (carrier N);\n     f \\<in> carrier M \\<rightarrow> carrier N;\n     f \\<in> extensional (carrier M);\n     \\<forall>a\\<in>carrier M.\n        \\<forall>b\\<in>carrier M.\n           f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b;\n     linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N\\<rbrakk>\n    \\<Longrightarrow> carrier N\n                      \\<subseteq> linear_span R N (carrier R) (f ` H)", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n        surj_to f (carrier M) (carrier N);\n        f \\<in> carrier M \\<rightarrow> carrier N;\n        f \\<in> extensional (carrier M);\n        \\<forall>a\\<in>carrier M.\n           \\<forall>b\\<in>carrier M.\n              f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b;\n        linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N;\n        x \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R N (carrier R) (f ` H)", "apply (simp add:surj_to_def,\n        thin_tac \"f \\<in> extensional (carrier M)\",\n        thin_tac \"\\<forall>a\\<in>carrier M. \\<forall>b\\<in>carrier M. f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; linear_span R M (carrier R) H = carrier M;\n        f ` carrier M = carrier N;\n        f \\<in> carrier M \\<rightarrow> carrier N;\n        linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N;\n        x \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R N (carrier R) (f ` H)", "apply (frule sym, rotate_tac 6, frule sym,\n        thin_tac \"f ` carrier M = carrier N\",\n        frule_tac a = x and A = \"carrier N\" and B = \"f ` carrier M\" in\n        eq_set_inc, assumption,\n        thin_tac \"carrier N = f ` carrier M\", \n        thin_tac \"carrier M = linear_span R M (carrier R) H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N;\n        x \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        linear_span R M (carrier R) H = carrier M;\n        x \\<in> f ` carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R N (carrier R) (f ` H)", "apply (simp add:image_def[of f \"carrier M\"], erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N;\n        x \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        linear_span R M (carrier R) H = carrier M; xa \\<in> carrier M;\n        x = f xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R N (carrier R) (f ` H)", "apply (frule sym, thin_tac \"linear_span R M (carrier R) H = carrier M\",\n        frule_tac a = xa in eq_set_inc[of _ \"carrier M\" \n        \"linear_span R M (carrier R) H\"], assumption,\n        thin_tac \"carrier M = linear_span R M (carrier R) H\",\n        thin_tac \"linear_span R N (carrier R) (f ` H) \\<subseteq> carrier N\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        x \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M; xa \\<in> carrier M;\n        x = f xa; xa \\<in> linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R N (carrier R) (f ` H)", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        f xa \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M; xa \\<in> carrier M;\n        x = f xa;\n        xa \\<in> (if H = {} then {\\<zero>}\n                  else {x. \\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    x = l_comb R M n s f})\\<rbrakk>\n       \\<Longrightarrow> (H = {} \\<longrightarrow>\n                          f xa = \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                         (H \\<noteq> {} \\<longrightarrow>\n                          (\\<exists>n.\n                              \\<exists>fa\n \\<in>{j. j \\<le> n} \\<rightarrow> f ` H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    f xa = l_comb R N n s fa))", "apply (case_tac \"H = {}\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        f \\<zero> \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); \\<zero> \\<in> carrier M; x = f \\<zero>;\n        xa = \\<zero>; H = {}\\<rbrakk>\n       \\<Longrightarrow> f \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        f xa \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M; xa \\<in> carrier M;\n        x = f xa;\n        xa \\<in> (if H = {} then {\\<zero>}\n                  else {x. \\<exists>n.\n                              \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    x = l_comb R M n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (H = {} \\<longrightarrow>\n                          f xa = \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                         (H \\<noteq> {} \\<longrightarrow>\n                          (\\<exists>n.\n                              \\<exists>fa\n \\<in>{j. j \\<le> n} \\<rightarrow> f ` H.\n                                 \\<exists>s\n    \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                    f xa = l_comb R N n s fa))", "apply (simp add:mHom_0, simp,\n        erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa n fa s.\n       \\<lbrakk>f \\<in> carrier M \\<rightarrow> carrier N;\n        f xa \\<in> carrier N; R module N; f \\<in> mHom R M N; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M; xa \\<in> carrier M;\n        x = f xa; H \\<noteq> {}; fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        xa = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>fa\\<in>{j. j \\<le> n} \\<rightarrow>\n      f ` H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  f xa = l_comb R N n s fa", "apply (cut_tac sc_Ring, frule Ring.whole_ideal[of R],\n       frule_tac s = s and n = n and g = fa in \n       linmap_im_linspan[of \"carrier R\" N f H], assumption+,\n       rotate_tac -5, frule sym,\n       thin_tac \"xa = l_comb R M n s fa\", simp,\n       thin_tac \"l_comb R M n s fa = xa\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa n fa s.\n       \\<lbrakk>s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f xa \\<in> linear_span R N (carrier R) (f ` H);\n        f \\<in> carrier M \\<rightarrow> carrier N; f xa \\<in> carrier N;\n        R module N; f \\<in> mHom R M N; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; xa \\<in> carrier M; x = f xa;\n        H \\<noteq> {}; fa \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>fa\\<in>{j. j \\<le> n} \\<rightarrow>\n      f ` H.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  f xa = l_comb R N n s fa", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) surjec_finitely_gen:\"\\<lbrakk>R module N; f \\<in> mHom R M N;\n       surjec\\<^bsub>M,N\\<^esub> f; M fgover R\\<rbrakk>  \\<Longrightarrow> N fgover R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n     M fgover R\\<rbrakk>\n    \\<Longrightarrow> N fgover R", "apply (simp add:fGOver_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n     \\<exists>H. finite_generator R M H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H. finite_generator R N H", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n        finite_generator R M H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H. finite_generator R N H", "apply (simp add:finite_generator_def [of \"R\" \"M\"],erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n        finite H; generator R M H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H. finite_generator R N H", "apply (frule_tac H = H in surjec_generator[of N f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n        finite H; generator R M H; generator R N (f ` H)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H. finite_generator R N H", "apply (simp add:finite_generator_def [of \"R\" \"N\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n        finite H; generator R M H; generator R N (f ` H)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H. finite H \\<and> generator R N H", "apply (frule_tac F = H and h = f in finite_imageI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>R module N; f \\<in> mHom R M N; surjec\\<^bsub>M,N\\<^esub> f;\n        finite H; generator R M H; generator R N (f ` H);\n        finite (f ` H)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H. finite H \\<and> generator R N H", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Sum up coefficients\""], ["", "text\\<open>Symbolic calculation.\\<close>"], ["", "lemma (in Module) similar_termTr:\"\\<lbrakk>ideal R A; a \\<in> A\\<rbrakk> \\<Longrightarrow>\n \\<forall>s. \\<forall>f. s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<and> \n         f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and> \n         m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n       (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A. nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n \\<plusminus> a \\<cdot>\\<^sub>s m = \n           nsum M (\\<lambda>j. t j \\<cdot>\\<^sub>s (f j)) n )\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 carrier M \\<and>\n                         m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n                         (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                             a \\<cdot>\\<^sub>s m =\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s f j) n)", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 carrier M \\<and>\n                         m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n                         (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                             a \\<cdot>\\<^sub>s m =\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s f j) n)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; a \\<in> A; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 carrier M \\<and>\n                         m \\<in> f ` {j. j \\<le> 0} \\<longrightarrow>\n                         (\\<exists>t\\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              s j \\<cdot>\\<^sub>s f j) 0 \\<plusminus>\n                             a \\<cdot>\\<^sub>s m =\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s f j) 0)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply (rule allI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 carrier M \\<and>\n                         m \\<in> f ` {j. j \\<le> 0} \\<longrightarrow>\n                         (\\<exists>t\\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              s j \\<cdot>\\<^sub>s f j) 0 \\<plusminus>\n                             a \\<cdot>\\<^sub>s m =\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s f j) 0)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M \\<and>\n        m \\<in> f ` {j. j \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) 0 \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M;\n        m \\<in> f ` {j. j \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) 0 \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R; s 0 \\<in> A;\n        f 0 \\<in> carrier M; m = f 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{0} \\<rightarrow> A.\n                            s 0 \\<cdot>\\<^sub>s f 0 \\<plusminus>\n                            a \\<cdot>\\<^sub>s f 0 =\n                            t 0 \\<cdot>\\<^sub>s f 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply (rule_tac x = \"\\<lambda>k\\<in>{0::nat}. (s 0 \\<plusminus>\\<^bsub>R\\<^esub> a)\" in bexI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R; s 0 \\<in> A;\n        f 0 \\<in> carrier M; m = f 0\\<rbrakk>\n       \\<Longrightarrow> s 0 \\<cdot>\\<^sub>s f 0 \\<plusminus>\n                         a \\<cdot>\\<^sub>s f 0 =\n                         (\\<lambda>k\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> a)\n                          0 \\<cdot>\\<^sub>s\n                         f 0\n 2. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R; s 0 \\<in> A;\n        f 0 \\<in> carrier M; m = f 0\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> a)\n                         \\<in> {0} \\<rightarrow> A\n 3. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply (simp add: Ring.ideal_subset sc_l_distr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R; s 0 \\<in> A;\n        f 0 \\<in> carrier M; m = f 0\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> a)\n                         \\<in> {0} \\<rightarrow> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R; s 0 \\<in> A;\n        f 0 \\<in> carrier M; m = f 0\\<rbrakk>\n       \\<Longrightarrow> s 0 \\<plusminus>\\<^bsub>R\\<^esub> a \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply (simp add:Ring.ideal_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\nt j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier M \\<and>\n                            m \\<in> f ` {j. j \\<le> Suc n} \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                                a \\<cdot>\\<^sub>s m =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 t j \\<cdot>\\<^sub>s f j) Suc n)", "apply ((rule allI)+, rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           m \\<in> f ` {j. j \\<le> n} \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        m \\<in> f ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (simp del:nsum_suc add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<exists>x\\<le>Suc n. m = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (cut_tac n = n and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" in nsum_mem,\n        rule allI, rule impI, rule sc_mem,\n        simp add:funcset_mem Ring.ideal_subset,\n        simp add:funcset_mem,\n        frule_tac x = \"Suc n\" and f = s and A = \"{j. j \\<le> Suc n}\" and\n        B = A in funcset_mem, simp,\n        frule_tac h = \"s (Suc n)\" in Ring.ideal_subset, assumption+,\n        frule_tac x = \"Suc n\" and f = f and A = \"{j. j \\<le> Suc n}\" and\n        B = \"carrier M\" in funcset_mem, simp,\n        frule_tac a = \"s (Suc n)\" and m = \"f (Suc n)\" in sc_mem, assumption+,\n        cut_tac a = a and m = m in sc_mem,\n        simp add:Ring.ideal_subset, erule exE, simp add:Pi_def,\n        erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (case_tac \"x = Suc n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s fa.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           fa \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. f (Suc n) = fa x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s fa j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s f (Suc n) =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s fa j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M; m = f (Suc n);\n        x = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                            a \\<cdot>\\<^sub>s f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "(***** case x = Suc n ********)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s fa.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           fa \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. f (Suc n) = fa x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s fa j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s f (Suc n) =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s fa j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M; m = f (Suc n);\n        x = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                            a \\<cdot>\\<^sub>s f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (subst ag_pOp_assoc, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s fa.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           fa \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. f (Suc n) = fa x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s fa j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s f (Suc n) =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s fa j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M; m = f (Suc n);\n        x = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            (s (Suc n) \\<cdot>\\<^sub>s\n                             f (Suc n) \\<plusminus>\n                             a \\<cdot>\\<^sub>s f (Suc n)) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<in> carrier M\",\n        thin_tac \"s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\",\n        thin_tac \"a \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\",\n        thin_tac \"\\<forall>s fa.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           fa \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and> (\\<exists>x\\<le>n. f (Suc n) = fa x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s fa j) n \\<plusminus> a \\<cdot>\\<^sub>s f (Suc n) =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s fa j) n)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            (s (Suc n) \\<cdot>\\<^sub>s\n                             f (Suc n) \\<plusminus>\n                             a \\<cdot>\\<^sub>s f (Suc n)) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (subst sc_l_distr[THEN sym], assumption+,\n        simp add:Ring.ideal_subset, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             a) \\<cdot>\\<^sub>s\n                            f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (frule func_pre[of _ _ A],\n        frule_tac f = s and n = n and g = \"\\<lambda>k\\<in>{0::nat}. (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\" and\n        m = 0 and A = A and B = A in jointfun_hom0,\n        simp add: Ring.ideal_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n s 0\n         (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n        \\<in> {l. l \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             a) \\<cdot>\\<^sub>s\n                            f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (subgoal_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s f (Suc n) =\n      \\<Sigma>\\<^sub>e M (\\<lambda>j. (jointfun n s 0 (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)) j \\<cdot>\\<^sub>s f j) (Suc n)\",\n      simp,\n      thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s f (Suc n) =\n      \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n s 0 (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a) j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n      jointfun n s 0 (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a) (Suc n) \\<cdot>\\<^sub>s f (Suc n)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n s 0\n         (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             jointfun n s 0\n              (\\<lambda>k\\<in>{0}.\n                  s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n              j \\<cdot>\\<^sub>s\n             f j) n \\<plusminus>\n                            jointfun n s 0\n                             (\\<lambda>k\\<in>{0}.\n                                 s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                             (Suc n) \\<cdot>\\<^sub>s\n                            f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n s 0\n         (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n        \\<in> {l. l \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n s 0\n           (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n           j \\<cdot>\\<^sub>s\n          f j) Suc n\n 3. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n s 0\n         (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n        \\<in> {l. l \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n s 0\n           (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n           j \\<cdot>\\<^sub>s\n          f j) Suc n\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n s 0\n         (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n s 0\n           (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n           j \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         jointfun n s 0\n                          (\\<lambda>k\\<in>{0}.\n                              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                          (Suc n) \\<cdot>\\<^sub>s\n                         f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then s j\n           else (\\<lambda>k\\<in>{0}.\n                    s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (cut_tac n = n and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" and g = \"\\<lambda>j. (if j \\<le> n then s j\n        else (\\<lambda>k\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a) (sliden (Suc n) j)) \\<cdot>\\<^sub>s f j\" in\n        nsum_eq)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            s j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n then s j\n                             else (\\<lambda>k\\<in>{0}.\ns (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 3. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            s j \\<cdot>\\<^sub>s f j =\n                            (if j \\<le> n then s j\n                             else (\\<lambda>k\\<in>{0}.\ns (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then s j\n                                else (\\<lambda>k\\<in>{0}.\n   s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then s j\n           else (\\<lambda>k\\<in>{0}.\n                    s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n)\n 5. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (rule allI, rule impI, rule sc_mem,\n               simp add:Pi_def Ring.ideal_subset,\n               simp add:Pi_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n then s j\n                             else (\\<lambda>k\\<in>{0}.\ns (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            s j \\<cdot>\\<^sub>s f j =\n                            (if j \\<le> n then s j\n                             else (\\<lambda>k\\<in>{0}.\ns (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n 3. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then s j\n                                else (\\<lambda>k\\<in>{0}.\n   s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then s j\n           else (\\<lambda>k\\<in>{0}.\n                    s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n)\n 4. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (rule allI, rule impI, simp, rule sc_mem,\n               simp add:Pi_def Ring.ideal_subset,\n               simp add:Pi_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            s j \\<cdot>\\<^sub>s f j =\n                            (if j \\<le> n then s j\n                             else (\\<lambda>k\\<in>{0}.\ns (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then s j\n                                else (\\<lambda>k\\<in>{0}.\n   s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then s j\n           else (\\<lambda>k\\<in>{0}.\n                    s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n)\n 3. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M; m = f (Suc n); x = Suc n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then s i\n            else (\\<lambda>k\\<in>{0}.\n                     s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                  (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then s j\n                                else (\\<lambda>k\\<in>{0}.\n   s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then s j\n           else (\\<lambda>k\\<in>{0}.\n                    s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> a)\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          a) \\<cdot>\\<^sub>s\n                         f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>x\\<le>n. m = f x) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s m =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s m \\<in> carrier M; x \\<le> Suc n; m = f x;\n        x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) Suc n \\<plusminus>\n                            a \\<cdot>\\<^sub>s m =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) Suc n", "apply (frule_tac m = x and n = \"Suc n\" in noteq_le_less, assumption,\n         thin_tac \"x \\<le> Suc n\",\n         frule_tac x = x and n = \"Suc n\" in less_le_diff,\n         thin_tac \"x < Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s fa.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           fa \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>xa\\<le>n. f x = fa xa) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s fa j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s f x =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s fa j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                            a \\<cdot>\\<^sub>s f x =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)", "apply (frule func_pre[of _ _ A], frule func_pre[of _ _ \"carrier M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        \\<forall>s fa.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           fa \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n           (\\<exists>xa\\<le>n. f x = fa xa) \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n               \\<Sigma>\\<^sub>e M (\\<lambda>j.\ns j \\<cdot>\\<^sub>s fa j) n \\<plusminus>\n               a \\<cdot>\\<^sub>s f x =\n               \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s fa j) n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                            a \\<cdot>\\<^sub>s f x =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)", "apply (drule_tac x = s in spec,\n         drule_tac x = f in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                            a \\<cdot>\\<^sub>s f x =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)", "apply (subgoal_tac \"\\<exists>xa\\<le>n. f x = f xa\", simp,\n          thin_tac \"\\<exists>xa\\<le>n. f x = f xa\", erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        a \\<cdot>\\<^sub>s f x =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus>\n                            a \\<cdot>\\<^sub>s f x =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (subst ag_pOp_assoc, assumption+,\n          frule_tac x = \"s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\" and y = \"a \\<cdot>\\<^sub>s f x\" in \n          ag_pOp_commute, assumption+, simp,\n          thin_tac \"s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<plusminus> a \\<cdot>\\<^sub>s f x =\n          a \\<cdot>\\<^sub>s f x \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\",\n          subst ag_pOp_assoc[THEN sym], assumption+, simp,\n    thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<plusminus> a \\<cdot>\\<^sub>s f x = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (frule_tac f = t and n = n and g = \"\\<lambda>k\\<in>{0::nat}. s (Suc n)\" and\n         m = 0 and A = A and B = A in jointfun_hom0,\n         simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (subgoal_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n         \\<Sigma>\\<^sub>e M (\\<lambda>j. (jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))) j \\<cdot>\\<^sub>s f j) (Suc n)\",\n         simp,\n         thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n)) (Suc n) \\<cdot>\\<^sub>s f (Suc n)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n              j \\<cdot>\\<^sub>s\n             f j) n \\<plusminus>\n                            jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n                             (Suc n) \\<cdot>\\<^sub>s\n                            f (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          f j) Suc n\n 3. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          f j) Suc n\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then t j\n           else (\\<lambda>k\\<in>{0}. s (Suc n))\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 2. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (cut_tac n = n and f = \"\\<lambda>j. t j \\<cdot>\\<^sub>s f j\" and \n          g = \"\\<lambda>j. (if j \\<le> n then t j  else (\\<lambda>k\\<in>{0}. s (Suc n)) \n                (sliden (Suc n) j)) \\<cdot>\\<^sub>s f j\" in nsum_eq)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            t j \\<cdot>\\<^sub>s f j \\<in> carrier M\n 2. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n then t j\n                             else (\\<lambda>k\\<in>{0}. s (Suc n))\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 3. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            t j \\<cdot>\\<^sub>s f j =\n                            (if j \\<le> n then t j\n                             else (\\<lambda>k\\<in>{0}. s (Suc n))\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n 4. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then t j\n                                else (\\<lambda>k\\<in>{0}. s (Suc n))\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then t j\n           else (\\<lambda>k\\<in>{0}. s (Suc n))\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 5. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (rule allI, rule impI, rule sc_mem,\n          simp add:Pi_def Ring.ideal_subset,\n          simp add:Pi_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n then t j\n                             else (\\<lambda>k\\<in>{0}. s (Suc n))\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n                            \\<in> carrier M\n 2. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            t j \\<cdot>\\<^sub>s f j =\n                            (if j \\<le> n then t j\n                             else (\\<lambda>k\\<in>{0}. s (Suc n))\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n 3. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then t j\n                                else (\\<lambda>k\\<in>{0}. s (Suc n))\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then t j\n           else (\\<lambda>k\\<in>{0}. s (Suc n))\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 4. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (rule allI, rule impI, simp, rule sc_mem,\n          simp add:Pi_def Ring.ideal_subset,\n          simp add:Pi_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            t j \\<cdot>\\<^sub>s f j =\n                            (if j \\<le> n then t j\n                             else (\\<lambda>k\\<in>{0}. s (Suc n))\n                                   (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                            f j\n 2. \\<And>n s f x t.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        (\\<lambda>i.\n            if i \\<le> n then t i\n            else (\\<lambda>k\\<in>{0}. s (Suc n)) (sliden (Suc n) i))\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               (if j \\<le> n then t j\n                                else (\\<lambda>k\\<in>{0}. s (Suc n))\n(sliden (Suc n) j)) \\<cdot>\\<^sub>s\n                               f j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          (if j \\<le> n then t j\n           else (\\<lambda>k\\<in>{0}. s (Suc n))\n                 (sliden (Suc n) j)) \\<cdot>\\<^sub>s\n          f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)\n 3. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply (rule allI, rule impI, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f x.\n       \\<lbrakk>ideal R A; a \\<in> A; Ring R;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n\n        \\<in> carrier M;\n        s (Suc n) \\<in> A; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        a \\<cdot>\\<^sub>s f x \\<in> carrier M; m = f x; x \\<le> n;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<and>\n        (\\<exists>xa\\<le>n. f x = f xa) \\<longrightarrow>\n        (\\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n            a \\<cdot>\\<^sub>s f x =\n            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                   t j \\<cdot>\\<^sub>s f j) n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. f x = f xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) similar_term1:\"\\<lbrakk>ideal R A; a \\<in> A; s \\<in> {j. j\\<le>(n::nat)} \\<rightarrow> A;\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; m \\<in> f ` {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow> \n      \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n \\<plusminus> a \\<cdot>\\<^sub>s m =\n             \\<Sigma>\\<^sub>e M (\\<lambda>j.  t j \\<cdot>\\<^sub>s (f j)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A; s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     m \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         a \\<cdot>\\<^sub>s m =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s f j) n", "apply (simp add:similar_termTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) same_togetherTr:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M \\<rbrakk> \\<Longrightarrow> \n \\<forall>s. \\<forall>f. s\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> A  \\<and> f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow> \n (\\<exists>t \\<in> {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow> A. \n  \\<exists>g \\<in> {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow> f ` {j. j \\<le> n}. \n   surj_to g {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} (f ` {j. j \\<le> n}) \\<and> \n  nsum M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n = nsum M (\\<lambda>k. t k \\<cdot>\\<^sub>s (g k)) \n       (card (f ` {j. j \\<le> n}) - Suc 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         (\\<exists>t\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n   A.\n                             \\<exists>g\n\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n     f ` {j. j \\<le> n}.\n                                surj_to g\n                                 {j. j \\<le> card (f ` {j. j \\<le> n}) -\n       Suc 0}\n                                 (f ` {j. j \\<le> n}) \\<and>\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) n =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                 t k \\<cdot>\\<^sub>s\n                 g k) (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s f.\n                         s \\<in> {j. j \\<le> 0} \\<rightarrow> A \\<and>\n                         f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 H \\<longrightarrow>\n                         (\\<exists>t\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> 0}) - Suc 0} \\<rightarrow>\n   A.\n                             \\<exists>g\n\\<in>{j. j \\<le> card (f ` {j. j \\<le> 0}) - Suc 0} \\<rightarrow>\n     f ` {j. j \\<le> 0}.\n                                surj_to g\n                                 {j. j \\<le> card (f ` {j. j \\<le> 0}) -\n       Suc 0}\n                                 (f ` {j. j \\<le> 0}) \\<and>\n                                \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                 s j \\<cdot>\\<^sub>s f j) 0 =\n                                \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                 t k \\<cdot>\\<^sub>s\n                 g k) (card (f ` {j. j \\<le> 0}) - Suc 0))\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n Suc 0} \\<rightarrow>\n                           A.\n               \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n    Suc 0} \\<rightarrow>\n                              f ` {j. j \\<le> n}.\n                  surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                   (f ` {j. j \\<le> n}) \\<and>\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n   s j \\<cdot>\\<^sub>s f j) n =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n   t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow> A.\n                                \\<exists>g\n   \\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n        f ` {j. j \\<le> Suc n}.\n                                   surj_to g\n                                    {j. j\n  \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0}\n                                    (f ` {j. j \\<le> Suc n}) \\<and>\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                    s j \\<cdot>\\<^sub>s f j) Suc n =\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                    t k \\<cdot>\\<^sub>s\n                    g k) (card (f ` {j. j \\<le> Suc n}) - Suc 0))", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> 0} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j.\n   j \\<le> card (f ` {j. j \\<le> 0}) - Suc 0} \\<rightarrow>\n  A.\n                            \\<exists>g\\<in>{j.\n      j \\<le> card (f ` {j. j \\<le> 0}) - Suc 0} \\<rightarrow>\n     f ` {j. j \\<le> 0}.\n                               surj_to g\n                                {j. j \\<le> card (f ` {j. j \\<le> 0}) -\n      Suc 0}\n                                (f ` {j. j \\<le> 0}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) 0 =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> 0}) - Suc 0)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n Suc 0} \\<rightarrow>\n                           A.\n               \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n    Suc 0} \\<rightarrow>\n                              f ` {j. j \\<le> n}.\n                  surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                   (f ` {j. j \\<le> n}) \\<and>\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n   s j \\<cdot>\\<^sub>s f j) n =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n   t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow> A.\n                                \\<exists>g\n   \\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n        f ` {j. j \\<le> Suc n}.\n                                   surj_to g\n                                    {j. j\n  \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0}\n                                    (f ` {j. j \\<le> Suc n}) \\<and>\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                    s j \\<cdot>\\<^sub>s f j) Suc n =\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                    t k \\<cdot>\\<^sub>s\n                    g k) (card (f ` {j. j \\<le> Suc n}) - Suc 0))", "apply (simp del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {0} \\<rightarrow> A; f \\<in> {0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{0} \\<rightarrow> A.\n                            \\<exists>g\\<in>{0} \\<rightarrow> {f 0}.\n                               surj_to g {0} {f 0} \\<and>\n                               s 0 \\<cdot>\\<^sub>s f 0 =\n                               t 0 \\<cdot>\\<^sub>s g 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n Suc 0} \\<rightarrow>\n                           A.\n               \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n    Suc 0} \\<rightarrow>\n                              f ` {j. j \\<le> n}.\n                  surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                   (f ` {j. j \\<le> n}) \\<and>\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n   s j \\<cdot>\\<^sub>s f j) n =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n   t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow> A.\n                                \\<exists>g\n   \\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n        f ` {j. j \\<le> Suc n}.\n                                   surj_to g\n                                    {j. j\n  \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0}\n                                    (f ` {j. j \\<le> Suc n}) \\<and>\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                    s j \\<cdot>\\<^sub>s f j) Suc n =\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                    t k \\<cdot>\\<^sub>s\n                    g k) (card (f ` {j. j \\<le> Suc n}) - Suc 0))", "apply (frule_tac f = f and A = \"{0}\" and B= H in func_to_img,\n        frule_tac f = f and A = \"{0}\" and B= H in surj_to_image,\n        fastforce simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n Suc 0} \\<rightarrow>\n                           A.\n               \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n    Suc 0} \\<rightarrow>\n                              f ` {j. j \\<le> n}.\n                  surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                   (f ` {j. j \\<le> n}) \\<and>\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n   s j \\<cdot>\\<^sub>s f j) n =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n   t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s f.\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    A \\<and>\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<longrightarrow>\n                            (\\<exists>t\n\\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow> A.\n                                \\<exists>g\n   \\<in>{j. j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n        f ` {j. j \\<le> Suc n}.\n                                   surj_to g\n                                    {j. j\n  \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0}\n                                    (f ` {j. j \\<le> Suc n}) \\<and>\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                    s j \\<cdot>\\<^sub>s f j) Suc n =\n                                   \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                    t k \\<cdot>\\<^sub>s\n                    g k) (card (f ` {j. j \\<le> Suc n}) - Suc 0))", "apply ((rule allI)+, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n Suc 0} \\<rightarrow>\n                           A.\n               \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n    Suc 0} \\<rightarrow>\n                              f ` {j. j \\<le> n}.\n                  surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                   (f ` {j. j \\<le> n}) \\<and>\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n   s j \\<cdot>\\<^sub>s f j) n =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n   t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0));\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j.\n   j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n  A.\n                            \\<exists>g\\<in>{j.\n      j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n     f ` {j. j \\<le> Suc n}.\n                               surj_to g\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) Suc n =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (frule func_pre [of _ _ \"A\"], frule func_pre [of _ _ \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        \\<forall>s f.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> A \\<and>\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<longrightarrow>\n           (\\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n Suc 0} \\<rightarrow>\n                           A.\n               \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n    Suc 0} \\<rightarrow>\n                              f ` {j. j \\<le> n}.\n                  surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                   (f ` {j. j \\<le> n}) \\<and>\n                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n   s j \\<cdot>\\<^sub>s f j) n =\n                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n   t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0));\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j.\n   j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n  A.\n                            \\<exists>g\\<in>{j.\n      j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n     f ` {j. j \\<le> Suc n}.\n                               surj_to g\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                s j \\<cdot>\\<^sub>s f j) Suc n =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (drule_tac x = s in spec,\n        drule_tac x = f in spec,\n        simp, (erule bexE)+ , (erule conjE)+, simp,\n        thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k. t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (case_tac \"f (Suc n) \\<in> f ` {j. j \\<le> n}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (frule_tac a = \"s (Suc n)\" and s = t and \n        n = \"card (f ` {j. j \\<le> n}) - Suc 0\" and f = g and m = \"f (Suc n)\" in \n        similar_term1[of A],\n        simp add:Pi_def,\n        assumption,\n        frule_tac f = f and A = \"{j. j \\<le> n}\" and B = H in image_sub0,\n        frule_tac A = \"f ` {j. j \\<le> n}\" and B = H and C = \"carrier M\" \n         in subset_trans, assumption,\n        rule_tac f = g and A = \"{j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\" and \n                 B = \"f ` {j. j \\<le> n}\" and ?B1.0 = \"carrier M\" in extend_fun, \n        assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> g `\n                               {j. j \\<le> card (f ` {j. j \\<le> n}) -\n     Suc 0}\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<in> f ` {j. j \\<le> n};\n        \\<exists>ta\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n                                    Suc 0} \\<rightarrow>\n                        A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) (card (f ` {j. j \\<le> n}) -\n  Suc 0) \\<plusminus>\n           s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  ta j \\<cdot>\\<^sub>s\n                                  g j) (card (f ` {j. j \\<le> n}) -\n  Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)\n 3. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<in> f ` {j. j \\<le> n};\n        \\<exists>ta\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n                                    Suc 0} \\<rightarrow>\n                        A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s\n                                  g j) (card (f ` {j. j \\<le> n}) -\n  Suc 0) \\<plusminus>\n           s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  ta j \\<cdot>\\<^sub>s\n                                  g j) (card (f ` {j. j \\<le> n}) -\n  Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (erule bexE, simp,\n         thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. ta j \\<cdot>\\<^sub>s g j) (card (f ` {j. j \\<le> n}) - Suc 0)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g ta.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<in> f ` {j. j \\<le> n};\n        ta \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) -\n                             Suc 0} \\<rightarrow>\n                 A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j.\n   j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n  A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                g k) (card (f ` {k. k \\<le> n}) - Suc 0) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:Nset_img0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g ta.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<in> f ` {j. j \\<le> n};\n        ta \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) -\n                             Suc 0} \\<rightarrow>\n                 A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j.\n   j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n  A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                g k) (card (f ` {k. k \\<le> n}) - Suc 0) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (frule_tac f = t and n = \"card (f ` {j. j \\<le> n}) - Suc 0\" and A = A and\n        g = \"\\<lambda>k\\<in>{0::nat}. s (Suc n)\" and m = 0 and B = A in jointfun_hom0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. s (Suc n))\n                         \\<in> {k. k \\<le> 0} \\<rightarrow> A\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0 +\n                               0)} \\<rightarrow>\n              A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:Pi_def,\n               simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (frule_tac f = g and n = \"card (f ` {j. j \\<le> n}) - Suc 0\" and \n         A = \"f ` {j. j \\<le> n}\" and g = \"\\<lambda>k\\<in>{0::nat}. f (Suc n)\" and m = 0 and \n         B = \"{f (Suc n)}\" in jointfun_hom0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. f (Suc n))\n                         \\<in> {k. k \\<le> 0} \\<rightarrow> {f (Suc n)}\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0 +\n                               0)} \\<rightarrow>\n              f ` {j. j \\<le> n} \\<union> {f (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:Pi_def,\n               simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                t k \\<cdot>\\<^sub>s\n                g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                               s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (subgoal_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>k. t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. (jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0 (\\<lambda>k\\<in>{0}. \n            s (Suc n))) j \\<cdot>\\<^sub>s (jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0 \n        (\\<lambda>k\\<in>{0}. f (Suc n))) j) (card (f ` {j. j \\<le> (Suc n)}) - Suc 0)\", simp, \n        thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>k. t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                   (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n                  jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                   (\\<lambda>k\\<in>{0}. f (Suc n))\n                   j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> card (f ` {j. j \\<le> Suc n}) - Suc 0} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> card (f ` {j. j \\<le> Suc n}) -\n      Suc 0}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                 (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n                jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                 (\\<lambda>k\\<in>{0}. f (Suc n))\n                 j) (card (f ` {j. j \\<le> Suc n}) - Suc 0) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) (card (f ` {j. j \\<le> Suc n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp del:nsum_suc add:card_image_Nsetn_Suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> Suc\n       (card (f ` {j. j \\<le> n}) - Suc 0)}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                 (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n                jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                 (\\<lambda>k\\<in>{0}. f (Suc n))\n                 j) Suc (card (f ` {j. j \\<le> n}) - Suc 0) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) Suc (card (f ` {j. j \\<le> n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp del:nsum_suc add:image_Nset_Suc[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j.\n    j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow>\n   A.\n                            \\<exists>ga\\<in>{j.\n       j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow>\n      f ` {j. j \\<le> Suc n}.\n                               surj_to ga\n                                {j. j \\<le> Suc\n       (card (f ` {j. j \\<le> n}) - Suc 0)}\n                                (f ` {j. j \\<le> Suc n}) \\<and>\n                               \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                 (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n                jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                 (\\<lambda>k\\<in>{0}. f (Suc n))\n                 j) Suc (card (f ` {j. j \\<le> n}) - Suc 0) =\n                               \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                ta k \\<cdot>\\<^sub>s\n                ga k) Suc (card (f ` {j. j \\<le> n}) - Suc 0)\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (subgoal_tac \"surj_to (jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0 \n       (\\<lambda>k\\<in>{0}. f (Suc n))) {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0)} \n       (f ` {j. j \\<le> Suc n})\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> surj_to\n                          (jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                            (\\<lambda>k\\<in>{0}. f (Suc n)))\n                          {l. l \\<le> Suc\n (card (f ` {j. j \\<le> n}) - Suc 0)}\n                          (f ` {j. j \\<le> Suc n})\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} =\n        f ` {j. j \\<le> n};\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n)) `\n                         {l. l \\<le> Suc\n(card (f ` {j. j \\<le> n}) - Suc 0)} =\n                         f ` {j. j \\<le> Suc n}\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (frule_tac f = g and n = \"card (f ` {j. j \\<le> n}) - Suc 0\" and A = \"f ` {j. j \\<le> n}\" and g = \"\\<lambda>k\\<in>{0}. f (Suc n)\" and m = 0 and B = \"{f (Suc n)}\" in\n  im_jointfun)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} =\n        f ` {j. j \\<le> n};\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. f (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> {f (Suc n)}\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} =\n        f ` {j. j \\<le> n};\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n)) `\n        {j. j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0 + 0)} =\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<union>\n        (\\<lambda>k\\<in>{0}. f (Suc n)) ` {j. j \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n)) `\n                         {l. l \\<le> Suc\n(card (f ` {j. j \\<le> n}) - Suc 0)} =\n                         f ` {j. j \\<le> Suc n}\n 3. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} =\n        f ` {j. j \\<le> n};\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n)) `\n        {j. j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0 + 0)} =\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<union>\n        (\\<lambda>k\\<in>{0}. f (Suc n)) ` {j. j \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n)) `\n                         {l. l \\<le> Suc\n(card (f ` {j. j \\<le> n}) - Suc 0)} =\n                         f ` {j. j \\<le> Suc n}\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        g ` {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} =\n        f ` {j. j \\<le> n};\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n)) `\n        {j. j \\<le> Suc (card (f ` {j. j \\<le> n}) - Suc 0)} =\n        insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> insert (f (Suc n)) (f ` {j. j \\<le> n}) =\n                         f ` {j. j \\<le> Suc n}\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:image_Nset_Suc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> Suc n}) - Suc 0)", "apply (simp add:card_image_Nsetn_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              insert (f (Suc n)) (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (simp add:Nset_img)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and B = H in image_sub0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (frule_tac A = \"f ` {j. j \\<le> Suc n}\" and B = H and C = \"carrier M\" in\n          subset_trans, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (cut_tac H = H and s = t and n = \"card (f ` {j. j \\<le> n}) - Suc 0\" \n         and f = g and t = \"\\<lambda>k\\<in>{0}. s (Suc n)\" and m = 0 and \n         g = \"\\<lambda>k\\<in>{0}. f (Suc n)\" in \n         l_comb_jointfun_jj[of _ A], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) -\n       Suc 0} \\<rightarrow>\n                                 H\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. s (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> A\n 3. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. f (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 4. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n                                j \\<cdot>\\<^sub>s\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n                                j) (card (f ` {j. j \\<le> n}) - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               t j \\<cdot>\\<^sub>s\n                               g j) (card (f ` {j. j \\<le> n}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" and B = H in image_sub0)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M;\n        f ` {j. j \\<le> n} \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) -\n       Suc 0} \\<rightarrow>\n                                 H\n 2. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. s (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> A\n 3. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. f (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 4. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n                                j \\<cdot>\\<^sub>s\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n                                j) (card (f ` {j. j \\<le> n}) - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               t j \\<cdot>\\<^sub>s\n                               g j) (card (f ` {j. j \\<le> n}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (rule_tac f = g and A = \"{j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\" and\n          B = \"f ` {j. j \\<le> n}\" in extend_fun[of _ _ _ H], assumption+,\n          simp add:Pi_def, simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n                                j \\<cdot>\\<^sub>s\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n                                j) (card (f ` {j. j \\<le> n}) - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               t j \\<cdot>\\<^sub>s\n                               g j) (card (f ` {j. j \\<le> n}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n           (\\<lambda>k\\<in>{0}. s (Suc n)) j \\<cdot>\\<^sub>s\n          jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n           (\\<lambda>k\\<in>{0}. f (Suc n))\n           j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s f t g.\n       \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        f (Suc n) \\<notin> f ` {j. j \\<le> n};\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n         (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              A;\n        jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n         (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc (card (f ` {j. j \\<le> n}) -\n                               Suc 0)} \\<rightarrow>\n              f ` {j. j \\<le> Suc n};\n        f ` {j. j \\<le> Suc n} \\<subseteq> H;\n        f ` {j. j \\<le> Suc n} \\<subseteq> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n                                j \\<cdot>\\<^sub>s\n                               jointfun (card (f ` {j. j \\<le> n}) - Suc 0)\n                                g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n                                j) (card (f ` {j. j \\<le> n}) - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               t j \\<cdot>\\<^sub>s\n                               g j) (card (f ` {j. j \\<le> n}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n          t k \\<cdot>\\<^sub>s\n          g k) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s\n          g j) (card (f ` {j. j \\<le> n}) - Suc 0) \\<plusminus>\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) t 0\n                          (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) -\n                                Suc 0)) \\<cdot>\\<^sub>s\n                         jointfun (card (f ` {j. j \\<le> n}) - Suc 0) g 0\n                          (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc (card (f ` {j. j \\<le> n}) - Suc 0))", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* H shall a generator *)"], ["", "lemma (in Module) same_together:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n       s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A; f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk> \\<Longrightarrow> \n \\<exists>t \\<in> {j. j \\<le> (card (f ` {j. j \\<le> (n::nat)}) - Suc 0)} \\<rightarrow> A. \n \\<exists>g \\<in> {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \\<rightarrow> f ` {j. j \\<le> n}. \n       surj_to g {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} (f ` {j. j \\<le> n}) \\<and> \n  \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n = \n                  \\<Sigma>\\<^sub>e M (\\<lambda>k. t k \\<cdot>\\<^sub>s (g k)) (card (f ` {j. j \\<le> n}) - Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j.\nj \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                                     A.\n                         \\<exists>g\\<in>{j.\n   j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n  f ` {j. j \\<le> n}.\n                            surj_to g\n                             {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                             (f ` {j. j \\<le> n}) \\<and>\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n}) - Suc 0)", "apply (simp add:same_togetherTr[of A H])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) one_last:\"\\<lbrakk>ideal R A; H \\<subseteq> carrier M; \n      s \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> A; f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> H; \n      bij_to f {j. j \\<le> (Suc n)} H; j \\<le> (Suc n); j \\<noteq> (Suc n)\\<rbrakk> \\<Longrightarrow> \n \\<exists>t \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> A. \\<exists>g \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> H.  \n  \\<Sigma>\\<^sub>e M (\\<lambda>k. s k  \\<cdot>\\<^sub>s (f k)) (Suc n) =  \\<Sigma>\\<^sub>e M (\\<lambda>k. t k  \\<cdot>\\<^sub>s (g k)) (Suc n) \\<and>\n  g (Suc n) = f j \\<and> t (Suc n) = s j \\<and> bij_to g {j. j \\<le> (Suc n)} H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             s k \\<cdot>\\<^sub>s f k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             s k \\<cdot>\\<^sub>s f k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H", "apply (subgoal_tac \"(\\<lambda>k. s k \\<cdot>\\<^sub>s (f k)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             s k \\<cdot>\\<^sub>s f k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M", "apply (frule transpos_hom[of j \"Suc n\" \"Suc n\"], simp, assumption,\n       frule transpos_inj[of j \"Suc n\" \"Suc n\"], simp, assumption,\n       frule_tac f1 = \"\\<lambda>k.  s k \\<cdot>\\<^sub>s (f k)\" and n1 = n and h1 = \n         \"transpos j (Suc n)\" in addition2 [THEN sym], assumption+,\n       simp del:nsum_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                         (transpos j (Suc n)) Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M cmp\n          (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n)) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                         (transpos j (Suc n)) Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M cmp\n          (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n)) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H", "apply (rule Pi_I, rule sc_mem,\n           simp add:Pi_def Ring.ideal_subset,\n           simp add:Pi_def subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                         (transpos j (Suc n)) Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M cmp\n          (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n)) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H", "apply (frule cmp_fun[of \"transpos j (Suc n)\" \"{j. j \\<le> Suc n}\" \n                         \"{j. j \\<le> Suc n}\" s A], assumption+,\n        frule cmp_fun[of \"transpos j (Suc n)\" \"{j. j \\<le> Suc n}\" \n                         \"{j. j \\<le> Suc n}\" f H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M cmp (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n                         (transpos j (Suc n)) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M cmp\n          (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) (transpos j (Suc n)) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H", "apply (simp del:nsum_suc add:l_comb_transpos[of A H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n             cmp f (transpos j (Suc n)) k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H", "apply (subgoal_tac \"bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> (Suc n)} H\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n             cmp f (transpos j (Suc n)) k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n}\n                       H", "apply (subgoal_tac \"(cmp f (transpos j (Suc n))) (Suc n) = f j\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H;\n     cmp f (transpos j (Suc n)) (Suc n) = f j\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n             cmp f (transpos j (Suc n)) k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos j (Suc n)) (Suc n) = f j\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n}\n                       H", "apply (subgoal_tac \"(cmp s (transpos j (Suc n))) (Suc n) = s j\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H;\n     cmp f (transpos j (Suc n)) (Suc n) = f j;\n     cmp s (transpos j (Suc n)) (Suc n) = s j\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<exists>g\\<in>{j. j \\<le> Suc n} \\<rightarrow> H.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n             cmp f (transpos j (Suc n)) k) Suc n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             t k \\<cdot>\\<^sub>s g k) Suc n \\<and>\n                            g (Suc n) = f j \\<and>\n                            t (Suc n) = s j \\<and>\n                            bij_to g {j. j \\<le> Suc n} H\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H;\n     cmp f (transpos j (Suc n)) (Suc n) = f j\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos j (Suc n)) (Suc n) = s j\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos j (Suc n)) (Suc n) = f j\n 4. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n}\n                       H", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H;\n     cmp f (transpos j (Suc n)) (Suc n) = f j\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos j (Suc n)) (Suc n) = s j\n 2. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n} H\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos j (Suc n)) (Suc n) = f j\n 3. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n}\n                       H", "apply (simp add:cmp_def, simp add:transpos_ij_2,\n        simp add:cmp_def, simp add:transpos_ij_2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     bij_to f {j. j \\<le> Suc n} H; j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) Suc n =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) Suc n;\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> bij_to (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n}\n                       H", "apply (simp add:bij_to_def, rule conjI,\n        rule cmp_surj[of \"transpos j (Suc n)\" \"{j. j \\<le> Suc n}\" \n          \"{j. j \\<le> Suc n}\" f H], assumption+,\n        simp add:transpos_surjec, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; H \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     surj_to f {j. j \\<le> Suc n} H \\<and> inj_on f {j. j \\<le> Suc n};\n     j \\<le> Suc n; j \\<noteq> Suc n; Ring R;\n     (\\<lambda>k. s k \\<cdot>\\<^sub>s f k)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     transpos j (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos j (Suc n)) {i. i \\<le> Suc n};\n     \\<Sigma>\\<^sub>e M (\\<lambda>k. s k \\<cdot>\\<^sub>s f k) n \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n     \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                            cmp s (transpos j (Suc n)) k \\<cdot>\\<^sub>s\n                            cmp f (transpos j (Suc n)) k) n \\<plusminus>\n     cmp s (transpos j (Suc n)) (Suc n) \\<cdot>\\<^sub>s\n     cmp f (transpos j (Suc n)) (Suc n);\n     cmp s (transpos j (Suc n)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n     cmp f (transpos j (Suc n))\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> inj_on (cmp f (transpos j (Suc n))) {j. j \\<le> Suc n}", "apply (rule cmp_inj[of \"transpos j (Suc n)\" \"{j. j \\<le> Suc n}\" \n          \"{j. j \\<le> Suc n}\" f H], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finite_lin_spanTr1:\"\\<lbrakk>ideal R A; z \\<in> carrier M\\<rbrakk> \\<Longrightarrow>\n      h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {z} \\<and> t \\<in> {j. j \\<le> n} \\<rightarrow> A  \\<longrightarrow> \n      (\\<exists>s\\<in>{0::nat} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s (h j)) n =  s 0 \\<cdot>\\<^sub>s z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; z \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n                      t \\<in> {j. j \\<le> n} \\<rightarrow>\n                              A \\<longrightarrow>\n                      (\\<exists>s\\<in>{0} \\<rightarrow> A.\n                          \\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s h j) n =\n                          s 0 \\<cdot>\\<^sub>s z)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; z \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> 0} \\<rightarrow> {z} \\<and>\n                      t \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              A \\<longrightarrow>\n                      (\\<exists>s\\<in>{0} \\<rightarrow> A.\n                          \\<Sigma>\\<^sub>e M (\\<lambda>j.\n           t j \\<cdot>\\<^sub>s h j) 0 =\n                          s 0 \\<cdot>\\<^sub>s z)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z} \\<and>\n                         t \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 A \\<longrightarrow>\n                         (\\<exists>s\\<in>{0} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s h j) Suc n =\n                             s 0 \\<cdot>\\<^sub>s z)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; z \\<in> carrier M;\n     h \\<in> {j. j \\<le> 0} \\<rightarrow> {z} \\<and>\n     t \\<in> {j. j \\<le> 0} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{0} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) 0 =\n                         s 0 \\<cdot>\\<^sub>s z\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z} \\<and>\n                         t \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 A \\<longrightarrow>\n                         (\\<exists>s\\<in>{0} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s h j) Suc n =\n                             s 0 \\<cdot>\\<^sub>s z)", "apply ((erule conjE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; z \\<in> carrier M; h 0 = z; t 0 \\<in> A\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{0} \\<rightarrow> A.\n                         t 0 \\<cdot>\\<^sub>s z = s 0 \\<cdot>\\<^sub>s z\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z} \\<and>\n                         t \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 A \\<longrightarrow>\n                         (\\<exists>s\\<in>{0} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s h j) Suc n =\n                             s 0 \\<cdot>\\<^sub>s z)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z} \\<and>\n                         t \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 A \\<longrightarrow>\n                         (\\<exists>s\\<in>{0} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s h j) Suc n =\n                             s 0 \\<cdot>\\<^sub>s z)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s\\<in>{0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n =\n                            s 0 \\<cdot>\\<^sub>s z", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s\\<in>{0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n =\n                            s 0 \\<cdot>\\<^sub>s z", "apply (frule func_pre [of _ _ \"{z}\"], frule func_pre [of _ _ \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z} \\<and>\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A \\<longrightarrow>\n        (\\<exists>s\\<in>{0} \\<rightarrow> A.\n            \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n            s 0 \\<cdot>\\<^sub>s z);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s\\<in>{0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n =\n                            s 0 \\<cdot>\\<^sub>s z", "apply (simp del:nsum_suc, erule bexE, simp,\n       frule_tac f = h and A = \"{j. j \\<le> Suc n}\" and B = \"{z}\" and x = \"Suc n\"\n       in funcset_mem, simp, simp,\n       frule_tac f = t and A = \"{j. j \\<le> Suc n}\" and B = A and x = \"Suc n\" in\n        funcset_mem, simp, cut_tac sc_Ring,\n       frule_tac h = \"s 0\" in Ring.ideal_subset[of R A], assumption+,\n       frule_tac h = \"t (Suc n)\" in Ring.ideal_subset[of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>sa\\<in>{0} \\<rightarrow> A.\n                            s 0 \\<cdot>\\<^sub>s z \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s z =\n                            sa 0 \\<cdot>\\<^sub>s z", "apply (simp add:sc_l_distr[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>sa\\<in>{0} \\<rightarrow> A.\n                            (s 0 \\<plusminus>\\<^bsub>R\\<^esub>\n                             t (Suc n)) \\<cdot>\\<^sub>s\n                            z =\n                            sa 0 \\<cdot>\\<^sub>s z", "apply (subgoal_tac \"(\\<lambda>l\\<in>{0::nat}. (s 0 \\<plusminus>\\<^bsub>R\\<^esub> (t (Suc n)))) \\<in> {0} \\<rightarrow> A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R;\n        (\\<lambda>l\\<in>{0}. s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n        \\<in> {0} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>sa\\<in>{0} \\<rightarrow> A.\n                            (s 0 \\<plusminus>\\<^bsub>R\\<^esub>\n                             t (Suc n)) \\<cdot>\\<^sub>s\n                            z =\n                            sa 0 \\<cdot>\\<^sub>s z\n 2. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                         \\<in> {0} \\<rightarrow> A", "apply (subgoal_tac \"(s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s z = (\\<lambda>l\\<in>{0::nat}. (s 0 \\<plusminus>\\<^bsub>R\\<^esub> (t (Suc n)))) 0 \\<cdot>\\<^sub>s z \")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R;\n        (\\<lambda>l\\<in>{0}. s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n        \\<in> {0} \\<rightarrow> A;\n        (s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s z =\n        (\\<lambda>l\\<in>{0}. s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n         0 \\<cdot>\\<^sub>s\n        z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>sa\\<in>{0} \\<rightarrow> A.\n                            (s 0 \\<plusminus>\\<^bsub>R\\<^esub>\n                             t (Suc n)) \\<cdot>\\<^sub>s\n                            z =\n                            sa 0 \\<cdot>\\<^sub>s z\n 2. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R;\n        (\\<lambda>l\\<in>{0}. s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n        \\<in> {0} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> (s 0 \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         z =\n                         (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                          0 \\<cdot>\\<^sub>s\n                         z\n 3. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                         \\<in> {0} \\<rightarrow> A", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R;\n        (\\<lambda>l\\<in>{0}. s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n        \\<in> {0} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> (s 0 \\<plusminus>\\<^bsub>R\\<^esub>\n                          t (Suc n)) \\<cdot>\\<^sub>s\n                         z =\n                         (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                          0 \\<cdot>\\<^sub>s\n                         z\n 2. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                         \\<in> {0} \\<rightarrow> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                         \\<in> {0} \\<rightarrow> A", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s x.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R; x \\<in> {0}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>l\\<in>{0}.\n                             s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n))\n                          x\n                         \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n s x.\n       \\<lbrakk>ideal R A; z \\<in> carrier M;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A; s 0 \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        s 0 \\<cdot>\\<^sub>s z;\n        h (Suc n) = z; t (Suc n) \\<in> A; Ring R; s 0 \\<in> carrier R;\n        t (Suc n) \\<in> carrier R; x = 0\\<rbrakk>\n       \\<Longrightarrow> s 0 \\<plusminus>\\<^bsub>R\\<^esub> t (Suc n) \\<in> A", "apply (rule Ring.ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) single_span:\"\\<lbrakk>ideal R A; z \\<in> carrier M;\n    h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {z}; t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk> \\<Longrightarrow> \n     \\<exists>s\\<in>{0::nat} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s (h j)) n =  s 0 \\<cdot>\\<^sub>s z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; z \\<in> carrier M;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {z};\n     t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{0} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n =\n                         s 0 \\<cdot>\\<^sub>s z", "apply (simp add:finite_lin_spanTr1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*\nlemma (in Module) finite_lin_spanTr2:\"\\<lbrakk>ideal R A; \\<forall>m. \n(\\<exists>n1. \\<exists>f\\<in>{j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> n}. \\<exists>s\\<in>{j. j \\<le> n1} \\<rightarrow> A. \n  m = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n1) \\<longrightarrow> \n     (\\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A. m = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (h j)) n); \n  h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier M; f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> n}; \n  s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n1\\<rbrakk> \\<Longrightarrow> \n  \\<exists>sa\\<in>{j. j \\<le> (Suc n)} \\<rightarrow> A. \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) n1 = \n    \\<Sigma>\\<^sub>e M (\\<lambda>j. sa j \\<cdot>\\<^sub>s (h j)) n \\<plusminus> (sa (Suc n) \\<cdot>\\<^sub>s (h (Suc n)))\"\n apply (frule_tac \n apply (subgoal_tac \"\\<exists>l\\<in>{j. j \\<le> n} \\<rightarrow> A. m = \\<Sigma>\\<^sub>e M (\\<lambda>j. l j \\<cdot>\\<^sub>s (h j)) n\")\n prefer 2 \n apply (thin_tac \"h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier M\")\n apply blast\n apply (thin_tac \" \\<forall>m. (\\<exists>n1. \\<exists>f\\<in>Nset n1 \\<rightarrow> h ` Nset n.\n  \\<exists>s\\<in>Nset n1 \\<rightarrow> A. m = e\\<Sigma> M (\\<lambda>j. s j \\<star>\\<^sub>M (f j)) n1) \\<longrightarrow>\n              (\\<exists>s\\<in>Nset n \\<rightarrow> A. m = e\\<Sigma> M (\\<lambda>j.  s j \\<star>\\<^sub>M (h j)) n)\")\n apply (subgoal_tac \"\\<forall>l\\<in>Nset n \\<rightarrow> A. m = e\\<Sigma> M (\\<lambda>j. l j \\<star>\\<^sub>M (h j)) n \\<longrightarrow> (\\<exists>sa\\<in>Nset (Suc n) \\<rightarrow> A. e\\<Sigma> M (\\<lambda>j. s j \\<star>\\<^sub>M (f j)) n1 = e\\<Sigma> M (\\<lambda>j. sa j \\<star>\\<^sub>M (h j)) n +\\<^sub>M  (sa (Suc n) \\<star>\\<^sub>M (h (Suc n))))\")\n apply blast\n apply (thin_tac \"\\<exists>l\\<in>Nset n \\<rightarrow> A. m = e\\<Sigma> M (\\<lambda>j. l j \\<star>\\<^sub>M (h j)) n\")\n apply (rule ballI) apply (rule impI)\n apply (frule sym) apply (thin_tac \"m = e\\<Sigma> M (\\<lambda>j. s j \\<star>\\<^sub>M (f j)) n1\")\n apply simp\n apply (thin_tac \"m = e\\<Sigma> M (\\<lambda>j. l j \\<star>\\<^sub>M (h j)) n\")\n apply (thin_tac \"e\\<Sigma> M (\\<lambda>j. s j \\<star>\\<^sub>M (f j)) n1 = e\\<Sigma> M (\\<lambda>j. l j \\<star>\\<^sub>M (h j)) n\")\n apply (subgoal_tac \"jointfun n l 0 (\\<lambda>x\\<in>Nset 0. (0\\<^sub>R)) \\<in> Nset (Suc n) \\<rightarrow> A\")\n apply (subgoal_tac \" e\\<Sigma> M (\\<lambda>j. l j \\<star>\\<^sub>M (h j)) n =\n  e\\<Sigma> M (\\<lambda>j. (jointfun n l 0 (\\<lambda>x\\<in>Nset 0. (0\\<^sub>R))) j \\<star>\\<^sub>M (h j)) n +\\<^sub>M  ((jointfun n l 0 (\\<lambda>x\\<in>Nset 0. (0\\<^sub>R))) (Suc n)) \\<star>\\<^sub>M (h (Suc n))\")\n apply blast\n apply (subgoal_tac \"jointfun n l 0 (\\<lambda>x\\<in>Nset 0. 0\\<^sub>R) (Suc n) \\<star>\\<^sub>M (h (Suc n)) =\n  0\\<^sub>M\") apply simp\n apply (subgoal_tac \"e\\<Sigma> M (\\<lambda>j. jointfun n l 0 (\\<lambda>x\\<in>Nset 0. 0\\<^sub>R) j \\<star>\\<^sub>M (h j)) n =\n e\\<Sigma> M (\\<lambda>j. l j \\<star>\\<^sub>M (h j)) n \") apply simp\n apply (frule module_is_ag [of \"R\" \"M\"], assumption+)\n apply (subst ag_r_zero, assumption+)\n apply (subgoal_tac \"(\\<lambda>j. l j \\<star>\\<^sub>M (h j)) \\<in> Nset n \\<rightarrow> carrier M\")\n apply (rule eSum_mem, assumption+) apply (simp add:n_in_Nsetn)\n apply (rule univar_func_test) apply (rule ballI) \n apply (rule sprod_mem, assumption+)\n apply (simp add:funcset_mem ideal_subset)\n apply (frule func_pre [of \"h\" _ \"carrier M\"])\n apply (simp add:funcset_mem) apply simp\n apply (rule eSum_eq)\n apply (rule module_is_ag [of \"R\" \"M\"], assumption+)\n apply (rule univar_func_test)\n apply (rule ballI)\n apply (frule_tac x = x and n = n in Nset_le)\n apply (insert Nset_nonempty[of \"0\"]) \n apply (simp add:jointfun_def)\n apply (rule sprod_mem, assumption+)\n apply (simp add:funcset_mem ideal_subset)\n apply (frule func_pre [of \"h\" _ \"carrier M\"]) \n apply (simp add:funcset_mem)\n apply (rule univar_func_test) apply (rule ballI)\n apply (rule sprod_mem, assumption+)\n apply (simp add:funcset_mem ideal_subset)\n apply (frule func_pre [of \"h\" _ \"carrier M\"])\n apply (simp add:funcset_mem)\napply (rule ballI)\n apply (frule_tac x = la and n = n in Nset_le)\n apply (simp add:jointfun_def)\n apply (subgoal_tac \"0 \\<in> Nset 0\")\n apply (simp add:jointfun_def sliden_def slide_def)\n apply (rule sprod_0_m, assumption+) \n apply (subgoal_tac \"Suc n \\<in> Nset (Suc n)\")\n apply (simp add:funcset_mem) apply (simp add:n_in_Nsetn)+ \napply (frule_tac f = l and n = n and A = A and g = \"\\<lambda>x\\<in>Nset 0. 0\\<^sub>R\" and m = 0\n      and B = A in jointfun_hom0)\n apply (rule univar_func_test) apply (rule ballI) apply (simp add:Nset_def)\n apply (simp add:ideal_zero) apply simp\ndone *)"], ["", "definition\n  coeff_at_k :: \"[('r, 'm) Ring_scheme, 'r, nat] \\<Rightarrow> (nat \\<Rightarrow> 'r)\" where\n  \"coeff_at_k R a k = (\\<lambda>j. if j = k then a else (\\<zero>\\<^bsub>R\\<^esub>))\""], ["", "lemma card_Nset_im:\"f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> A \\<Longrightarrow> \n                      (Suc 0) \\<le> card (f `{j. j \\<le> n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> {j. j \\<le> n} \\<rightarrow> A \\<Longrightarrow>\n    Suc 0 \\<le> card (f ` {j. j \\<le> n})", "apply (cut_tac image_Nsetn_card_pos[of f n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> A;\n     0 < card (f ` {i. i \\<le> n})\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> card (f ` {j. j \\<le> n})", "apply (frule_tac m = 0 and n = \"card (f ` {i. i \\<le> n})\" in Suc_leI,\n        assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) eSum_changeTr1:\"\\<lbrakk>ideal R A; \n  t \\<in> {k. k \\<le> (card (f ` {j. j \\<le> (n1::nat)}) - Suc 0)} \\<rightarrow> A; \n  g \\<in> {k. k \\<le> (card (f ` {j. j \\<le> n1}) - Suc 0)} \\<rightarrow> f `{j. j \\<le> n1}; \n  Suc 0 < card (f `{j. j \\<le> n1}); g x = h (Suc n); x = Suc n; \ncard (f `{j. j \\<le> n1}) - Suc 0 =  Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0)\\<rbrakk>\n  \\<Longrightarrow> \n \\<Sigma>\\<^sub>e M (\\<lambda>k. t k  \\<cdot>\\<^sub>s (g k)) (card (f ` {j. j \\<le> n1}) - Suc 0) =  \n \\<Sigma>\\<^sub>e M (\\<lambda>k. t k  \\<cdot>\\<^sub>s (g k)) (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0) \\<plusminus>  \n    (t (Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0))  \\<cdot>\\<^sub>s \n                (g ( Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A;\n     t \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0} \\<rightarrow>\n             A;\n     g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0} \\<rightarrow>\n             f ` {j. j \\<le> n1};\n     Suc 0 < card (f ` {j. j \\<le> n1}); g x = h (Suc n); x = Suc n;\n     card (f ` {j. j \\<le> n1}) - Suc 0 =\n     Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n1}) - Suc 0) =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>k.\n       t k \\<cdot>\\<^sub>s\n       g k) (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0) \\<plusminus>\n                      t (Suc (card (f ` {j. j \\<le> n1}) - Suc 0 -\n                              Suc 0)) \\<cdot>\\<^sub>s\n                      g (Suc (card (f ` {j. j \\<le> n1}) - Suc 0 - Suc 0))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  zeroi :: \"[('r, 'm) Ring_scheme] \\<Rightarrow> nat \\<Rightarrow> 'r\" where\n  \"zeroi R = (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\""], ["", "lemma zeroi_func:\"\\<lbrakk>Ring R; ideal R A\\<rbrakk> \\<Longrightarrow>  zeroi R \\<in> {j. j \\<le> 0} \\<rightarrow> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R A\\<rbrakk>\n    \\<Longrightarrow> zeroi R \\<in> {j. j \\<le> 0} \\<rightarrow> A", "by (simp add:zeroi_def Ring.ideal_zero)"], ["", "lemma (in Module) prep_arrTr1:\"\\<lbrakk>ideal R A; h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier M;\n f \\<in> {j. j \\<le> (n1::nat)} \\<rightarrow> h ` {j. j \\<le> (Suc n)}; s \\<in> {j. j \\<le> n1}\\<rightarrow> A; \n m = l_comb R M n1 s f\\<rbrakk> \\<Longrightarrow> \n \\<exists>l\\<in>{j. j \\<le> (Suc n)}. (\\<exists>s\\<in>{j. j \\<le> (l::nat)} \\<rightarrow> A. \n \\<exists>g\\<in> {j. j \\<le> l} \\<rightarrow> h `{j. j \\<le> (Suc n)}. m = l_comb R M l s g \\<and> \n                      bij_to g {j. j \\<le> l} (f ` {j. j \\<le> n1}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<in>{j. j \\<le> Suc n}.\n                         \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                            \\<exists>g\\<in>{j. j \\<le> l} \\<rightarrow>\n     h ` {j. j \\<le> Suc n}.\n                               m = l_comb R M l s g \\<and>\n                               bij_to g {j. j \\<le> l} (f ` {j. j \\<le> n1})", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<in>{j. j \\<le> Suc n}.\n                         \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                            \\<exists>g\\<in>{j. j \\<le> l} \\<rightarrow>\n     h ` {j. j \\<le> Suc n}.\n                               m = l_comb R M l s g \\<and>\n                               bij_to g {j. j \\<le> l} (f ` {j. j \\<le> n1})", "apply (frule_tac s = s and n = n1 and f = f in  same_together[of A \n      \"h ` {j. j \\<le> (Suc n)}\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> h ` {j. j \\<le> Suc n} \\<subseteq> carrier M\n 2. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> n1} \\<rightarrow> A\n 3. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n1} \\<rightarrow>\n                              h ` {j. j \\<le> Suc n}\n 4. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                                Suc 0} \\<rightarrow>\n                    A.\n        \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                                   Suc 0} \\<rightarrow>\n                       f ` {j. j \\<le> n1}.\n           surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n            (f ` {j. j \\<le> n1}) \\<and>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n1 =\n           \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                                  t k \\<cdot>\\<^sub>s\n                                  g k) (card (f ` {j. j \\<le> n1}) -\n  Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<in>{j. j \\<le> Suc n}.\n                         \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                            \\<exists>g\\<in>{j. j \\<le> l} \\<rightarrow>\n     h ` {j. j \\<le> Suc n}.\n                               m = l_comb R M l s g \\<and>\n                               bij_to g {j. j \\<le> l} (f ` {j. j \\<le> n1})", "apply (simp add:image_sub0, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                                Suc 0} \\<rightarrow>\n                    A.\n        \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                                   Suc 0} \\<rightarrow>\n                       f ` {j. j \\<le> n1}.\n           surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n            (f ` {j. j \\<le> n1}) \\<and>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n1 =\n           \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                                  t k \\<cdot>\\<^sub>s\n                                  g k) (card (f ` {j. j \\<le> n1}) -\n  Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<in>{j. j \\<le> Suc n}.\n                         \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                            \\<exists>g\\<in>{j. j \\<le> l} \\<rightarrow>\n     h ` {j. j \\<le> Suc n}.\n                               m = l_comb R M l s g \\<and>\n                               bij_to g {j. j \\<le> l} (f ` {j. j \\<le> n1})", "apply (erule bexE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A; m = l_comb R M n1 s f;\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1}) \\<and>\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n1 =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<in>{j. j \\<le> Suc n}.\n                            \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                               \\<exists>g\n  \\<in>{j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                  m = l_comb R M l s g \\<and>\n                                  bij_to g {j. j \\<le> l}\n                                   (f ` {j. j \\<le> n1})", "apply (simp add:l_comb_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n1 =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>Suc n.\n                            \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                               \\<exists>ga\n  \\<in>{j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                   t k \\<cdot>\\<^sub>s\n                   g k) (card (f ` {j. j \\<le> n1}) - Suc 0) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s ga j) l \\<and>\n                                  bij_to ga {j. j \\<le> l}\n                                   (f ` {j. j \\<le> n1})", "apply (thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n1 =\n           \\<Sigma>\\<^sub>e M (\\<lambda>k. t k \\<cdot>\\<^sub>s g k) (card (f ` {j. j \\<le> n1}) - Suc 0)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>Suc n.\n                            \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                               \\<exists>ga\n  \\<in>{j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                   t k \\<cdot>\\<^sub>s\n                   g k) (card (f ` {j. j \\<le> n1}) - Suc 0) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s ga j) l \\<and>\n                                  bij_to ga {j. j \\<le> l}\n                                   (f ` {j. j \\<le> n1})", "apply (subgoal_tac \"(card (f ` {j. j \\<le> n1}) - Suc 0) \\<in> {j. j \\<le> Suc n}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>Suc n.\n                            \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                               \\<exists>ga\n  \\<in>{j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                   t k \\<cdot>\\<^sub>s\n                   g k) (card (f ` {j. j \\<le> n1}) - Suc 0) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s ga j) l \\<and>\n                                  bij_to ga {j. j \\<le> l}\n                                   (f ` {j. j \\<le> n1})\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (subgoal_tac \"g \\<in> {k. k \\<le> (card (f `{j. j \\<le> n1}) - Suc 0)} \\<rightarrow>\n                         h ` {j. j \\<le> Suc n}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>Suc n.\n                            \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                               \\<exists>ga\n  \\<in>{j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                   t k \\<cdot>\\<^sub>s\n                   g k) (card (f ` {j. j \\<le> n1}) - Suc 0) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s ga j) l \\<and>\n                                  bij_to ga {j. j \\<le> l}\n                                   (f ` {j. j \\<le> n1})\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n       Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (subgoal_tac \"bij_to g {k. k \\<le> (card (f ` {j. j \\<le> n1}) - Suc 0)} (f ` {j. j \\<le> n1})\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n};\n        bij_to g {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>Suc n.\n                            \\<exists>s\\<in>{j. j \\<le> l} \\<rightarrow> A.\n                               \\<exists>ga\n  \\<in>{j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                   t k \\<cdot>\\<^sub>s\n                   g k) (card (f ` {j. j \\<le> n1}) - Suc 0) =\n                                  \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                   s j \\<cdot>\\<^sub>s ga j) l \\<and>\n                                  bij_to ga {j. j \\<le> l}\n                                   (f ` {j. j \\<le> n1})\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n       Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 4. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n       Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "prefer 2"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n       Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (frule_tac f = f and A = \"{j. j \\<le> n1}\" and B = \"h ` {j. j \\<le> Suc n}\" \n          in image_sub0, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        f ` {j. j \\<le> n1} \\<subseteq> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n       Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (rule extend_fun, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<in> {j. j \\<le> Suc n};\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (simp add:bij_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> inj_on g\n                          {k. k \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (rule_tac A = \"f ` {j. j \\<le> n1}\" and n = \"card (f `{j. j \\<le> n1}) - Suc 0\" and f = g in Nset2finite_inj)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> finite (f ` {j. j \\<le> n1})\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) =\n                         Suc (card (f ` {j. j \\<le> n1}) - Suc 0)\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> surj_to g\n                          {i. i \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 4. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (rule finite_imageI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) =\n                         Suc (card (f ` {j. j \\<le> n1}) - Suc 0)\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> surj_to g\n                          {i. i \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (frule_tac f = f and n = n1 and A = \"h ` {j. j \\<le> (Suc n)}\" in card_Nset_im)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n};\n        Suc 0 \\<le> card (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) =\n                         Suc (card (f ` {j. j \\<le> n1}) - Suc 0)\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n;\n        g \\<in> {k. k \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> surj_to g\n                          {i. i \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n                          (f ` {j. j \\<le> n1})\n 3. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}", "apply (subgoal_tac \"finite (h ` {j. j \\<le> (Suc n)})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        finite (h ` {j. j \\<le> Suc n})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0\n                         \\<in> {j. j \\<le> Suc n}\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> finite (h ` {j. j \\<le> Suc n})", "apply (frule_tac f = f and A = \"{j. j \\<le> n1}\" and B = \"h ` {j. j \\<le> (Suc n)}\" \n       in image_sub0, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        f ` {j. j \\<le> n1} \\<subseteq> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1})\\<rbrakk>\n       \\<Longrightarrow> finite (h ` {j. j \\<le> Suc n})", "apply (cut_tac B = \"h ` {j. j \\<le> (Suc n)}\" and A = \"f ` {j. j \\<le> n1}\" in \n        card_mono, simp,  assumption+,\n        insert finite_Collect_le_nat [of \"Suc n\"],\n        frule card_image_le [of \"{j. j \\<le> (Suc n)}\" \"h\"],\n        frule_tac i = \"card (f ` {j. j \\<le> n1})\" and \n         j = \"card (h ` {j. j \\<le> (Suc n)})\" and k = \"card {j. j \\<le> (Suc n)}\" in\n        le_trans, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        f ` {j. j \\<le> n1} \\<subseteq> h ` {j. j \\<le> Suc n};\n        card (f ` {j. j \\<le> n1}) \\<le> card (h ` {j. j \\<le> Suc n});\n        finite {na. na \\<le> Suc n};\n        card (h ` {j. j \\<le> Suc n}) \\<le> card {j. j \\<le> Suc n};\n        card (f ` {j. j \\<le> n1}) \\<le> card {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n1}) - Suc 0 \\<le> Suc n\n 2. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        finite {na. na \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> finite (h ` {j. j \\<le> Suc n})", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n        m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n1}) - Suc 0);\n        Ring R;\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                A;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n1}) -\n                            Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n1};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n1}) - Suc 0}\n         (f ` {j. j \\<le> n1});\n        finite {na. na \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> finite (h ` {j. j \\<le> Suc n})", "apply (rule finite_imageI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma two_func_imageTr:\"\\<lbrakk> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> B; \n   f \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> h ` {j. j \\<le> Suc n};  h (Suc n) \\<notin> f ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> {j. j \\<le> Suc n} \\<rightarrow> B;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     h (Suc n) \\<notin> f ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> m} \\<rightarrow>\n                              h ` {j. j \\<le> n}", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> {j. j \\<le> Suc n} \\<rightarrow> B;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m};\n        x \\<in> {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> h ` {j. j \\<le> n}", "apply (frule_tac x = x and f = f and A = \"{j. j \\<le> m}\" and \n           B = \"h ` {j. j \\<le> Suc n}\" in funcset_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> {j. j \\<le> Suc n} \\<rightarrow> B;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<in> {j. j \\<le> m};\n        f x \\<in> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> h ` {j. j \\<le> n}", "apply (thin_tac \"h \\<in> {j. j \\<le> Suc n} \\<rightarrow> B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<in> {j. j \\<le> m};\n        f x \\<in> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> h ` {j. j \\<le> n}", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        f x \\<in> h ` {j. j \\<le> Suc n};\n        f x \\<notin> h ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:image_def[of h])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<exists>xa\\<le>Suc n. f x = h xa;\n        \\<forall>xa\\<le>n. f x \\<noteq> h xa\\<rbrakk>\n       \\<Longrightarrow> False", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>xa\\<le>n. f x \\<noteq> h xa; xa \\<le> Suc n;\n        f x = h xa\\<rbrakk>\n       \\<Longrightarrow> False", "apply (case_tac \"xa \\<noteq> Suc n\",\n            frule_tac m = xa and n = \"Suc n\" in noteq_le_less, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>xa\\<le>n. f x \\<noteq> h xa; xa \\<le> Suc n; f x = h xa;\n        xa \\<noteq> Suc n; xa < Suc n\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>xa\\<le>n. f x \\<noteq> h xa; xa \\<le> Suc n; f x = h xa;\n        \\<not> xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n            thin_tac \"xa \\<le> Suc n\",\n            frule_tac x = xa and n = \"Suc n\" in less_le_diff,\n            thin_tac \"xa < Suc n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>x\\<le>n. h xa \\<noteq> h x; f x = h xa; xa \\<le> n\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>xa\\<le>n. f x \\<noteq> h xa; xa \\<le> Suc n; f x = h xa;\n        \\<not> xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> False", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>xa\\<le>n. f x \\<noteq> h xa; xa \\<le> Suc n; f x = h xa;\n        \\<not> xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>x\\<le>n. h (Suc n) \\<noteq> h x; f x = h (Suc n);\n        xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"(f x) \\<in> f ` {j. j \\<le> m}\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        h (Suc n) \\<notin> f ` {j. j \\<le> m}; x \\<le> m;\n        \\<forall>x\\<le>n. h (Suc n) \\<noteq> h x; f x = h (Suc n);\n        xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` {j. j \\<le> m}", "apply (thin_tac \"h (Suc n) \\<notin> f ` {j. j \\<le> m}\",\n                 thin_tac \"\\<forall>x\\<le>n. h (Suc n) \\<noteq> h x\",\n                 thin_tac \"f x = h (Suc n)\",\n                 thin_tac \"xa = Suc n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> m} \\<rightarrow>\n                        {y. \\<exists>x\\<le>Suc n. y = h x};\n        x \\<le> m\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> f ` {j. j \\<le> m}", "apply (simp add:image_def, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finite_lin_spanTr3_0:\"\\<lbrakk>bij_to g {j. j \\<le> l} (g `{j. j \\<le> l});\n      ideal R A; \n     \\<forall>na. \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                   \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A. l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M; s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n}; \n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A; g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     0 < l; f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l\\<rbrakk>\n \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A. l_comb R M l sa g = l_comb R M (Suc n) t h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (subgoal_tac \"l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\",\n         simp del:Suc_pred,\n         thin_tac \"l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\",\n         simp del:Suc_pred add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 \\<Sigma>\\<^sub>e M (\\<lambda>j.\n  s j \\<cdot>\\<^sub>s f j) na =\n                 \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (drule_tac x = \"l - Suc 0\" in spec,\n         drule_tac x = sa in bspec)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> sa \\<in> {j. j \\<le> l - Suc 0} \\<rightarrow> A\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<forall>f\\<in>{j. j \\<le> l - Suc 0} \\<rightarrow> h ` {j. j \\<le> n}.\n        \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  sa j \\<cdot>\\<^sub>s f j) (l - Suc 0) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n        x \\<le> l - Suc 0\\<rbrakk>\n       \\<Longrightarrow> sa x \\<in> A\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<forall>f\\<in>{j. j \\<le> l - Suc 0} \\<rightarrow> h ` {j. j \\<le> n}.\n        \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  sa j \\<cdot>\\<^sub>s f j) (l - Suc 0) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (rule_tac x = x and f = sa and A = \"{j. j \\<le> l}\"and B = A\n               in funcset_mem, assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<forall>f\\<in>{j. j \\<le> l - Suc 0} \\<rightarrow> h ` {j. j \\<le> n}.\n        \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  sa j \\<cdot>\\<^sub>s f j) (l - Suc 0) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "(*\n        apply (rule_tac i = x and j = \"l - Suc 0\" and k = l in le_trans)\napply (\n               assumption, subst Suc_le_mono[THEN sym], simp) *)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<forall>f\\<in>{j. j \\<le> l - Suc 0} \\<rightarrow> h ` {j. j \\<le> n}.\n        \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  sa j \\<cdot>\\<^sub>s f j) (l - Suc 0) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                                  t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (drule_tac x = g in bspec,\n         thin_tac \"f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n}\",\n         thin_tac \"sa \\<in> {j. j \\<le> l} \\<rightarrow> A\",\n         thin_tac \"f ` {j. j \\<le> m} = g ` {j. j \\<le> l}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     h (Suc n) = g l; Ring R\\<rbrakk>\n    \\<Longrightarrow> g \\<in> {j. j \\<le> l - Suc 0} \\<rightarrow>\n                              h ` {j. j \\<le> n}\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> h ` {j. j \\<le> n}\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (frule_tac x = x and f = g and A = \"{j. j \\<le> l}\" and \n         B = \"h ` {j. j \\<le> Suc n}\" in funcset_mem)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {j. j \\<le> l}\n 2. \\<And>x.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0;\n        g x \\<in> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> h ` {j. j \\<le> n}\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 4. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0;\n        g x \\<in> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> h ` {j. j \\<le> n}\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "(*\n      apply (rule_tac i = x and j = \"l - Suc 0\" and k = l in Nat.le_trans,\n             assumption, subst Suc_le_mono[THEN sym], simp) *)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0;\n        g x \\<in> h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> h ` {j. j \\<le> n}\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (unfold bij_to_def, frule conjunct2, fold bij_to_def,\n             thin_tac \"bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l})\",\n             thin_tac \"g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0;\n        g x \\<in> h ` {j. j \\<le> Suc n}; inj_on g {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> h ` {j. j \\<le> n}\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (simp add:image_def, erule exE, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (case_tac \"xa = Suc n\", simp add:inj_on_def,\n             drule_tac a = x in forall_spec)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; g x = g l;\n        xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> x \\<le> l\n 2. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; g x = g l; xa = Suc n;\n        \\<forall>y\\<le>l. g x = g y \\<longrightarrow> x = y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>n. g l = h x\n 3. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 4. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 5. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; g x = g l; xa = Suc n;\n        \\<forall>y\\<le>l. g x = g y \\<longrightarrow> x = y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>n. g l = h x\n 2. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 4. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "(*\n      apply (frule_tac i = x and j = \"l - Suc 0\" and k = l in Nat.le_trans,\n              subst Suc_le_mono[THEN sym], simp, assumption) *)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; g x = g l; xa = Suc n;\n        \\<forall>y\\<le>l. g x = g y \\<longrightarrow> x = y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>n. g l = h x\n 2. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 4. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply(drule_tac a = l in forall_spec, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; g x = g l; xa = Suc n;\n        g x = g l \\<longrightarrow> x = l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>n. g l = h x\n 2. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 4. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (cut_tac n1 = l and m1 = \"l - Suc 0\" in Suc_le_mono[THEN sym])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; g x = g l; xa = Suc n;\n        g x = g l \\<longrightarrow> x = l;\n        (l \\<le> l - Suc 0) = (Suc l \\<le> Suc (l - Suc 0))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>n. g l = h x\n 2. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 4. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        xa \\<le> Suc n; g x = h xa; xa \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>n. g x = h xa\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (frule_tac m = xa and n = \"Suc n\" in noteq_le_less, assumption,\n            thin_tac \"xa \\<le> Suc n\",\n            frule_tac x = xa and n = \"Suc n\" in less_le_diff,\n            thin_tac \"xa < Suc n\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A; l \\<le> Suc n; 0 < l;\n        h (Suc n) = g l; Ring R; x \\<le> l - Suc 0; inj_on g {j. j \\<le> l};\n        g x = h xa; xa \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>n. h xa = h x\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n     \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus>\n                         sa (Suc (l - Suc 0)) \\<cdot>\\<^sub>s\n                         g (Suc (l - Suc 0)) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         t (Suc n) \\<cdot>\\<^sub>s g l\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l; Ring R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            sa l \\<cdot>\\<^sub>s g l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s g l\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (rotate_tac -4, frule sym, thin_tac \"h (Suc n) = g l\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            sa l \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (frule_tac f = t and n = n and A = A and g = \"\\<lambda>k\\<in>{0::nat}. sa l\"\n          and m = 0 and B = A in jointfun_hom0,\n          simp add:Pi_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            sa l \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (subgoal_tac \" \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n \\<plusminus> sa l \\<cdot>\\<^sub>s h (Suc n) =\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. (jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)) j \\<cdot>\\<^sub>s h j) (Suc n)\",\n          simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         sa l \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l) j \\<cdot>\\<^sub>s\n          h j) Suc n\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (cut_tac H = \"carrier M\" and A = A and s = t and f = h and n = n and\n          m = 0 and t = \"\\<lambda>k\\<in>{0}. sa l\" in l_comb_jointfun_jf)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> carrier M \\<subseteq> carrier M\n 2. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> n} \\<rightarrow> A\n 4. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc (n + 0)} \\<rightarrow>\n                                 carrier M\n 5. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{0}. sa l)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> A\n 6. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n                                j \\<cdot>\\<^sub>s\n                               h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         sa l \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l) j \\<cdot>\\<^sub>s\n          h j) Suc n\n 7. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply simp+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> sa l \\<in> A\n 2. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n                                j \\<cdot>\\<^sub>s\n                               h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         sa l \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l) j \\<cdot>\\<^sub>s\n          h j) Suc n\n 3. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n                                j \\<cdot>\\<^sub>s\n                               h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         sa l \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l) j \\<cdot>\\<^sub>s\n          h j) Suc n\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>Ring R; t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n;\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; g l = h (Suc n);\n        jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n                                j \\<cdot>\\<^sub>s\n                               h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         sa l \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                         jointfun n t 0 (\\<lambda>k\\<in>{0}. sa l)\n                          (Suc n) \\<cdot>\\<^sub>s\n                         h (Suc n)\n 2. \\<lbrakk>bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); ideal R A;\n     \\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> m} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> m} \\<rightarrow> h ` {j. j \\<le> Suc n};\n     l \\<le> Suc n; sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n     g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n}; 0 < l;\n     f ` {j. j \\<le> m} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g", "apply (simp add:jointfun_def sliden_def, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finite_lin_spanTr3:\"ideal R A \\<Longrightarrow> \n       h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M \\<longrightarrow> \n      (\\<forall>na. \\<forall>s \\<in> {j. j \\<le> (na::nat)} \\<rightarrow> A. \n       \\<forall>f\\<in> {j. j \\<le> na} \\<rightarrow> (h ` {j. j \\<le> n}). (\\<exists>t \\<in> {j. j \\<le> n} \\<rightarrow> A. \n       l_comb R M na s f = l_comb R M n t h))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n    (\\<forall>na.\n        \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n           \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n              \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                 l_comb R M na s f = l_comb R M n t h)", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; Ring R\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> n} \\<rightarrow>\n                              carrier M \\<longrightarrow>\n                      (\\<forall>na.\n                          \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                             \\<forall>f\n\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                \\<exists>t\n   \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                   l_comb R M na s f = l_comb R M n t h)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; Ring R\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              carrier M \\<longrightarrow>\n                      (\\<forall>na.\n                          \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                             \\<forall>f\n\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> 0}.\n                                \\<exists>t\n   \\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                                   l_comb R M na s f = l_comb R M 0 t h)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply (rule impI, rule allI, (rule ballI)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M 0 t h\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply (insert Nset_nonempty [of \"0\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> 0} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> 0};\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> 0} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M 0 t h\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) na =\n                            t 0 \\<cdot>\\<^sub>s h 0\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply (frule_tac z = \"h 0\" and h = f and t = s and n = na in \n          single_span [of A])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\\<rbrakk>\n       \\<Longrightarrow> h 0 \\<in> carrier M\n 2. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\n 3. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 4. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0};\n        \\<exists>sa\\<in>{0} \\<rightarrow> A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) na =\n           sa 0 \\<cdot>\\<^sub>s h 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) na =\n                            t 0 \\<cdot>\\<^sub>s h 0\n 5. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\n 2. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0}\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 3. \\<And>na s f.\n       \\<lbrakk>ideal R A; Ring R; h 0 \\<in> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> {h 0};\n        \\<exists>sa\\<in>{0} \\<rightarrow> A.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) na =\n           sa 0 \\<cdot>\\<^sub>s h 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{0} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             s j \\<cdot>\\<^sub>s f j) na =\n                            t 0 \\<cdot>\\<^sub>s h 0\n 4. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "(********** n = 0 done ***********)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier M \\<longrightarrow>\n                         (\\<forall>na.\n                             \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                \\<forall>f\n   \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n}.\n                                   \\<exists>t\n      \\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\nl_comb R M na s f = l_comb R M (Suc n) t h)", "apply (rule impI, rule allI, (rule ballI)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M \\<longrightarrow>\n        (\\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     l_comb R M na s f = l_comb R M n t h);\n        {i. i \\<le> 0} \\<noteq> {};\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow>\n                h ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (frule func_pre, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (case_tac \"h (Suc n) \\<notin>  f ` {j. j \\<le> na}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (frule_tac h = h and n = n and B = \"carrier M\" and f = f and\n         m = na in two_func_imageTr, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (drule_tac x = na in spec,\n         drule_tac x = s in bspec, assumption,\n         drule_tac x = f in bspec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n           l_comb R M na s f = l_comb R M n t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (erule bexE, simp )"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        l_comb R M na s f = l_comb R M n t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M n t h = l_comb R M (Suc n) ta h\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (thin_tac \"l_comb R M na s f = l_comb R M n t h\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M n t h = l_comb R M (Suc n) ta h\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (subgoal_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. t j  \\<cdot>\\<^sub>s (h j)) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. (jointfun n t 0 (zeroi R)) j \\<cdot>\\<^sub>s (h j)) (Suc n)\", simp,\n        thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n        jointfun n t 0 (zeroi R) (Suc n) \\<cdot>\\<^sub>s h (Suc n)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            jointfun n t 0 (zeroi R) (Suc n) \\<cdot>\\<^sub>s\n                            h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) Suc n\n 3. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (frule_tac f = t and n = n and g = \"zeroi R\" and m = 0 and A = A and \n        B = A in jointfun_hom)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> zeroi R \\<in> {j. j \\<le> 0} \\<rightarrow> A\n 2. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        jointfun n t 0 (zeroi R)\n        \\<in> {j. j \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            jointfun n t 0 (zeroi R) (Suc n) \\<cdot>\\<^sub>s\n                            h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             ta j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            ta (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 3. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) Suc n\n 4. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (rule zeroi_func, assumption+, simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) Suc n\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (cut_tac H = \"carrier M\" and s = t and n = n and f = h and m = 0 and \n        t = \"zeroi R\" in l_comb_jointfun_jf[of _ A],\n        simp, assumption+, simp,\n        rule zeroi_func, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f t.\n       \\<lbrakk>ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<notin> f ` {j. j \\<le> na};\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        t \\<in> {j. j \\<le> n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s\n                               h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s h j) n =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) Suc n\n 2. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (simp,\n       thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n t 0 (zeroi R) j \\<cdot>\\<^sub>s h j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\",\n        simp add:jointfun_def sliden_def zeroi_def,\n        subst sc_0_m, simp add:Pi_def,\n        subst ag_r_zero,\n        rule nsum_mem, rule allI, rule impI, rule sc_mem,\n               simp add:Pi_def Ring.ideal_subset,\n               simp add:Pi_def,\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "(*** case h (Suc n) \\<notin>  f ` (Nset na) done ***)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        \\<not> h (Suc n) \\<notin> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (frule_tac h = h and n = n and m = \"l_comb R M na s f\" in \n               prep_arrTr1 [of \"A\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na};\n        \\<exists>l\\<in>{j. j \\<le> Suc n}.\n           \\<exists>sa\\<in>{j. j \\<le> l} \\<rightarrow> A.\n              \\<exists>g\\<in>{j. j \\<le> l} \\<rightarrow>\n                             h ` {j. j \\<le> Suc n}.\n                 l_comb R M na s f = l_comb R M l sa g \\<and>\n                 bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (erule bexE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<in> {j. j \\<le> Suc n};\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g \\<and>\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M na s f = l_comb R M (Suc n) t h", "apply (simp, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (case_tac \"l = 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; sa 0 \\<in> A;\n        g 0 \\<in> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M 0 sa g;\n        bij_to g {0} (f ` {j. j \\<le> na}); l = 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M 0 sa g = l_comb R M (Suc n) t h\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (unfold bij_to_def, frule conjunct1, frule conjunct2, fold bij_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; sa 0 \\<in> A;\n        g 0 \\<in> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M 0 sa g;\n        bij_to g {0} (f ` {j. j \\<le> na}); l = 0;\n        surj_to g {0} (f ` {j. j \\<le> na}); inj_on g {0}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M 0 sa g = l_comb R M (Suc n) t h\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (thin_tac \"l_comb R M na s f = l_comb R M 0 sa g\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; sa 0 \\<in> A;\n        g 0 \\<in> h ` {j. j \\<le> Suc n};\n        bij_to g {0} (f ` {j. j \\<le> na}); l = 0;\n        surj_to g {0} (f ` {j. j \\<le> na}); inj_on g {0}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M 0 sa g = l_comb R M (Suc n) t h\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; sa 0 \\<in> A;\n        g 0 \\<in> h ` {j. j \\<le> Suc n};\n        bij_to g {0} (f ` {j. j \\<le> na}); l = 0;\n        surj_to g {0} (f ` {j. j \\<le> na})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            sa 0 \\<cdot>\\<^sub>s g 0 =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:surj_to_def, rotate_tac -1, frule sym, \n        thin_tac \"{g 0} = f ` {j. j \\<le> na}\", simp,\n        rotate_tac -6, frule sym, thin_tac \"h (Suc n) = g 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        g 0 = h (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (cut_tac f = \"zeroi R\" and n = n and g = \"\\<lambda>j. sa 0\" and m = 0 and \n         A = A and B = A in jointfun_hom0)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        g 0 = h (Suc n)\\<rbrakk>\n       \\<Longrightarrow> zeroi R \\<in> {j. j \\<le> n} \\<rightarrow> A\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        g 0 = h (Suc n)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. sa 0)\n                         \\<in> {k. k \\<le> 0} \\<rightarrow> A\n 3. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 4. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:zeroi_def Ring.ideal_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        g 0 = h (Suc n)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. sa 0)\n                         \\<in> {k. k \\<le> 0} \\<rightarrow> A\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 3. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc (n + 0)} \\<rightarrow> A \\<union> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (subgoal_tac \"sa 0 \\<cdot>\\<^sub>s h (Suc n) = nsum M (\\<lambda>j. (jointfun n (zeroi R) 0 \n         (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s h j)) (Suc n)\", simp,\n        thin_tac \"sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) (Suc n) \\<cdot>\\<^sub>s h (Suc n)\",\n        blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s\n          h j) Suc n\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s\n          h j) n \\<plusminus>\n                         jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n                          (Suc n) \\<cdot>\\<^sub>s\n                         h (Suc n)\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (cut_tac n = n and f = \"\\<lambda>j. jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s h j\"\n        in nsum_zeroA)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n                             j \\<cdot>\\<^sub>s\n                            h j =\n                            \\<zero>\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n                                j \\<cdot>\\<^sub>s\n                               h j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s\n          h j) n \\<plusminus>\n                         jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n                          (Suc n) \\<cdot>\\<^sub>s\n                         h (Suc n)\n 3. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (rule allI, rule impI,\n        simp add:jointfun_def zeroi_def,\n        rule sc_0_m, simp add:Pi_def, simp,\n       thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun n (zeroi R) 0 (\\<lambda>j. sa 0) j \\<cdot>\\<^sub>s h j) n = \\<zero>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>sa 0 \\<in> A; bij_to g {0} {h (Suc n)}; l = 0;\n        f ` {j. j \\<le> na} = {h (Suc n)}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; g 0 = h (Suc n);\n        jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n        \\<in> {l. l \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> sa 0 \\<cdot>\\<^sub>s h (Suc n) =\n                         \\<zero> \\<plusminus>\n                         jointfun n (zeroi R) 0 (\\<lambda>j. sa 0)\n                          (Suc n) \\<cdot>\\<^sub>s\n                         h (Suc n)\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:jointfun_def sliden_def,\n        subst ag_l_zero,\n        rule sc_mem, simp add:Pi_def Ring.ideal_subset,\n        simp add:Pi_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "(**** l = 0 done ***)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); l \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        l_comb R M na s f = l_comb R M l sa g;\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); 0 < l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (thin_tac \"l_comb R M na s f = l_comb R M l sa g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); 0 < l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (unfold bij_to_def, frule conjunct1, frule conjunct2, fold bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> f ` {j. j \\<le> na}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (f ` {j. j \\<le> na}); 0 < l;\n        surj_to g {j. j \\<le> l} (f ` {j. j \\<le> na});\n        inj_on g {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:surj_to_def, rotate_tac -2, frule sym,\n        thin_tac \"g ` {j. j \\<le> l} = f ` {j. j \\<le> na}\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (subgoal_tac \"\\<exists>x\\<in>{j. j \\<le> l}. h (Suc n) = g x\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l};\n        \\<exists>x\\<in>{j. j \\<le> l}. h (Suc n) = g x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>{j. j \\<le> l}. h (Suc n) = g x", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>{j. j \\<le> l}. h (Suc n) = g x\n 2. \\<And>n na s f l sa g.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l};\n        \\<exists>x\\<in>{j. j \\<le> l}. h (Suc n) = g x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l};\n        \\<exists>x\\<in>{j. j \\<le> l}. h (Suc n) = g x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (case_tac \"x = l\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; h (Suc n) = g l;\n        x = l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (frule_tac g = g and l = l and A = A and h = h and n = n and s = s and\n       m = na and f = f and l = l and sa = sa in finite_lin_spanTr3_0,\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (subgoal_tac \"l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l;\n        l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l_comb R M l sa g =\n                         l_comb R M (Suc (l - Suc 0)) sa g", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l_comb R M l sa g =\n                         l_comb R M (Suc (l - Suc 0)) sa g\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l;\n        l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    l_comb R M na s f = l_comb R M n t h;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        h (Suc n) \\<in> g ` {j. j \\<le> l}; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l}); 0 < l;\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<in> {j. j \\<le> l};\n        h (Suc n) = g x; x \\<noteq> l;\n        l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            l_comb R M l sa g = l_comb R M (Suc n) t h", "apply (simp del:nsum_suc Suc_pred,\n          thin_tac \"l_comb R M l sa g = l_comb R M (Suc (l - Suc 0)) sa g\",\n          simp del:nsum_suc Suc_pred add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (cut_tac f1 = \"\\<lambda>j. sa j \\<cdot>\\<^sub>s g j\" and n1 = \"l - Suc 0\" and\n          h1 = \"transpos x (Suc (l - Suc 0))\" in addition2[THEN sym],\n          thin_tac \"\\<forall>na. \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                   \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) na = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\",\n              rule Pi_I, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n na s f l sa g x xa.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l; xa \\<le> l\\<rbrakk>\n       \\<Longrightarrow> sa xa \\<cdot>\\<^sub>s g xa \\<in> carrier M\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> transpos x (Suc (l - Suc 0))\n                         \\<in> {j. j \\<le> Suc (l - Suc 0)} \\<rightarrow>\n                               {j. j \\<le> Suc (l - Suc 0)}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> inj_on (transpos x (Suc (l - Suc 0)))\n                          {j. j \\<le> Suc (l - Suc 0)}\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n                            (transpos x\n                              (Suc (l - Suc 0))) Suc (l - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (rule sc_mem, \n              simp add:Pi_def Ring.ideal_subset,\n              frule_tac f = h and A = \"{j. j \\<le> Suc n}\" and B = \"carrier M\" in\n              image_sub0,\n              frule_tac x = xa and f = g and A = \"{j. j \\<le> l}\" and \n              B = \"h ` {j. j \\<le> Suc n}\" in funcset_mem, simp, simp add:subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> transpos x (Suc (l - Suc 0))\n                         \\<in> {j. j \\<le> Suc (l - Suc 0)} \\<rightarrow>\n                               {j. j \\<le> Suc (l - Suc 0)}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> inj_on (transpos x (Suc (l - Suc 0)))\n                          {j. j \\<le> Suc (l - Suc 0)}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n                            (transpos x\n                              (Suc (l - Suc 0))) Suc (l - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (simp,\n             rule_tac i = x and n = l and j = l in transpos_hom,\n             assumption+, simp, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> inj_on (transpos x (Suc (l - Suc 0)))\n                          {j. j \\<le> Suc (l - Suc 0)}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n                            (transpos x\n                              (Suc (l - Suc 0))) Suc (l - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (simp,\n              rule_tac i = x and n = l and j = l in transpos_inj,\n              assumption+, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n                            (transpos x\n                              (Suc (l - Suc 0))) Suc (l - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (simp del:Suc_pred nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n                            (transpos x\n                              (Suc (l - Suc 0))) Suc (l - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M cmp\n          (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n          (transpos x (Suc (l - Suc 0))) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (subst l_comb_transpos[of A \"carrier M\"], assumption, simp,\n           simp, simp,\n           rule Pi_I,\n           frule_tac f = h and A = \"{j. j \\<le> Suc n}\" and B = \"carrier M\" in\n              image_sub0,\n              frule_tac x = xa and f = g and A = \"{j. j \\<le> l}\" and \n              B = \"h ` {j. j \\<le> Suc n}\" in funcset_mem, simp, simp add:subsetD,\n            simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               sa j \\<cdot>\\<^sub>s g j) Suc (l - Suc 0) =\n        \\<Sigma>\\<^sub>e M cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j)\n                            (transpos x\n                              (Suc (l - Suc 0))) Suc (l - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x (Suc (l - Suc 0))) k \\<cdot>\\<^sub>s\n             cmp g (transpos x (Suc (l - Suc 0))) k) Suc (l - Suc 0) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) Suc n", "apply (simp del:Suc_pred, simp,\n            thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j) (l - Suc 0) \\<plusminus> sa l \\<cdot>\\<^sub>s g l =\n        \\<Sigma>\\<^sub>e M (cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j) (transpos x l)) (l - Suc 0) \\<plusminus>\n        cmp (\\<lambda>j. sa j \\<cdot>\\<^sub>s g j) (transpos x l) l\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (cut_tac g = \"cmp g (transpos x l)\" and l = l and A = A and\n      h = h and n = n and s = s and m = na and f = f and l = l and\n      sa = \"cmp sa (transpos x l)\" in finite_lin_spanTr3_0)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (frule_tac i = x and n = l and j = l in transpos_hom,\n          simp, assumption)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l\n        \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (cut_tac n = l in Nat.le_refl)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (frule_tac i = x and n = l and j = l in transpos_surjec, assumption+)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (frule_tac f = \"transpos x l\" and A = \"{j. j \\<le> l}\" and \n         B = \"{j. j \\<le> l}\" and g = g and C = \"g ` {j. j \\<le> l}\" in cmp_surj,\n         assumption+)"], ["proof (prove)\ngoal (15 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> l} \\<rightarrow>\n                                 g ` {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> surj_to g {j. j \\<le> l} (g ` {j. j \\<le> l})\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l; surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> cmp sa (transpos x l)\n                          \\<in> {j. j \\<le> l} \\<rightarrow> A\nA total of 15 subgoals...", "apply (rule_tac f = g and A = \"{j. j \\<le> l}\" and B = \"h ` {j. j \\<le> Suc n}\"\n          in func_to_img, assumption)"], ["proof (prove)\ngoal (14 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> surj_to g {j. j \\<le> l} (g ` {j. j \\<le> l})\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l; surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> cmp g (transpos x l)\n                          \\<in> {j. j \\<le> l} \\<rightarrow>\n                                h ` {j. j \\<le> Suc n}\nA total of 14 subgoals...", "apply (simp add:bij_to_def)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        l \\<le> l; surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> bij_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l})\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (subst bij_to_def, simp)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n                          (cmp g (transpos x l) ` {j. j \\<le> l}) \\<and>\n                         inj_on (cmp g (transpos x l)) {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (subgoal_tac \"cmp g (transpos x l) ` {j. j \\<le> l} = g ` {j. j \\<le> l}\",\n          simp)"], ["proof (prove)\ngoal (14 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l} (g ` {j. j \\<le> l});\n        cmp g (transpos x l) ` {j. j \\<le> l} = g ` {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp g (transpos x l)) {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l) ` {j. j \\<le> l} =\n                         g ` {j. j \\<le> l}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> cmp g (transpos x l)\n                          \\<in> {j. j \\<le> l} \\<rightarrow>\n                                h ` {j. j \\<le> Suc n}\nA total of 14 subgoals...", "apply (frule_tac f = \"transpos x l\" and A = \"{j. j \\<le> l}\" and \n         B = \"{j. j \\<le> l}\" and g = g and C = \"h ` {j. j \\<le> Suc n}\" in cmp_inj,\n         assumption+)"], ["proof (prove)\ngoal (16 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l} (g ` {j. j \\<le> l});\n        cmp g (transpos x l) ` {j. j \\<le> l} = g ` {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> inj_on (transpos x l) {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l} (g ` {j. j \\<le> l});\n        cmp g (transpos x l) ` {j. j \\<le> l} = g ` {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> l}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l} (g ` {j. j \\<le> l});\n        cmp g (transpos x l) ` {j. j \\<le> l} = g ` {j. j \\<le> l};\n        inj_on (cmp g (transpos x l)) {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp g (transpos x l)) {j. j \\<le> l}\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l) ` {j. j \\<le> l} =\n                         g ` {j. j \\<le> l}\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> l \\<le> Suc n\nA total of 16 subgoals...", "apply (rule_tac i = x and n = l and j = l in transpos_inj, assumption,\n          simp, assumption, simp add:bij_to_def,\n          assumption)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        surj_to (cmp g (transpos x l)) {j. j \\<le> l}\n         (g ` {j. j \\<le> l})\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l) ` {j. j \\<le> l} =\n                         g ` {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> 0 < l\nA total of 13 subgoals...", "apply (simp add:cmp_fun_image, simp add:surj_to_def)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> ideal R A\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> f ` {j. j \\<le> na} =\n                          cmp g (transpos x l) ` {j. j \\<le> l}\nA total of 12 subgoals...", "apply assumption+"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<forall>na.\n                            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                               \\<forall>f\n  \\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                                  \\<exists>t\n     \\<in>{j. j \\<le> n} \\<rightarrow> A.\n                                     l_comb R M na s f = l_comb R M n t h\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n        \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\nA total of 11 subgoals...", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> na} \\<rightarrow> A\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> na} \\<rightarrow>\n                                 h ` {j. j \\<le> Suc n}\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> l \\<le> Suc n\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 7. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 8. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 9. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 10. \\<And>n na s f l sa g x.\n        \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n         \\<forall>na.\n            \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n               \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                              h ` {j. j \\<le> n}.\n                  \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      s j \\<cdot>\\<^sub>s f j) na =\n                     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n      t j \\<cdot>\\<^sub>s h j) n;\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n         s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n         f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n         sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n         g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n         bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n         f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n         h (Suc n) = g x; x \\<noteq> l;\n         \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n            l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n            l_comb R M (Suc n) t h\\<rbrakk>\n        \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                             \\<Sigma>\\<^sub>e M (\\<lambda>k.\n              cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n              cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                             cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                             cmp g (transpos x l) l =\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                             t (Suc n) \\<cdot>\\<^sub>s g x", "apply assumption+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow> A\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (rule Pi_I)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n na s f l sa g x xa.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l; xa \\<in> {j. j \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> cmp sa (transpos x l) xa \\<in> A\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n na s f l sa g x xa.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l; xa \\<le> l\\<rbrakk>\n       \\<Longrightarrow> sa (transpos x l xa) \\<in> A\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 6. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (cut_tac n = l in Nat.le_refl,\n          frule_tac i = x and n = l and j = l and l = xa in transpos_mem,\n          assumption+,\n          simp add:Pi_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> cmp g (transpos x l)\n                         \\<in> {j. j \\<le> l} \\<rightarrow>\n                               h ` {j. j \\<le> Suc n}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 5. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (rule Pi_I,\n          simp add:cmp_def,\n          cut_tac n = l in Nat.le_refl,\n          frule_tac i = x and n = l and j = l and l = xa in transpos_mem,\n          assumption+,\n          simp add:Pi_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> 0 < l\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 4. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (cut_tac n = l in Nat.le_refl,\n          frule_tac i = x and n = l and j = l in transpos_surjec, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l; l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (frule_tac i = x and n = l and j = l in transpos_hom,\n           simp, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l; l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        transpos x l\n        \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (frule_tac f = \"transpos x l\" and A = \"{i. i \\<le> l}\" and \n          B = \"{i. i \\<le> l}\" and g = g and C = \"h ` {j. j \\<le> Suc n}\" in\n          cmp_fun_image, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l; l \\<le> l;\n        surj_to (transpos x l) {i. i \\<le> l} {i. i \\<le> l};\n        transpos x l \\<in> {i. i \\<le> l} \\<rightarrow> {i. i \\<le> l};\n        cmp g (transpos x l) ` {i. i \\<le> l} =\n        g ` transpos x l ` {i. i \\<le> l}\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> na} =\n                         cmp g (transpos x l) ` {j. j \\<le> l}\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 3. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> h (Suc n) = cmp g (transpos x l) l\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> g x = g (transpos x l l)\n 2. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (simp add:transpos_ij_2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n           l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n           l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x t.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        \\<forall>na.\n           \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow>\n                             h ` {j. j \\<le> n}.\n                 \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     s j \\<cdot>\\<^sub>s f j) na =\n                    \\<Sigma>\\<^sub>e M (\\<lambda>j.\n     t j \\<cdot>\\<^sub>s h j) n;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (thin_tac \"\\<forall>na. \\<forall>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                \\<forall>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n                   \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) na = \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s h j) n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x t.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) t h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (rename_tac n na s f l sa g x sb)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x", "apply (subgoal_tac \"l_comb R M l (cmp sa (transpos x l)) \n   (cmp g (transpos x l)) = l_comb R M (Suc (l - Suc 0)) \n    (cmp sa (transpos x l)) (cmp g (transpos x l)) \",\n     simp del:Suc_pred,\n     thin_tac \"l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M (Suc (l - Suc 0)) (cmp sa (transpos x l))\n         (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             cmp sa (transpos x l) k \\<cdot>\\<^sub>s\n             cmp g (transpos x l) k) (l - Suc 0) \\<plusminus>\n                            cmp sa (transpos x l) l \\<cdot>\\<^sub>s\n                            cmp g (transpos x l) l =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x\n 2. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\\<rbrakk>\n       \\<Longrightarrow> l_comb R M l (cmp sa (transpos x l))\n                          (cmp g (transpos x l)) =\n                         l_comb R M (Suc (l - Suc 0))\n                          (cmp sa (transpos x l)) (cmp g (transpos x l))", "apply (simp del:Suc_pred add:l_comb_def, simp,\n         thin_tac \" \\<Sigma>\\<^sub>e M (\\<lambda>j. cmp sa (transpos x l) j \\<cdot>\\<^sub>s\n                  cmp g (transpos x l) j) (l - Suc 0) \\<plusminus>\n         cmp sa (transpos x l) l \\<cdot>\\<^sub>s cmp g (transpos x l) l =\n         \\<Sigma>\\<^sub>e M (\\<lambda>j. sb j \\<cdot>\\<^sub>s h j) n \\<plusminus> sb (Suc n) \\<cdot>\\<^sub>s g x\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             sb k \\<cdot>\\<^sub>s h k) n \\<plusminus>\n                            sb (Suc n) \\<cdot>\\<^sub>s g x =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s g x\n 2. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\\<rbrakk>\n       \\<Longrightarrow> l_comb R M l (cmp sa (transpos x l))\n                          (cmp g (transpos x l)) =\n                         l_comb R M (Suc (l - Suc 0))\n                          (cmp sa (transpos x l)) (cmp g (transpos x l))", "apply (rotate_tac -3, frule sym, thin_tac \"h (Suc n) = g x\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>x \\<noteq> l; sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        g x = h (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> Suc n} \\<rightarrow> A.\n                            \\<Sigma>\\<^sub>e M (\\<lambda>k.\n             sb k \\<cdot>\\<^sub>s h k) n \\<plusminus>\n                            sb (Suc n) \\<cdot>\\<^sub>s h (Suc n) =\n                            \\<Sigma>\\<^sub>e M (\\<lambda>j.\n             t j \\<cdot>\\<^sub>s h j) n \\<plusminus>\n                            t (Suc n) \\<cdot>\\<^sub>s h (Suc n)\n 2. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\\<rbrakk>\n       \\<Longrightarrow> l_comb R M l (cmp sa (transpos x l))\n                          (cmp g (transpos x l)) =\n                         l_comb R M (Suc (l - Suc 0))\n                          (cmp sa (transpos x l)) (cmp g (transpos x l))", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na s f l sa g x sb.\n       \\<lbrakk>inj_on g {j. j \\<le> l}; ideal R A; Ring R;\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier M;\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M; l \\<le> Suc n;\n        sa \\<in> {j. j \\<le> l} \\<rightarrow> A;\n        g \\<in> {j. j \\<le> l} \\<rightarrow> h ` {j. j \\<le> Suc n};\n        bij_to g {j. j \\<le> l} (g ` {j. j \\<le> l});\n        f ` {j. j \\<le> na} = g ` {j. j \\<le> l}; x \\<le> l;\n        h (Suc n) = g x; x \\<noteq> l;\n        sb \\<in> {j. j \\<le> Suc n} \\<rightarrow> A;\n        l_comb R M l (cmp sa (transpos x l)) (cmp g (transpos x l)) =\n        l_comb R M (Suc n) sb h\\<rbrakk>\n       \\<Longrightarrow> l_comb R M l (cmp sa (transpos x l))\n                          (cmp g (transpos x l)) =\n                         l_comb R M (Suc (l - Suc 0))\n                          (cmp sa (transpos x l)) (cmp g (transpos x l))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finite_lin_span:\n\"\\<lbrakk>ideal R A;  h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier M; s \\<in> {j. j \\<le> (n1::nat)} \\<rightarrow> A;\n f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n              l_comb R M n1 s f = l_comb R M n t h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     s \\<in> {j. j \\<le> n1} \\<rightarrow> A;\n     f \\<in> {j. j \\<le> n1} \\<rightarrow> h ` {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         l_comb R M n1 s f = l_comb R M n t h", "apply (simp add:finite_lin_spanTr3)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Free generators\""], ["", "definition\n  free_generator :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, 'a set]\n        \\<Rightarrow> bool\" where\n \"free_generator R M H \\<longleftrightarrow> generator R M H \\<and>\n      (\\<forall>n. (\\<forall>s f. (s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R \\<and>\n                   f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> inj_on f {j. j \\<le> n} \\<and> \n         l_comb R M n s f = \\<zero>\\<^bsub>M\\<^esub>) \\<longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}))\""], ["", "lemma (in Module) free_generator_generator:\"free_generator R M H \\<Longrightarrow>\n                  generator R M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. free_generator R M H \\<Longrightarrow> generator R M H", "by (simp add:free_generator_def)"], ["", "lemma (in Module) free_generator_sub:\"free_generator R M H \\<Longrightarrow> \n                    H \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. free_generator R M H \\<Longrightarrow> H \\<subseteq> carrier M", "by (simp add:free_generator_def generator_def)"], ["", "lemma (in Module) free_generator_nonzero:\"\\<lbrakk>\\<not> (zeroring R); \n                free_generator R M H; h \\<in> H\\<rbrakk> \\<Longrightarrow> h \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; free_generator R M H; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> h \\<noteq> \\<zero>", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; free_generator R M H; h \\<in> H;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> h \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; free_generator R M H; \\<zero> \\<in> H;\n     Ring R; h = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:free_generator_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> False", "apply (subgoal_tac \"(\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (subgoal_tac \"(\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> H \\<and> \n                     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> (0::nat)} \\<and>\n        l_comb R M 0 (\\<lambda>t.  1\\<^sub>r\\<^bsub>R\\<^esub>) (\\<lambda>t.  \\<zero>) =  \\<zero>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n     l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. \\<zero>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n                      l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 3. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (subgoal_tac \"(\\<lambda>t.  1\\<^sub>r\\<^bsub>R\\<^esub>) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n     l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>;\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n     l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 3. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. \\<zero>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n                      l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 4. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "prefer 2"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n     l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow>\n                            {\\<zero>\\<^bsub>R\\<^esub>}\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n     l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>;\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. \\<zero>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n                      l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 4. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>t. \\<zero>) \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n     inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n     l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>;\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. \\<zero>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n                      l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 3. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (frule_tac f = \"\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>\" and A = \"{j. j \\<le> (0::nat)}\" and B = \"{\\<zero>\\<^bsub>R\\<^esub>}\" \n        and x = 0 in funcset_mem, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R;\n     l_comb R M 0 (\\<lambda>t. \\<zero>\\<^bsub>R\\<^esub>)\n      (\\<lambda>t. \\<zero>) =\n     \\<zero>;\n     1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. \\<zero>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n                      l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 3. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (frule Ring.Zero_ring1 [of \"R\"], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. \\<zero>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on (\\<lambda>t. \\<zero>) {j. j \\<le> 0} \\<and>\n                      l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (thin_tac \"\\<forall>n s. s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           (\\<exists>f. f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n                inj_on f {j. j \\<le> n} \\<and> l_comb R M n s f = \\<zero>) \\<longrightarrow>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H; 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> l_comb R M 0 (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                       (\\<lambda>t. \\<zero>) =\n                      \\<zero>\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H; 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s \\<zero> =\n                      \\<zero>\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (rule sc_a_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H; 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\n 2. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (simp add:Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; \\<zero> \\<in> H; Ring R; h = \\<zero>;\n     generator R M H;\n     \\<forall>n s.\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        (\\<exists>f.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            l_comb R M n s f = \\<zero>) \\<longrightarrow>\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>t. 1\\<^sub>r\\<^bsub>R\\<^esub>)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (simp add:Ring.ring_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) has_free_generator_nonzeroring:\" \\<lbrakk>free_generator R M H; \n      \\<exists>p \\<in> linear_span R M (carrier R) H. p \\<noteq> \\<zero> \\<rbrakk>  \\<Longrightarrow> \\<not> zeroring R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<exists>p\\<in>linear_span R M (carrier R) H.\n        p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<not> zeroring R", "apply (erule bexE, simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>p.\n       \\<lbrakk>free_generator R M H;\n        p \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                   x = l_comb R M n s f});\n        p \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<not> zeroring R", "apply (case_tac \"H = {}\", simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>p.\n       \\<lbrakk>free_generator R M H;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 p = l_comb R M n s f;\n        p \\<noteq> \\<zero>; H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<not> zeroring R", "apply (erule exE, (erule bexE)+, simp,\n        thin_tac \"p = l_comb R M n s f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>p n f s.\n       \\<lbrakk>free_generator R M H; l_comb R M n s f \\<noteq> \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<not> zeroring R", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>free_generator R M H; l_comb R M n s f \\<noteq> \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; zeroring R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:zeroring_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>free_generator R M H; l_comb R M n s f \\<noteq> \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule Ring.ring_one[of \"R\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>free_generator R M H; l_comb R M n s f \\<noteq> \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>free_generator R M H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<noteq>\n        \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac n = n and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s f j\" in nsum_zeroA)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s.\n       \\<lbrakk>free_generator R M H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<noteq>\n        \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. s j \\<cdot>\\<^sub>s f j = \\<zero>\n 2. \\<And>n f s.\n       \\<lbrakk>free_generator R M H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<noteq>\n        \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s j.\n       \\<lbrakk>free_generator R M H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<noteq>\n        \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>;\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s j \\<cdot>\\<^sub>s f j = \\<zero>\n 2. \\<And>n f s.\n       \\<lbrakk>free_generator R M H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<noteq>\n        \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:free_generator_def generator_def, frule conjunct1,\n        frule_tac x = j and f = f and A = \"{j. j \\<le> n}\" and B = H in\n        funcset_mem, simp,\n        frule_tac c = \"f j\" in subsetD[of H \"carrier M\"], assumption+,\n       frule_tac x = j and f = s and A = \"{j. j \\<le> n}\" and B = \"{\\<zero>\\<^bsub>R\\<^esub>}\" in\n       funcset_mem, simp, simp add:sc_0_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>free_generator R M H;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n \\<noteq>\n        \\<zero>;\n        H \\<noteq> {}; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        Ring R; carrier R = {\\<zero>\\<^bsub>R\\<^esub>};\n        1\\<^sub>r\\<^bsub>R\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression1:\"\\<lbrakk>H \\<subseteq> carrier M; free_generator R M H;\n      s \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R; m \\<in> {j. j \\<le> n} \\<rightarrow> H; \n      inj_on m {j. j \\<le> n}; l_comb R M n s m = \\<zero>\\<rbrakk> \\<Longrightarrow> \n                                 \\<forall>j\\<in>{j. j \\<le> n}. s j = \\<zero>\\<^bsub>R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; free_generator R M H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     m \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on m {j. j \\<le> n};\n     l_comb R M n s m = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                         s j = \\<zero>\\<^bsub>R\\<^esub>", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>H \\<subseteq> carrier M; free_generator R M H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on m {j. j \\<le> n};\n        l_comb R M n s m = \\<zero>; j \\<in> {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> s j = \\<zero>\\<^bsub>R\\<^esub>", "apply (simp add:free_generator_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on m {j. j \\<le> n};\n        l_comb R M n s m = \\<zero>; j \\<le> n; generator R M H;\n        \\<forall>n s.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           (\\<exists>f.\n               f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n               inj_on f {j. j \\<le> n} \\<and>\n               l_comb R M n s f = \\<zero>) \\<longrightarrow>\n           s \\<in> {j. j \\<le> n} \\<rightarrow>\n                   {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> s j = \\<zero>\\<^bsub>R\\<^esub>", "apply (subgoal_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on m {j. j \\<le> n};\n        l_comb R M n s m = \\<zero>; j \\<le> n; generator R M H;\n        \\<forall>n s.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           (\\<exists>f.\n               f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n               inj_on f {j. j \\<le> n} \\<and>\n               l_comb R M n s f = \\<zero>) \\<longrightarrow>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>};\n        s \\<in> {j. j \\<le> n} \\<rightarrow>\n                {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> s j = \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>j.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on m {j. j \\<le> n};\n        l_comb R M n s m = \\<zero>; j \\<le> n; generator R M H;\n        \\<forall>n s.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           (\\<exists>f.\n               f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n               inj_on f {j. j \\<le> n} \\<and>\n               l_comb R M n s f = \\<zero>) \\<longrightarrow>\n           s \\<in> {j. j \\<le> n} \\<rightarrow>\n                   {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 {\\<zero>\\<^bsub>R\\<^esub>}", "apply (frule_tac f = s and A = \"{j. j \\<le> n}\" and B = \"{\\<zero>\\<^bsub>R\\<^esub>}\" and x = j in \n        funcset_mem, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on m {j. j \\<le> n};\n        l_comb R M n s m = \\<zero>; j \\<le> n; generator R M H;\n        \\<forall>n s.\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           (\\<exists>f.\n               f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n               inj_on f {j. j \\<le> n} \\<and>\n               l_comb R M n s f = \\<zero>) \\<longrightarrow>\n           s \\<in> {j. j \\<le> n} \\<rightarrow>\n                   {\\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 {\\<zero>\\<^bsub>R\\<^esub>}", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) free_gen_coeff_zero:\"\\<lbrakk>H \\<subseteq> carrier M; free_generator R M H;\n       h \\<in> H; a \\<in> carrier R; a \\<cdot>\\<^sub>s h = \\<zero>\\<rbrakk> \\<Longrightarrow> a = \\<zero>\\<^bsub>R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; free_generator R M H; h \\<in> H;\n     a \\<in> carrier R; a \\<cdot>\\<^sub>s h = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a = \\<zero>\\<^bsub>R\\<^esub>", "apply (frule unique_expression1[of H \"\\<lambda>x\\<in>{0::nat}. a\" 0 \"\\<lambda>x\\<in>{0::nat}. h\"],\n        assumption+,\n       simp,\n       simp,\n       simp add:inj_on_def,\n       simp add:l_comb_def,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression2:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk> \\<Longrightarrow>\n    \\<exists>m g t. g \\<in> ({j. j \\<le> (m::nat)} \\<rightarrow> H) \\<and> \n            bij_to g {j. j \\<le> (m::nat)} (f ` {j. j \\<le> n}) \\<and> \n            t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and> \n            l_comb R M n s f = l_comb R M m t g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M n s f = l_comb R M m t g", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M n s f = l_comb R M m t g", "apply (frule Ring.whole_ideal [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M n s f = l_comb R M m t g", "apply (frule_tac  A = \"carrier R\" and H = H and s = s and f = f in \n       same_together, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n     ideal R (carrier R);\n     \\<exists>t\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n                                Suc 0} \\<rightarrow>\n                    carrier R.\n        \\<exists>g\\<in>{j. j \\<le> card (f ` {j. j \\<le> n}) -\n                                   Suc 0} \\<rightarrow>\n                       f ` {j. j \\<le> n}.\n           surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n            (f ` {j. j \\<le> n}) \\<and>\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n           \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                                  t k \\<cdot>\\<^sub>s\n                                  g k) (card (f ` {j. j \\<le> n}) -\n  Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M n s f = l_comb R M m t g", "apply ((erule bexE)+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) -\n                                     Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g t.\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            bij_to g {j. j \\<le> m}\n                             (f ` {j. j \\<le> n}) \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M n s f = l_comb R M m t g", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" in image_sub0,\n       frule_tac f = g and A = \"{j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\" \n       and B = \"f ` {j. j \\<le> n}\" in extend_fun[of _ _ _ \"H\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g t.\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            bij_to g {j. j \\<le> m}\n                             (f ` {j. j \\<le> n}) \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M n s f = l_comb R M m t g", "apply (subgoal_tac \"bij_to g {j. j \\<le> (card (f ` {j. j \\<le> n}) - Suc 0)} \n                                  (f ` {j. j \\<le> n})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        bij_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g t.\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            bij_to g {j. j \\<le> m}\n                             (f ` {j. j \\<le> n}) \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M n s f = l_comb R M m t g\n 2. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                          (f ` {j. j \\<le> n})", "apply (simp add:l_comb_def, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H\\<rbrakk>\n       \\<Longrightarrow> bij_to g\n                          {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                          (f ` {j. j \\<le> n})", "apply (simp add:bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H\\<rbrakk>\n       \\<Longrightarrow> inj_on g\n                          {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}", "apply (cut_tac finite_Collect_le_nat[of n],\n        frule finite_imageI[of \"{j. j \\<le> n}\" f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        finite {na. na \\<le> n}; finite (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> inj_on g\n                          {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}", "apply (rule_tac A = \"f ` {j. j \\<le> n}\" and n = \"card (f ` {j. j \\<le> n}) - \n        Suc 0\" and f = g in Nset2finite_inj, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        finite {na. na \\<le> n}; finite (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n}) =\n                         Suc (card (f ` {j. j \\<le> n}) - Suc 0)\n 2. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        finite {na. na \\<le> n}; finite (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> surj_to g\n                          {i. i \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                          (f ` {j. j \\<le> n})", "using image_Nsetn_card_pos[of f n]"], ["proof (prove)\nusing this:\n  0 < card (f ` {i. i \\<le> n})\n\ngoal (2 subgoals):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        finite {na. na \\<le> n}; finite (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> card (f ` {j. j \\<le> n}) =\n                         Suc (card (f ` {j. j \\<le> n}) - Suc 0)\n 2. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        finite {na. na \\<le> n}; finite (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> surj_to g\n                          {i. i \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                          (f ` {j. j \\<le> n})", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t g.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; Ring R;\n        ideal R (carrier R);\n        t \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                carrier R;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                f ` {j. j \\<le> n};\n        surj_to g {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n         (f ` {j. j \\<le> n});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>k.\n                               t k \\<cdot>\\<^sub>s\n                               g k) (card (f ` {j. j \\<le> n}) - Suc 0);\n        f ` {j. j \\<le> n} \\<subseteq> H;\n        g \\<in> {j. j \\<le> card (f ` {j. j \\<le> n}) - Suc 0} \\<rightarrow>\n                H;\n        finite {na. na \\<le> n}; finite (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> surj_to g\n                          {i. i \\<le> card (f ` {j. j \\<le> n}) - Suc 0}\n                          (f ` {j. j \\<le> n})", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression3_1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {l. l \\<le> (Suc n)} \\<rightarrow> H; s \\<in> {l. l \\<le> (Suc n)} \\<rightarrow> carrier R; \n      (f (Suc n)) \\<notin> f `({l. l \\<le> (Suc n)} - {Suc n})\\<rbrakk> \\<Longrightarrow> \n     \\<exists>g m t. g \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> H \\<and> \n             inj_on g {l. l \\<le> (m::nat)} \\<and> \n             t \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> carrier R \\<and> \n             l_comb R M (Suc n) s f = \n                 l_comb R M m t g \\<and> t m = s (Suc n) \\<and> g m = f (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` ({l. l \\<le> Suc n} - {Suc n})\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s (Suc n) \\<and> g m = f (Suc n)", "apply (cut_tac sc_Ring,\n       frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` ({l. l \\<le> Suc n} - {Suc n}); Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s (Suc n) \\<and> g m = f (Suc n)", "apply (simp add:Nset_pre1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         (\\<exists>t.\n                             t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             l_comb R M (Suc n) s f =\n                             l_comb R M m t g \\<and>\n                             t m = s (Suc n) \\<and> g m = f (Suc n))", "apply (subst l_comb_Suc[of H \"carrier R\" s n f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         (\\<exists>t.\n                             t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             l_comb R M n s f \\<plusminus>\n                             s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                             l_comb R M m t g \\<and>\n                             t m = s (Suc n) \\<and> g m = f (Suc n))", "apply (frule func_pre[of _ _ H], frule func_pre[of _ _ \"carrier R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         (\\<exists>t.\n                             t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             l_comb R M n s f \\<plusminus>\n                             s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                             l_comb R M m t g \\<and>\n                             t m = s (Suc n) \\<and> g m = f (Suc n))", "apply (frule unique_expression2[of H f n s], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     \\<exists>m g t.\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         (\\<exists>t.\n                             t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             l_comb R M n s f \\<plusminus>\n                             s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                             l_comb R M m t g \\<and>\n                             t m = s (Suc n) \\<and> g m = f (Suc n))", "apply ((erule exE)+, (erule conjE)+, simp,\n        thin_tac \"l_comb R M n s f = l_comb R M m t g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ga ma.\n                            ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {l. l \\<le> ma} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {l. l \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga \\<and>\n                                ta ma = s (Suc n) \\<and> ga ma = f (Suc n))", "apply (frule_tac f = g and n = m and A = H and g = \"\\<lambda>k\\<in>{0::nat}. f (Suc n)\"\n         and m = 0 and B = H in jointfun_hom0,\n        simp add:Pi_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ga ma.\n                            ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {l. l \\<le> ma} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {l. l \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga \\<and>\n                                ta ma = s (Suc n) \\<and> ga ma = f (Suc n))", "apply (frule_tac f = t and n = m and A = \"carrier R\" and \n        g = \"\\<lambda>k\\<in>{0::nat}. s (Suc n)\"  and m = 0 and B = \"carrier R\" in \n        jointfun_hom0,\n        simp add:Pi_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ga ma.\n                            ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {l. l \\<le> ma} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {l. l \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga \\<and>\n                                ta ma = s (Suc n) \\<and> ga ma = f (Suc n))", "apply (subgoal_tac \"inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))) \n                       {l. l \\<le> Suc m}\",\n    subgoal_tac \"l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))) \n                             (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\",\n    subgoal_tac \"(jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))) (Suc m) = s (Suc n) \\<and>\n                 (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))) (Suc m) = f (Suc n)\",\n    simp, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n         {l. l \\<le> Suc m};\n        l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n)))\n         (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n                          (Suc m) =\n                         s (Suc n) \\<and>\n                         jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n                          (Suc m) =\n                         f (Suc n)\n 2. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n         {l. l \\<le> Suc m}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n 3. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n                          {l. l \\<le> Suc m}", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n         {l. l \\<le> Suc m}\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n 2. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n                          {l. l \\<le> Suc m}", "apply (frule_tac s = t and n = m and f = g and t = \"\\<lambda>k\\<in>{0}. s (Suc n)\" and\n         m = 0 and g = \"\\<lambda>k\\<in>{0}. f (Suc n)\" in l_comb_jointfun_jj[of H \n        \"carrier R\"], assumption+,\n         simp add:Pi_def, simp,\n         simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n         {l. l \\<le> Suc m};\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               jointfun m t 0\n                                (\\<lambda>k\\<in>{0}. s (Suc n))\n                                j \\<cdot>\\<^sub>s\n                               jointfun m g 0\n                                (\\<lambda>k\\<in>{0}. f (Suc n)) j) m =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n 2. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n                          {l. l \\<le> Suc m}", "apply (simp add:l_comb_def, simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n                          {l. l \\<le> Suc m}", "apply (thin_tac \"jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)) \\<in> {l. l \\<le> Suc m} \\<rightarrow> H\",\n  thin_tac \"jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n)) \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\",\n  thin_tac \"t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\", \n  thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\n                          {l. l \\<le> Suc m}", "apply (rule_tac f = g and n = m and b = \"f (Suc n)\" and B = H in jointfun_inj,\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> m}\n 2. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<notin> g ` {j. j \\<le> m}", "apply (simp add:bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {l. l \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> f ` {l. l \\<le> n}; Ring R; ideal R (carrier R);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<notin> g ` {j. j \\<le> m}", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def,\n         simp add:surj_to_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*\nlemma (in Module) unique_expression3_1:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {l. l \\<le> (Suc n)} \\<rightarrow> H; s \\<in> {l. l \\<le> (Suc n)} \\<rightarrow> carrier R; \n      (f (Suc n)) \\<notin> f `({l. l \\<le> (Suc n)} - {Suc n})\\<rbrakk> \\<Longrightarrow> \n     \\<exists>g m t. g \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> H \\<and> \n             inj_on g {l. l \\<le> (m::nat)} \\<and> \n             t \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> carrier R \\<and> \n             l_comb R M (Suc n) s f = l_comb R M m t g \\<and> \n              t m = s (Suc n)\"\napply (cut_tac sc_Ring,\n       frule Ring.whole_ideal)\napply (simp add:Nset_pre1)\n apply (subst l_comb_Suc[of H \"carrier R\" s n f], assumption+)\n apply (frule func_pre[of _ _ H], frule func_pre[of _ _ \"carrier R\"])\n apply (frule unique_expression2[of H f n s], assumption+)\n apply ((erule exE)+, (erule conjE)+, simp,\n        thin_tac \"l_comb R M n s f = l_comb R M m t g\")\n apply (frule_tac f = g and n = m and A = H and g = \"\\<lambda>k\\<in>{0::nat}. f (Suc n)\"\n         and m = 0 and B = H in jointfun_hom0,\n        rule univar_func_test, rule ballI, simp add:funcset_mem, simp)\n apply (frule_tac f = t and n = m and A = \"carrier R\" and \n        g = \"\\<lambda>k\\<in>{0::nat}. s (Suc n)\"  and m = 0 and B = \"carrier R\" in \n        jointfun_hom0,\n        rule univar_func_test, rule ballI, simp add:funcset_mem, simp)\n apply (subgoal_tac \"inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n))) \n                       {l. l \\<le> Suc m}\",\n    subgoal_tac \"l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))) \n                             (jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)))\",\n    subgoal_tac \"(jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n))) (Suc m) = s (Suc n)\",\n    simp, blast)\n apply (simp add:jointfun_def sliden_def)\n  apply (frule_tac s = t and n = m and f = g and t = \"\\<lambda>k\\<in>{0}. s (Suc n)\" and\n         m = 0 and g = \"\\<lambda>k\\<in>{0}. f (Suc n)\" in l_comb_jointfun_jj[of H \n        \"carrier R\"], assumption+,\n         rule univar_func_test, rule ballI, simp add:funcset_mem, simp,\n         rule univar_func_test, rule ballI, simp add:funcset_mem)\n  apply (simp add:l_comb_def, simp add:jointfun_def sliden_def)\n  apply (thin_tac \"jointfun m g 0 (\\<lambda>k\\<in>{0}. f (Suc n)) \\<in> {l. l \\<le> Suc m} \\<rightarrow> H\",\n  thin_tac \"jointfun m t 0 (\\<lambda>k\\<in>{0}. s (Suc n)) \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R\",\n  thin_tac \"t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\", \n  thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\")\n apply (rule_tac f = g and n = m and b = \"f (Suc n)\" and B = H in jointfun_inj,\n        assumption+)\n  apply (simp add:bij_to_def)\n  apply (unfold bij_to_def, frule conjunct1, fold bij_to_def,\n         simp add:surj_to_def)\ndone     *)"], ["", "lemma (in Module) unique_expression3_2:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> H; s \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> carrier R; \n      l \\<le> (Suc n); (f l) \\<notin> f ` ({k. k \\<le> (Suc n)} - {l}); l \\<noteq> Suc n\\<rbrakk> \\<Longrightarrow> \n    \\<exists>g m t. g \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> H \\<and> inj_on g {l. l \\<le> (m::nat)} \\<and> \n            t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R \\<and> \n            l_comb R M (Suc n) s f = l_comb R M m t g \\<and> \n             t m = s l \\<and> g m = f l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l", "apply (cut_tac sc_Ring,\n       frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l", "apply (subst l_comb_transpos1[of \"carrier R\" H s n f l], assumption+,\n        rule noteq_le_less[of l \"Suc n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n                          (cmp f (transpos l (Suc n))) =\n                         l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l", "apply (cut_tac unique_expression3_1[of H \"cmp f (transpos l (Suc n))\" n \n        \"cmp s (transpos l (Suc n))\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     \\<exists>g m t.\n        g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {l. l \\<le> m} \\<and>\n        t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n         (cmp f (transpos l (Suc n))) =\n        l_comb R M m t g \\<and>\n        t m = cmp s (transpos l (Suc n)) (Suc n) \\<and>\n        g m = cmp f (transpos l (Suc n)) (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {l. l \\<le> m} \\<and>\n                         t \\<in> {l. l \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n                          (cmp f (transpos l (Suc n))) =\n                         l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> H\n 4. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 5. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply ((erule exE)+, (erule conjE)+, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>g m t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n        f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n;\n        Ring R; ideal R (carrier R); g \\<in> {l. l \\<le> m} \\<rightarrow> H;\n        inj_on g {l. l \\<le> m};\n        t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n         (cmp f (transpos l (Suc n))) =\n        l_comb R M m t g;\n        t m = cmp s (transpos l (Suc n)) (Suc n);\n        g m = cmp f (transpos l (Suc n)) (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ga ma.\n                            ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {l. l \\<le> ma} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {l. l \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                l_comb R M m t g =\n                                l_comb R M ma ta ga \\<and>\n                                ta ma = s l \\<and> ga ma = f l)\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> H\n 4. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 5. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (subgoal_tac \"t m = s l \\<and> g m = f l\", blast)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>g m t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n        f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n;\n        Ring R; ideal R (carrier R); g \\<in> {l. l \\<le> m} \\<rightarrow> H;\n        inj_on g {l. l \\<le> m};\n        t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n         (cmp f (transpos l (Suc n))) =\n        l_comb R M m t g;\n        t m = cmp s (transpos l (Suc n)) (Suc n);\n        g m = cmp f (transpos l (Suc n)) (Suc n)\\<rbrakk>\n       \\<Longrightarrow> t m = s l \\<and> g m = f l\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> H\n 4. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 5. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (thin_tac \"l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n         (cmp f (transpos l (Suc n))) = l_comb R M m t g\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>g m t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n        f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n;\n        Ring R; ideal R (carrier R); g \\<in> {l. l \\<le> m} \\<rightarrow> H;\n        inj_on g {l. l \\<le> m};\n        t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        t m = cmp s (transpos l (Suc n)) (Suc n);\n        g m = cmp f (transpos l (Suc n)) (Suc n)\\<rbrakk>\n       \\<Longrightarrow> t m = s l \\<and> g m = f l\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> H\n 4. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 5. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>g m t.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n        f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n;\n        Ring R; ideal R (carrier R); g \\<in> {l. l \\<le> m} \\<rightarrow> H;\n        inj_on g {l. l \\<le> m};\n        t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        t m = s (transpos l (Suc n) (Suc n));\n        g m = f (transpos l (Suc n) (Suc n))\\<rbrakk>\n       \\<Longrightarrow> s (transpos l (Suc n) (Suc n)) = s l \\<and>\n                         f (transpos l (Suc n) (Suc n)) = f l\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> H\n 4. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 5. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (subst transpos_ij_2[of l \"Suc n\" \"Suc n\"], simp+,\n        subst transpos_ij_2[of l \"Suc n\" \"Suc n\"], simp+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> H\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 3. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (rule Pi_I, simp add:cmp_def,\n        frule_tac l = x in transpos_mem[of l \"Suc n\" \"Suc n\"], simp,\n         assumption+, simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp s (transpos l (Suc n))\n                      \\<in> {l. l \\<le> Suc n} \\<rightarrow> carrier R\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (rule Pi_I, simp add:cmp_def,\n        frule_tac l = x in transpos_mem[of l \"Suc n\" \"Suc n\"], simp,\n         assumption+, simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (frule_tac i = l and n = \"Suc n\" and j = \"Suc n\" in transpos_hom,\n           simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (frule cmp_fun_sub_image[of \"transpos l (Suc n)\" \"{i. i \\<le> Suc n}\" \n       \"{i. i \\<le> Suc n}\" f H \"{l. l \\<le> Suc n} - {Suc n}\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> {l. l \\<le> Suc n} - {Suc n}\n                      \\<subseteq> {i. i \\<le> Suc n}\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - {Suc n}) =\n     f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n})\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - {Suc n}) =\n     f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n})\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> cmp f (transpos l (Suc n)) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - {Suc n}) =\n     f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n})\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> f `\n                               transpos l (Suc n) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (frule_tac i = l and n = \"Suc n\" and j = \"Suc n\" in transpos_inj,\n              simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - {Suc n}) =\n     f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n});\n     inj_on (transpos l (Suc n)) {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> f `\n                               transpos l (Suc n) `\n                               ({l. l \\<le> Suc n} - {Suc n})", "apply (subst injfun_elim_image[of \"transpos l (Suc n)\" \"{i. i \\<le> Suc n}\"\n        \"{i. i \\<le> Suc n}\" \"Suc n\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - {Suc n}) =\n     f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n});\n     inj_on (transpos l (Suc n)) {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> f `\n                               (transpos l (Suc n) ` {i. i \\<le> Suc n} -\n                                {transpos l (Suc n) (Suc n)})", "apply (thin_tac \"cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - \n            {Suc n}) = f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n})\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos l (Suc n)) {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> f `\n                               (transpos l (Suc n) ` {i. i \\<le> Suc n} -\n                                {transpos l (Suc n) (Suc n)})", "apply (frule_tac i = l and n = \"Suc n\" and j = \"Suc n\" in \n              transpos_surjec, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos l (Suc n)) {i. i \\<le> Suc n};\n     surj_to (transpos l (Suc n)) {i. i \\<le> Suc n}\n      {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos l (Suc n)) (Suc n)\n                      \\<notin> f `\n                               (transpos l (Suc n) ` {i. i \\<le> Suc n} -\n                                {transpos l (Suc n) (Suc n)})", "apply (simp add:surj_to_def cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n; Ring R;\n     ideal R (carrier R);\n     transpos l (Suc n)\n     \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n     inj_on (transpos l (Suc n)) {i. i \\<le> Suc n};\n     transpos l (Suc n) ` {i. i \\<le> Suc n} = {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> f (transpos l (Suc n) (Suc n))\n                      \\<notin> f `\n                               ({i. i \\<le> Suc n} -\n                                {transpos l (Suc n) (Suc n)})", "apply (simp add:transpos_ij_2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*\nlemma (in Module) unique_expression3_2:\"\\<lbrakk>H \\<subseteq> carrier M; \n      f \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> H; s \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> carrier R; \n      l \\<le> (Suc n); (f l) \\<notin> f ` ({k. k \\<le> (Suc n)} - {l}); l \\<noteq> Suc n\\<rbrakk> \\<Longrightarrow> \n    \\<exists>g m t. g \\<in> {l. l \\<le> (m::nat)} \\<rightarrow> H \\<and> inj_on g {l. l \\<le> (m::nat)} \\<and> \n            t \\<in> {l. l \\<le> m} \\<rightarrow> carrier R \\<and> \n            l_comb R M (Suc n) s f = l_comb R M m t g \\<and> t m = s l\"\napply (cut_tac sc_Ring,\n       frule Ring.whole_ideal)\n apply (subst l_comb_transpos1[of \"carrier R\" H s n f l], assumption+,\n        rule noteq_le_less[of l \"Suc n\"], assumption+) \n apply (cut_tac unique_expression3_1[of H \"cmp f (transpos l (Suc n))\" n \n        \"cmp s (transpos l (Suc n))\"])\n apply ((erule exE)+, (erule conjE)+, simp)\n apply (subgoal_tac \"t m = s l\", blast)\n apply (thin_tac \"l_comb R M (Suc n) (cmp s (transpos l (Suc n)))\n         (cmp f (transpos l (Suc n))) = l_comb R M m t g\")\n apply (simp add:cmp_def)\n apply (subst transpos_ij_2[of l \"Suc n\" \"Suc n\"], assumption+,\n        simp, assumption, simp, assumption)\n apply (rule univar_func_test, rule ballI, simp add:cmp_def,\n        frule_tac l = x in transpos_mem[of l \"Suc n\" \"Suc n\"], simp,\n         assumption+, simp add:funcset_mem)\n apply (rule univar_func_test, rule ballI, simp add:cmp_def,\n        frule_tac l = x in transpos_mem[of l \"Suc n\" \"Suc n\"], simp,\n         assumption+, simp add:funcset_mem)\n apply (frule_tac i = l and n = \"Suc n\" and j = \"Suc n\" in transpos_hom,\n           simp, assumption)\n apply (frule cmp_fun_sub_image[of \"transpos l (Suc n)\" \"{i. i \\<le> Suc n}\" \n       \"{i. i \\<le> Suc n}\" f H \"{l. l \\<le> Suc n} - {Suc n}\"], assumption+)\n       apply (rule subsetI, simp)\n       apply simp\n       apply (frule_tac i = l and n = \"Suc n\" and j = \"Suc n\" in transpos_inj,\n              simp, assumption+)\n       apply (subst injfun_elim_image[of \"transpos l (Suc n)\" \"{i. i \\<le> Suc n}\"\n        \"{i. i \\<le> Suc n}\" \"Suc n\"], assumption+, simp)\n       apply (thin_tac \"cmp f (transpos l (Suc n)) ` ({l. l \\<le> Suc n} - \n            {Suc n}) = f ` transpos l (Suc n) ` ({l. l \\<le> Suc n} - {Suc n})\")\n       apply (frule_tac i = l and n = \"Suc n\" and j = \"Suc n\" in \n              transpos_surjec, simp, assumption+)\n       apply (simp add:surj_to_def cmp_def)\n    apply (simp add:transpos_ij_2)\ndone  *)"], ["", "lemma (in Module) unique_expression3:\n   \"\\<lbrakk>H \\<subseteq> carrier M; f \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> (Suc n)} \\<rightarrow> carrier R; l \\<le> (Suc n);\n    (f l) \\<notin> f ` ({k. k \\<le> (Suc n)} - {l})\\<rbrakk> \\<Longrightarrow> \n   \\<exists>g m t. g \\<in> {k. k \\<le> (m::nat)} \\<rightarrow> H \\<and> \n        inj_on g {k. k \\<le> m} \\<and> \n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and> \n        l_comb R M (Suc n) s f = l_comb R M m t g \\<and> t m = s l \\<and> g m = f l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l})\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l", "apply (case_tac \"l = Suc n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n     f (Suc n) \\<notin> f ` ({k. k \\<le> Suc n} - {Suc n});\n     l = Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         (\\<exists>t.\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             l_comb R M (Suc n) s f =\n                             l_comb R M m t g \\<and>\n                             t m = s (Suc n) \\<and> g m = f (Suc n))\n 2. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l", "apply (cut_tac unique_expression3_1[of H f n s], blast,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R; l \\<le> Suc n;\n     f l \\<notin> f ` ({k. k \\<le> Suc n} - {l}); l \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g m t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                         t m = s l \\<and> g m = f l", "apply (rule unique_expression3_2[of H f n s l], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression4:\"free_generator R M H \\<Longrightarrow>\n     f \\<in> {k. k \\<le> (n::nat)} \\<rightarrow> H \\<and> inj_on f {k. k \\<le> n} \\<and> \n     s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and> l_comb R M n s f \\<noteq> \\<zero>  \\<longrightarrow> \n(\\<exists>m g t. (g \\<in> {k. k \\<le> m} \\<rightarrow> H) \\<and> inj_on g {k. k \\<le> m} \\<and> \n        (g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n}) \\<and> (t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R) \\<and>\n        (\\<forall>l \\<in> {k. k \\<le> m}. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> l_comb R M n s f = l_comb R M m t g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. free_generator R M H \\<Longrightarrow>\n    f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n    inj_on f {k. k \\<le> n} \\<and>\n    s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n    l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n    (\\<exists>m g t.\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {k. k \\<le> m} \\<and>\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n        (\\<forall>l\\<in>{k. k \\<le> m}.\n            t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        l_comb R M n s f = l_comb R M m t g)", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; Ring R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n                      inj_on f {k. k \\<le> n} \\<and>\n                      s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n                      l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n                      (\\<exists>m g t.\n                          g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                          inj_on g {k. k \\<le> m} \\<and>\n                          g ` {k. k \\<le> m}\n                          \\<subseteq> f ` {k. k \\<le> n} \\<and>\n                          t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                  carrier R \\<and>\n                          (\\<forall>l\\<in>{k. k \\<le> m}.\n                              t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                          l_comb R M n s f = l_comb R M m t g)", "apply (frule free_generator_sub[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n                      inj_on f {k. k \\<le> n} \\<and>\n                      s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n                      l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n                      (\\<exists>m g t.\n                          g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                          inj_on g {k. k \\<le> m} \\<and>\n                          g ` {k. k \\<le> m}\n                          \\<subseteq> f ` {k. k \\<le> n} \\<and>\n                          t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                  carrier R \\<and>\n                          (\\<forall>l\\<in>{k. k \\<le> m}.\n                              t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                          l_comb R M n s f = l_comb R M m t g)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {k. k \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on f {k. k \\<le> 0} \\<and>\n                      s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R \\<and>\n                      l_comb R M 0 s f \\<noteq> \\<zero> \\<longrightarrow>\n                      (\\<exists>m g t.\n                          g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                          inj_on g {k. k \\<le> m} \\<and>\n                          g ` {k. k \\<le> m}\n                          \\<subseteq> f ` {k. k \\<le> 0} \\<and>\n                          t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                  carrier R \\<and>\n                          (\\<forall>l\\<in>{k. k \\<le> m}.\n                              t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                          l_comb R M 0 s f = l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> 0} \\<rightarrow> H; inj_on f {k. k \\<le> 0};\n     s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R;\n     l_comb R M 0 s f \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         g ` {k. k \\<le> m}\n                         \\<subseteq> f ` {k. k \\<le> 0} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         (\\<forall>l\\<in>{k. k \\<le> m}.\n                             t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M 0 s f = l_comb R M m t g\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (frule has_free_generator_nonzeroring[of H])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> 0} \\<rightarrow> H; inj_on f {k. k \\<le> 0};\n     s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R;\n     l_comb R M 0 s f \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>p\\<in>linear_span R M (carrier R) H.\n                         p \\<noteq> \\<zero>\n 2. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> 0} \\<rightarrow> H; inj_on f {k. k \\<le> 0};\n     s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R;\n     l_comb R M 0 s f \\<noteq> \\<zero>; \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         g ` {k. k \\<le> m}\n                         \\<subseteq> f ` {k. k \\<le> 0} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         (\\<forall>l\\<in>{k. k \\<le> m}.\n                             t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M 0 s f = l_comb R M m t g\n 3. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (frule Ring.whole_ideal,\n         frule_tac s = s and n = 0 and f = f in \n             l_comb_mem_linear_span[of \"carrier R\" H], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> 0} \\<rightarrow> H; inj_on f {k. k \\<le> 0};\n     s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R;\n     l_comb R M 0 s f \\<noteq> \\<zero>; ideal R (carrier R);\n     l_comb R M 0 s f \\<in> linear_span R M (carrier R) H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>p\\<in>linear_span R M (carrier R) H.\n                         p \\<noteq> \\<zero>\n 2. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> 0} \\<rightarrow> H; inj_on f {k. k \\<le> 0};\n     s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R;\n     l_comb R M 0 s f \\<noteq> \\<zero>; \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         g ` {k. k \\<le> m}\n                         \\<subseteq> f ` {k. k \\<le> 0} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         (\\<forall>l\\<in>{k. k \\<le> m}.\n                             t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M 0 s f = l_comb R M m t g\n 3. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f \\<in> {k. k \\<le> 0} \\<rightarrow> H; inj_on f {k. k \\<le> 0};\n     s \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R;\n     l_comb R M 0 s f \\<noteq> \\<zero>; \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g t.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         g ` {k. k \\<le> m}\n                         \\<subseteq> f ` {k. k \\<le> 0} \\<and>\n                         t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         (\\<forall>l\\<in>{k. k \\<le> m}.\n                             t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M 0 s f = l_comb R M m t g\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f 0 \\<in> H; s 0 \\<in> carrier R;\n     s 0 \\<cdot>\\<^sub>s f 0 \\<noteq> \\<zero>; \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m g.\n                         g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {k. k \\<le> m} \\<and>\n                         g ` {k. k \\<le> m} \\<subseteq> {f 0} \\<and>\n                         (\\<exists>t.\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<le>m.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             s 0 \\<cdot>\\<^sub>s f 0 =\n                             \\<Sigma>\\<^sub>e M (\\<lambda>j.\n              t j \\<cdot>\\<^sub>s g j) m)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (subgoal_tac \"f \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> H \\<and> \n        inj_on f {j. j \\<le> 0} \\<and> f ` {j. j \\<le> 0} \\<subseteq> f ` {0} \\<and> \n        s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and> (\\<forall>l \\<le> 0. s l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>  \n        s 0 \\<cdot>\\<^sub>s (f 0) = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (f j)) 0\",\n        (erule conjE)+, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f 0 \\<in> H; s 0 \\<in> carrier R;\n     s 0 \\<cdot>\\<^sub>s f 0 \\<noteq> \\<zero>; \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                      inj_on f {j. j \\<le> 0} \\<and>\n                      f ` {j. j \\<le> 0} \\<subseteq> f ` {0} \\<and>\n                      s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n                      (\\<forall>l\\<le>0.\n                          s l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      s 0 \\<cdot>\\<^sub>s f 0 =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s f j) 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f 0 \\<in> H; s 0 \\<in> carrier R;\n     s 0 \\<cdot>\\<^sub>s f 0 \\<noteq> \\<zero>; \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n     f 0 \\<in> H; \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R;\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f 0 \\<noteq> \\<zero>;\n     \\<not> zeroring R; s 0 = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (cut_tac m = \"f 0\" in sc_0_m,\n           simp add:Pi_def subsetD, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n                         inj_on f {k. k \\<le> Suc n} \\<and>\n                         s \\<in> {k. k \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M (Suc n) s f \\<noteq>\n                         \\<zero> \\<longrightarrow>\n                         (\\<exists>m g t.\n                             g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                             inj_on g {k. k \\<le> m} \\<and>\n                             g ` {k. k \\<le> m}\n                             \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                             t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                     carrier R \\<and>\n                             (\\<forall>l\\<in>{k. k \\<le> m}.\n                                 t l \\<noteq>\n                                 \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                             l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g);\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> Suc n} \\<and>\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc n) s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g t.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            (\\<forall>l\\<in>{k. k \\<le> m}.\n                                t l \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        f \\<in> {k. k \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {k. k \\<le> n} \\<and>\n        s \\<in> {k. k \\<le> n} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g t.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n            (\\<forall>l\\<in>{k. k \\<le> m}.\n                t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            l_comb R M n s f = l_comb R M m t g);\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g t.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            t \\<in> {k. k \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            (\\<forall>l\\<in>{k. k \\<le> m}.\n                                t l \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g", "apply (frule func_pre[of _ _ H],\n        frule_tac f = f and A = \"{k. k \\<le> Suc n}\" and ?A1.0 = \"{k. k \\<le> n}\" in\n        restrict_inj, rule subsetI, simp,\n        frule func_pre[of _ _ \"carrier R\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; H \\<subseteq> carrier M;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M (Suc n) s f = l_comb R M m t g)", "apply (frule free_generator_sub[of H], \n         simp add:l_comb_Suc[of H \"carrier R\" s _ f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (case_tac \"s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\n                                f (Suc n) =\n                                l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (frule_tac x = \"Suc n\" and f = f and A = \"{k. k \\<le> Suc n}\" and\n              B = H in funcset_mem, simp,\n             frule_tac c = \"f (Suc n)\" in subsetD[of H \"carrier M\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\n                                f (Suc n) =\n                                l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (frule_tac m = \"f (Suc n)\" in sc_0_m, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus> \\<zero> \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f (Suc n) =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus> \\<zero> =\n                                l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (frule_tac n = n in l_comb_mem[of \"carrier R\" H s _ f],\n               assumption+, simp add:ag_r_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        \\<exists>m g.\n           g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {k. k \\<le> m} \\<and>\n           g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n           (\\<exists>t.\n               t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n               (\\<forall>l\\<le>m.\n                   t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n               l_comb R M n s f = l_comb R M m t g);\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f (Suc n) = \\<zero>;\n        l_comb R M n s f \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f = l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply ((erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f (Suc n) = \\<zero>;\n        l_comb R M n s f \\<in> carrier M;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        \\<exists>t.\n           t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n           (\\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f = l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (frule_tac f = f and A = \"{k. k \\<le> Suc n}\" and B = H and \n          ?A1.0 = \"{k. k \\<le> n}\" and ?A2.0 = \"{k. k \\<le> Suc n}\" in im_set_mono,\n          rule subsetI, simp, simp,\n          frule_tac A = \"g ` {k. k \\<le> m}\" and B = \"f ` {k. k \\<le> n}\" and \n          C = \"f ` {k. k \\<le> Suc n}\" in subset_trans, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) = \\<zero>\\<^bsub>R\\<^esub>;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f (Suc n) = \\<zero>;\n        l_comb R M n s f \\<in> carrier M;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        \\<exists>t.\n           t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n           (\\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           l_comb R M n s f = l_comb R M m t g;\n        f ` {k. k \\<le> n} \\<subseteq> f ` {k. k \\<le> Suc n};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f = l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (case_tac \"l_comb R M n s f = \\<zero>\\<^bsub>M\\<^esub>\", simp,\n         frule_tac x = \"Suc n\" and f = s and A = \"{k. k \\<le> Suc n}\" and \n            B = \"carrier R\" in funcset_mem, simp,\n         frule_tac x = \"Suc n\" and f = f and A = \"{k. k \\<le> Suc n}\" and \n         B = H in funcset_mem, simp,\n         frule_tac c = \"f (Suc n)\" in subsetD[of H \"carrier M\"], assumption+,\n         frule_tac a = \"s (Suc n)\" and m = \"f (Suc n)\" in sc_mem, assumption+,\n         simp add:ag_l_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f = \\<zero>; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (subgoal_tac \"(\\<lambda>j\\<in>{0::nat}. f (Suc n)) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> H \\<and> \n     inj_on (\\<lambda>j\\<in>{0::nat}. f (Suc n)) {j. j \\<le> (0::nat)} \\<and> \n     (\\<lambda>j\\<in>{0::nat}. f (Suc n)) ` {j. j \\<le> (0::nat)} \\<subseteq>  f  ` {k. k \\<le> (Suc n)} \\<and> \n      (\\<lambda>j\\<in>{0::nat}. s (Suc n))\\<in> {k. k \\<le> 0} \\<rightarrow> carrier R \\<and> \n      (\\<forall>l\\<le>0. (\\<lambda>j\\<in>{0::nat}. s (Suc n)) l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) = \n           l_comb R M 0 (\\<lambda>j\\<in>{0::nat}. s (Suc n)) (\\<lambda>j\\<in>{0::nat}. f (Suc n))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f = \\<zero>; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M;\n        (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n        inj_on (\\<lambda>j\\<in>{0}. f (Suc n)) {j. j \\<le> 0} \\<and>\n        (\\<lambda>j\\<in>{0}. f (Suc n)) ` {j. j \\<le> 0}\n        \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n        (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R \\<and>\n        (\\<forall>l\\<le>0.\n            (\\<lambda>j\\<in>{0}. s (Suc n)) l \\<noteq>\n            \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        l_comb R M 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n         (\\<lambda>j\\<in>{0}. f (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f = \\<zero>; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>{0}. f (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                         inj_on (\\<lambda>j\\<in>{0}. f (Suc n))\n                          {j. j \\<le> 0} \\<and>\n                         (\\<lambda>j\\<in>{0}. f (Suc n)) ` {j. j \\<le> 0}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<lambda>j\\<in>{0}. s (Suc n))\n                         \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R \\<and>\n                         (\\<forall>l\\<le>0.\n                             (\\<lambda>j\\<in>{0}. s (Suc n)) l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                          (\\<lambda>j\\<in>{0}. f (Suc n))\n 3. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply ((erule conjE)+, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f = \\<zero>; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>{0}. f (Suc n))\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                         inj_on (\\<lambda>j\\<in>{0}. f (Suc n))\n                          {j. j \\<le> 0} \\<and>\n                         (\\<lambda>j\\<in>{0}. f (Suc n)) ` {j. j \\<le> 0}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<lambda>j\\<in>{0}. s (Suc n))\n                         \\<in> {k. k \\<le> 0} \\<rightarrow> carrier R \\<and>\n                         (\\<forall>l\\<le>0.\n                             (\\<lambda>j\\<in>{0}. s (Suc n)) l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                          (\\<lambda>j\\<in>{0}. f (Suc n))\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq> \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f = \\<zero>; s (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> H; f (Suc n) \\<in> carrier M;\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                          (\\<lambda>j\\<in>{0}. f (Suc n))\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        l_comb R M n s f \\<noteq> \\<zero> \\<longrightarrow>\n        (\\<exists>m g.\n            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {k. k \\<le> m} \\<and>\n            g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n            (\\<exists>t.\n                t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n                (\\<forall>l\\<le>m.\n                    t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                l_comb R M n s f = l_comb R M m t g));\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R;\n        \\<exists>m g.\n           g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {k. k \\<le> m} \\<and>\n           g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n} \\<and>\n           (\\<exists>t.\n               t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R \\<and>\n               (\\<forall>l\\<le>m.\n                   t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n               l_comb R M n s f = l_comb R M m t g);\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>m g.\n                            g \\<in> {k. k \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {k. k \\<le> m} \\<and>\n                            g ` {k. k \\<le> m}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>t.\n                                t \\<in> {k. k \\<le> m} \\<rightarrow>\n  carrier R \\<and>\n                                (\\<forall>l\\<le>m.\n                                    t l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M n s f \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M m t g)", "apply ((erule exE)+, (erule conjE)+, erule exE, (erule conjE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M m t g \\<plusminus>\n        s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq>\n        \\<zero>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M m t g \\<noteq> \\<zero>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ma ga.\n                            ga \\<in> {k. k \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {k. k \\<le> ma} \\<and>\n                            ga ` {k. k \\<le> ma}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {k. k \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                (\\<forall>l\\<le>ma.\n                                    ta l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga)", "apply (thin_tac \"l_comb R M m t g \\<noteq> \\<zero>\",\n        thin_tac \"l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) \\<noteq> \\<zero>\",\n        thin_tac \"l_comb R M n s f = l_comb R M m t g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ma ga.\n                            ga \\<in> {k. k \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {k. k \\<le> ma} \\<and>\n                            ga ` {k. k \\<le> ma}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {k. k \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                (\\<forall>l\\<le>ma.\n                                    ta l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga)", "apply (frule_tac f = g and n = m and A = H and g = \"\\<lambda>j\\<in>{0::nat}. f (Suc n)\"\n        and m = 0 and B = H in jointfun_hom,\n        rule Pi_I, simp add:Pi_def,\n        frule_tac f = t and n = m and A = \"carrier R\" and \n         g = \"\\<lambda>j\\<in>{0::nat}. s (Suc n)\" and m = 0 and B = \"carrier R\" in \n         jointfun_hom, simp add:Pi_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ma ga.\n                            ga \\<in> {k. k \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {k. k \\<le> ma} \\<and>\n                            ga ` {k. k \\<le> ma}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {k. k \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                (\\<forall>l\\<le>ma.\n                                    ta l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga)", "apply (subgoal_tac \"inj_on (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n    {k. k \\<le> Suc m} \\<and> \n (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))) ` {k. k \\<le> Suc m} \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n (\\<forall>l \\<le> (Suc m). (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))) l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n    l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                            (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        inj_on (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n         {k. k \\<le> Suc m} \\<and>\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) ` {k. k \\<le> Suc m}\n        \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n        (\\<forall>l\\<le>Suc m.\n            jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)) l \\<noteq>\n            \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n         (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ma ga.\n                            ga \\<in> {k. k \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {k. k \\<le> ma} \\<and>\n                            ga ` {k. k \\<le> ma}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {k. k \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                (\\<forall>l\\<le>ma.\n                                    ta l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga)\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n                          {k. k \\<le> Suc m} \\<and>\n                         jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        inj_on (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n         {k. k \\<le> Suc m};\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) ` {k. k \\<le> Suc m}\n        \\<subseteq> f ` {k. k \\<le> Suc n};\n        \\<forall>l\\<le>Suc m.\n           jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)) l \\<noteq>\n           \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M m t g \\<plusminus> s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n        l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n         (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ma ga.\n                            ga \\<in> {k. k \\<le> ma} \\<rightarrow> H \\<and>\n                            inj_on ga {k. k \\<le> ma} \\<and>\n                            ga ` {k. k \\<le> ma}\n                            \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                            (\\<exists>ta.\n                                ta \\<in> {k. k \\<le> ma} \\<rightarrow>\n   carrier R \\<and>\n                                (\\<forall>l\\<le>ma.\n                                    ta l \\<noteq>\n                                    \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                                l_comb R M m t g \\<plusminus>\n                                s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                                l_comb R M ma ta ga)\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n                          {k. k \\<le> Suc m} \\<and>\n                         jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n                          {k. k \\<le> Suc m} \\<and>\n                         jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> inj_on\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))\n                          {k. k \\<le> Suc m}\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (rule_tac f = g and n = m and b = \"f (Suc n)\" and B = H in \n         jointfun_inj, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<notin> g ` {j. j \\<le> m}\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (frule_tac c = \"f (Suc n)\" and A = \"g ` {k. k \\<le> m}\" and \n       B = \"f ` {k. k \\<le> n}\" in subsetD, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> g ` {j. j \\<le> m};\n        f (Suc n) \\<in> f ` {k. k \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (thin_tac \"inj_on f {k. k \\<le> n}\",\n         thin_tac \"g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n}\",\n         thin_tac \"f (Suc n) \\<in> g ` {j. j \\<le> m}\", simp add:image_def,\n         erule exE, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t x.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        x \\<le> n; f (Suc n) = f x\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (simp add:inj_on_def,\n         drule_tac a = \"Suc n\" in forall_spec, simp,\n         thin_tac \"\\<forall>x\\<le>m. \\<forall>y\\<le>m. g x = g y \\<longrightarrow> x = y\",\n         thin_tac \"\\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\",\n         drule_tac a = x in forall_spec, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                         {k. k \\<le> Suc m}\n                         \\<subseteq> f ` {k. k \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (rule conjI, rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t x.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        x \\<in> jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) `\n                {k. k \\<le> Suc m}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> f ` {k. k \\<le> Suc n}\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (simp add:image_def, erule exE, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        xa \\<le> Suc m;\n        x = jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>Suc n. x = f xa\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (case_tac \"xa = Suc m\", simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        (\\<lambda>i.\n            if i \\<le> m then g i\n            else (\\<lambda>j\\<in>{0}. f (Suc n)) (sliden (Suc m) i))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        (\\<lambda>i.\n            if i \\<le> m then t i\n            else (\\<lambda>j\\<in>{0}. s (Suc n)) (sliden (Suc m) i))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        x = f (Suc n); xa = Suc m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>Suc n. f (Suc n) = f x\n 2. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        xa \\<le> Suc m;\n        x = jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) xa;\n        xa \\<noteq> Suc m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>Suc n. x = f xa\n 3. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (cut_tac n = \"Suc n\" in Nat.le_refl, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        xa \\<le> Suc m;\n        x = jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) xa;\n        xa \\<noteq> Suc m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>Suc n. x = f xa\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (frule_tac m = xa and n = \"Suc m\" in noteq_le_less, assumption,\n            thin_tac \"xa \\<le> Suc m\",\n            frule_tac x = xa and n = \"Suc m\" in less_le_diff,\n            thin_tac \"xa < Suc m\", simp,\n      thin_tac \"jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) \\<in> {j. j \\<le> Suc m} \\<rightarrow> H\",\n  thin_tac \"jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)) \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\",\n  simp add:jointfun_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; x = g xa;\n        xa \\<le> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>Suc n. g xa = f x\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (subgoal_tac \"g xa \\<in> {y. \\<exists>x\\<le>n. y = f x}\", simp, erule exE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m g t x xa xb.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; x = g xa;\n        xa \\<le> m; xb \\<le> n \\<and> g xa = f xb\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<le>Suc n. g xa = f x\n 2. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; x = g xa;\n        xa \\<le> m\\<rbrakk>\n       \\<Longrightarrow> g xa \\<in> {y. \\<exists>x\\<le>n. y = f x}\n 3. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (erule conjE, frule_tac i = xb and j = n and k = \"Suc n\" in\n         le_trans, simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t x xa.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        {y. \\<exists>x\\<le>m. y = g x}\n        \\<subseteq> {y. \\<exists>x\\<le>n. y = f x};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; x = g xa;\n        xa \\<le> m\\<rbrakk>\n       \\<Longrightarrow> g xa \\<in> {y. \\<exists>x\\<le>n. y = f x}\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (rule_tac c = \"g xa\" and A = \"{y. \\<exists>x\\<le>m. y = g x}\" and \n         B = \"{y. \\<exists>x\\<le>n. y = f x}\" in subsetD, assumption+,\n         simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>Suc m.\n                             jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                              l \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (rule conjI, rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t l.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        l \\<le> Suc m\\<rbrakk>\n       \\<Longrightarrow> jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                          l \\<noteq>\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (case_tac \"l = Suc m\", simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m g t l.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R;\n        l \\<le> Suc m; l \\<noteq> Suc m\\<rbrakk>\n       \\<Longrightarrow> jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                          l \\<noteq>\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (frule_tac m = l and n = \"Suc m\" in noteq_le_less, assumption,\n            thin_tac \"l \\<le> Suc m\",\n            frule_tac x = l and n = \"Suc m\" in less_le_diff,\n            thin_tac \"l < Suc m\", simp,\n  thin_tac \"jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)) \\<in> {j. j \\<le> Suc m} \\<rightarrow> H\",\n  thin_tac \"jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)) \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\",\n   simp add:jointfun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n)))\n                          (jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n)))", "apply (simp add:l_comb_def,\n        subst l_comb_jointfun_jj[of H \"carrier R\"], assumption+,\n        simp add:Pi_def,\n        simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m g t.\n       \\<lbrakk>free_generator R M H; Ring R;\n        f \\<in> {k. k \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {k. k \\<le> Suc n};\n        s \\<in> {k. k \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {k. k \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; ideal R (carrier R);\n        H \\<subseteq> carrier M;\n        s (Suc n) \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        g ` {k. k \\<le> m} \\<subseteq> f ` {k. k \\<le> n};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> H;\n        jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n        \\<in> {j. j \\<le> Suc m} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s g j) m \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n) =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s g j) m \\<plusminus>\n                         jointfun m t 0 (\\<lambda>j\\<in>{0}. s (Suc n))\n                          (Suc m) \\<cdot>\\<^sub>s\n                         jointfun m g 0 (\\<lambda>j\\<in>{0}. f (Suc n))\n                          (Suc m)", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_prepression5_0:\"\\<lbrakk>free_generator R M H; \n       f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n       s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; g \\<in> {j. j \\<le> m} \\<rightarrow> H; \n       inj_on g {j. j \\<le> m}; t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; \n       l_comb R M n s f = l_comb R M m t g;\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n       f n \\<notin> g ` {j. j \\<le> m}; 0 < n\\<rbrakk>  \\<Longrightarrow> False\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n\\<rbrakk>\n    \\<Longrightarrow> False", "apply (cut_tac sc_Ring,\n       frule Ring.ring_is_ag,\n       frule Ring.whole_ideal,\n       frule free_generator_sub[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> False", "apply (cut_tac l_comb_Suc[of H \"carrier R\" s \"n - Suc 0\" f],\n         simp,\n         thin_tac \"l_comb R M n s f = l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus>\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule free_generator_sub[of H],\n         frule l_comb_mem[of \"carrier R\" H t m g], assumption+,\n         frule l_comb_mem[of \"carrier R\" H s \"n - Suc 0\" f], assumption+,\n         rule func_pre, simp, rule func_pre, simp,\n         cut_tac sc_mem[of \"s n\" \"f n\"])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule ag_pOp_closed[of \"l_comb R M (n - Suc 0) s f\" \"s n \\<cdot>\\<^sub>s f n\"],\n          assumption+,\n         frule ag_mOp_closed[of \"l_comb R M (n - Suc 0) s f\"])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule ag_pOp_add_l[of \"l_comb R M m t g\" \"l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\" \"-\\<^sub>a (l_comb R M (n - Suc 0) s f)\"], assumption+,\n        thin_tac \"l_comb R M m t g = l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\")"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M; H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus>\n     (l_comb R M (n - Suc 0) s f \\<plusminus>\n      s n \\<cdot>\\<^sub>s f n)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (simp add:ag_pOp_assoc[THEN sym, of \"-\\<^sub>a (l_comb R M (n - Suc 0) s f)\"\n         \"l_comb R M (n - Suc 0) s f\" \"s n \\<cdot>\\<^sub>s f n\"],\n         simp add:ag_l_inv1 ag_l_zero)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (cut_tac func_pre[of f \"n - Suc 0\" H],\n         cut_tac func_pre[of s \"n - Suc 0\" \"carrier R\"])"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule linear_span_iOp_closedTr2[of \"carrier R\" \"H\" f \"n - Suc 0\" s],\n         assumption+)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f =\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (simp, \n          thin_tac \"-\\<^sub>a (l_comb R M (n - Suc 0) s f) =\n         l_comb R M (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) f\")"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) \n         \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (simp add:l_comb_add[THEN sym, of \"carrier R\" H\n          \"\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)\" \"n - Suc 0\" f t m g],\n        thin_tac \"l_comb R M m t g \\<in> carrier M\",\n        thin_tac \"l_comb R M (n - Suc 0) s f \\<in> carrier M\",\n        thin_tac \"l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n \\<in> carrier M\",\n        thin_tac \"l_comb R M (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) f\n         \\<in> carrier M\")"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule jointfun_hom[of f \"n - Suc 0\" H g m H], assumption+,\n         frule jointfun_hom[of \"\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)\" \"n - Suc 0\"\n          \"carrier R\" t m \"carrier R\"], assumption+, simp)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "(* to apply unique_expression3_1, we show\n     f n \\<notin> (jointfun (n - Suc 0) f m g) ` {j. j \\<le> n + m} *)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule im_jointfun[of f \"n - Suc 0\" H g m H], assumption+)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "apply (frule unique_expression3_1[of H \n  \"jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0::nat}. (f n))\"\n  \"n + m\"\n  \"jointfun (n + m) (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) \n  m t) 0 (\\<lambda>x\\<in>{0::nat}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n))\"])"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n)\n                      \\<in> {l. l \\<le> Suc (n + m)} \\<rightarrow> H\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m)\n                       (jointfun (n - Suc 0)\n                         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                         m t)\n                       0 (\\<lambda>x\\<in>{0}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                      \\<in> {l. l \\<le> Suc (n + m)} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\n                      \\<notin> jointfun (n + m) (jointfun (n - Suc 0) f m g)\n                                0 (\\<lambda>x\\<in>{0}. f n) `\n                               ({l. l \\<le> Suc (n + m)} - {Suc (n + m)})\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> H \\<subseteq> carrier M\nA total of 13 subgoals...", "apply (rule Pi_I,\n        case_tac \"x \\<le> (n + m)\", simp,\n        simp add:jointfun_def[of \"n+m\"], simp add:Pi_def,\n        simp add:jointfun_def[of \"n+m\"] sliden_def, simp add:Pi_def)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m)\n                       (jointfun (n - Suc 0)\n                         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                         m t)\n                       0 (\\<lambda>x\\<in>{0}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                      \\<in> {l. l \\<le> Suc (n + m)} \\<rightarrow> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\n                      \\<notin> jointfun (n + m) (jointfun (n - Suc 0) f m g)\n                                0 (\\<lambda>x\\<in>{0}. f n) `\n                               ({l. l \\<le> Suc (n + m)} - {Suc (n + m)})\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> ideal R (carrier R)\nA total of 12 subgoals...", "apply (rule Pi_I,\n        case_tac \"x \\<le> (n + m)\", simp,\n        simp add:jointfun_def[of \"n+m\"], simp add:Pi_def)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        x \\<in> {l. l \\<le> Suc (n + m)}; \\<not> x \\<le> n + m\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          x\n                         \\<in> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\n                      \\<notin> jointfun (n + m) (jointfun (n - Suc 0) f m g)\n                                0 (\\<lambda>x\\<in>{0}. f n) `\n                               ({l. l \\<le> Suc (n + m)} - {Suc (n + m)})\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> ideal R (carrier R)\nA total of 12 subgoals...", "apply (simp add:jointfun_def[of \"n+m\"] sliden_def,\n         frule Ring.ring_is_ag[of R], rule aGroup.ag_mOp_closed, assumption,\n         simp add:Pi_def)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\n                      \\<notin> jointfun (n + m) (jointfun (n - Suc 0) f m g)\n                                0 (\\<lambda>x\\<in>{0}. f n) `\n                               ({l. l \\<le> Suc (n + m)} - {Suc (n + m)})\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                               carrier R\nA total of 11 subgoals...", "apply (thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n         thin_tac \"t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\",\n         thin_tac \"\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\",\n         thin_tac \"\\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\",\n         thin_tac \"l_comb R M (n + m)\n          (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t)\n          (jointfun (n - Suc 0) f m g) =\n         s n \\<cdot>\\<^sub>s f n\",\n         thin_tac \"s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n}; g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n     inj_on g {j. j \\<le> m}; f n \\<notin> g ` {j. j \\<le> m}; 0 < n;\n     Ring R; aGroup R; ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\n                      \\<notin> jointfun (n + m) (jointfun (n - Suc 0) f m g)\n                                0 (\\<lambda>x\\<in>{0}. f n) `\n                               ({l. l \\<le> Suc (n + m)} - {Suc (n + m)})\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                               carrier R\nA total of 11 subgoals...", "apply (thin_tac \"(\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x))\n         \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\",\n        thin_tac \"jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t\n         \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n}; g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n     inj_on g {j. j \\<le> m}; f n \\<notin> g ` {j. j \\<le> m}; 0 < n;\n     Ring R; aGroup R; ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                       (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\n                      \\<notin> jointfun (n + m) (jointfun (n - Suc 0) f m g)\n                                0 (\\<lambda>x\\<in>{0}. f n) `\n                               ({l. l \\<le> Suc (n + m)} - {Suc (n + m)})\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                               carrier R\nA total of 11 subgoals...", "apply (simp add:Nset_pre1,\n        simp add:im_jointfunTr1[of \"n + m\" \"jointfun (n - Suc 0) f m g\" 0 \n        \"\\<lambda>x\\<in>{0}. f n\"],\n        thin_tac \"jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H\",\n        thin_tac \"jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n         f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\",\n        simp add:jointfun_def[of \"n+m\"] sliden_def)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n}; g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n     inj_on g {j. j \\<le> m}; f n \\<notin> g ` {j. j \\<le> m}; 0 < n;\n     Ring R; aGroup R; ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> f n \\<notin> f ` {l. l \\<le> n - Suc 0}\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> Suc (n - Suc 0 + m)} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma ta.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga \\<and>\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<and>\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                               carrier R\nA total of 11 subgoals...", "apply (rule contrapos_pp, simp+, simp add:image_def, erule exE,erule conjE,\n        simp add:inj_on_def[of f],\n        drule_tac a = n in forall_spec, simp,\n        thin_tac \"\\<forall>xa\\<le>m. f x \\<noteq> g xa\",\n        drule_tac a = x in forall_spec,\n        rule_tac i = x and j = \"n - Suc 0\" and k = n in Nat.le_trans,\n        assumption+, subst Suc_le_mono[THEN sym], simp,\n        simp,\n        cut_tac n1 = x and m1 = \"x - Suc 0\" in \n               Suc_le_mono[THEN sym], simp)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        (\\<exists>ta.\n            ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n            l_comb R M (Suc (n + m))\n             (jointfun (n + m)\n               (jointfun (n - Suc 0)\n                 (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                     -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                 m t)\n               0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n             (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n               (\\<lambda>x\\<in>{0}. f n)) =\n            l_comb R M ma ta ga \\<and>\n            ta ma =\n            jointfun (n + m)\n             (jointfun (n - Suc 0)\n               (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                   -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n               m t)\n             0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n             (Suc (n + m)) \\<and>\n            ga ma =\n            jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n             (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)))\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H", "defer"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f\n     \\<in> carrier M;\n     l_comb R M (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      f \\<plusminus>\n     l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n\n     \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<in> carrier M;\n     -\\<^sub>a l_comb R M (n - Suc 0) s f \\<plusminus> l_comb R M m t g =\n     s n \\<cdot>\\<^sub>s f n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s n \\<in> carrier R\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M m t g =\n     l_comb R M (n - Suc 0) s f \\<plusminus> s n \\<cdot>\\<^sub>s f n;\n     H \\<subseteq> carrier M; l_comb R M m t g \\<in> carrier M;\n     l_comb R M (n - Suc 0) s f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier M\n 6. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 7. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R)\n 8. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier R\n 9. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow> H\n 10. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n      f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n      ideal R (carrier R); H \\<subseteq> carrier M;\n      s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n      l_comb R M (n + m)\n       (jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t)\n       (jointfun (n - Suc 0) f m g) =\n      s n \\<cdot>\\<^sub>s f n;\n      f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n      jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n      jointfun (n - Suc 0)\n       (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n           -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n       m t\n      \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n      jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n      f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n      \\<exists>ga ma.\n         ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n         inj_on ga {l. l \\<le> ma} \\<and>\n         (\\<exists>ta.\n             ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n             l_comb R M (Suc (n + m))\n              (jointfun (n + m)\n                (jointfun (n - Suc 0)\n                  (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                      -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                  m t)\n                0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n              (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                (\\<lambda>x\\<in>{0}. f n)) =\n             l_comb R M ma ta ga \\<and>\n             ta ma =\n             jointfun (n + m)\n              (jointfun (n - Suc 0)\n                (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                    -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                m t)\n              0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n              (Suc (n + m)) \\<and>\n             ga ma =\n             jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n              (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)))\\<rbrakk>\n     \\<Longrightarrow> False", "apply (rule Pi_I, simp,\n        rule aGroup.ag_mOp_closed, assumption,\n        cut_tac  i = x and j = \"n - Suc 0\" and k = n in Nat.le_trans,\n        assumption, subst Suc_le_mono[THEN sym], simp,\n        simp add:Pi_def, simp, simp, simp add:Pi_def,\n        simp add:Pi_def,\n        simp add:Pi_def subsetD, assumption+, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n     ideal R (carrier R); H \\<subseteq> carrier M;\n     s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n     l_comb R M (n + m)\n      (jointfun (n - Suc 0)\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        m t)\n      (jointfun (n - Suc 0) f m g) =\n     s n \\<cdot>\\<^sub>s f n;\n     f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n     \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n     jointfun (n - Suc 0)\n      (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n          -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n      m t\n     \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n     jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n     f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n     \\<exists>ga ma.\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> ma} \\<and>\n        (\\<exists>ta.\n            ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R \\<and>\n            l_comb R M (Suc (n + m))\n             (jointfun (n + m)\n               (jointfun (n - Suc 0)\n                 (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                     -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                 m t)\n               0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n             (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n               (\\<lambda>x\\<in>{0}. f n)) =\n            l_comb R M ma ta ga \\<and>\n            ta ma =\n            jointfun (n + m)\n             (jointfun (n - Suc 0)\n               (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                   -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n               m t)\n             0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n             (Suc (n + m)) \\<and>\n            ga ma =\n            jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n             (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)))\\<rbrakk>\n    \\<Longrightarrow> False", "apply ((erule exE)+, (erule conjE)+, erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac l_comb_Suc[of H \"carrier R\" \"jointfun (n + m)\n           (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n           (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n))\" \"n + m\"\n           \"jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)\"],\n        simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m));\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (\n       thin_tac \"l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n           (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (subgoal_tac \"l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n           (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n         (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)) (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)\n         (Suc (n + m)) = \\<zero>\\<^bsub>M\\<^esub>\", simp,\n       thin_tac \"l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n           (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n         (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)) (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)\n         (Suc (n + m)) =\n        l_comb R M ma ta ga\",\n       thin_tac \"l_comb R M (n + m)\n         (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n\",\n       thin_tac \"jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H\",\n       thin_tac \"jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R\",\n       thin_tac \"jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\")"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        \\<zero> = l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 6. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (simp add:jointfun_def[of \"n+m\"] sliden_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        \\<zero> = l_comb R M ma ta ga;\n        ta ma = -\\<^sub>a\\<^bsub>R\\<^esub> s n; ga ma = f n\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 6. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (rotate_tac -3, frule sym, thin_tac \"\\<zero> = l_comb R M ma ta ga\")"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>ta ma = -\\<^sub>a\\<^bsub>R\\<^esub> s n; ga ma = f n;\n        free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M ma ta ga = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 6. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (frule_tac s = ta and n = ma and m = ga in unique_expression1[of H],\n           assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>ta ma = -\\<^sub>a\\<^bsub>R\\<^esub> s n; ga ma = f n;\n        free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M ma ta ga = \\<zero>;\n        \\<forall>j\\<in>{j. j \\<le> ma}.\n           ta j = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 6. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (rotate_tac -1, \n           drule_tac x = ma in bspec, simp)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>ta ma = -\\<^sub>a\\<^bsub>R\\<^esub> s n; ga ma = f n;\n        free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M ma ta ga = \\<zero>;\n        ta ma = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 6. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (frule_tac funcset_mem[of s \"{j. j \\<le> n}\" \"carrier R\" n], simp,\n           frule sym, thin_tac \"ta ma = -\\<^sub>a\\<^bsub>R\\<^esub> (s n)\",\n           frule aGroup.ag_inv_inv[of R \"s n\"], assumption+, simp,\n           thin_tac \" -\\<^sub>a\\<^bsub>R\\<^esub> (s n) = \\<zero>\\<^bsub>R\\<^esub>\",\n           rotate_tac -1, frule sym, thin_tac \" -\\<^sub>a\\<^bsub>R\\<^esub> \\<zero>\\<^bsub>R\\<^esub> = s n\",\n           simp add:aGroup.ag_inv_zero[of R])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (thin_tac \"l_comb R M (n + m)\n         (jointfun (n + m)\n           (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n           (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n        jointfun (n + m)\n         (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n         (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)) (Suc (n + m)) \\<cdot>\\<^sub>s\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0 (\\<lambda>x\\<in>{0}. f n)\n         (Suc (n + m)) =\n        l_comb R M ma ta ga\",\n        thin_tac \"ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) 0\n         (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s n)) (Suc (n + m))\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n + m)\n                            (jointfun (n - Suc 0)\n                              (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                              m t)\n                            0 (\\<lambda>x\\<in>{0}.\n                                  -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n                          (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                            (\\<lambda>x\\<in>{0}. f n)) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (subst l_comb_jointfun_jj1[of H \"carrier R\"], assumption+,\n         rule Pi_I, simp,\n         rule aGroup.ag_mOp_closed, assumption, simp add:Pi_def,\n         simp add:Pi_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          (jointfun (n - Suc 0) f m g) \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (simp,\n        thin_tac \"l_comb R M (n + m) (jointfun (n - Suc 0) \n       (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t) (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n\",\n       thin_tac \"jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H\",\n       thin_tac \"jointfun (n - Suc 0) (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s x)) m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R\",\n       thin_tac \"jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m}\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> s n \\<cdot>\\<^sub>s f n \\<plusminus>\n                         jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                          (Suc (n + m)) \\<cdot>\\<^sub>s\n                         jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n) (Suc (n + m)) =\n                         \\<zero>\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 4. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 5. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (simp add:jointfun_def[of \"n+m\"] sliden_def,\n         subst sc_minus_am1[THEN sym],\n         simp add:Pi_def, simp add:Pi_def subsetD,\n         simp add:ag_r_inv1,  simp add:free_generator_sub)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 2. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m)\n                          (jointfun (n - Suc 0)\n                            (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n                            m t)\n                          0 (\\<lambda>x\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n                               carrier R\n 3. \\<And>ga ma ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f n \\<notin> g ` {j. j \\<le> m}; 0 < n; Ring R; aGroup R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        s n \\<cdot>\\<^sub>s f n \\<in> carrier M;\n        l_comb R M (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         (jointfun (n - Suc 0) f m g) =\n        s n \\<cdot>\\<^sub>s f n;\n        f \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n            -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n        \\<in> {j. j \\<le> n - Suc 0} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g \\<in> {j. j \\<le> n + m} \\<rightarrow> H;\n        jointfun (n - Suc 0)\n         (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n             -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n         m t\n        \\<in> {j. j \\<le> n + m} \\<rightarrow> carrier R;\n        jointfun (n - Suc 0) f m g ` {j. j \\<le> n + m} =\n        f ` {j. j \\<le> n - Suc 0} \\<union> g ` {j. j \\<le> m};\n        ga \\<in> {l. l \\<le> ma} \\<rightarrow> H; inj_on ga {l. l \\<le> ma};\n        ta \\<in> {l. l \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M (Suc (n + m))\n         (jointfun (n + m)\n           (jointfun (n - Suc 0)\n             (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n             m t)\n           0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n))\n         (jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n           (\\<lambda>x\\<in>{0}. f n)) =\n        l_comb R M ma ta ga;\n        ta ma =\n        jointfun (n + m)\n         (jointfun (n - Suc 0)\n           (\\<lambda>x\\<in>{j. j \\<le> n - Suc 0}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> s x)\n           m t)\n         0 (\\<lambda>x\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s n)\n         (Suc (n + m));\n        ga ma =\n        jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n         (\\<lambda>x\\<in>{0}. f n) (Suc (n + m))\\<rbrakk>\n       \\<Longrightarrow> jointfun (n + m) (jointfun (n - Suc 0) f m g) 0\n                          (\\<lambda>x\\<in>{0}. f n)\n                         \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> H", "apply (assumption+,\n         rule Pi_I,\n         case_tac \"x \\<le> n + m\", simp add:jointfun_def[of \"n+m\"],\n         simp add:Pi_def,\n         simp add:jointfun_def[of \"n+m\"] sliden_def,\n         rule aGroup.ag_mOp_closed, assumption, simp add:Pi_def,\n         rule Pi_I, simp,\n          case_tac \"x \\<le> n+m\", simp add:jointfun_def[of \"n+m\"],\n          simp add:Pi_def, \n          simp add:jointfun_def[of \"n+m\"] sliden_def,\n          simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression5:\"\\<lbrakk>free_generator R M H; \n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; inj_on f {j. j \\<le> n}; \n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H; \n      inj_on g {j. j \\<le> m}; t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; \n      l_comb R M n s f = l_comb R M m t g; \n     \\<forall>j \\<in> {j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k \\<in> {j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk> \\<Longrightarrow>\n      f ` {j. j \\<le> n} \\<subseteq> g ` {j. j \\<le> m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f ` {j. j \\<le> n} \\<subseteq> g ` {j. j \\<le> m}", "apply (cut_tac sc_Ring, frule Ring.ring_is_ag[of R],\n       frule Ring.whole_ideal, \n       frule free_generator_sub[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     Ring R; aGroup R; ideal R (carrier R); H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> f ` {j. j \\<le> n} \\<subseteq> g ` {j. j \\<le> m}", "apply (rule contrapos_pp, simp+, simp add:subset_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n     aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n     \\<exists>x\\<le>n. f x \\<notin> g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> False", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (case_tac \"n = 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M 0 s f = l_comb R M m t g;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac f = t and n = m and A = \"carrier R\" and \n        g = \"\\<lambda>k\\<in>{0::nat}. -\\<^sub>a\\<^bsub>R\\<^esub> (s 0)\"  and m = 0 and B = \"carrier R\" in \n        jointfun_hom0,\n        simp add:Pi_def,\n        rule aGroup.ag_mOp_closed, assumption, simp add:Pi_def,\n        frule_tac f = g and n = m and A = H and \n        g = \"\\<lambda>k\\<in>{0::nat}. (f 0)\" and m = 0 and B = H in \n        jointfun_hom0,\n        simp add:Pi_def subsetD,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M 0 s f = l_comb R M m t g;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule sym, thin_tac \"l_comb R M 0 s f = l_comb R M m t g\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g = l_comb R M 0 s f\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac n = 0 in l_comb_mem[of \"carrier R\" H s _ f],\n         simp add:free_generator_sub, simp+,\n         frule_tac n = m in l_comb_mem[of \"carrier R\" H t _ g],\n         simp add:free_generator_sub, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g = l_comb R M 0 s f;\n        l_comb R M 0 s f \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:ag_eq_diffzero[of \"l_comb R M m t g\" \"l_comb R M 0 s f\"],\n         simp add:l_comb_def[of R M 0 s f],\n         frule free_generator_sub[of H],\n          frule_tac c = \"f 0\" in subsetD[of H \"carrier M\"], assumption+,\n          simp add:sc_minus_am1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"l_comb R M m t g \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> (s 0)) \\<cdot>\\<^sub>s f 0 = \n          l_comb R M (Suc m) (jointfun m t 0 (\\<lambda>k\\<in>{0}. (-\\<^sub>a\\<^bsub>R\\<^esub> (s 0))))\n          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M (Suc m)\n         (jointfun m t 0\n           (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n         (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)) =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0\n                            (\\<lambda>k\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac f = g and n = m and B = H and b = \"f 0\" in jointfun_inj,\n          assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M (Suc m)\n         (jointfun m t 0\n           (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n         (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)) =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n         {j. j \\<le> Suc m}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0\n                            (\\<lambda>k\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule unique_expression1[of H \"jointfun m t 0 (\\<lambda>k\\<in>{0}. (-\\<^sub>a\\<^bsub>R\\<^esub> (s 0)))\" \n        \"Suc m\" \"jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M (Suc m)\n         (jointfun m t 0\n           (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n         (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)) =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n         {j. j \\<le> Suc m};\n        \\<forall>j\\<in>{j. j \\<le> Suc m}.\n           jointfun m t 0\n            (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0) j =\n           \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0\n                            (\\<lambda>k\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"Suc m\" in bspec, simp,\n        thin_tac \"\\<forall>j\\<in>{j. j \\<le> Suc m}. jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s 0)) j \n          = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M (Suc m)\n         (jointfun m t 0\n           (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n         (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)) =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        inj_on (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n         {j. j \\<le> Suc m};\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n         (Suc m) =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0\n                            (\\<lambda>k\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        (\\<lambda>i.\n            if i \\<le> m then t i\n            else (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n                  (sliden (Suc m) i))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        (\\<lambda>i.\n            if i \\<le> m then g i\n            else (\\<lambda>k\\<in>{0}. f 0) (sliden (Suc m) i))\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M (Suc m)\n         (\\<lambda>i.\n             if i \\<le> m then t i\n             else (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n                   (sliden (Suc m) i))\n         (\\<lambda>i.\n             if i \\<le> m then g i\n             else (\\<lambda>k\\<in>{0}. f 0) (sliden (Suc m) i)) =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M;\n        l_comb R M m t g \\<plusminus>\n        \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        inj_on\n         (\\<lambda>i.\n             if i \\<le> m then g i\n             else (\\<lambda>k\\<in>{0}. f 0) (sliden (Suc m) i))\n         {j. j \\<le> Suc m};\n        -\\<^sub>a\\<^bsub>R\\<^esub> s 0 = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0\n                            (\\<lambda>k\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule aGroup.ag_inv_inv[THEN sym, of R \"s 0\"], assumption,\n         simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        l_comb R M m t g \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s f 0 =\n        \\<zero>;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         l_comb R M (Suc m)\n                          (jointfun m t 0\n                            (\\<lambda>k\\<in>{0}.\n                                -\\<^sub>a\\<^bsub>R\\<^esub> s 0))\n                          (jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0))\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (thin_tac \"l_comb R M m t g \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> (s 0)) \\<cdot>\\<^sub>s f 0 = \\<zero>\",\n         simp del:nsum_suc add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; f 0 \\<in> H; s 0 \\<in> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x = 0; f 0 \\<notin> g ` {j. j \\<le> m}; n = 0;\n        jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> carrier R;\n        jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0)\n        \\<in> {l. l \\<le> Suc m} \\<rightarrow> H;\n        s 0 \\<cdot>\\<^sub>s f 0 \\<in> carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\n        \\<in> carrier M;\n        H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          t j \\<cdot>\\<^sub>s g j) m \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> s 0) \\<cdot>\\<^sub>s\n                         f 0 =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          jointfun m t 0\n           (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> s 0)\n           j \\<cdot>\\<^sub>s\n          jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0) j) Suc m\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac l_comb_jointfun_jj[of H \"carrier R\" t m g \"\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s 0)\"\n               0 \"\\<lambda>k\\<in>{0}. f 0\"], simp,\n         thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. jointfun m t 0 (\\<lambda>k\\<in>{0}. -\\<^sub>a\\<^bsub>R\\<^esub> (s 0)) j \\<cdot>\\<^sub>s\n                   jointfun m g 0 (\\<lambda>k\\<in>{0}. f 0) j) m =\n         \\<Sigma>\\<^sub>e M (\\<lambda>j. t j \\<cdot>\\<^sub>s g j) m\",\n         simp add:jointfun_def sliden_def, simp add:free_generator_sub,\n         assumption+,\n         rule Pi_I, simp,\n         rule aGroup.ag_mOp_closed, assumption+,\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (case_tac \"x = n\", simp,\n        rule unique_prepression5_0[of H f n s g m t], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; n \\<noteq> 0;\n        x \\<noteq> n\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac j = x in l_comb_transpos1[of \"carrier R\" H s \"n - Suc 0\" f],\n        rule subsetI, simp,\n        simp+,\n        rotate_tac -1, frule sym,\n        thin_tac \"l_comb R M m t g = \n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n))\",\n        frule_tac i = x and n = n and j = n in transpos_hom, simp,\n           assumption,\n        frule_tac i = x and n = n and j = n in transpos_inj, simp,\n           assumption+,\n        rule_tac f = \"cmp f (transpos x n)\" and s = \"cmp s (transpos x n)\" in \n        unique_prepression5_0[of H _ n _ g m t], assumption+,\n        simp add:cmp_fun, simp add:cmp_fun, simp add:cmp_inj,\n        simp add:cmp_fun, assumption+,\n        rule allI, rule impI, simp add:cmp_def,\n        frule_tac i = x and n = n and j = n and l = j in transpos_mem,\n        simp, assumption+, blast, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f =\n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n));\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; x \\<noteq> n;\n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n)) =\n        l_comb R M m t g;\n        transpos x n \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> n};\n        inj_on (transpos x n) {i. i \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x n) n \\<notin> g ` {j. j \\<le> m}\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f =\n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n));\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; x \\<noteq> n;\n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n)) =\n        l_comb R M m t g;\n        transpos x n \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> n};\n        inj_on (transpos x n) {i. i \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> 0 < n", "apply (simp add:cmp_def transpos_ij_2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f =\n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n));\n        \\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; ideal R (carrier R); \\<forall>x\\<in>H. x \\<in> carrier M;\n        x \\<le> n; f x \\<notin> g ` {j. j \\<le> m}; x \\<noteq> n;\n        l_comb R M n (cmp s (transpos x n)) (cmp f (transpos x n)) =\n        l_comb R M m t g;\n        transpos x n \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> n};\n        inj_on (transpos x n) {i. i \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> 0 < n", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression6:\"\\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; inj_on f {j. j \\<le> n}; \n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; \n      g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H; inj_on g {j. j \\<le> m}; \n      t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n      l_comb R M n s f = l_comb R M m t g;\n      \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k\\<in> {j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk> \\<Longrightarrow> \n      f `{j. j \\<le> n} = g `  {j. j \\<le> m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f ` {j. j \\<le> n} = g ` {j. j \\<le> m}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f ` {j. j \\<le> n} \\<subseteq> g ` {j. j \\<le> m}\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> g ` {j. j \\<le> m} \\<subseteq> f ` {j. j \\<le> n}", "apply (rule_tac  H = H and f = f and n = n and s = s and g = g and m = m and \n       t = t in unique_expression5, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> g ` {j. j \\<le> m} \\<subseteq> f ` {j. j \\<le> n}", "apply (rule_tac  H = H and f = g and n = m and s = t and g = f and m = n and \n       t = s in unique_expression5, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> l_comb R M m t g = l_comb R M n s f\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> m}.\n                         t j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> n}.\n                         s k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>", "apply (rule sym, assumption, blast, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression7_1:\"\\<lbrakk>free_generator R M H; \n    f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H; inj_on f {j. j \\<le> n}; \n    s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; \n    g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H; inj_on g {j. j \\<le> m}; \n    t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; \n    l_comb R M n s f = l_comb R M m t g; \n   \\<forall>j \\<in> {j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; \\<forall>k\\<in>{j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk> \\<Longrightarrow> n = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}.\n        t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (frule_tac A = \"{j. j \\<le> n}\" and f = f in card_image,\n       frule_tac A = \"{j. j \\<le> m}\" and f = g in card_image)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     card (f ` {j. j \\<le> n}) = card {j. j \\<le> n};\n     card (g ` {j. j \\<le> m}) = card {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (frule_tac H = H and f = f and n = n and s = s and g = g and t = t and \n       m = m in unique_expression6, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     card (f ` {j. j \\<le> n}) = card {j. j \\<le> n};\n     card (g ` {j. j \\<le> m}) = card {j. j \\<le> m};\n     f ` {j. j \\<le> n} = g ` {j. j \\<le> m}\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (rotate_tac -3, frule sym, \n       thin_tac \"card (f ` {j. j \\<le> n}) = card ({j. j \\<le> n})\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>card (g ` {j. j \\<le> m}) = card {j. j \\<le> m};\n     f ` {j. j \\<le> n} = g ` {j. j \\<le> m}; free_generator R M H;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n     t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M m t g;\n     \\<forall>j\\<in>{j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<in>{j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     card {j. j \\<le> n} = card (f ` {j. j \\<le> n})\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression7_2:\"\\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H;  inj_on f {j. j \\<le> n};\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R; \n      l_comb R M n s f = l_comb R M n t f\\<rbrakk> \\<Longrightarrow> (\\<forall>l \\<in> {j. j \\<le> n}. s l = t l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M n t f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{j. j \\<le> n}. s l = t l", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M n t f; Ring R;\n     ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{j. j \\<le> n}. s l = t l", "apply (frule free_generator_sub[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M n t f; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{j. j \\<le> n}. s l = t l", "apply (frule l_comb_mem[of \"carrier R\" H s n f], assumption+,\n        frule l_comb_mem[of \"carrier R\" H t n f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f = l_comb R M n t f; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; l_comb R M n s f \\<in> carrier M;\n     l_comb R M n t f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{j. j \\<le> n}. s l = t l", "apply (simp add:ag_eq_diffzero[of \"l_comb R M n s f\" \"l_comb R M n t f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus> -\\<^sub>a l_comb R M n t f = \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n t f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (simp add:linear_span_iOp_closedTr2[of \"carrier R\" H f n t])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n t f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (frule l_comb_add1[THEN sym, of \"carrier R\" H f n s \"\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t j)\"],\n            assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n t f \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j\\<in>{k. k \\<le> n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t j)\n                      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) x)\n      f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n        \\<zero>;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n        x \\<in> {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>{k. k \\<le> n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t j)\n                          x\n                         \\<in> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) x)\n      f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (simp, frule Ring.ring_is_ag[of R],\n              rule aGroup.ag_mOp_closed[of R], simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n        \\<zero>;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n        x \\<le> n; aGroup R\\<rbrakk>\n       \\<Longrightarrow> t x \\<in> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) x)\n      f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) x)\n      f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (frule_tac s = \"\\<lambda>x\\<in>{x. x \\<le> n}. s x \\<plusminus>\\<^bsub>R\\<^esub> (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> (t x) else \n        undefined)\" in unique_expression1[of H _ n f], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{x. x \\<le> n}.\n                          s x \\<plusminus>\\<^bsub>R\\<^esub>\n                          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n                           else undefined))\n                      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> inj_on f {j. j \\<le> n}\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n\n                       (\\<lambda>x\\<in>{x. x \\<le> n}.\n                           s x \\<plusminus>\\<^bsub>R\\<^esub>\n                           (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n                            else undefined))\n                       f =\n                      \\<zero>\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>;\n     \\<forall>j\\<in>{j. j \\<le> n}.\n        (\\<lambda>x\\<in>{x. x \\<le> n}.\n            s x \\<plusminus>\\<^bsub>R\\<^esub>\n            (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n             else undefined))\n         j =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n\n         (\\<lambda>x\\<in>{x. x \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub>\n             (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n              else undefined))\n         f =\n        \\<zero>;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n        \\<zero>;\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> t x\n                         \\<in> carrier R\n 2. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> inj_on f {j. j \\<le> n}\n 4. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> l_comb R M n\n                       (\\<lambda>x\\<in>{x. x \\<le> n}.\n                           s x \\<plusminus>\\<^bsub>R\\<^esub>\n                           (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n                            else undefined))\n                       f =\n                      \\<zero>\n 5. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>;\n     \\<forall>j\\<in>{j. j \\<le> n}.\n        (\\<lambda>x\\<in>{x. x \\<le> n}.\n            s x \\<plusminus>\\<^bsub>R\\<^esub>\n            (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n             else undefined))\n         j =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (frule Ring.ring_is_ag[of R], rule aGroup.ag_pOp_closed, assumption,\n         simp add:Pi_def,\n         rule aGroup.ag_mOp_closed, assumption,\n         simp add:Pi_def, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     inj_on f {j. j \\<le> n};\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{x. x \\<le> n}.\n          s x \\<plusminus>\\<^bsub>R\\<^esub>\n          (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x else undefined))\n      f =\n     \\<zero>;\n     Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n     \\<zero>;\n     \\<forall>j\\<in>{j. j \\<le> n}.\n        (\\<lambda>x\\<in>{x. x \\<le> n}.\n            s x \\<plusminus>\\<^bsub>R\\<^esub>\n            (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n             else undefined))\n         j =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n. s l = t l", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n\n         (\\<lambda>x\\<in>{x. x \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub>\n             (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n              else undefined))\n         f =\n        \\<zero>;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n        \\<zero>;\n        \\<forall>j\\<in>{j. j \\<le> n}.\n           (\\<lambda>x\\<in>{x. x \\<le> n}.\n               s x \\<plusminus>\\<^bsub>R\\<^esub>\n               (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n                else undefined))\n            j =\n           \\<zero>\\<^bsub>R\\<^esub>;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s l = t l", "apply (subst aGroup.ag_eq_diffzero[of R],\n         simp add:Ring.ring_is_ag,\n         simp add:Pi_def, simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n\n         (\\<lambda>x\\<in>{x. x \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub>\n             (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n              else undefined))\n         f =\n        \\<zero>;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n        \\<zero>;\n        \\<forall>j\\<in>{j. j \\<le> n}.\n           (\\<lambda>x\\<in>{x. x \\<le> n}.\n               s x \\<plusminus>\\<^bsub>R\\<^esub>\n               (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n                else undefined))\n            j =\n           \\<zero>\\<^bsub>R\\<^esub>;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> s l \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> t l =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (drule_tac x = l in bspec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H; inj_on f {j. j \\<le> n};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n\n         (\\<lambda>x\\<in>{x. x \\<le> n}.\n             s x \\<plusminus>\\<^bsub>R\\<^esub>\n             (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n              else undefined))\n         f =\n        \\<zero>;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M; l_comb R M n t f \\<in> carrier M;\n        l_comb R M n s f \\<plusminus>\n        l_comb R M n\n         (\\<lambda>j\\<in>{k. k \\<le> n}. -\\<^sub>a\\<^bsub>R\\<^esub> t j) f =\n        \\<zero>;\n        l \\<le> n;\n        (\\<lambda>x\\<in>{x. x \\<le> n}.\n            s x \\<plusminus>\\<^bsub>R\\<^esub>\n            (if x \\<le> n then -\\<^sub>a\\<^bsub>R\\<^esub> t x\n             else undefined))\n         l =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> s l \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> t l =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "end"]]}