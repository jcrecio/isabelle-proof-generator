{"file_name": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module/Algebra8.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module", "problem_names": ["lemma (in Module) unique_expression_last:\" \\<lbrakk>free_generator R M H; \n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g; \n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; \n        f (Suc n) = g (Suc n)\\<rbrakk>  \\<Longrightarrow> s (Suc n) = t (Suc n)\"", "lemma (in Module) unique_exprTr7p1:\"  \\<lbrakk>free_generator R M H;\n  \\<forall>f s g t m.\n   f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> inj_on f {j. j \\<le> n} \\<and> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n   g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and> inj_on g {j. j \\<le> m} \\<and> t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n   l_comb R M n s f = l_comb R M m t g \\<and> \n         (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> (\\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n   (\\<exists>h. h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n                (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n   g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n   l_comb R M (Suc n) s f = l_comb R M (Suc n) t g; \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n   \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; \n   f (Suc n) = g (Suc n)\\<rbrakk> \\<Longrightarrow> \\<exists>h. h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n              (\\<forall>l\\<le>Suc n. cmp f h l = g l \\<and> cmp s h l = t l)\"", "lemma (in Module) unique_expression7:\"free_generator R M H \\<Longrightarrow>\n \\<forall>f s g t m. f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H \\<and> inj_on f {j. j \\<le> n} \\<and>\n    s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n    g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H \\<and> inj_on g {j. j \\<le> m} \\<and>\n    t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and> l_comb R M n s f = l_comb R M m t g \\<and>\n    (\\<forall>j \\<in> {j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> (\\<forall>k \\<in> {j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub> ) \\<longrightarrow> n = m \\<and> \n    (\\<exists>h. h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and> (\\<forall>l \\<in> {j. j \\<le> n}. (cmp f h) l = g l\n      \\<and> (cmp s h) l = t l))\"", "lemma (in Module) gen_mHom_eq:\"\\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n       g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h \\<rbrakk> \\<Longrightarrow> f = g\"", "lemma (in Module) od_fm_fun_carrier:\"carrier (od_fm_fun R M N f H) = \n                    fsps R M N f H\"", "lemma (in Module) fgs_submodule:\"a \\<subseteq> carrier M \\<Longrightarrow> \n              submodule R M (fgs R M a)\"", "lemma (in Module) fgs_sub_carrier:\"a \\<subseteq> carrier M \\<Longrightarrow> (fgs R M a) \\<subseteq> carrier M\"", "lemma (in Module) elem_fgs:\"\\<lbrakk>a \\<subseteq> carrier M; x \\<in> a\\<rbrakk> \\<Longrightarrow> x \\<in> fgs R M a\"", "lemma (in Module) fst_chain_subset:\"\\<lbrakk>R module N; free_generator R M H;\n f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; (a, b) \\<in> C\\<rbrakk>  \\<Longrightarrow> a \\<subseteq> carrier M\"", "lemma (in Module) empty_fsp:\"\\<lbrakk>R module N; free_generator R M H; \n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> ({}, (\\<lambda>x\\<in>{\\<zero>\\<^bsub>M\\<^esub>}. \\<zero>\\<^bsub>N\\<^esub>)) \\<in> fsps R M N f H\"", "lemma (in Module) mem_fgs_l_comb:\"\\<lbrakk>K \\<noteq> {}; K \\<subseteq> carrier M; x \\<in> fgs R M K\\<rbrakk> \\<Longrightarrow> \n        \\<exists>(n::nat).  \n        \\<exists>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> K. \\<exists>s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R.\n                    x = l_comb R M n s f\"", "lemma PairE_lemma: \"\\<exists>x y. p = (x, y)\"", "lemma (in Module) fsps_chain_boundTr1:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \\<forall>a b. (a, b) \\<in> C \\<longrightarrow> \n              (a, b) \\<in> fsps R M N f H; \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}\\<rbrakk> \\<Longrightarrow> \n      fa \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \\<Union>{a. \\<exists>b. (a, b) \\<in> C} \n                       \\<longrightarrow> (\\<exists>(c, d) \\<in> C. fa ` {j. j \\<le> n} \\<subseteq> c)\"", "lemma (in Module) fsps_chain_boundTr1_1:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \n       \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}; \n       fa \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \\<Union>{a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk> \\<Longrightarrow> \n        \\<exists>(c, d) \\<in> C. fa ` {j. j \\<le> n} \\<subseteq> c\"", "lemma (in Module) fsps_chain_boundTr1_2:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \n       \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}; \n       fa \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \\<Union>{a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk> \\<Longrightarrow> \n       \\<exists>P \\<in> C. fa ` {j. j \\<le> n} \\<subseteq> fst P\"", "lemma (in Module) eSum_in_SubmoduleTr:\"\\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H\\<rbrakk> \\<Longrightarrow>\n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> K \\<and> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R  \\<longrightarrow>\n      l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\"", "lemma (in Module) eSum_in_Submodule:\"\\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H; \n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> K; s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk> \\<Longrightarrow> \n      l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\"", "lemma (in Module) fgs_generator:\"H \\<subseteq> carrier M \\<Longrightarrow>\n       generator R (mdl M (fgs R M H)) H\"", "lemma (in Module) fgs_mono:\"\\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K\"", "lemma (in Module) empty_fgs:\"fgs R M {} = {\\<zero>}\"", "lemma (in Module) mem_fsps_snd_mHom:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow> \n                    b \\<in> mHom R (mdl M (fgs R M a)) N\"", "lemma (in Module) mem_fsps_fst_sub:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow>  a \\<subseteq> H\"", "lemma (in Module) mem_fsps_fst_sub1:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow>  a \\<subseteq> carrier M\"", "lemma (in Module) Order_od_fm_fun:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> Order (od_fm_fun R M N f H)\"", "lemma (in Module) fsps_chain_boundTr2_1:\"\\<lbrakk>R module N; \n      free_generator R M H; f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n      (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa\\<rbrakk>\n      \\<Longrightarrow> b x = ba x\"", "lemma (in Module) fsps_chain_boundTr2_2:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; C \\<noteq> {}; (a, b) \\<in> C; \n       x \\<in> fgs R M a; (a1, b1) \\<in> C; x \\<in> fgs R M a1\\<rbrakk> \\<Longrightarrow> b x = b1 x\"", "lemma (in Module) fsps_chain_boundTr2:\"\\<And>x. \\<lbrakk>R module N; free_generator R M H;\n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;  \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \n       x \\<in> (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})); C \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> \n    (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) \\<in> \n    (carrier N) \\<and> \n    (\\<exists>a1 b1. (a1, b1) \\<in> C \\<and> x \\<in> fgs R M a1 \\<and> \n    (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) = \n              b1 x)\"", "lemma (in Module) Un_C_submodule:\"\\<lbrakk>R module N; free_generator R M H; \n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {};\n     \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk> \\<Longrightarrow> \n       submodule R M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\"", "lemma (in Module) Un_C_fgs_sub:\"\\<lbrakk>R module N; free_generator R M H; \n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {};\n     \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk> \\<Longrightarrow>\n     \\<Union>{a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\"", "lemma (in Module) Chain_3_supset:\"\\<lbrakk>R module N; free_generator R M H; \n    f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {};\n   \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; (a1, b1) \\<in> C; (a2, b2) \\<in> C;\n   (a3, b3) \\<in> C\\<rbrakk> \\<Longrightarrow> \\<exists>(g, h)\\<in>C. a1 \\<subseteq> g \\<and> a2 \\<subseteq> g \\<and> a3 \\<subseteq> g\"", "lemma (in Module) fsps_chain_bound1:\"\\<lbrakk>R module N; free_generator R M H;  \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;  \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; C \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> \n      (\\<lambda>x\\<in>(fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})). (THE y. y \\<in> carrier N \\<and> \n                    (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))) \\<in> \n       mHom R (mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))) N\"", "lemma (in Module) fsps_chain_bound2:\"\\<lbrakk>R module N; free_generator R M H;  \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {}; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>  \\<Longrightarrow> \n   \\<forall>y\\<in>(\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). (\\<lambda>x\\<in>(fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})). \n   (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))) y =\n    f y\"", "lemma (in Module) od_fm_fun_Chain:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk> \\<Longrightarrow> \n      \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\"", "lemma (in Module) od_fm_fun_inPr0:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {};\n       \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>  \\<Longrightarrow> z \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\"", "lemma (in Module) od_fm_fun_indPr1:\" \\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk> \\<Longrightarrow>\n      (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}, \n         \\<lambda>x \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). THE y. y \\<in> carrier N \\<and>\n         (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) \\<in> fsps R M N f H\"", "lemma (in Module) od_fm_fun_indPr2:\" \\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk> \\<Longrightarrow>\n     ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}, \n         \\<lambda>x \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). THE y. y \\<in> carrier N \\<and>\n                          (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\"", "lemma (in Module) od_fm_fun_inductive:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> inductive_set (od_fm_fun R M N f H)\"", "lemma (in Module) sSum_eq:\"\\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; \n      h \\<in> H - H1\\<rbrakk> \\<Longrightarrow>  (fgs R M H1) \\<minusplus> (fgs R M {h}) = fgs R M (H1 \\<union> {h})\"", "lemma (in Module) fgs_single_span:\"\\<lbrakk>h \\<in> carrier M; x \\<in> (fgs R M {h})\\<rbrakk> \\<Longrightarrow> \n              \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h\"", "lemma (in Module) monofun_mHomTr:\"\\<lbrakk>h \\<in> H; free_generator R M H; \n      a \\<in> carrier R; r \\<in> carrier R; a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h\\<rbrakk> \\<Longrightarrow> a = r\"", "lemma (in Module) monofun_mhomTr1:\"\\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R\\<rbrakk>  \\<Longrightarrow> \n                monofun R M N f H h (a \\<cdot>\\<^sub>s h) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f h)\"", "lemma (in Module) monofun_mem:\"\\<lbrakk>R module N; h \\<in> H; free_generator R M H; \n       x \\<in> fgs R M {h}; f \\<in> H \\<rightarrow> carrier N\\<rbrakk>  \\<Longrightarrow>  \n       monofun R M N f H h x \\<in> carrier N\"", "lemma (in Module) monofun_eq_f:\"\\<lbrakk>R module N; h \\<in> H; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N\\<rbrakk>  \\<Longrightarrow>  monofun R M N f H h h = f h\"", "lemma (in Module) sSum_unique:\"\\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; \n       h \\<in> H - H1; x1 \\<in>(fgs R M H1); x2 \\<in> (fgs R M H1); \n       y1 \\<in> (fgs R M {h}); y2 \\<in> (fgs R M {h}); x1 \\<plusminus> y1 = x2 \\<plusminus> y2\\<rbrakk> \\<Longrightarrow>\n       x1 = x2 \\<and> y1 = y2\"", "lemma (in Module) ex_extensionTr:\"\\<lbrakk>R module N; free_generator R M H;  \n       f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H; h \\<notin> H1; \n       g \\<in> mHom R (mdl M (fgs R M H1)) N; \n       x \\<in> fgs R M H1 \\<minusplus> (fgs R M {h})\\<rbrakk> \\<Longrightarrow> \n     \\<exists>k1\\<in> fgs R M H1. \\<exists>k2\\<in>fgs R M {h}. x = k1 \\<plusminus> k2 \\<and> \n (THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}. x = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> \n         (monofun R M N f H h h2)) = g k1  \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h k2)\"", "lemma (in Module) monofun_add:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; h \\<in> H; x \\<in> fgs R M {h}; y \\<in> fgs R M {h}\\<rbrakk> \\<Longrightarrow> \n       monofun R M N f H h (x \\<plusminus> y) = \n                   monofun R M N f H h x \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h y)\"", "lemma (in Module) monofun_sprod:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; h \\<in> H; x \\<in> fgs R M {h}; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n      monofun R M N f H h ( a \\<cdot>\\<^sub>s x) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (monofun R M N f H h x)\"", "lemma (in Module) monofun_0:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; h \\<in> H\\<rbrakk> \\<Longrightarrow>  monofun R M N f H h  \\<zero>  = \\<zero>\\<^bsub>N\\<^esub>\"", "lemma (in Module) ex_extension:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H - H1; (H1, g) \\<in> fsps R M N f H\\<rbrakk> \\<Longrightarrow>\n       \\<exists>k. ((H1 \\<union> {h}), k) \\<in> fsps R M N f H\"", "lemma (in Module) mHom_mHom:\"\\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n       \\<Longrightarrow> g \\<in> mHom R M N\"", "lemma (in Module) exist_extension_mhom:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x\"", "lemma (in Module) NAKTr1:\"M fgover R \\<Longrightarrow> \n      \\<exists>H. finite_generator R M H \\<and> (LEAST j. \n        \\<exists>L. finite_generator R M L \\<and> j = card L) = card H\"", "lemma (in Module) NAKTr2:\"\\<lbrakk>Lcg R M j; k < (LEAST j. Lcg R M j)\\<rbrakk> \\<Longrightarrow>\n                            \\<not> Lcg R M k\"", "lemma (in Module) NAKTr3:\"\\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n       card H < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L)\\<rbrakk> \\<Longrightarrow>\n              \\<not> finite_generator R M H\"", "lemma (in Module) finite_gen_over_ideal:\"\\<lbrakk>ideal R A; h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow>\n carrier M; generator R M (h ` {j. j \\<le> n}); A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; \n m \\<in> carrier M \\<rbrakk>  \\<Longrightarrow>  \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A. m = l_comb R M n s h\"", "lemma (in Module) NAKTr4:\"\\<lbrakk>ideal R A; h \\<in> {j. j \\<le> (k::nat)} \\<rightarrow> carrier M; \n 0 < k;  h ` {j. j \\<le> k} \\<subseteq> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A; \n h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (h j)) (k - Suc 0) \\<plusminus> (s k \\<cdot>\\<^sub>s (h k))\\<rbrakk> \\<Longrightarrow> \n  (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k))) \\<cdot>\\<^sub>s (h k) = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (h j)) (k - Suc 0)\"", "lemma (in Module) NAKTr5:\"\\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R; \n       A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H; card H = Suc k; 0 < k\\<rbrakk> \\<Longrightarrow>\n     \\<exists>h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M. H = h ` {j. j \\<le> k} \\<and>  \n             h k \\<in> linear_span R M A (h ` {j. j \\<le> (k - Suc 0)})\"", "lemma (in Module) NAK:\"\\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A; A \\<subseteq> J_rad R;  \n       A \\<odot>\\<^bsub>R\\<^esub> M = carrier M \\<rbrakk> \\<Longrightarrow> carrier M = {\\<zero>}\"", "lemma (in Module) fg_qmodule:\"\\<lbrakk> M fgover R; submodule R M N\\<rbrakk> \\<Longrightarrow>\n                          (M /\\<^sub>m N) fgover R\"", "lemma (in Module) NAK1:\"\\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; \n      ideal R A; A \\<subseteq> J_rad R;  carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N \\<rbrakk> \\<Longrightarrow> carrier M = N\"", "lemma (in Ring) prodM_carr:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i))\\<rbrakk> \\<Longrightarrow> \n                                carrier (prodM R I M) = carr_prodag I M\"", "lemma (in Ring) prodM_mem_eq:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); \n      m1 \\<in> carrier (prodM R I M); m2 \\<in> carrier (prodM R I M); \n      \\<forall>i\\<in>I. m1 i = m2 i \\<rbrakk> \\<Longrightarrow> m1 = m2\"", "lemma (in Ring) prodM_sprod_mem:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); a \\<in> carrier R;\n       m \\<in> carr_prodag I M\\<rbrakk> \\<Longrightarrow> prodM_sprod R I M a m \\<in> carr_prodag I M\"", "lemma (in Ring) prodM_sprod_val:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); a \\<in> carrier R;\n m \\<in> carr_prodag I M; j \\<in> I\\<rbrakk> \\<Longrightarrow> (prodM_sprod R I M a m) j = a \\<cdot>\\<^sub>s\\<^bsub>(M j)\\<^esub> (m j)\"", "lemma (in Ring) prodM_Module:\"\\<forall>i\\<in>I. (R module (M i)) \\<Longrightarrow> \n                                      R module (prodM R I M)\"", "lemma (in Ring) dsumM_carr:\"carrier (dsumM R I M) = carr_dsumag I M\"", "lemma (in Ring) dsum_sprod_mem:\"\\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n       b \\<in> carr_dsumag I M\\<rbrakk>  \\<Longrightarrow> prodM_sprod R I M a b \\<in> carr_dsumag I M\"", "lemma (in Ring) carr_dsum_prod:\"carr_dsumag I M \\<subseteq> carr_prodag I M\"", "lemma (in Ring) carr_dsum_prod1:\"\n                 \\<forall>x. x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M\"", "lemma (in Ring) carr_dsumM_mem_eq:\"\\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n      y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j\\<rbrakk> \\<Longrightarrow> x = y\"", "lemma (in Ring) dsumM_Module:\"\\<forall>i\\<in>I. R module (M i) \\<Longrightarrow> R module (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\"", "lemma (in Ring) ringModule_Module:\"R module M\\<^bsub>R\\<^esub>\"", "lemma (in Ring) dsumMhom_mem:\"\\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n                \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); x \\<in> carr_dsumag I M\\<rbrakk>\n                 \\<Longrightarrow> dsumMhom I M N S x \\<in> carr_dsumag I N\"", "lemma (in Ring) dsumMhom_mHom:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); \n      \\<forall>i\\<in>I. (R module (N i)); \\<forall>i\\<in>I. ((S i) \\<in> mHom R (M i) (N i))\\<rbrakk> \\<Longrightarrow> \n                dsumMhom I M N S \\<in> mHom R (dsumM R I M) (dsumM R I N)\""], "translations": [["", "lemma (in Module) unique_expression_last:\" \\<lbrakk>free_generator R M H; \n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g; \n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; \n        f (Suc n) = g (Suc n)\\<rbrakk>  \\<Longrightarrow> s (Suc n) = t (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n)\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)", "apply (cut_tac sc_Ring, frule Ring.whole_ideal, frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)", "apply (frule l_comb_mem[of \"carrier R\" H s \"Suc n\" f], assumption+,\n       frule l_comb_mem[of \"carrier R\" H t \"Suc n\" g], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; l_comb R M (Suc n) s f \\<in> carrier M;\n     l_comb R M (Suc n) t g \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)", "apply (frule ag_r_inv1[of \"l_comb R M (Suc n) t g\"],\n       simp only:linear_span_iOp_closedTr2,\n             thin_tac \"l_comb R M (Suc n) t g \\<in> carrier M\",\n       frule sym, \n             thin_tac \"l_comb R M (Suc n) s f = l_comb R M (Suc n) t g\",\n             simp,\n             thin_tac \"l_comb R M (Suc n) t g = l_comb R M (Suc n) s f\",\n       subgoal_tac \"(\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)) \\<in> \n                                      {j. j \\<le> Suc n} \\<rightarrow> carrier R\",\n            simp add:l_comb_Suc,\n       frule funcset_mem[of s \"{j. j \\<le> Suc n}\" \"carrier R\" \"Suc n\"], \n                  simp,\n       frule funcset_mem[of t \"{j. j \\<le> Suc n}\" \"carrier R\" \"Suc n\"], \n                  simp,\n       frule funcset_mem[of g \"{j. j \\<le> Suc n}\" H \"Suc n\"], \n                  simp,\n       frule subsetD[of H \"carrier M\" \"g (Suc n)\"], assumption+,\n       frule func_pre[of s], frule func_pre[of t], frule func_pre[of f],\n            frule func_pre[of g], \n            frule func_pre[of \"\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)\"],\n       frule l_comb_mem[of \"carrier R\" H s n f], assumption+,\n       frule l_comb_mem[of \"carrier R\" H \"\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)\" \n               n g], assumption+,\n       frule sc_mem[of \"s (Suc n)\" \"g (Suc n)\"], assumption+,\n         cut_tac sc_mem[of \"-\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))\" \"g (Suc n)\"],\n       simp add:pOp_assocTr43[of \"l_comb R M n s f\" \"s (Suc n) \\<cdot>\\<^sub>s g (Suc n)\"],\n         simp add:ag_pOp_commute[of \"s (Suc n) \\<cdot>\\<^sub>s g (Suc n)\"],\n         simp add:pOp_assocTr43[THEN sym, of \"l_comb R M n s f\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g \\<plusminus>\n     (s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (frule Ring.ring_is_ag[of R],\n         frule aGroup.ag_mOp_closed[of R \"t (Suc n)\"], assumption+,\n         simp add:sc_l_distr[THEN sym],\n         simp add:l_comb_add[THEN sym, of \"carrier R\" H s n f \n                  \"\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)\" n g])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (frule jointfun_hom[of f n H g n H], assumption+,\n         frule jointfun_hom[of s n \"carrier R\" \"\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)\"\n          n \"carrier R\"], assumption+, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (subgoal_tac \"(s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))) \\<cdot>\\<^sub>s g (Suc n) = \n            l_comb R M 0 (\\<lambda>x\\<in>{0::nat}. (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))))\n               (\\<lambda>x\\<in>{0::nat}. (g (Suc n)))\",\n         simp,\n         thin_tac \"(s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))) \\<cdot>\\<^sub>s g (Suc n) =\n     l_comb R M 0 (\\<lambda>x\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n)))\n      (\\<lambda>x\\<in>{0}. g (Suc n))\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (subgoal_tac \"(\\<lambda>x\\<in>{0::nat}. (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n)))) \\<in> \n           {j. j \\<le> (0::nat)} \\<rightarrow> carrier R\",\n          subgoal_tac \"(\\<lambda>x\\<in>{0::nat}. g (Suc n)) \\<in>  {j. j \\<le> (0::nat)} \\<rightarrow> H\")"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}. g (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (simp add:l_comb_add[THEN sym] del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (cut_tac unique_expression3_1[of H \"jointfun (Suc (n + n)) \n         (jointfun n f n g) 0 (\\<lambda>x\\<in>{0}. g (Suc n))\" \"Suc (n + n)\" \n      \"jointfun (Suc (n + n))\n        (jointfun n s n (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x))) 0\n        (\\<lambda>x\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n)))\"], simp del: Pi_split_insert_domain,\n   thin_tac \"l_comb R M (Suc (Suc (n + n)))\n   (jointfun (Suc (n + n)) (jointfun n s n (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x))) 0\n   (\\<lambda>x\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0 (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>\",\n     thin_tac \"(\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)) \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\",\n     thin_tac \"l_comb R M n s f \\<in> carrier M\",\n     thin_tac \"jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H\",\n     thin_tac \"jointfun n s n (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x))\n                     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\",\n     thin_tac \"(\\<lambda>x\\<in>{0}. s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))) \\<in> {0} \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; s (Suc n) \\<in> carrier R;\n     t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n     g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     \\<exists>ga m.\n        ga \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> m} \\<and>\n        (\\<exists>ta.\n            ta \\<in> {l. l \\<le> m} \\<rightarrow> carrier R \\<and>\n            \\<zero> = l_comb R M m ta ga \\<and>\n            ta m =\n            jointfun (Suc (n + n))\n             (jointfun n s n\n               (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                   -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n             0 (\\<lambda>x\\<in>{0}.\n                   s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                   -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n             (Suc (Suc (n + n))) \\<and>\n            ga m =\n            jointfun (Suc (n + n)) (jointfun n f n g) 0\n             (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n))))\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M n s f \\<plusminus>\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (l_comb R M n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        g \\<plusminus>\n       (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n      \\<zero>;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n      g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      l_comb R M n s f \\<in> carrier M;\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n      \\<in> carrier M;\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n     \\<Longrightarrow> g (Suc n) \\<in> carrier M\nA total of 11 subgoals...", "apply (thin_tac \" (-\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\",\n        thin_tac \"-\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n)) \\<in> carrier R\",\n        thin_tac \"l_comb R M n (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> (t x)) g \\<in> carrier M\")"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; s (Suc n) \\<in> carrier R;\n     t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n     g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M; aGroup R;\n     \\<exists>ga m.\n        ga \\<in> {l. l \\<le> m} \\<rightarrow> H \\<and>\n        inj_on ga {l. l \\<le> m} \\<and>\n        (\\<exists>ta.\n            ta \\<in> {l. l \\<le> m} \\<rightarrow> carrier R \\<and>\n            \\<zero> = l_comb R M m ta ga \\<and>\n            ta m =\n            jointfun (Suc (n + n))\n             (jointfun n s n\n               (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                   -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n             0 (\\<lambda>x\\<in>{0}.\n                   s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                   -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n             (Suc (Suc (n + n))) \\<and>\n            ga m =\n            jointfun (Suc (n + n)) (jointfun n f n g) 0\n             (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n))))\\<rbrakk>\n    \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M n s f \\<plusminus>\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (l_comb R M n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        g \\<plusminus>\n       (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n      \\<zero>;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n      g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      l_comb R M n s f \\<in> carrier M;\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n      \\<in> carrier M;\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n     \\<Longrightarrow> g (Suc n) \\<in> carrier M\nA total of 11 subgoals...", "apply ((erule exE)+, (erule conjE)+, erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>ga m ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) \\<in> carrier R;\n        t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n        g (Suc n) \\<in> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M; aGroup R;\n        ga \\<in> {l. l \\<le> m} \\<rightarrow> H; inj_on ga {l. l \\<le> m};\n        ta \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        \\<zero> = l_comb R M m ta ga;\n        ta m =\n        jointfun (Suc (n + n))\n         (jointfun n s n\n           (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n         0 (\\<lambda>x\\<in>{0}.\n               s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n               -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n         (Suc (Suc (n + n)));\n        ga m =\n        jointfun (Suc (n + n)) (jointfun n f n g) 0\n         (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M n s f \\<plusminus>\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (l_comb R M n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        g \\<plusminus>\n       (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n      \\<zero>;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n      g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      l_comb R M n s f \\<in> carrier M;\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n      \\<in> carrier M;\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n     \\<Longrightarrow> g (Suc n) \\<in> carrier M\nA total of 11 subgoals...", "apply (frule_tac s = ta and n = m and m = ga in unique_expression1[of H],\n          assumption+, simp)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>ga m ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) \\<in> carrier R;\n        t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n        g (Suc n) \\<in> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M; aGroup R;\n        ga \\<in> {l. l \\<le> m} \\<rightarrow> H; inj_on ga {l. l \\<le> m};\n        ta \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        \\<zero> = l_comb R M m ta ga;\n        ta m =\n        jointfun (Suc (n + n))\n         (jointfun n s n\n           (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n         0 (\\<lambda>x\\<in>{0}.\n               s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n               -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n         (Suc (Suc (n + n)));\n        ga m =\n        jointfun (Suc (n + n)) (jointfun n f n g) 0\n         (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)));\n        \\<forall>j\\<in>{j. j \\<le> m}.\n           ta j = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M n s f \\<plusminus>\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (l_comb R M n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        g \\<plusminus>\n       (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n      \\<zero>;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n      g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      l_comb R M n s f \\<in> carrier M;\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n      \\<in> carrier M;\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n     \\<Longrightarrow> g (Suc n) \\<in> carrier M\nA total of 11 subgoals...", "apply (drule_tac x = m in bspec, simp)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>ga m ta.\n       \\<lbrakk>free_generator R M H;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) \\<in> carrier R;\n        t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n        g (Suc n) \\<in> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M; aGroup R;\n        ga \\<in> {l. l \\<le> m} \\<rightarrow> H; inj_on ga {l. l \\<le> m};\n        ta \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        \\<zero> = l_comb R M m ta ga;\n        ta m =\n        jointfun (Suc (n + n))\n         (jointfun n s n\n           (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n               -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n         0 (\\<lambda>x\\<in>{0}.\n               s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n               -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n         (Suc (Suc (n + n)));\n        ga m =\n        jointfun (Suc (n + n)) (jointfun n f n g) 0\n         (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)));\n        ta m = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) = t (Suc n)\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M n s f \\<plusminus>\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (l_comb R M n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        g \\<plusminus>\n       (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n      \\<zero>;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n      g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      l_comb R M n s f \\<in> carrier M;\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n      \\<in> carrier M;\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n     \\<Longrightarrow> g (Suc n) \\<in> carrier M\nA total of 11 subgoals...", "apply (simp add:jointfun_def[of \"Suc (n + n)\"] sliden_def,\n          thin_tac \"\\<zero> = l_comb R M m ta ga\",\n          thin_tac \"ta m = s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t (Suc n))\",\n          frule Ring.ring_is_ag[of R],\n          rotate_tac -2, frule sym,\n       subst aGroup.ag_eq_diffzero[of R \"s (Suc n)\" \"t (Suc n)\"], assumption+)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>ga m ta.\n       \\<lbrakk>ga m = g (Suc n); aGroup R; free_generator R M H;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; s (Suc n) \\<in> carrier R;\n        t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n        g (Suc n) \\<in> carrier M;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M; aGroup R;\n        ga \\<in> {l. l \\<le> m} \\<rightarrow> H; inj_on ga {l. l \\<le> m};\n        ta \\<in> {l. l \\<le> m} \\<rightarrow> carrier R;\n        \\<zero>\\<^bsub>R\\<^esub> =\n        s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n);\n        g (Suc n) = ga m\\<rbrakk>\n       \\<Longrightarrow> s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M n s f \\<plusminus>\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n      (l_comb R M n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n        g \\<plusminus>\n       (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n      \\<zero>;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n      g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n      s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n      l_comb R M n s f \\<in> carrier M;\n      l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n      \\<in> carrier M;\n      s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n     \\<Longrightarrow> g (Suc n) \\<in> carrier M\nA total of 11 subgoals...", "apply (rule sym, assumption)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier M\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 10. \\<lbrakk>free_generator R M H;\n      f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n      t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n      inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n      f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n      H \\<subseteq> carrier M;\n      l_comb R M (Suc n) s f \\<plusminus>\n      l_comb R M (Suc n)\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g =\n      \\<zero>\\<rbrakk>\n     \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                       \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply assumption"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow> H\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 9. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (rule Pi_I,\n          case_tac \"x \\<le> Suc (n + n)\", simp add:jointfun_def del: Pi_split_insert_domain, \n          simp add:Pi_def del: Pi_split_insert_domain,\n          rule impI, simp add:sliden_def del: Pi_split_insert_domain,\n          simp add:Pi_def, simp add:jointfun_def sliden_def del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n))\n                       (jointfun n s n\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n                       0 (\\<lambda>x\\<in>{0}.\n                             s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {l. l \\<le> Suc (Suc (n + n))} \\<rightarrow>\n                            carrier R\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                       (\\<lambda>x\\<in>{0}. g (Suc n)) (Suc (Suc (n + n)))\n                      \\<notin> jointfun (Suc (n + n)) (jointfun n f n g) 0\n                                (\\<lambda>x\\<in>{0}. g (Suc n)) `\n                               ({l. l \\<le> Suc (Suc (n + n))} -\n                                {Suc (Suc (n + n))})\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 8. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (rule Pi_I,\n          case_tac \"x \\<le> Suc (n + n)\",\n          simp add:jointfun_def[of \"Suc (n+n)\"] del: Pi_split_insert_domain,\n          simp add:Pi_def,\n          simp add:jointfun_def[of \"Suc (n + n)\"] sliden_def del: Pi_split_insert_domain,\n          rule aGroup.ag_pOp_closed, assumption+,\n          simp add: Nset_pre1 del: Pi_split_insert_domain,\n          simp add:im_jointfunTr1[of \"Suc (n+n)\" \"jointfun n f n g\" 0 \n              \"\\<lambda>x\\<in>{0}. g (Suc n)\"] del: Pi_split_insert_domain,\n          simp add:im_jointfun[of f n H g n H] del: Pi_split_insert_domain,\n          (subst jointfun_def[of \"Suc (n+n)\"])+, simp add:sliden_def del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<notin> f ` {l. l \\<le> n} \\<and>\n                      g (Suc n) \\<notin> g ` {l. l \\<le> n}\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (rule conjI, frule sym, thin_tac \"f (Suc n) = g (Suc n)\",\n         simp add:inj_on_def[of f],\n         rule contrapos_pp, simp+, simp add:image_def, erule exE, \n         erule conjE,\n         drule_tac a = \"Suc n\" in forall_spec, simp,\n         drule_tac a = x in forall_spec, simp, simp)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (Suc (n + n)))\n      (jointfun (Suc (n + n))\n        (jointfun n s n\n          (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n              -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n        0 (\\<lambda>x\\<in>{0}.\n              s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n              -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)))\n      (jointfun (Suc (n + n)) (jointfun n f n g) 0\n        (\\<lambda>x\\<in>{0}. g (Suc n))) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<notin> g ` {l. l \\<le> n}\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 7. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (simp add:inj_on_def[of g],\n         rule contrapos_pp, simp+, simp add:image_def, erule exE, \n         erule conjE,\n         drule_tac a = \"Suc n\" in forall_spec, simp,\n         drule_tac a = x in forall_spec, simp, simp)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R;\n     (\\<lambda>x\\<in>{0}.\n         s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n     \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}. g (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 6. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     l_comb R M 0\n      (\\<lambda>x\\<in>{0}.\n          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n      (\\<lambda>x\\<in>{0}. g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                          s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 5. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (rule Pi_I, simp,\n           rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc (n + n))\n      (jointfun n s n\n        (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x))\n      (jointfun n f n g) \\<plusminus>\n     (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n     g (Suc n) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)\n     \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R;\n     jointfun n f n g \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> H;\n     jointfun n s n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc (n + n)} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> (s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s\n                      g (Suc n) =\n                      l_comb R M 0\n                       (\\<lambda>x\\<in>{0}.\n                           s (Suc n) \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n))\n                       (\\<lambda>x\\<in>{0}. g (Suc n))\n 2. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n) \\<in> carrier R\n 3. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M n s f \\<plusminus>\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<plusminus>\n     (l_comb R M n\n       (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n       g \\<plusminus>\n      (-\\<^sub>a\\<^bsub>R\\<^esub> t (Suc n)) \\<cdot>\\<^sub>s g (Suc n)) =\n     \\<zero>;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     s (Suc n) \\<in> carrier R; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n     \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<in> carrier M;\n     l_comb R M n\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x) g\n     \\<in> carrier M;\n     s (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> g (Suc n) \\<in> carrier M\n 4. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (subst l_comb_def, simp,\n           rule aGroup.ag_mOp_closed, simp add:Ring.ring_is_ag,\n           simp add:Pi_def, simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M;\n     l_comb R M (Suc n) s f \\<plusminus>\n     l_comb R M (Suc n)\n      (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n      g =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                          -\\<^sub>a\\<^bsub>R\\<^esub> t x)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R", "apply (rule Pi_I, simp,\n           frule Ring.ring_is_ag[of R],\n           rule aGroup.ag_mOp_closed[of R], assumption+,\n           simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_exprTr7p1:\"  \\<lbrakk>free_generator R M H;\n  \\<forall>f s g t m.\n   f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> inj_on f {j. j \\<le> n} \\<and> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n   g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and> inj_on g {j. j \\<le> m} \\<and> t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n   l_comb R M n s f = l_comb R M m t g \\<and> \n         (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> (\\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n   (\\<exists>h. h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n                (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n   g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H; t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n   l_comb R M (Suc n) s f = l_comb R M (Suc n) t g; \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n   \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; \n   f (Suc n) = g (Suc n)\\<rbrakk> \\<Longrightarrow> \\<exists>h. h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n              (\\<forall>l\\<le>Suc n. cmp f h l = g l \\<and> cmp s h l = t l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac sc_Ring, frule Ring.whole_ideal,\n       frule Ring.ring_is_ag,\n       frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac f = f and n = n and s = s and g = g and t = t in \n         unique_expression_last[of H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (simp add:l_comb_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus> t (Suc n) \\<cdot>\\<^sub>s g (Suc n) =\n     l_comb R M n t g \\<plusminus> t (Suc n) \\<cdot>\\<^sub>s g (Suc n);\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac f = f in func_pre, frule_tac f = s in func_pre,\n         frule_tac f = g in func_pre, frule_tac f = t in func_pre,\n         cut_tac n = n in Nsetn_sub,\n         frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and ?A1.0 = \"{j. j \\<le> n}\" in \n         restrict_inj, assumption+,\n         frule_tac f = g and A = \"{j. j \\<le> Suc n}\" and ?A1.0 = \"{j. j \\<le> n}\" in \n         restrict_inj, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus> t (Suc n) \\<cdot>\\<^sub>s g (Suc n) =\n     l_comb R M n t g \\<plusminus> t (Suc n) \\<cdot>\\<^sub>s g (Suc n);\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n}; inj_on f {j. j \\<le> n};\n     inj_on g {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac s = s and m = f and n = n in l_comb_mem[of \"carrier R\" H], \n         assumption+,\n         frule_tac s = t and m = g and n = n in l_comb_mem[of \"carrier R\" H], \n         assumption+,\n         frule_tac f = t and A = \"{j. j \\<le> Suc n}\" and B = \"carrier R\" and \n         x = \"Suc n\" in funcset_mem, simp,\n         frule_tac f = g and A = \"{j. j \\<le> Suc n}\" and B = H and x = \"Suc n\" \n         in funcset_mem, simp,\n         frule_tac c = \"g (Suc n)\" in subsetD[of H \"carrier M\"], assumption+,\n         frule_tac a = \"t (Suc n)\" and m = \"g (Suc n)\" in sc_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     l_comb R M n s f \\<plusminus> t (Suc n) \\<cdot>\\<^sub>s g (Suc n) =\n     l_comb R M n t g \\<plusminus> t (Suc n) \\<cdot>\\<^sub>s g (Suc n);\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n}; inj_on f {j. j \\<le> n};\n     inj_on g {j. j \\<le> n}; l_comb R M n s f \\<in> carrier M;\n     l_comb R M n t g \\<in> carrier M; t (Suc n) \\<in> carrier R;\n     g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n     t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac x = \"l_comb R M n s f\" and y = \"t (Suc n) \\<cdot>\\<^sub>s g (Suc n)\" and\n         z = \"-\\<^sub>a (t (Suc n) \\<cdot>\\<^sub>s g (Suc n))\" in ag_pOp_assoc, assumption+,\n         rule ag_mOp_closed, assumption, simp add:ag_r_inv1 ag_r_zero,\n         frule_tac x = \"t (Suc n) \\<cdot>\\<^sub>s g (Suc n)\" in ag_mOp_closed,\n         simp add:ag_pOp_assoc, simp add:ag_r_inv1 ag_r_zero,\n         rotate_tac -2, frule sym,\n                thin_tac \"l_comb R M n t g = l_comb R M n s f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     free_generator R M H;\n     \\<forall>f s g t m.\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> n} \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M n s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<le>m.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n        n = m \\<and>\n        (\\<exists>h.\n            h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n            (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n}; inj_on f {j. j \\<le> n};\n     inj_on g {j. j \\<le> n}; l_comb R M n s f \\<in> carrier M;\n     t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n     g (Suc n) \\<in> carrier M;\n     t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     l_comb R M n s f = l_comb R M n t g\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (drule_tac x = f in spec,\n  rotate_tac -1,\n  drule_tac x = s in spec,\n  rotate_tac -1,\n  drule_tac x = g in spec,\n  rotate_tac -1, drule_tac x = t in spec,\n  rotate_tac -1, drule_tac x = n in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     free_generator R M H; f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n}; inj_on f {j. j \\<le> n};\n     inj_on g {j. j \\<le> n}; l_comb R M n s f \\<in> carrier M;\n     t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n     g (Suc n) \\<in> carrier M;\n     t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     l_comb R M n s f = l_comb R M n t g;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n     inj_on f {j. j \\<le> n} \\<and>\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n     inj_on g {j. j \\<le> n} \\<and>\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n     l_comb R M n s f = l_comb R M n t g \\<and>\n     (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n     (\\<forall>k\\<le>n.\n         t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n     n = n \\<and>\n     (\\<exists>h.\n         h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n         (\\<forall>l\\<le>n.\n             cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     free_generator R M H; f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n     \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n     inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n     f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n     H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n     f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n     t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n}; inj_on f {j. j \\<le> n};\n     inj_on g {j. j \\<le> n}; l_comb R M n t g \\<in> carrier M;\n     t (Suc n) \\<in> carrier R; g (Suc n) \\<in> H;\n     g (Suc n) \\<in> carrier M;\n     t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n     l_comb R M n s f = l_comb R M n t g;\n     \\<exists>h.\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n        (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 {j. j \\<le> Suc n} \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             cmp f h l = g l \\<and> cmp s h l = t l)", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n)\n                \\<in> carrier M;\n        free_generator R M H; f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n        H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> n}; inj_on g {j. j \\<le> n};\n        l_comb R M n t g \\<in> carrier M; t (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n        l_comb R M n s f = l_comb R M n t g;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        \\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (subgoal_tac \"(jointfun n h 0 (\\<lambda>j. (Suc n))) \\<in> \n                       {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\",\n        subgoal_tac \"\\<forall>l\\<le>Suc n. cmp f (jointfun n h 0 (\\<lambda>j. (Suc n))) l = \n          g l \\<and> cmp s (jointfun n h 0 (\\<lambda>j. (Suc n))) l = t l\",\n   thin_tac \"\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\", thin_tac \"inj_on f {j. j \\<le> Suc n}\",\n   thin_tac \"inj_on g {j. j \\<le> Suc n}\", thin_tac \"f (Suc n) = g (Suc n)\",\n   thin_tac \"s (Suc n) = t (Suc n)\",\n   thin_tac \"f \\<in> {j. j \\<le> n} \\<rightarrow> H\", thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n   thin_tac \"g \\<in> {j. j \\<le> n} \\<rightarrow> H\", thin_tac \"t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n   thin_tac \"{j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n}\",\n   thin_tac \"\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l\",\n   thin_tac \"l_comb R M n t g \\<in> carrier M\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h.\n       \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n)\n                \\<in> carrier M;\n        free_generator R M H; f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n        H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> n}; inj_on g {j. j \\<le> n};\n        l_comb R M n t g \\<in> carrier M; t (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n        l_comb R M n s f = l_comb R M n t g;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        \\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l;\n        jointfun n h 0 (\\<lambda>j. Suc n)\n        \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>Suc n.\n                            cmp f (jointfun n h 0 (\\<lambda>j. Suc n)) l =\n                            g l \\<and>\n                            cmp s (jointfun n h 0 (\\<lambda>j. Suc n)) l =\n                            t l\n 2. \\<And>h.\n       \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n)\n                \\<in> carrier M;\n        free_generator R M H; f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n        H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> n}; inj_on g {j. j \\<le> n};\n        l_comb R M n t g \\<in> carrier M; t (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n        l_comb R M n s f = l_comb R M n t g;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        \\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l\\<rbrakk>\n       \\<Longrightarrow> jointfun n h 0 (\\<lambda>j. Suc n)\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                               {j. j \\<le> Suc n}", "apply (rule allI, rule impI, case_tac \"l \\<le> n\", \n                                simp add:cmp_def jointfun_def,\n         simp add:cmp_def, simp add:jointfun_def sliden_def,\n         frule_tac y = l and x = n in not_le_imp_less, thin_tac \"\\<not> l \\<le> n\",\n         frule_tac m = n and n = l in Suc_leI,\n         frule_tac m = l and n = \"Suc n\" in Nat.le_antisym, assumption,\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>-\\<^sub>a t (Suc n) \\<cdot>\\<^sub>s g (Suc n)\n                \\<in> carrier M;\n        free_generator R M H; f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        f (Suc n) = g (Suc n); Ring R; ideal R (carrier R); aGroup R;\n        H \\<subseteq> carrier M; s (Suc n) = t (Suc n);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        {j. j \\<le> n} \\<subseteq> {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> n}; inj_on g {j. j \\<le> n};\n        l_comb R M n t g \\<in> carrier M; t (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> H; g (Suc n) \\<in> carrier M;\n        t (Suc n) \\<cdot>\\<^sub>s g (Suc n) \\<in> carrier M;\n        l_comb R M n s f = l_comb R M n t g;\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        \\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l\\<rbrakk>\n       \\<Longrightarrow> jointfun n h 0 (\\<lambda>j. Suc n)\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                               {j. j \\<le> Suc n}", "apply (rule Pi_I,\n         case_tac \"xa \\<le> n\", simp add:jointfun_def, rule impI,\n         frule_tac x = x and f = h and A = \"{j. j \\<le> n}\" and \n         B = \"{j. j \\<le> n}\" in funcset_mem, simp, simp,\n         simp add:jointfun_def, rule impI,frule_tac x = x and f = h and \n         A = \"{j. j \\<le> n}\" and B = \"{j. j \\<le> n}\" in funcset_mem, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) unique_expression7:\"free_generator R M H \\<Longrightarrow>\n \\<forall>f s g t m. f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> H \\<and> inj_on f {j. j \\<le> n} \\<and>\n    s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n    g \\<in> {j. j \\<le> (m::nat)} \\<rightarrow> H \\<and> inj_on g {j. j \\<le> m} \\<and>\n    t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and> l_comb R M n s f = l_comb R M m t g \\<and>\n    (\\<forall>j \\<in> {j. j \\<le> n}. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> (\\<forall>k \\<in> {j. j \\<le> m}. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub> ) \\<longrightarrow> n = m \\<and> \n    (\\<exists>h. h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and> (\\<forall>l \\<in> {j. j \\<le> n}. (cmp f h) l = g l\n      \\<and> (cmp s h) l = t l))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. free_generator R M H \\<Longrightarrow>\n    \\<forall>f s g t m.\n       f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n       inj_on f {j. j \\<le> n} \\<and>\n       s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n       inj_on g {j. j \\<le> m} \\<and>\n       t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n       l_comb R M n s f = l_comb R M m t g \\<and>\n       (\\<forall>j\\<in>{j. j \\<le> n}.\n           s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n       (\\<forall>k\\<in>{j. j \\<le> m}.\n           t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n       n = m \\<and>\n       (\\<exists>h.\n           h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> n}.\n               cmp f h l = g l \\<and> cmp s h l = t l))", "apply (cut_tac sc_Ring,\n        frule Ring.ring_is_ag[of R],\n        frule free_generator_sub[of H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f s g t m.\n                         f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n                         inj_on f {j. j \\<le> n} \\<and>\n                         s \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 carrier R \\<and>\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {j. j \\<le> m} \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M n s f = l_comb R M m t g \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> n}.\n                             s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         (\\<forall>k\\<in>{j. j \\<le> m}.\n                             t k \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                         n = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> n} \\<rightarrow>\n                                     {j. j \\<le> n} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> n}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f s g t m.\n                         f \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                         inj_on f {j. j \\<le> 0} \\<and>\n                         s \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 carrier R \\<and>\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {j. j \\<le> m} \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M 0 s f = l_comb R M m t g \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> 0}.\n                             s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         (\\<forall>k\\<in>{j. j \\<le> m}.\n                             t k \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                         0 = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                     {j. j \\<le> 0} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> 0}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (rule allI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> 0} \\<rightarrow> H \\<and>\n                         inj_on f {j. j \\<le> 0} \\<and>\n                         s \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 carrier R \\<and>\n                         g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                         inj_on g {j. j \\<le> m} \\<and>\n                         t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                 carrier R \\<and>\n                         l_comb R M 0 s f = l_comb R M m t g \\<and>\n                         (\\<forall>j\\<in>{j. j \\<le> 0}.\n                             s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                         (\\<forall>k\\<in>{j. j \\<le> m}.\n                             t k \\<noteq>\n                             \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                         0 = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                     {j. j \\<le> 0} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> 0}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n        inj_on f {j. j \\<le> 0};\n        s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M 0 s f = l_comb R M m t g;\n        \\<forall>j\\<in>{j. j \\<le> 0}.\n           s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<in>{j. j \\<le> m}.\n           t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> 0 = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                     {j. j \\<le> 0} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> 0}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (frule_tac H = H and f = f and n = 0 and s = s and g = g and m = m \n        and t = t in unique_expression7_1, assumption+, simp del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        l_comb R M 0 s f = l_comb R M 0 t g;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (frule_tac H = H and f = f and n = 0 and s = s and g = g and m = m \n        and t = t in  unique_expression6, (simp del: Pi_split_insert_domain) +)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        l_comb R M 0 s f = l_comb R M 0 t g;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (simp add:l_comb_def del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (frule_tac f = s in funcset_mem[of _ \"{0}\" \"carrier R\" 0], simp del: Pi_split_insert_domain,\n        frule_tac f = t in funcset_mem[of _ \"{0}\" \"carrier R\" 0], simp del: Pi_split_insert_domain,\n        frule_tac f = g in funcset_mem[of _ \"{0}\" H 0], simp del: Pi_split_insert_domain,\n        frule_tac c = \"g 0\" in subsetD[of \"H\" \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (frule_tac a = \"s 0\" and m = \"g 0\" in sc_mem, assumption+, \n        frule_tac a = \"t 0\" and m = \"g 0\" in sc_mem, assumption+,\n        frule_tac a = \"s 0 \\<cdot>\\<^sub>s g 0\" and b = \"t 0 \\<cdot>\\<^sub>s g 0\" in ag_eq_diffzero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M; s 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M\n 2. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M; s 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        (s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0) =\n        (s 0 \\<cdot>\\<^sub>s g 0 \\<plusminus>\n         -\\<^sub>a t 0 \\<cdot>\\<^sub>s g 0 =\n         \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 3. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M; s 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        (s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0) =\n        (s 0 \\<cdot>\\<^sub>s g 0 \\<plusminus>\n         -\\<^sub>a t 0 \\<cdot>\\<^sub>s g 0 =\n         \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (simp only:sc_minus_am1, \n        thin_tac \"(s 0 \\<cdot>\\<^sub>s g 0 = t 0 \\<cdot>\\<^sub>s g 0) = (\\<zero> = \\<zero>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> t 0) \\<cdot>\\<^sub>s g 0 =\n        \\<zero>;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M; s 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (frule_tac x = \"t 0\" in aGroup.ag_mOp_closed[of R], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M; f \\<in> {0} \\<rightarrow> H;\n        s \\<in> {0} \\<rightarrow> carrier R; g \\<in> {0} \\<rightarrow> H;\n        t \\<in> {0} \\<rightarrow> carrier R;\n        s 0 \\<cdot>\\<^sub>s g 0 \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> t 0) \\<cdot>\\<^sub>s g 0 =\n        \\<zero>;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M; s 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        -\\<^sub>a\\<^bsub>R\\<^esub> t 0 \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {0} \\<rightarrow> {0} \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (simp add:sc_l_distr[THEN sym],\n        frule_tac h = \"g 0\" and a = \"s 0 \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (t 0)\" in \n        free_gen_coeff_zero[of H],\n        assumption+,\n        rule aGroup.ag_pOp_closed[of R], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        (s 0 \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> t 0) \\<cdot>\\<^sub>s\n        g 0 =\n        \\<zero>;\n        s 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        t 0 \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; m = 0; f 0 = g 0;\n        s 0 \\<in> carrier R; t 0 \\<in> carrier R; g 0 \\<in> H;\n        g 0 \\<in> carrier M; s 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        t 0 \\<cdot>\\<^sub>s g 0 \\<in> carrier M;\n        -\\<^sub>a\\<^bsub>R\\<^esub> t 0 \\<in> carrier R;\n        s 0 \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> t 0 =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h 0 = 0 \\<and>\n                            cmp f h 0 = g 0 \\<and> cmp s h 0 = t 0\n 2. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply (simp add:aGroup.ag_eq_diffzero[THEN sym, of R],\n        simp add:cmp_def,\n        cut_tac Pi_I[of \"{0::nat}\" \"id\" \"%_. {0::nat}\"],\n        subgoal_tac \"f (id 0) = g 0 \\<and> s (id 0) = t 0\", blast,\n        simp add:id_def, simp add:id_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "(** n = 0 done **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f s g t m.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    H \\<and>\n                            inj_on f {j. j \\<le> Suc n} \\<and>\n                            s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    carrier R \\<and>\n                            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n                            inj_on g {j. j \\<le> m} \\<and>\n                            t \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    carrier R \\<and>\n                            l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n                            (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n                                s j \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                            (\\<forall>k\\<in>{j. j \\<le> m}.\n                                t k \\<noteq>\n                                \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n                            Suc n = m \\<and>\n                            (\\<exists>h.\n                                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n  {j. j \\<le> Suc n} \\<and>\n                                (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                    cmp f h l = g l \\<and> cmp s h l = t l))", "apply ((rule allI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H \\<and>\n        inj_on f {j. j \\<le> Suc n} \\<and>\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n        inj_on g {j. j \\<le> m} \\<and>\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n        l_comb R M (Suc n) s f = l_comb R M m t g \\<and>\n        (\\<forall>j\\<in>{j. j \\<le> Suc n}.\n            s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n        (\\<forall>k\\<in>{j. j \\<le> m}.\n            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> Suc n = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                     {j. j \\<le> Suc n} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M m t g;\n        \\<forall>j\\<in>{j. j \\<le> Suc n}.\n           s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<in>{j. j \\<le> m}.\n           t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> Suc n = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                     {j. j \\<le> Suc n} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))", "apply (frule_tac H = H and f = f and n = \"Suc n\" and s = s and g = g and \n       m = m and t = t in unique_expression6, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<in>{j. j \\<le> n}.\n               s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<in>{j. j \\<le> m}.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<in>{j. j \\<le> n}.\n                   cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        inj_on f {j. j \\<le> Suc n};\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M m t g;\n        \\<forall>j\\<in>{j. j \\<le> Suc n}.\n           s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<in>{j. j \\<le> m}.\n           t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> Suc n = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                     {j. j \\<le> Suc n} \\<and>\n                             (\\<forall>l\\<in>{j. j \\<le> Suc n}.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))", "apply (cut_tac k = \"Suc n\" in finite_Collect_le_nat,\n         frule_tac A = \"{j. j \\<le> Suc n}\" and f = f in inj_on_iff_eq_card,\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        card (g ` {j. j \\<le> m}) = Suc (Suc n);\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; inj_on g {j. j \\<le> m};\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M m t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> m};\n        inj_on f {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> Suc n = m \\<and>\n                         (\\<exists>h.\n                             h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                     {j. j \\<le> Suc n} \\<and>\n                             (\\<forall>l\\<le>Suc n.\n                                 cmp f h l = g l \\<and> cmp s h l = t l))", "apply (cut_tac k = m in finite_Collect_le_nat,\n         frule_tac A = \"{j. j \\<le> m}\" and f = g in inj_on_iff_eq_card,\n         simp,\n         thin_tac \"card (g ` {j. j \\<le> m}) = Suc m\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H; Suc n = m;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M m s f = l_comb R M m t g;\n        \\<forall>j\\<le>m. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> m} = g ` {j. j \\<le> m}; inj_on f {j. j \\<le> m};\n        inj_on g {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> m} \\<rightarrow>\n                                    {j. j \\<le> m} \\<and>\n                            (\\<forall>l\\<le>m.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule sym, thin_tac \"Suc n = m\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        m = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac a = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" and f = g in \n         mem_in_image2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n        m = Suc n\\<rbrakk>\n       \\<Longrightarrow> Suc n \\<in> {j. j \\<le> Suc n}\n 2. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        g (Suc n) \\<in> g ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>free_generator R M H; Ring R; aGroup R;\n        H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        g (Suc n) \\<in> g ` {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (\n         rotate_tac -6)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> Suc n};\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        g (Suc n) \\<in> g ` {j. j \\<le> Suc n}; free_generator R M H;\n        Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply ( frule sym,\n         thin_tac \"f ` {j. j \\<le> Suc n} = g ` {j. j \\<le> Suc n}\", simp,\n         simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        \\<exists>x\\<le>Suc n. g (Suc n) = f x; free_generator R M H; Ring R;\n        aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply ( erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; g (Suc n) = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (case_tac \"x = Suc n\", simp, thin_tac \"x = Suc n\",\n         rotate_tac -1, frule sym, thin_tac \"g (Suc n) = f (Suc n)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        f (Suc n) = g (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; g (Suc n) = f x; x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (rule_tac n = n and f = f and s = s and g = g and t = t in \n          unique_exprTr7p1[of H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; g (Suc n) = f x; x \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (rotate_tac -2, frule sym, thin_tac \"g (Suc n) = f x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac s = s and n = n and f = f and j = x in \n         l_comb_transpos1[of \"carrier R\" H], assumption+,\n         rule noteq_le_less, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        l_comb R M (Suc n) s f = l_comb R M (Suc n) t g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (\n         thin_tac \"l_comb R M (Suc n) s f = l_comb R M (Suc n) t g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac f = \"cmp f (transpos x (Suc n))\" and n = n and \n         s = \"cmp s (transpos x (Suc n))\" and g = g and t = t in \n         unique_exprTr7p1[of H], assumption+)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n))\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp s (transpos x (Suc n))\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\n 5. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n                          (cmp f (transpos x (Suc n))) =\n                         l_comb R M (Suc n) t g\n 6. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                            cmp s (transpos x (Suc n)) j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 7. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 8. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 9. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 10. \\<And>n f s g t m x.\n        \\<lbrakk>x \\<noteq> Suc n;\n         \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n         m = Suc n; free_generator R M H; Ring R; aGroup R;\n         H \\<subseteq> carrier M;\n         \\<forall>f s g t m.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {j. j \\<le> m} \\<and>\n            t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n            l_comb R M n s f = l_comb R M m t g \\<and>\n            (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            (\\<forall>k\\<le>m.\n                t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n            n = m \\<and>\n            (\\<exists>h.\n                h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n                (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n         s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n         g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n         t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n         l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n          (cmp f (transpos x (Suc n))) =\n         l_comb R M (Suc n) t g;\n         \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         {y. \\<exists>x\\<le>Suc n. y = g x} =\n         {y. \\<exists>x\\<le>Suc n. y = f x};\n         x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n        \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\nA total of 11 subgoals...", "apply (rule Pi_I,\n         simp add:cmp_def, rule_tac f = f and A = \"{j. j \\<le> Suc n}\" and B = H \n         and x = \"transpos x (Suc n) xa\" in funcset_mem, simp,\n         simp add:transpos_mem)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp s (transpos x (Suc n))\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n                          (cmp f (transpos x (Suc n))) =\n                         l_comb R M (Suc n) t g\n 5. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                            cmp s (transpos x (Suc n)) j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 6. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 7. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 8. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 9. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 10. \\<And>n f s g t m x.\n        \\<lbrakk>x \\<noteq> Suc n;\n         \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n};\n         m = Suc n; free_generator R M H; Ring R; aGroup R;\n         H \\<subseteq> carrier M;\n         \\<forall>f s g t m.\n            f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n            inj_on f {j. j \\<le> n} \\<and>\n            s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n            g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n            inj_on g {j. j \\<le> m} \\<and>\n            t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n            l_comb R M n s f = l_comb R M m t g \\<and>\n            (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n            (\\<forall>k\\<le>m.\n                t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n            n = m \\<and>\n            (\\<exists>h.\n                h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n                (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n         f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n         s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n         g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n         t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n         l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n          (cmp f (transpos x (Suc n))) =\n         l_comb R M (Suc n) t g;\n         \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         {y. \\<exists>x\\<le>Suc n. y = g x} =\n         {y. \\<exists>x\\<le>Suc n. y = f x};\n         x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n         \\<exists>h.\n            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                    {j. j \\<le> Suc n} \\<and>\n            (\\<forall>l\\<le>Suc n.\n                cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n                cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n        \\<Longrightarrow> \\<exists>h.\n                             h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                     {j. j \\<le> Suc n} \\<and>\n                             (\\<forall>l\\<le>Suc n.\n                                 cmp f h l = g l \\<and> cmp s h l = t l)", "apply (rule Pi_I,\n         simp add:cmp_def, rule_tac f = s and A = \"{j. j \\<le> Suc n}\" and \n         B = \"carrier R\" and x = \"transpos x (Suc n) xa\" in funcset_mem, simp,\n         simp add:transpos_mem)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n                          (cmp f (transpos x (Suc n))) =\n                         l_comb R M (Suc n) t g\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                            cmp s (transpos x (Suc n)) j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 5. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 6. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 7. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 8. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 9. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply assumption+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                            cmp s (transpos x (Suc n)) j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 5. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 6. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n f s g t m x j.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. f (h l) = g l \\<and> s (h l) = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (\\<lambda>xa. s (transpos x (Suc n) xa))\n         (\\<lambda>xa. f (transpos x (Suc n) xa)) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> s (transpos x (Suc n) j) \\<noteq>\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 5. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 6. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac i = x and n = \"Suc n\" and j = \"Suc n\" and l = j in \n              transpos_mem, simp+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac i = x and n = \"Suc n\" and j = \"Suc n\" in transpos_inj,\n          simp+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        inj_on (transpos x (Suc n)) {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac  i = x and n = \"Suc n\" and j = \"Suc n\" in \n              transpos_hom, simp+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        inj_on (transpos x (Suc n)) {i. i \\<le> Suc n};\n        transpos x (Suc n)\n        \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp f (transpos x (Suc n)))\n                          {j. j \\<le> Suc n}\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> Suc n}\n 3. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 4. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (rule_tac f = \"transpos x (Suc n)\" and A = \"{j. j \\<le> Suc n}\" and \n          B = \"{j. j \\<le> Suc n}\" and g = f and C = H in cmp_inj,\n          assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos x (Suc n)) (Suc n) = g (Suc n)\n 2. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (simp add:cmp_def transpos_ij_2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        \\<exists>h.\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           (\\<forall>l\\<le>Suc n.\n               cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n               cmp (cmp s (transpos x (Suc n))) h l = t l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x h.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n        \\<forall>l\\<le>Suc n.\n           cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n           cmp (cmp s (transpos x (Suc n))) h l = t l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (cut_tac  i = x and n = \"Suc n\" and j = \"Suc n\" in \n              transpos_hom, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x h.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n        \\<forall>l\\<le>Suc n.\n           cmp (cmp f (transpos x (Suc n))) h l = g l \\<and>\n           cmp (cmp s (transpos x (Suc n))) h l = t l;\n        transpos x (Suc n)\n        \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (simp add:cmp_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x h.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n        \\<forall>l\\<le>Suc n.\n           cmp f (cmp (transpos x (Suc n)) h) l = g l \\<and>\n           cmp s (cmp (transpos x (Suc n)) h) l = t l;\n        transpos x (Suc n)\n        \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (frule_tac f = h and A = \"{j. j \\<le> Suc n}\" and B = \"{j. j \\<le> Suc n}\" \n          and g = \"transpos x (Suc n)\" and C = \"{j. j \\<le> Suc n}\" in \n          cmp_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x h.\n       \\<lbrakk>x \\<noteq> Suc n;\n        \\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        inj_on f {j. j \\<le> Suc n}; inj_on g {j. j \\<le> Suc n}; m = Suc n;\n        free_generator R M H; Ring R; aGroup R; H \\<subseteq> carrier M;\n        \\<forall>f s g t m.\n           f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n           inj_on f {j. j \\<le> n} \\<and>\n           s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n           g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and>\n           inj_on g {j. j \\<le> m} \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g \\<and>\n           (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n           (\\<forall>k\\<le>m.\n               t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>\n           n = m \\<and>\n           (\\<exists>h.\n               h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and>\n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l));\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        \\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        {y. \\<exists>x\\<le>Suc n. y = g x} =\n        {y. \\<exists>x\\<le>Suc n. y = f x};\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n        \\<forall>l\\<le>Suc n.\n           cmp f (cmp (transpos x (Suc n)) h) l = g l \\<and>\n           cmp s (cmp (transpos x (Suc n)) h) l = t l;\n        transpos x (Suc n)\n        \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n        cmp (transpos x (Suc n)) h\n        \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply (thin_tac \"\\<forall>f s g t m. f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and> inj_on f {j. j \\<le> n} \\<and>\n   s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and> g \\<in> {j. j \\<le> m} \\<rightarrow> H \\<and> inj_on g {j. j \\<le> m} \\<and>\n   t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and> l_comb R M n s f = l_comb R M m t g \\<and>\n   (\\<forall>j\\<le>n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<and> (\\<forall>k\\<le>m. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>) \\<longrightarrow>  n = m \\<and>\n   (\\<exists>h. h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n} \\<and> \n               (\\<forall>l\\<le>n. cmp f h l = g l \\<and> cmp s h l = t l))\",\n    thin_tac \"\\<forall>j\\<le>Suc n. s j \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\", thin_tac \"\\<forall>k\\<le>Suc n. t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\",\n    thin_tac \"{y. \\<exists>x\\<le>Suc n. y = g x} = {y. \\<exists>x\\<le>Suc n. y = f x}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s g t m x h.\n       \\<lbrakk>x \\<noteq> Suc n; inj_on f {j. j \\<le> Suc n};\n        inj_on g {j. j \\<le> Suc n}; m = Suc n; free_generator R M H;\n        Ring R; aGroup R; H \\<subseteq> carrier M;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> H;\n        t \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        l_comb R M (Suc n) (cmp s (transpos x (Suc n)))\n         (cmp f (transpos x (Suc n))) =\n        l_comb R M (Suc n) t g;\n        x \\<le> Suc n; f x = g (Suc n); ideal R (carrier R);\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n        \\<forall>l\\<le>Suc n.\n           cmp f (cmp (transpos x (Suc n)) h) l = g l \\<and>\n           cmp s (cmp (transpos x (Suc n)) h) l = t l;\n        transpos x (Suc n)\n        \\<in> {i. i \\<le> Suc n} \\<rightarrow> {i. i \\<le> Suc n};\n        cmp (transpos x (Suc n)) h\n        \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {j. j \\<le> Suc n} \\<and>\n                            (\\<forall>l\\<le>Suc n.\n                                cmp f h l = g l \\<and> cmp s h l = t l)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) gen_mHom_eq:\"\\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n       g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h \\<rbrakk> \\<Longrightarrow> f = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n     g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h\\<rbrakk>\n    \\<Longrightarrow> f = g", "apply (rule mHom_eq[of N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n     g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier M. f m = g m", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h;\n        m \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (unfold generator_def, frule conjunct2, fold generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; m \\<in> carrier M;\n        linear_span R M (carrier R) H = carrier M\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (frule sym, thin_tac \"linear_span R M (carrier R) H = carrier M\",\n        simp,\n        thin_tac \"carrier M = linear_span R M (carrier R) H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h;\n        m \\<in> linear_span R M (carrier R) H\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h;\n        m \\<in> (if H = {} then {\\<zero>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                   x = l_comb R M n s f})\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (case_tac \"H = {}\", simp, simp add:mHom_0, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 m = l_comb R M n s f;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (unfold generator_def, frule conjunct1, fold generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> f m = g m", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> f (l_comb R M n s fa) = g (l_comb R M n s fa)", "apply (simp add: linmap_im_lincomb [of \"carrier R\" N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (frule_tac s = s and n = n and f = \"cmp f fa\" and g = \"cmp g fa\" in \n         Module.linear_comb_eq[of N R \"f ` H\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> f ` H \\<subseteq> carrier N\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 3. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 4. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp g fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 5. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 6. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (simp add: mHom_def aHom_def cong del: image_cong)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H;\n        f \\<in> carrier M \\<rightarrow> carrier N \\<and>\n        f \\<in> extensional (carrier M) \\<and>\n        (\\<forall>a\\<in>carrier M.\n            \\<forall>b\\<in>carrier M.\n               f (a \\<plusminus> b) =\n               f a \\<plusminus>\\<^bsub>N\\<^esub> f b) \\<and>\n        (\\<forall>a\\<in>carrier R.\n            \\<forall>m\\<in>carrier M.\n               f (a \\<cdot>\\<^sub>s m) =\n               a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m);\n        g \\<in> carrier M \\<rightarrow> carrier N \\<and>\n        g \\<in> extensional (carrier M) \\<and>\n        (\\<forall>a\\<in>carrier M.\n            \\<forall>b\\<in>carrier M.\n               g (a \\<plusminus> b) =\n               g a \\<plusminus>\\<^bsub>N\\<^esub> g b) \\<and>\n        (\\<forall>a\\<in>carrier R.\n            \\<forall>m\\<in>carrier M.\n               g (a \\<cdot>\\<^sub>s m) =\n               a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m);\n        \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> f ` H \\<subseteq> carrier N\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 3. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 4. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp g fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 5. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 6. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (erule conjE)+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; \\<forall>h\\<in>H. f h = g h;\n        H \\<noteq> {}; fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R); f \\<in> carrier M \\<rightarrow> carrier N;\n        g \\<in> carrier M \\<rightarrow> carrier N;\n        f \\<in> extensional (carrier M); g \\<in> extensional (carrier M);\n        \\<forall>a\\<in>carrier M.\n           \\<forall>b\\<in>carrier M.\n              f (a \\<plusminus> b) = f a \\<plusminus>\\<^bsub>N\\<^esub> f b;\n        \\<forall>a\\<in>carrier R.\n           \\<forall>m\\<in>carrier M.\n              f (a \\<cdot>\\<^sub>s m) =\n              a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f m;\n        \\<forall>a\\<in>carrier M.\n           \\<forall>b\\<in>carrier M.\n              g (a \\<plusminus> b) = g a \\<plusminus>\\<^bsub>N\\<^esub> g b;\n        \\<forall>a\\<in>carrier R.\n           \\<forall>m\\<in>carrier M.\n              g (a \\<cdot>\\<^sub>s m) =\n              a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m\\<rbrakk>\n       \\<Longrightarrow> f ` H \\<subseteq> carrier N\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 3. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 4. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp g fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 5. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 6. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (simp add: image_sub [of f \"carrier M\" \"carrier N\" H] cong del: image_cong)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 3. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp g fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 4. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 5. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply assumption"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp f fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp g fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 3. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 4. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (rule Pi_I, simp add:cmp_def,\n         simp add:image_def, \n         frule_tac f = fa and A = \"{j. j \\<le> n}\" and B = H and x = x in \n         funcset_mem, simp, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> cmp g fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 3. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (rule Pi_I, simp add:cmp_def,\n         simp add:image_def, \n         frule_tac f = fa and A = \"{j. j \\<le> n}\" and B = H and x = x in \n         funcset_mem, simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp f fa j = cmp g fa j\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply (rule ballI, simp add:cmp_def,\n         frule_tac f = fa and A = \"{j. j \\<le> n}\" and B = H and x = j in \n         funcset_mem, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n fa s j.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R); j \\<le> n; fa j \\<in> H\\<rbrakk>\n       \\<Longrightarrow> f (fa j) = g (fa j)\n 2. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n fa s.\n       \\<lbrakk>R module N; generator R M H; f \\<in> mHom R M N;\n        g \\<in> mHom R M N; \\<forall>h\\<in>H. f h = g h; H \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        m = l_comb R M n s fa; H \\<subseteq> carrier M; Ring R;\n        ideal R (carrier R);\n        l_comb R N n s (cmp f fa) = l_comb R N n s (cmp g fa)\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp f fa) =\n                         l_comb R N n s (cmp g fa)", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Existence of homomorphism\""], ["", "definition\n  fgs :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, 'a set]  \\<Rightarrow>\n       'a set\" where\n  (* free generator span, A is a subset of free generator *)\n  \"fgs R M A = linear_span R M (carrier R) A\""], ["", "definition\n  fsp :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, \n  ('b, 'r, 'm2) Module_scheme, 'a \\<Rightarrow> 'b, 'a set, 'a set, 'a \\<Rightarrow> 'b] \\<Rightarrow> bool\" where\n  \"fsp R M N f H A g \\<longleftrightarrow> g \\<in> mHom R (mdl M (fgs R M A)) N \\<and> (\\<forall>z\\<in>A. f z = g z) \\<and> A \\<subseteq> H\""], ["", "(* f \\<in> H \\<rightarrow> N (not a module hom), free span pair condition *)"], ["", "definition\n  fsps :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, \n   ('b, 'r, 'm2) Module_scheme, 'a \\<Rightarrow> 'b, 'a set] \\<Rightarrow> \n                                      (('a set) * ('a \\<Rightarrow> 'b)) set\" where\n  \"fsps R M N f H = {Z. \\<exists>A g. Z = (A, g) \\<and> fsp R M N f H A g}\""], ["", "(* free span pairs *)"], ["", "definition\n  od_fm_fun :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, \n ('b, 'r, 'm2) Module_scheme, 'a \\<Rightarrow> 'b, 'a set] \\<Rightarrow> \n                          (('a set) * ('a \\<Rightarrow> 'b)) Order\" where\n  \"od_fm_fun R M N f H = \\<lparr>carrier = fsps R M N f H, \n     rel = {Y. Y \\<in> (fsps R M N f H) \\<times> (fsps R M N f H) \\<and> \n                              (fst (fst Y)) \\<subseteq> (fst (snd Y))} \\<rparr>\""], ["", "(* ordered set free module with function f *)"], ["", "lemma (in Module) od_fm_fun_carrier:\"carrier (od_fm_fun R M N f H) = \n                    fsps R M N f H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier (od_fm_fun R M N f H) = fsps R M N f H", "by (simp add:od_fm_fun_def)"], ["", "lemma (in Module) fgs_submodule:\"a \\<subseteq> carrier M \\<Longrightarrow> \n              submodule R M (fgs R M a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<subseteq> carrier M \\<Longrightarrow> submodule R M (fgs R M a)", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> submodule R M (fgs R M a)", "apply (subst fgs_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<subseteq> carrier M; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> submodule R M (linear_span R M (carrier R) a)", "apply (rule linear_span_subModule, assumption, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fgs_sub_carrier:\"a \\<subseteq> carrier M \\<Longrightarrow> (fgs R M a) \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M a \\<subseteq> carrier M", "by (frule fgs_submodule[of a], \n       rule submodule_subset, assumption+)"], ["", "lemma (in Module) elem_fgs:\"\\<lbrakk>a \\<subseteq> carrier M; x \\<in> a\\<rbrakk> \\<Longrightarrow> x \\<in> fgs R M a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<subseteq> carrier M; x \\<in> a\\<rbrakk>\n    \\<Longrightarrow> x \\<in> fgs R M a", "apply (simp add:fgs_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<subseteq> carrier M; x \\<in> a\\<rbrakk>\n    \\<Longrightarrow> x \\<in> linear_span R M (carrier R) a", "apply (frule l_span_cont_H[of a])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<subseteq> carrier M; x \\<in> a;\n     a \\<subseteq> linear_span R M (carrier R) a\\<rbrakk>\n    \\<Longrightarrow> x \\<in> linear_span R M (carrier R) a", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fst_chain_subset:\"\\<lbrakk>R module N; free_generator R M H;\n f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; (a, b) \\<in> C\\<rbrakk>  \\<Longrightarrow> a \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> carrier M", "apply (subgoal_tac \"a \\<subseteq> H\", frule free_generator_sub)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; a \\<subseteq> H; H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> carrier M\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> H", "apply (rule subset_trans, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> H", "apply (frule_tac A = C and B = \"fsps R M N f H\" and c = \"(a, b)\" in subsetD, \n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (a, b) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> H", "apply (simp add:fsps_def fsp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) empty_fsp:\"\\<lbrakk>R module N; free_generator R M H; \n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> ({}, (\\<lambda>x\\<in>{\\<zero>\\<^bsub>M\\<^esub>}. \\<zero>\\<^bsub>N\\<^esub>)) \\<in> fsps R M N f H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> ({},\n                       \\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> fsps R M N f H", "apply (simp add:fsps_def fsp_def,\n       simp add:fgs_def linear_span_def,\n       cut_tac submodule_0,\n       frule mdl_is_module[of \"{\\<zero>}\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> mHom R (mdl M {\\<zero>}) N", "apply (rule Module.mHom_test, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> carrier (mdl M {\\<zero>}) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> extensional (carrier (mdl M {\\<zero>})) \\<and>\n                      (\\<forall>m\\<in>carrier (mdl M {\\<zero>}).\n                          \\<forall>n\\<in>carrier (mdl M {\\<zero>}).\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              (m \\<plusminus>\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (mdl M {\\<zero>}).\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> carrier (mdl M {\\<zero>}) \\<rightarrow>\n                            carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> extensional (carrier (mdl M {\\<zero>})) \\<and>\n                      (\\<forall>m\\<in>carrier (mdl M {\\<zero>}).\n                          \\<forall>n\\<in>carrier (mdl M {\\<zero>}).\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              (m \\<plusminus>\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (mdl M {\\<zero>}).\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              m)", "apply (rule Pi_I, simp add:mdl_carrier,\n        rule Module.module_inc_zero[of N R], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>{\\<zero>}. \\<zero>\\<^bsub>N\\<^esub>)\n                      \\<in> extensional (carrier (mdl M {\\<zero>})) \\<and>\n                      (\\<forall>m\\<in>carrier (mdl M {\\<zero>}).\n                          \\<forall>n\\<in>carrier (mdl M {\\<zero>}).\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              (m \\<plusminus>\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier (mdl M {\\<zero>}).\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>{\\<zero>}.\n                                 \\<zero>\\<^bsub>N\\<^esub>)\n                              m)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<zero> \\<plusminus>\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                       \\<zero> =\n                       \\<zero> \\<longrightarrow>\n                       \\<zero>\\<^bsub>N\\<^esub> =\n                       \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                       \\<zero>\\<^bsub>N\\<^esub> \\<and>\n                       (\\<forall>a\\<in>carrier R.\n                           (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                            \\<zero> =\n                            \\<zero> \\<longrightarrow>\n                            \\<zero>\\<^bsub>N\\<^esub> =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                           (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                            \\<zero> \\<noteq>\n                            \\<zero> \\<longrightarrow>\n                            undefined =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>))) \\<and>\n                      (\\<zero> \\<plusminus>\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                       \\<zero> \\<noteq>\n                       \\<zero> \\<longrightarrow>\n                       undefined =\n                       \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                       \\<zero>\\<^bsub>N\\<^esub> \\<and>\n                       (\\<forall>a\\<in>carrier R.\n                           (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                            \\<zero> =\n                            \\<zero> \\<longrightarrow>\n                            \\<zero>\\<^bsub>N\\<^esub> =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                           (a \\<cdot>\\<^sub>s\\<^bsub>mdl M {\\<zero>}\\<^esub>\n                            \\<zero> \\<noteq>\n                            \\<zero> \\<longrightarrow>\n                            undefined =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>)))", "apply (simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> (\\<zero> \\<plusminus> \\<zero> =\n                       \\<zero> \\<longrightarrow>\n                       \\<zero>\\<^bsub>N\\<^esub> =\n                       \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                       \\<zero>\\<^bsub>N\\<^esub> \\<and>\n                       (\\<forall>a\\<in>carrier R.\n                           (a \\<cdot>\\<^sub>s \\<zero> =\n                            \\<zero> \\<longrightarrow>\n                            \\<zero>\\<^bsub>N\\<^esub> =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                           (a \\<cdot>\\<^sub>s \\<zero> \\<noteq>\n                            \\<zero> \\<longrightarrow>\n                            undefined =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>))) \\<and>\n                      (\\<zero> \\<plusminus> \\<zero> \\<noteq>\n                       \\<zero> \\<longrightarrow>\n                       undefined =\n                       \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                       \\<zero>\\<^bsub>N\\<^esub> \\<and>\n                       (\\<forall>a\\<in>carrier R.\n                           (a \\<cdot>\\<^sub>s \\<zero> =\n                            \\<zero> \\<longrightarrow>\n                            \\<zero>\\<^bsub>N\\<^esub> =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                           (a \\<cdot>\\<^sub>s \\<zero> \\<noteq>\n                            \\<zero> \\<longrightarrow>\n                            undefined =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            \\<zero>\\<^bsub>N\\<^esub>)))", "apply (cut_tac ag_inc_zero, simp add:ag_l_zero,\n        frule Module.module_is_ag[of N R],\n        frule aGroup.ag_inc_zero[of N], simp add:aGroup.ag_l_zero[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n     R module mdl M {\\<zero>}; \\<zero> \\<in> carrier M; aGroup N;\n     \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         (a \\<cdot>\\<^sub>s \\<zero> =\n                          \\<zero> \\<longrightarrow>\n                          \\<zero>\\<^bsub>N\\<^esub> =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          \\<zero>\\<^bsub>N\\<^esub>) \\<and>\n                         (a \\<cdot>\\<^sub>s \\<zero> \\<noteq>\n                          \\<zero> \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          \\<zero>\\<^bsub>N\\<^esub>)", "apply (rule ballI, frule_tac a = a in sc_a_0, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; submodule R M {\\<zero>};\n        R module mdl M {\\<zero>}; \\<zero> \\<in> carrier M; aGroup N;\n        \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N; a \\<in> carrier R;\n        a \\<cdot>\\<^sub>s \\<zero> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (simp add:Module.sc_a_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mem_fgs_l_comb:\"\\<lbrakk>K \\<noteq> {}; K \\<subseteq> carrier M; x \\<in> fgs R M K\\<rbrakk> \\<Longrightarrow> \n        \\<exists>(n::nat).  \n        \\<exists>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> K. \\<exists>s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R.\n                    x = l_comb R M n s f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>K \\<noteq> {}; K \\<subseteq> carrier M;\n     x \\<in> fgs R M K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n     carrier R.\n                               x = l_comb R M n s f", "apply (simp add:fgs_def linear_span_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma PairE_lemma: \"\\<exists>x y. p = (x, y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x y. p = (x, y)", "by auto"], ["", "lemma (in Module) fsps_chain_boundTr1:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \\<forall>a b. (a, b) \\<in> C \\<longrightarrow> \n              (a, b) \\<in> fsps R M N f H; \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}\\<rbrakk> \\<Longrightarrow> \n      fa \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \\<Union>{a. \\<exists>b. (a, b) \\<in> C} \n                       \\<longrightarrow> (\\<exists>(c, d) \\<in> C. fa ` {j. j \\<le> n} \\<subseteq> c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<forall>a b.\n        (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                               \\<Union>\n                                {a. \\<exists>b.\n (a, b) \\<in> C} \\<longrightarrow>\n                      (\\<exists>(c, d)\\<in>C.\n                          fa ` {j. j \\<le> n} \\<subseteq> c)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<forall>a b.\n        (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fa \\<in> {j. j \\<le> 0} \\<rightarrow>\n                               \\<Union>\n                                {a. \\<exists>b.\n (a, b) \\<in> C} \\<longrightarrow>\n                      (\\<exists>a\\<in>C.\n                          case a of\n                          (c, d) \\<Rightarrow>\n                            fa ` {j. j \\<le> 0} \\<subseteq> c)\n 2. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<longrightarrow>\n        (\\<exists>a\\<in>C.\n            case a of\n            (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c)\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                  \\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C} \\<longrightarrow>\n                         (\\<exists>a\\<in>C.\n                             case a of\n                             (c, d) \\<Rightarrow>\n                               fa ` {j. j \\<le> Suc n} \\<subseteq> c)", "apply (rule impI, simp del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<forall>a b.\n        (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {0} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>C.\n                         case x of (c, d) \\<Rightarrow> fa 0 \\<in> c\n 2. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<longrightarrow>\n        (\\<exists>a\\<in>C.\n            case a of\n            (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c)\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                  \\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C} \\<longrightarrow>\n                         (\\<exists>a\\<in>C.\n                             case a of\n                             (c, d) \\<Rightarrow>\n                               fa ` {j. j \\<le> Suc n} \\<subseteq> c)", "apply ((erule exE)+, erule conjE, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {0} \\<rightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>C.\n                            case x of (c, d) \\<Rightarrow> fa 0 \\<in> c\n 2. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<longrightarrow>\n        (\\<exists>a\\<in>C.\n            case a of\n            (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c)\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                  \\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C} \\<longrightarrow>\n                         (\\<exists>a\\<in>C.\n                             case a of\n                             (c, d) \\<Rightarrow>\n                               fa ` {j. j \\<le> Suc n} \\<subseteq> c)", "apply (frule_tac f = fa and A = \"{0}\" and B = \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C}\" and \n                      ?A1.0 = \"{0}\" in image_sub, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> fa 0 \\<in> x;\n        x \\<noteq> {}; (x, b) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>C.\n                            case x of (c, d) \\<Rightarrow> fa 0 \\<in> c\n 2. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<longrightarrow>\n        (\\<exists>a\\<in>C.\n            case a of\n            (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c)\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                  \\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C} \\<longrightarrow>\n                         (\\<exists>a\\<in>C.\n                             case a of\n                             (c, d) \\<Rightarrow>\n                               fa ` {j. j \\<le> Suc n} \\<subseteq> c)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<longrightarrow>\n        (\\<exists>a\\<in>C.\n            case a of\n            (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c)\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                  \\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C} \\<longrightarrow>\n                         (\\<exists>a\\<in>C.\n                             case a of\n                             (c, d) \\<Rightarrow>\n                               fa ` {j. j \\<le> Suc n} \\<subseteq> c)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<longrightarrow>\n        (\\<exists>a\\<in>C.\n            case a of\n            (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c);\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (frule func_pre, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        \\<exists>(c, d)\\<in>C. fa ` {j. j \\<le> n} \\<subseteq> c;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (frule_tac f = fa and A = \"{j. j \\<le> (Suc n)}\" and \n        B = \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C}\" and x = \"Suc n\" in funcset_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        \\<exists>(c, d)\\<in>C. fa ` {j. j \\<le> n} \\<subseteq> c;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa (Suc n) \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        \\<exists>x\\<in>C.\n           case x of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        \\<exists>x.\n           (\\<exists>b. (x, b) \\<in> C) \\<and> fa (Suc n) \\<in> x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply ((erule exE)+, erule conjE, erule exE, erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa b ba.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        \\<exists>x\\<in>C.\n           case x of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of\n        (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (drule_tac x = \"(xa, ba)\" in bspec, assumption, \n        drule_tac x = xb in bspec, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst (xa, ba) \\<subseteq> fst xb \\<or>\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (erule disjE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        xa \\<subseteq> fst xb\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 2. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (subgoal_tac \"(\\<lambda>(c, d). fa ` {j. j \\<le> Suc n} \\<subseteq> c) xb\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        xa \\<subseteq> fst xb;\n        case xb of\n        (c, d) \\<Rightarrow> fa ` {j. j \\<le> Suc n} \\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 2. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        xa \\<subseteq> fst xb\\<rbrakk>\n       \\<Longrightarrow> case xb of\n                         (c, d) \\<Rightarrow>\n                           fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 3. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply auto[1]"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        xa \\<subseteq> fst xb\\<rbrakk>\n       \\<Longrightarrow> case xb of\n                         (c, d) \\<Rightarrow>\n                           fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 2. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (subgoal_tac \"(\\<lambda>(c, d). fa ` {j. j \\<le> Suc n} \\<subseteq> c) xb\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        xa \\<subseteq> fst xb;\n        case xb of\n        (c, d) \\<Rightarrow> fa ` {j. j \\<le> Suc n} \\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> case xb of\n                         (c, d) \\<Rightarrow>\n                           fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 2. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        xa \\<subseteq> fst xb\\<rbrakk>\n       \\<Longrightarrow> case xb of\n                         (c, d) \\<Rightarrow>\n                           fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 3. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (blast,\n        cut_tac p = xb in PairE_lemma,\n        (erule exE)+, simp, rule subsetI, simp add:image_def,\n           erule exE, erule conjE,\n        case_tac \"xe = Suc n\", simp, simp add:subsetD,\n        frule_tac m = xe and n = \"Suc n\" in noteq_le_less, assumption,\n        frule_tac x = xe and n = n in Suc_less_le,\n        thin_tac \"xe \\<le> Suc n\", thin_tac \"xe < Suc n\",\n        cut_tac c = xd and A = \"{y. \\<exists>x\\<le>n. y = fa x}\" and B = xc in\n           subsetD, simp, simp, blast, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (subgoal_tac \"(\\<lambda>(c, d). fa ` {j. j \\<le> Suc n} \\<subseteq> c) (xa, ba)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba);\n        case (xa, ba) of\n        (c, d) \\<Rightarrow> fa ` {j. j \\<le> Suc n} \\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>C.\n                            case a of\n                            (c, d) \\<Rightarrow>\n                              fa ` {j. j \\<le> Suc n} \\<subseteq> c\n 2. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> case (xa, ba) of\n                         (c, d) \\<Rightarrow>\n                           fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply auto[1]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa b ba xb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; xb \\<in> C;\n        case xb of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        fst xb \\<subseteq> fst (xa, ba)\\<rbrakk>\n       \\<Longrightarrow> case (xa, ba) of\n                         (c, d) \\<Rightarrow>\n                           fa ` {j. j \\<le> Suc n} \\<subseteq> c", "apply (simp, rule subsetI, simp add:image_def, erule exE, erule conjE,\n         case_tac \"xd = Suc n\", simp,\n         frule_tac m = xd and n = \"Suc n\" in noteq_le_less, assumption,\n           frule_tac x = xd and n = n in Suc_less_le,\n           thin_tac \"xd \\<le> Suc n\", thin_tac \"xd < Suc n\",\n         cut_tac p = xb in PairE_lemma, (erule exE)+, simp,\n         cut_tac c = \"fa xd\" and A = \"{y. \\<exists>x\\<le>n. y = fa x}\" and B = xe in \n          subsetD, assumption, simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa b ba xb xc xd xe y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H;\n        fa \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<noteq> {}; (x, b) \\<in> C; fa (Suc n) \\<in> xa;\n        (xa, ba) \\<in> C; (xe, y) \\<in> C;\n        {y. \\<exists>x\\<le>n. y = fa x} \\<subseteq> xe; xe \\<subseteq> xa;\n        xc = fa xd; xd \\<le> n; xb = (xe, y); fa xd \\<in> xe\\<rbrakk>\n       \\<Longrightarrow> fa xd \\<in> xa", "apply (rule_tac c = \"fa xd\" and A = xe and B = xa in subsetD, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fsps_chain_boundTr1_1:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \n       \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}; \n       fa \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \\<Union>{a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk> \\<Longrightarrow> \n        \\<exists>(c, d) \\<in> C. fa ` {j. j \\<le> n} \\<subseteq> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {j. j \\<le> n} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(c, d)\\<in>C.\n                         fa ` {j. j \\<le> n} \\<subseteq> c", "apply (subgoal_tac \"\\<forall>a b. (a, b) \\<in> C \\<longrightarrow> (a, b) \\<in> fsps R M N f H\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {j. j \\<le> n} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n     \\<forall>a b.\n        (a, b) \\<in> C \\<longrightarrow>\n        (a, b) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(c, d)\\<in>C.\n                         fa ` {j. j \\<le> n} \\<subseteq> c\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {j. j \\<le> n} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b.\n                         (a, b) \\<in> C \\<longrightarrow>\n                         (a, b) \\<in> fsps R M N f H", "apply (simp add:fsps_chain_boundTr1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {j. j \\<le> n} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b.\n                         (a, b) \\<in> C \\<longrightarrow>\n                         (a, b) \\<in> fsps R M N f H", "apply ((rule allI)+, rule impI, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fsps_chain_boundTr1_2:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \n       \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}; \n       fa \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> \\<Union>{a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk> \\<Longrightarrow> \n       \\<exists>P \\<in> C. fa ` {j. j \\<le> n} \\<subseteq> fst P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {j. j \\<le> n} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>P\\<in>C.\n                         fa ` {j. j \\<le> n} \\<subseteq> fst P", "apply (frule_tac N = N and f = f and C = C and fa = fa and n = n in \n         fsps_chain_boundTr1_1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n     fa \\<in> {j. j \\<le> n} \\<rightarrow>\n              \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n     \\<exists>(c, d)\\<in>C. fa ` {j. j \\<le> n} \\<subseteq> c\\<rbrakk>\n    \\<Longrightarrow> \\<exists>P\\<in>C.\n                         fa ` {j. j \\<le> n} \\<subseteq> fst P", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<in> C;\n        case x of\n        (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>P\\<in>C.\n                            fa ` {j. j \\<le> n} \\<subseteq> fst P", "apply (cut_tac p = x in PairE_lemma, (erule exE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<in> C;\n        case x of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        (\\<exists>b. (xa, b) \\<in> C) \\<and> xa \\<noteq> {};\n        x = (xb, y)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>P\\<in>C.\n                            fa ` {j. j \\<le> n} \\<subseteq> fst P", "apply (subgoal_tac \"fa ` {j. j \\<le> n} \\<subseteq> fst x\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<in> C;\n        case x of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        (\\<exists>b. (xa, b) \\<in> C) \\<and> xa \\<noteq> {}; x = (xb, y);\n        fa ` {j. j \\<le> n} \\<subseteq> fst x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>P\\<in>C.\n                            fa ` {j. j \\<le> n} \\<subseteq> fst P\n 2. \\<And>x xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<in> C;\n        case x of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        (\\<exists>b. (xa, b) \\<in> C) \\<and> xa \\<noteq> {};\n        x = (xb, y)\\<rbrakk>\n       \\<Longrightarrow> fa ` {j. j \\<le> n} \\<subseteq> fst x", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        x \\<in> C;\n        case x of (c, d) \\<Rightarrow> fa ` {j. j \\<le> n} \\<subseteq> c;\n        (\\<exists>b. (xa, b) \\<in> C) \\<and> xa \\<noteq> {};\n        x = (xb, y)\\<rbrakk>\n       \\<Longrightarrow> fa ` {j. j \\<le> n} \\<subseteq> fst x", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) eSum_in_SubmoduleTr:\"\\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H\\<rbrakk> \\<Longrightarrow>\n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> K \\<and> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R  \\<longrightarrow>\n      l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n                      s \\<in> {j. j \\<le> n} \\<rightarrow>\n                              carrier R \\<longrightarrow>\n                      l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> 0} \\<rightarrow> K \\<and>\n                      s \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              carrier R \\<longrightarrow>\n                      l_comb R (mdl M (fgs R M K)) 0 s f = l_comb R M 0 s f\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<longrightarrow>\n                         l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> K;\n     s \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> l_comb R (mdl M (fgs R M K)) 0 s f = l_comb R M 0 s f\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<longrightarrow>\n                         l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (simp add:l_comb_def del: Pi_split_insert_domain, simp add:mdl_def del: Pi_split_insert_domain, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n     f \\<in> {0} \\<rightarrow> K; s \\<in> {0} \\<rightarrow> carrier R;\n     f 0 \\<notin> fgs R M K\\<rbrakk>\n    \\<Longrightarrow> undefined = s 0 \\<cdot>\\<^sub>s f 0\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<longrightarrow>\n                         l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (simp add:fgs_def del: Pi_split_insert_domain, frule subset_trans[of K H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n     f \\<in> {0} \\<rightarrow> K; s \\<in> {0} \\<rightarrow> carrier R;\n     f 0 \\<notin> linear_span R M (carrier R) K;\n     K \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> undefined = s 0 \\<cdot>\\<^sub>s f 0\n 2. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<longrightarrow>\n                         l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (frule funcset_mem[of f \"{0}\" K 0], simp del: Pi_split_insert_domain,\n        frule l_span_cont_H[of K], simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K \\<and>\n                         s \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier R \\<longrightarrow>\n                         l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K \\<and>\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (frule func_pre[of  _ _ K], frule func_pre[of  _ _ \"carrier R\"],\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> l_comb R (mdl M (fgs R M K)) (Suc n) s f =\n                         l_comb R M (Suc n) s f", "apply (simp add:l_comb_def, simp add:mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        \\<Sigma>\\<^sub>e \\<lparr>carrier = fgs R M K, pop = (\\<plusminus>),\n                            mop = mop M, zero = \\<zero>,\n                            sprod =\n                              \\<lambda>a.\n                                 restrict ((\\<cdot>\\<^sub>s) a)\n                                  (fgs R M\n                                    K)\\<rparr> (\\<lambda>j.\n             if f j \\<in> fgs R M K then s j \\<cdot>\\<^sub>s f j\n             else undefined) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<notin> fgs R M K \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         undefined =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)", "apply (rule impI, simp add:fgs_def,frule subset_trans[of K H \"carrier M\"], \n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n        \\<Sigma>\\<^sub>e \\<lparr>carrier = linear_span R M (carrier R) K,\n                            pop = (\\<plusminus>), mop = mop M,\n                            zero = \\<zero>,\n                            sprod =\n                              \\<lambda>a.\n                                 restrict ((\\<cdot>\\<^sub>s) a)\n                                  (linear_span R M (carrier R)\n                                    K)\\<rparr> (\\<lambda>j.\n             if f j \\<in> linear_span R M (carrier R) K\n             then s j \\<cdot>\\<^sub>s f j else undefined) n =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<notin> linear_span R M (carrier R) K;\n        K \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         undefined =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s f j) n \\<plusminus>\n                         s (Suc n) \\<cdot>\\<^sub>s f (Suc n)", "apply (frule_tac x = \"Suc n\" and A = \"{j. j \\<le> Suc n}\" in\n         funcset_mem[of f _ K], simp,\n        frule l_span_cont_H[of K], simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) eSum_in_Submodule:\"\\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H; \n      f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> K; s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk> \\<Longrightarrow> \n      l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier M; K \\<subseteq> H;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> K;\n     s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> l_comb R (mdl M (fgs R M K)) n s f = l_comb R M n s f", "apply (simp add:eSum_in_SubmoduleTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fgs_generator:\"H \\<subseteq> carrier M \\<Longrightarrow>\n       generator R (mdl M (fgs R M H)) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    generator R (mdl M (fgs R M H)) H", "apply (simp add:generator_def, simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    H \\<subseteq> fgs R M H \\<and>\n    linear_span R (mdl M (fgs R M H)) (carrier R) H = fgs R M H", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. H \\<subseteq> carrier M \\<Longrightarrow> H \\<subseteq> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    linear_span R (mdl M (fgs R M H)) (carrier R) H = fgs R M H", "apply (simp add:fgs_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    H \\<subseteq> linear_span R M (carrier R) H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    linear_span R (mdl M (fgs R M H)) (carrier R) H = fgs R M H", "apply (simp add:l_span_cont_H)"], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    linear_span R (mdl M (fgs R M H)) (carrier R) H = fgs R M H", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    linear_span R (mdl M (fgs R M H)) (carrier R) H \\<subseteq> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (rule subsetI, simp add:linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        x \\<in> (if H = {} then {\\<zero>\\<^bsub>mdl M (fgs R M H)\\<^esub>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                   x =\n                                   l_comb R (mdl M (fgs R M H)) n s\n                                    f})\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (case_tac \"H = {}\", simp add:mdl_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. H = {} \\<Longrightarrow> \\<zero> \\<in> fgs R M {}\n 2. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        x \\<in> (if H = {} then {\\<zero>\\<^bsub>mdl M (fgs R M H)\\<^esub>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                   x = l_comb R (mdl M (fgs R M H)) n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M H\n 3. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (simp add:fgs_def linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        x \\<in> (if H = {} then {\\<zero>\\<^bsub>mdl M (fgs R M H)\\<^esub>}\n                 else {x. \\<exists>n.\n                             \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n                                \\<exists>s\n   \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                   x = l_comb R (mdl M (fgs R M H)) n s f});\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R (mdl M (fgs R M H)) n s f;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (cut_tac f = f and n = n and s = s in eSum_in_Submodule[of H H],\n        assumption+, simp, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f;\n        l_comb R (mdl M (fgs R M H)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        l_comb R (mdl M (fgs R M H)) n s f = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f \\<in> fgs R M H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (simp add:fgs_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        l_comb R (mdl M (linear_span R M (carrier R) H)) n s f =\n        l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f\n                         \\<in> linear_span R M (carrier R) H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        l_comb R (mdl M (linear_span R M (carrier R) H)) n s f =\n        l_comb R M n s f;\n        Ring R; ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> l_comb R M n s f\n                         \\<in> linear_span R M (carrier R) H\n 2. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (simp add:l_comb_mem_linear_span)"], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<subseteq> carrier M \\<Longrightarrow>\n    fgs R M H \\<subseteq> linear_span R (mdl M (fgs R M H)) (carrier R) H", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> fgs R M H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (mdl M (fgs R M H))\n                                  (carrier R) H", "apply (case_tac \"H = {}\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> fgs R M {}; H = {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (mdl M (fgs R M {}))\n                                  (carrier R) {}\n 2. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> fgs R M H;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (mdl M (fgs R M H))\n                                  (carrier R) H", "apply (simp add:fgs_def linear_span_def mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> fgs R M H;\n        H \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (mdl M (fgs R M H))\n                                  (carrier R) H", "apply (frule_tac x = x in mem_fgs_l_comb[of H], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> fgs R M H; H \\<noteq> {};\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> H.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (mdl M (fgs R M H))\n                                  (carrier R) H", "apply (erule exE, erule bexE, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M; x \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (mdl M (fgs R M H))\n                                  (carrier R) H", "apply (simp add:eSum_in_Submodule[THEN sym, of H H])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f\\<rbrakk>\n       \\<Longrightarrow> l_comb R (mdl M (fgs R M H)) n s f\n                         \\<in> linear_span R (mdl M (fgs R M H)) (carrier R)\n                                H", "apply (frule fgs_submodule[of H],\n        frule mdl_is_module[of \"fgs R M H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> l_comb R (mdl M (fgs R M H)) n s f\n                         \\<in> linear_span R (mdl M (fgs R M H)) (carrier R)\n                                H", "apply (rule Module.l_comb_mem_linear_span[of \"mdl M (fgs R M H)\" R \"carrier R\" H], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 2. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier (mdl M (fgs R M H))\n 3. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 4. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (cut_tac sc_Ring, rule Ring.whole_ideal, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> carrier (mdl M (fgs R M H))\n 2. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 3. \\<And>x n f s.\n       \\<lbrakk>H \\<subseteq> carrier M;\n        l_comb R (mdl M (fgs R M H)) n s f \\<in> fgs R M H; H \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M H)) n s f; submodule R M (fgs R M H);\n        R module mdl M (fgs R M H)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H", "apply (simp add:mdl_carrier, simp add:fgs_def l_span_cont_H,\n      assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fgs_mono:\"\\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "(* H1 \\<subseteq> H2 , J \\<subseteq> K *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (case_tac \"J = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J = {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (simp add:fgs_def linear_span_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {}\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {} \\<longrightarrow>\n                      (\\<exists>n.\n                          \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                             \\<exists>s\n\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                \\<zero> = l_comb R M n s f)\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (case_tac \"K = {}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n     K = {}\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {} \\<longrightarrow>\n                      (\\<exists>n.\n                          \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                             \\<exists>s\n\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                \\<zero> = l_comb R M n s f)\n 2. \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n     K \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {} \\<longrightarrow>\n                      (\\<exists>n.\n                          \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                             \\<exists>s\n\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                \\<zero> = l_comb R M n s f)\n 3. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n     K \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {} \\<longrightarrow>\n                      (\\<exists>n.\n                          \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                             \\<exists>s\n\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                \\<zero> = l_comb R M n s f)\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n     K \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n     carrier R.\n                               \\<zero> = l_comb R M n s f\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (frule nonempty_ex [of K])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n     K \\<noteq> {}; \\<exists>x. x \\<in> K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                            \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow>\n     carrier R.\n                               \\<zero> = l_comb R M n s f\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  \\<zero> = l_comb R M n s f\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (subgoal_tac \"(\\<lambda>j. x) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> K\",\n        subgoal_tac \"(\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>) \\<in> {j. j \\<le> (0::nat)} \\<rightarrow> carrier R\",\n        subgoal_tac \"\\<zero>\\<^bsub>M\\<^esub> = l_comb R M 0 (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>) (\\<lambda>j. x)\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K;\n        (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        \\<zero> =\n        l_comb R M 0 (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n         (\\<lambda>j. x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  \\<zero> = l_comb R M n s f\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K;\n        (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         l_comb R M 0 (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n                          (\\<lambda>j. x)\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 4. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. x)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> K\n 5. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply blast"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K;\n        (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         l_comb R M 0 (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n                          (\\<lambda>j. x)\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. x)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> K\n 4. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (simp add:l_comb_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero> =\n                         \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s x\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 3. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. x)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> K\n 4. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (frule free_generator_sub[of H],\n        frule subset_trans[of K H \"carrier M\"], assumption+,\n        frule_tac c = x in subsetD[of K \"carrier M\"], assumption+,\n        simp add:sc_0_m)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K;\n        (\\<lambda>j. x) \\<in> {j. j \\<le> 0} \\<rightarrow> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. \\<zero>\\<^bsub>R\\<^esub>)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 2. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. x)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> K\n 3. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (rule Pi_I,\n        frule Ring.ring_is_ag [of \"R\"],\n        simp add:aGroup.ag_inc_zero[of R])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; K \\<subseteq> H; Ring R; J = {};\n        K \\<noteq> {}; x \\<in> K\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j. x)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> K\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (rule Pi_I, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (subgoal_tac \"K \\<noteq> {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}; K \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> K \\<noteq> {}\n 2. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}; K \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H; Ring R;\n     J \\<noteq> {}; K \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> fgs R M J \\<subseteq> fgs R M K", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H;\n        Ring R; J \\<noteq> {}; K \\<noteq> {}; x \\<in> fgs R M J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M K", "apply (simp add:fgs_def, simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H;\n        Ring R; J \\<noteq> {}; K \\<noteq> {};\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> J.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H;\n        Ring R; J \\<noteq> {}; K \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> J;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" and B = J and ?B1.0 = K in \n        extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f s.\n       \\<lbrakk>free_generator R M H; J \\<subseteq> K; K \\<subseteq> H;\n        Ring R; J \\<noteq> {}; K \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> J;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> K.\n                               \\<exists>s\n  \\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                                  x = l_comb R M n s f", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) empty_fgs:\"fgs R M {} = {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fgs R M {} = {\\<zero>}", "by(simp add:fgs_def linear_span_def)"], ["", "lemma (in Module) mem_fsps_snd_mHom:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow> \n                    b \\<in> mHom R (mdl M (fgs R M a)) N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> b \\<in> mHom R (mdl M (fgs R M a)) N", "by (simp add:fsps_def fsp_def)"], ["", "(*\nlemma (in Module) mem_fsps_snd_mHom1:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow> \n                    b \\<in> mHom R (mdl M (fgs R M a)) N\"\nby (simp add:fsps_def fsp_def) *)"], ["", "lemma (in Module) mem_fsps_fst_sub:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow>  a \\<subseteq> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> H", "by (simp add:fsps_def fsp_def)"], ["", "lemma (in Module) mem_fsps_fst_sub1:\"\\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>  \\<Longrightarrow>  a \\<subseteq> carrier M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> carrier M", "apply (simp add:fsps_def fsp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N;\n     b \\<in> mHom R (mdl M (fgs R M a)) N \\<and>\n     (\\<forall>z\\<in>a. f z = b z) \\<and> a \\<subseteq> H\\<rbrakk>\n    \\<Longrightarrow> a \\<subseteq> carrier M", "apply (frule free_generator_sub[of H],\n       rule subset_trans[of a H \"carrier M\"], simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Order_od_fm_fun:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> Order (od_fm_fun R M N f H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> Order (od_fm_fun R M N f H)", "apply (rule Order.intro)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> rel (od_fm_fun R M N f H)\n                      \\<subseteq> carrier (od_fm_fun R M N f H) \\<times>\n                                  carrier (od_fm_fun R M N f H)\n 2. \\<And>a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, a) \\<in> rel (od_fm_fun R M N f H)\n 3. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, a) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> a = b\n 4. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (simp add:od_fm_fun_carrier)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> rel (od_fm_fun R M N f H)\n                      \\<subseteq> fsps R M N f H \\<times> fsps R M N f H\n 2. \\<And>a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, a) \\<in> rel (od_fm_fun R M N f H)\n 3. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, a) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> a = b\n 4. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (rule subsetI, simp add:od_fm_fun_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, a) \\<in> rel (od_fm_fun R M N f H)\n 2. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, a) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> a = b\n 3. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (simp add:od_fm_fun_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, a) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> a = b\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (simp add:od_fm_fun_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> fsps R M N f H;\n        b \\<in> fsps R M N f H; fst b = fst a\\<rbrakk>\n       \\<Longrightarrow> a = b\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (cut_tac p = a in PairE_lemma, (erule exE)+,\n        cut_tac p = b in PairE_lemma, (erule exE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x; a = (x, y);\n        b = (x, ya)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (frule_tac a = x and b = y in mem_fsps_snd_mHom[of N H f], assumption+,\n       frule_tac a = x and b = ya in mem_fsps_snd_mHom[of N H f], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x; a = (x, y); b = (x, ya);\n        y \\<in> mHom R (mdl M (fgs R M x)) N;\n        ya \\<in> mHom R (mdl M (fgs R M x)) N\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (frule_tac a = x and b = y in mem_fsps_fst_sub[of N H f], assumption+,\n        frule free_generator_sub,\n        frule_tac A = x and B = H and C = \"carrier M\" in subset_trans,\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x; a = (x, y); b = (x, ya);\n        y \\<in> mHom R (mdl M (fgs R M x)) N;\n        ya \\<in> mHom R (mdl M (fgs R M x)) N; x \\<subseteq> H;\n        H \\<subseteq> carrier M; x \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (frule_tac a = x in fgs_submodule,\n       frule_tac H = \"fgs R M x\" in mdl_is_module)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x; a = (x, y); b = (x, ya);\n        y \\<in> mHom R (mdl M (fgs R M x)) N;\n        ya \\<in> mHom R (mdl M (fgs R M x)) N; x \\<subseteq> H;\n        H \\<subseteq> carrier M; x \\<subseteq> carrier M;\n        submodule R M (fgs R M x); R module mdl M (fgs R M x)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (thin_tac \"a = (x, y)\", thin_tac \"b = (x, ya)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x;\n        y \\<in> mHom R (mdl M (fgs R M x)) N;\n        ya \\<in> mHom R (mdl M (fgs R M x)) N; x \\<subseteq> H;\n        H \\<subseteq> carrier M; x \\<subseteq> carrier M;\n        submodule R M (fgs R M x); R module mdl M (fgs R M x)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x;\n        y \\<in> mHom R (mdl M (fgs R M x)) N;\n        ya \\<in> mHom R (mdl M (fgs R M x)) N; x \\<subseteq> H;\n        H \\<subseteq> carrier M; x \\<subseteq> carrier M;\n        submodule R M (fgs R M x); R module mdl M (fgs R M x)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (frule_tac H = x in fgs_generator)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (x, y) \\<in> fsps R M N f H;\n        (x, ya) \\<in> fsps R M N f H; xa = x;\n        y \\<in> mHom R (mdl M (fgs R M x)) N;\n        ya \\<in> mHom R (mdl M (fgs R M x)) N; x \\<subseteq> H;\n        H \\<subseteq> carrier M; x \\<subseteq> carrier M;\n        submodule R M (fgs R M x); R module mdl M (fgs R M x);\n        generator R (mdl M (fgs R M x)) x\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (frule_tac R = R and M = \"mdl M (fgs R M x)\" and N = N and H = x \n       and f = y and g = ya in Module.gen_mHom_eq, assumption+,\n       simp add:fsps_def fsp_def, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        a \\<in> carrier (od_fm_fun R M N f H);\n        b \\<in> carrier (od_fm_fun R M N f H);\n        c \\<in> carrier (od_fm_fun R M N f H);\n        (a, b) \\<in> rel (od_fm_fun R M N f H);\n        (b, c) \\<in> rel (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> (a, c) \\<in> rel (od_fm_fun R M N f H)", "apply (simp add:od_fm_fun_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fsps_chain_boundTr2_1:\"\\<lbrakk>R module N; \n      free_generator R M H; f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n      (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa\\<rbrakk>\n      \\<Longrightarrow> b x = ba x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (cut_tac sc_Ring, frule Ring.whole_ideal, frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (frule mem_fsps_snd_mHom[of N H f a b], assumption+, simp add:subsetD,\n        frule mem_fsps_snd_mHom[of N H f aa ba], assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (case_tac \"a = {}\", simp add:empty_fgs)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     ({}, b) \\<in> C; (aa, ba) \\<in> C; x = \\<zero>;\n     \\<zero> \\<in> fgs R M aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M {\\<zero>}) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a = {}\\<rbrakk>\n    \\<Longrightarrow> b \\<zero> = ba \\<zero>\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (cut_tac submodule_0, frule mdl_is_module[of \"{\\<zero>}\"],\n        frule subsetD[of C \"fsps R M N f H\" \"(aa, ba)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     ({}, b) \\<in> C; (aa, ba) \\<in> C; x = \\<zero>;\n     \\<zero> \\<in> fgs R M aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M {\\<zero>}) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a = {};\n     submodule R M {\\<zero>}; R module mdl M {\\<zero>};\n     (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> b \\<zero> = ba \\<zero>\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (cut_tac fgs_submodule[of aa],\n          frule mdl_is_module[of \"fgs R M aa\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     ({}, b) \\<in> C; (aa, ba) \\<in> C; x = \\<zero>;\n     \\<zero> \\<in> fgs R M aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M {\\<zero>}) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a = {};\n     submodule R M {\\<zero>}; R module mdl M {\\<zero>};\n     (aa, ba) \\<in> fsps R M N f H; submodule R M (fgs R M aa);\n     R module mdl M (fgs R M aa)\\<rbrakk>\n    \\<Longrightarrow> b \\<zero> = ba \\<zero>\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     ({}, b) \\<in> C; (aa, ba) \\<in> C; x = \\<zero>;\n     \\<zero> \\<in> fgs R M aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M {\\<zero>}) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a = {};\n     submodule R M {\\<zero>}; R module mdl M {\\<zero>};\n     (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (frule Module.mHom_0[of \"mdl M {\\<zero>}\" R N b], assumption+,\n        frule Module.mHom_0[of \"mdl M (fgs R M aa)\" R N ba], assumption+,\n        simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     ({}, b) \\<in> C; (aa, ba) \\<in> C; x = \\<zero>;\n     \\<zero> \\<in> fgs R M aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M {\\<zero>}) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a = {};\n     submodule R M {\\<zero>}; R module mdl M {\\<zero>};\n     (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> aa \\<subseteq> carrier M\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (frule mem_fsps_fst_sub[of N H f aa ba], assumption+,\n          rule subset_trans[of aa H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n     x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n     ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> b x = ba x", "apply (frule nonempty_ex[of a], erule exE,\n        frule_tac c = xa in subsetD[of a aa], assumption,\n        frule_tac x = xa in nonempty[of _ aa],\n        thin_tac \"xa \\<in> a\", thin_tac \"xa \\<in> aa\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n        x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (frule mem_fsps_fst_sub[of N H f aa ba], assumption+,\n        simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n        x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (frule mem_fgs_l_comb[of a x],\n        frule subset_trans[of a aa H], assumption+,\n        rule subset_trans[of a H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n        x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> a.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n        x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (frule_tac f = fa and A = \"{j. j \\<le> n}\" and B = a and ?B1.0 = aa in \n                  extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        (a, b) \\<in> C; (aa, ba) \\<in> C; x \\<in> fgs R M a;\n        x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (frule subsetD[of C \"fsps R M N f H\" \"(a, b)\"], assumption+,\n        frule subsetD[of C \"fsps R M N f H\" \"(aa, ba)\"], assumption+,\n        thin_tac \"C \\<subseteq> fsps R M N f H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (cut_tac fgs_submodule[of a],\n        frule mdl_is_module[of \"fgs R M a\"],\n        cut_tac fgs_submodule[of  aa], \n        frule mdl_is_module[of \"fgs R M aa\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa)\\<rbrakk>\n       \\<Longrightarrow> b x = ba x\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "(* \n apply (simp add:fsps_def fsp_def, (erule conjE)+) *)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa)\\<rbrakk>\n       \\<Longrightarrow> b x = ba x\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (frule subset_trans[of a aa H], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> b x = ba x\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (frule_tac f1 = fa and n1 = n and s1 = s in eSum_in_Submodule[THEN sym,\n        of H a], assumption+,\n        frule_tac s = s and n = n and g = fa in Module.linmap_im_lincomb[of \n        \"mdl M (fgs R M a)\" R \"carrier R\" N _ a], assumption+,\n        simp add:mdl_carrier,\n        subst fgs_def, rule_tac l_span_cont_H,\n        frule subset_trans[of a H \"carrier M\"], assumption+, simp,\n        thin_tac \"b (l_comb R (mdl M (fgs R M a)) n s fa) = \n                                                  l_comb R N n s (cmp b fa)\",\n        rotate_tac -1, frule sym, \n        thin_tac \"l_comb R M n s fa = l_comb R (mdl M (fgs R M a)) n s fa\",\n        simp,\n        thin_tac \"l_comb R (mdl M (fgs R M a)) n s fa = l_comb R M n s fa\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R M n s fa \\<in> fgs R M a;\n        l_comb R M n s fa \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp b fa) = ba (l_comb R M n s fa)\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (frule_tac f1 = fa and n1 = n and s1 = s in eSum_in_Submodule[THEN sym,\n        of H aa], assumption+,\n        frule_tac s = s and n = n and g = fa in Module.linmap_im_lincomb[of \n        \"mdl M (fgs R M aa)\" R \"carrier R\" N _ aa], assumption+,\n        simp add:mdl_carrier,\n        subst fgs_def, rule_tac l_span_cont_H,\n        frule subset_trans[of a H \"carrier M\"], assumption+, simp+,\n        thin_tac \"l_comb R M n s fa = l_comb R (mdl M (fgs R M aa)) n s fa\",\n        thin_tac \"ba (l_comb R (mdl M (fgs R M aa)) n s fa) =\n        l_comb R N n s (cmp ba fa)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp b fa) =\n                         l_comb R N n s (cmp ba fa)\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (simp add:fsps_def fsp_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R N n s (cmp b fa) =\n                         l_comb R N n s (cmp ba fa)\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (rule_tac s = s and n = n and f = \"cmp b fa\" and g = \"cmp ba fa\" in\n        Module.linear_comb_eq[of N R \"f ` H\"], assumption+,\n        simp add:image_sub0, assumption)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> cmp b fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 2. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> cmp ba fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 3. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp b fa j = cmp ba fa j\n 4. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 5. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (rule Pi_I, simp add:cmp_def,\n       frule_tac x = xa and f = fa and A = \"{j. j \\<le> n}\" and B = a in \n       funcset_mem, simp,\n       frule_tac m = \"fa xa\" in Module.mHom_mem[of \"mdl M (fgs R M a)\" R N b],\n         assumption+,\n       simp add:mdl_carrier fgs_def, rule_tac c = \"fa xa\" in \n         subsetD[of a \"linear_span R M (carrier R) a\"],\n        rule l_span_cont_H,\n        frule subset_trans[of a aa H], assumption+,\n        rule subset_trans[of a H \"carrier M\"], assumption+,\n        drule_tac x = \"fa xa\" in bspec, assumption,\n        frule_tac c = \"fa xa\" in subsetD[of a H], assumption+,\n        rotate_tac -2, frule sym, thin_tac \"f (fa xa) = b (fa xa)\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> cmp ba fa \\<in> {j. j \\<le> n} \\<rightarrow> f ` H\n 2. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp b fa j = cmp ba fa j\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 4. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (rule Pi_I, simp add:cmp_def,\n        frule_tac x = xa and f = fa and A = \"{j. j \\<le> n}\" and B = aa in \n        funcset_mem, simp,\n        frule_tac c = \"fa xa\" in subsetD[of aa H], assumption+,\n        drule_tac x = \"fa xa\" in bspec, assumption,\n        rotate_tac -1, frule sym, thin_tac \"f (fa xa) = ba (fa xa)\",\n        simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> n}.\n                            cmp b fa j = cmp ba fa j\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (rule ballI, simp add:cmp_def,\n        frule_tac x = j and f = fa and A = \"{j. j \\<le> n}\" and B = a in \n        funcset_mem, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n fa s j.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        \\<forall>z\\<in>a. f z = b z; \\<forall>z\\<in>aa. f z = ba z;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a);\n        submodule R M (fgs R M aa); R module mdl M (fgs R M aa);\n        a \\<subseteq> H; j \\<le> n; fa j \\<in> a\\<rbrakk>\n       \\<Longrightarrow> b (fa j) = ba (fa j)\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (frule_tac x = \"fa j\" in bspec, assumption,\n               thin_tac \"\\<forall>z\\<in>a. f z = b z\",\n               frule_tac c = \"fa j\" in subsetD[of a aa], assumption+,\n               frule_tac x = \"fa j\" in bspec, assumption,\n               thin_tac \"\\<forall>z\\<in>aa. f z = ba z\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n fa s j.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M a;\n        l_comb R (mdl M (fgs R M aa)) n s fa \\<in> fgs R M aa;\n        a \\<subseteq> aa; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R (mdl M (fgs R M aa)) n s fa;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> aa; submodule R M (fgs R M a);\n        R module mdl M (fgs R M a); submodule R M (fgs R M aa);\n        R module mdl M (fgs R M aa); a \\<subseteq> H; j \\<le> n;\n        fa j \\<in> a; f (fa j) = b (fa j); fa j \\<in> aa;\n        f (fa j) = ba (fa j)\\<rbrakk>\n       \\<Longrightarrow> b (fa j) = ba (fa j)\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 3. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (rotate_tac -3, frule sym, \n               thin_tac \"f (fa j) = b (fa j)\", frule sym,\n               thin_tac \"f (fa j) = ba (fa j)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H;\n        submodule R M (fgs R M a); R module mdl M (fgs R M a)\\<rbrakk>\n       \\<Longrightarrow> aa \\<subseteq> carrier M\n 2. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (simp add:subset_trans[of aa H \"carrier M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; (a, b) \\<in> C; (aa, ba) \\<in> C;\n        x \\<in> fgs R M a; x \\<in> fgs R M aa; a \\<subseteq> aa; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        b \\<in> mHom R (mdl M (fgs R M a)) N;\n        ba \\<in> mHom R (mdl M (fgs R M aa)) N; a \\<noteq> {};\n        aa \\<noteq> {}; aa \\<subseteq> H;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow> a;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; fa \\<in> {j. j \\<le> n} \\<rightarrow> aa;\n        (a, b) \\<in> fsps R M N f H; (aa, ba) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> a \\<subseteq> carrier M", "apply (frule subset_trans[of a aa H], assumption+,\n         simp add:subset_trans[of a H \"carrier M\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fsps_chain_boundTr2_2:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; C \\<noteq> {}; (a, b) \\<in> C; \n       x \\<in> fgs R M a; (a1, b1) \\<in> C; x \\<in> fgs R M a1\\<rbrakk> \\<Longrightarrow> b x = b1 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; (a, b) \\<in> C; x \\<in> fgs R M a; (a1, b1) \\<in> C;\n     x \\<in> fgs R M a1\\<rbrakk>\n    \\<Longrightarrow> b x = b1 x", "apply (frule_tac x = \"(a, b)\" in bspec, assumption,\n        thin_tac \"\\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\",\n        frule_tac x = \"(a1, b1)\" in bspec, assumption,\n        thin_tac \"\\<forall>ba\\<in>C. fst (a, b) \\<subseteq> fst ba \\<or> fst ba \\<subseteq> fst (a, b)\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {}; (a, b) \\<in> C; x \\<in> fgs R M a; (a1, b1) \\<in> C;\n     x \\<in> fgs R M a1; a \\<subseteq> a1 \\<or> a1 \\<subseteq> a\\<rbrakk>\n    \\<Longrightarrow> b x = b1 x", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {}; (a, b) \\<in> C; x \\<in> fgs R M a; (a1, b1) \\<in> C;\n     x \\<in> fgs R M a1; a \\<subseteq> a1\\<rbrakk>\n    \\<Longrightarrow> b x = b1 x\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {}; (a, b) \\<in> C; x \\<in> fgs R M a; (a1, b1) \\<in> C;\n     x \\<in> fgs R M a1; a1 \\<subseteq> a\\<rbrakk>\n    \\<Longrightarrow> b x = b1 x", "apply (rule fsps_chain_boundTr2_1[of N H f C a b a1 b1], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {}; (a, b) \\<in> C; x \\<in> fgs R M a; (a1, b1) \\<in> C;\n     x \\<in> fgs R M a1; a1 \\<subseteq> a\\<rbrakk>\n    \\<Longrightarrow> b x = b1 x", "apply (frule fsps_chain_boundTr2_1[of N H f C a1 b1 a b], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {}; (a, b) \\<in> C; x \\<in> fgs R M a; (a1, b1) \\<in> C;\n     x \\<in> fgs R M a1; a1 \\<subseteq> a; b1 x = b x\\<rbrakk>\n    \\<Longrightarrow> b x = b1 x", "apply (rule sym, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fsps_chain_boundTr2:\"\\<And>x. \\<lbrakk>R module N; free_generator R M H;\n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;  \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; \n       x \\<in> (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})); C \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> \n    (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) \\<in> \n    (carrier N) \\<and> \n    (\\<exists>a1 b1. (a1, b1) \\<in> C \\<and> x \\<in> fgs R M a1 \\<and> \n    (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) = \n              b1 x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (cut_tac sc_Ring, frule Ring.whole_ideal[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (case_tac \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C} = {}\", simp add: empty_fgs,\n       frule nonempty_ex[of C], erule exE,\n       cut_tac p = xa in PairE_lemma, (erule exE)+,\n       frule_tac c = xa in subsetD[of C \"fsps R M N f H\"], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (xb, y) \\<in> C; xa = (xb, y); (xb, y) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b1 \\<zero>)\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (frule_tac a = xb and b = y in mem_fsps_snd_mHom[of N H f], \n       assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (xb, y) \\<in> C; xa = (xb, y);\n        y \\<in> mHom R (mdl M (fgs R M xb)) N\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b1 \\<zero>)\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (rename_tac a b a1 b1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b1 \\<zero>)\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (subgoal_tac \"\\<exists>!y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \n                                          \\<zero> \\<in> (fgs R M a) \\<and> y = b \\<zero>)\",\n        subgoal_tac \"(THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \n         \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>)) \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \n          \\<zero> \\<in> fgs R M a \\<and> \n     (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>)) =\n      b \\<zero>)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and>\n               \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>);\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>))\n        \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and>\n            (THE y.\n                y \\<in> carrier N \\<and>\n                (\\<exists>a b.\n                    (a, b) \\<in> C \\<and>\n                    \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>)) =\n            b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b1 \\<zero>)\n 2. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and>\n               \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a b.\n                             (a, b) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b \\<zero>)\n 3. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                \\<zero> \\<in> fgs R M a \\<and>\n                                y = b \\<zero>)\n 4. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "prefer 2"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and>\n               \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a b.\n                             (a, b) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b \\<zero>)\n 2. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and>\n               \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>);\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>))\n        \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and>\n            (THE y.\n                y \\<in> carrier N \\<and>\n                (\\<exists>a b.\n                    (a, b) \\<in> C \\<and>\n                    \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>)) =\n            b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 \\<zero> \\<in> fgs R M a \\<and>\n                                 y = b \\<zero>))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             \\<zero> \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     \\<zero> \\<in> fgs R M a \\<and>\n                                     y = b \\<zero>)) =\n                             b1 \\<zero>)\n 3. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                \\<zero> \\<in> fgs R M a \\<and>\n                                y = b \\<zero>)\n 4. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (rule theI', simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                \\<zero> \\<in> fgs R M a \\<and>\n                                y = b \\<zero>)\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                \\<zero> \\<in> fgs R M a \\<and>\n                                y = b \\<zero>)\n 2. \\<And>a b a1 b1 y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> ya = b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 3. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (cut_tac a = a1 in fgs_submodule)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> a1 \\<subseteq> carrier M\n 2. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        submodule R M (fgs R M a1)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                \\<zero> \\<in> fgs R M a \\<and>\n                                y = b \\<zero>)\n 3. \\<And>a b a1 b1 y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> ya = b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 4. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (frule_tac a = a1 and b = b1 in mem_fsps_fst_sub[of N H f],\n          assumption+, simp add:subsetD, frule free_generator_sub[of H],\n          rule subset_trans[of _ H \"carrier M\"], assumption+,\n        frule_tac H = \"fgs R M a1\" in mdl_is_module,\n        frule_tac M = \"mdl M (fgs R M a1)\" and f = b1 in \n                                   Module.mHom_0[of _ R N], assumption+,\n        frule_tac H = \"fgs R M a1\" in submodule_inc_0,\n        frule Module.module_inc_zero[of N],\n        thin_tac \"b1 \\<in> mHom R (mdl M (fgs R M a1)) N\",\n        thin_tac \"R module mdl M (fgs R M a1)\",\n        simp add:mdl_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b a1 b1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1); submodule R M (fgs R M a1);\n        b1 \\<zero> = \\<zero>\\<^bsub>N\\<^esub>; \\<zero> \\<in> fgs R M a1;\n        \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                \\<zero> \\<in> fgs R M a \\<and>\n                                y = b \\<zero>)\n 2. \\<And>a b a1 b1 y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> ya = b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 3. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (rotate_tac -3, frule sym, thin_tac \"b1 \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b a1 b1 y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N;\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> y = b \\<zero>);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            \\<zero> \\<in> fgs R M a \\<and> ya = b \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply ((erule conjE)+, (erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b a1 b1 y ya aa ab ba bb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N; y \\<in> carrier N;\n        ya \\<in> carrier N; (aa, ba) \\<in> C; (ab, bb) \\<in> C;\n        \\<zero> \\<in> fgs R M aa; y = ba \\<zero>; \\<zero> \\<in> fgs R M ab;\n        ya = bb \\<zero>\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (cut_tac a = aa in fgs_submodule,\n          frule_tac a = aa and b = ba in mem_fsps_fst_sub[of N H f],\n          assumption+, simp add:subsetD,\n          frule free_generator_sub, rule subset_trans, assumption+,\n          simp add:subsetD,\n          frule_tac H = \"fgs R M aa\" in mdl_is_module,\n          frule_tac M = \"mdl M (fgs R M aa)\" and f = ba in \n                                   Module.mHom_0[of _ R N], assumption+,\n          frule_tac H = \"fgs R M aa\" in submodule_inc_0,\n          frule_tac c = \"(aa, ba)\" in subsetD[of C \"fsps R M N f H\"], \n          assumption+, simp,\n          frule_tac a = aa and b = ba in mem_fsps_snd_mHom[of N H f],\n          assumption+, simp add:mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b a1 b1 y ya aa ab ba bb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R\n                  \\<lparr>carrier = fgs R M a1, pop = (\\<plusminus>),\n                     mop = mop M, zero = \\<zero>,\n                     sprod =\n                       \\<lambda>a.\n                          restrict ((\\<cdot>\\<^sub>s) a)\n                           (fgs R M a1)\\<rparr>\n                  N;\n        \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N;\n        bb \\<zero> \\<in> carrier N; (aa, ba) \\<in> C; (ab, bb) \\<in> C;\n        \\<zero> \\<in> fgs R M aa; y = \\<zero>\\<^bsub>N\\<^esub>;\n        \\<zero> \\<in> fgs R M ab; ya = bb \\<zero>;\n        submodule R M (fgs R M aa);\n        R module\n        \\<lparr>carrier = fgs R M aa, pop = (\\<plusminus>), mop = mop M,\n           zero = \\<zero>,\n           sprod =\n             \\<lambda>a.\n                restrict ((\\<cdot>\\<^sub>s) a) (fgs R M aa)\\<rparr>;\n        ba \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> = bb \\<zero>\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (cut_tac a = ab in fgs_submodule,\n          frule_tac a = ab and b = bb in mem_fsps_fst_sub[of N H f],\n          assumption+, simp add:subsetD,\n          frule free_generator_sub, rule subset_trans[of _ H \"carrier M\"],\n          assumption+,\n          frule_tac H = \"fgs R M ab\" in mdl_is_module,\n          frule_tac M = \"mdl M (fgs R M ab)\" and f = bb in \n                                   Module.mHom_0[of _ R N], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b a1 b1 y ya aa ab ba bb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R\n                  \\<lparr>carrier = fgs R M a1, pop = (\\<plusminus>),\n                     mop = mop M, zero = \\<zero>,\n                     sprod =\n                       \\<lambda>a.\n                          restrict ((\\<cdot>\\<^sub>s) a)\n                           (fgs R M a1)\\<rparr>\n                  N;\n        \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N;\n        bb \\<zero> \\<in> carrier N; (aa, ba) \\<in> C; (ab, bb) \\<in> C;\n        \\<zero> \\<in> fgs R M aa; y = \\<zero>\\<^bsub>N\\<^esub>;\n        \\<zero> \\<in> fgs R M ab; ya = bb \\<zero>;\n        submodule R M (fgs R M aa);\n        R module\n        \\<lparr>carrier = fgs R M aa, pop = (\\<plusminus>), mop = mop M,\n           zero = \\<zero>,\n           sprod =\n             \\<lambda>a.\n                restrict ((\\<cdot>\\<^sub>s) a) (fgs R M aa)\\<rparr>;\n        ba \\<zero> = \\<zero>\\<^bsub>N\\<^esub>; submodule R M (fgs R M ab);\n        R module mdl M (fgs R M ab)\\<rbrakk>\n       \\<Longrightarrow> bb \\<in> mHom R (mdl M (fgs R M ab)) N\n 2. \\<And>a b a1 b1 y ya aa ab ba bb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        a = \\<zero>; C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<forall>x. (\\<exists>b. (x, b) \\<in> C) \\<longrightarrow> x = {};\n        (a1, b1) \\<in> C; b = (a1, b1);\n        b1 \\<in> mHom R\n                  \\<lparr>carrier = fgs R M a1, pop = (\\<plusminus>),\n                     mop = mop M, zero = \\<zero>,\n                     sprod =\n                       \\<lambda>a.\n                          restrict ((\\<cdot>\\<^sub>s) a)\n                           (fgs R M a1)\\<rparr>\n                  N;\n        \\<zero>\\<^bsub>N\\<^esub> \\<in> carrier N;\n        bb \\<zero> \\<in> carrier N; (aa, ba) \\<in> C; (ab, bb) \\<in> C;\n        \\<zero> \\<in> fgs R M aa; y = \\<zero>\\<^bsub>N\\<^esub>;\n        \\<zero> \\<in> fgs R M ab; ya = bb \\<zero>;\n        submodule R M (fgs R M aa);\n        R module\n        \\<lparr>carrier = fgs R M aa, pop = (\\<plusminus>), mop = mop M,\n           zero = \\<zero>,\n           sprod =\n             \\<lambda>a.\n                restrict ((\\<cdot>\\<^sub>s) a) (fgs R M aa)\\<rparr>;\n        ba \\<zero> = \\<zero>\\<^bsub>N\\<^esub>; submodule R M (fgs R M ab);\n        R module mdl M (fgs R M ab);\n        bb \\<zero>\\<^bsub>mdl M (fgs R M ab)\\<^esub> =\n        \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>N\\<^esub> = bb \\<zero>\n 3. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (fold mdl_def,\n         frule_tac c = \"(ab, bb)\" in subsetD[of C \"fsps R M N f H\"], \n         assumption+,\n          frule_tac a = ab and b = bb in mem_fsps_snd_mHom[of N H f], \n          assumption+, simp add:mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "(*********** case \\<Union>{a. \\<exists>b. (a, b) \\<in> C} = {} done **********)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)", "apply (subgoal_tac \"\\<exists>!y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \n                                          x \\<in> (fgs R M a) \\<and> y = b x)\",\n        subgoal_tac \"(THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \n         x \\<in> fgs R M a \\<and> y = b x)) \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> \n          x \\<in> fgs R M a \\<and> \n     (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) =\n      b x)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n        \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and>\n            (THE y.\n                y \\<in> carrier N \\<and>\n                (\\<exists>a b.\n                    (a, b) \\<in> C \\<and>\n                    x \\<in> fgs R M a \\<and> y = b x)) =\n            b x)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and>\n               x \\<in> fgs R M a \\<and> y = b x)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a b.\n                             (a, b) \\<in> C \\<and>\n                             x \\<in> fgs R M a \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b x)\n 3. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)", "prefer 2"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and>\n               x \\<in> fgs R M a \\<and> y = b x)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a b.\n                             (a, b) \\<in> C \\<and>\n                             x \\<in> fgs R M a \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b x)\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        \\<exists>!y.\n           y \\<in> carrier N \\<and>\n           (\\<exists>a b.\n               (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n        \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and>\n            (THE y.\n                y \\<in> carrier N \\<and>\n                (\\<exists>a b.\n                    (a, b) \\<in> C \\<and>\n                    x \\<in> fgs R M a \\<and> y = b x)) =\n            b x)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                         \\<in> carrier N \\<and>\n                         (\\<exists>a1 b1.\n                             (a1, b1) \\<in> C \\<and>\n                             x \\<in> fgs R M a1 \\<and>\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)) =\n                             b1 x)\n 3. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)", "apply (rule theI', simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)\n 2. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac K = \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C}\" and x = x in mem_fgs_l_comb)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n                         \\<subseteq> carrier M\n 2. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M\n                                  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\n 3. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          \\<Union> {a. \\<exists>b. (a, b) \\<in> C}.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)\n 4. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (rule subsetI, simp,\n          thin_tac \"\\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {}\",\n          erule exE, erule conjE, erule exE,\n          frule_tac a = xb and b = b in mem_fsps_fst_sub[of N H f],\n                assumption+, simp add:subsetD,\n          frule free_generator_sub[of H], simp add:subsetD, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          \\<Union> {a. \\<exists>b. (a, b) \\<in> C}.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)\n 2. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)\n 2. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac fa = fa and n = n in fsps_chain_boundTr1_1[of N H f C],\n          assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>b. (x, b) \\<in> C) \\<and>\n                            x \\<noteq> {}\n 2. \\<And>x n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                                  \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n 3. \\<And>x n fa s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa;\n        \\<exists>(c, d)\\<in>C. fa ` {j. j \\<le> n} \\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                x \\<in> fgs R M a \\<and> y = b x)\n 4. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac A = \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C}\" in nonempty_ex, \n          erule exE, simp, assumption+, erule bexE,\n          cut_tac p = xa in PairE_lemma, (erule exE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa s xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        l_comb R M n s fa\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; (xb, y) \\<in> C;\n        fa ` {j. j \\<le> n} \\<subseteq> xb; xa = (xb, y)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                l_comb R M n s fa \\<in> fgs R M a \\<and>\n                                y = b (l_comb R M n s fa))\n 2. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac a = xb and b = y in mem_fsps_fst_sub[of N H f], \n               assumption+, simp add:subsetD,\n          frule free_generator_sub[of H], \n          frule_tac A = xb in subset_trans[of _ H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa s xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        l_comb R M n s fa\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; (xb, y) \\<in> C;\n        fa ` {j. j \\<le> n} \\<subseteq> xb; xa = (xb, y); xb \\<subseteq> H;\n        H \\<subseteq> carrier M; xb \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                l_comb R M n s fa \\<in> fgs R M a \\<and>\n                                y = b (l_comb R M n s fa))\n 2. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac H = xb and s = s and n = n and f = fa in \n          l_comb_mem_linear_span[of \"carrier R\"], assumption+,\n          rule Pi_I,\n          frule_tac a = xc and A = \"{j. j \\<le> n}\" and f = fa in \n          mem_in_image2, simp add:image_def, erule exE, blast,\n          fold fgs_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa s xa xb y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        l_comb R M n s fa\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s fa; (xb, y) \\<in> C;\n        fa ` {j. j \\<le> n} \\<subseteq> xb; xa = (xb, y); xb \\<subseteq> H;\n        H \\<subseteq> carrier M; xb \\<subseteq> carrier M;\n        l_comb R M n s fa \\<in> fgs R M xb\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            y \\<in> carrier N \\<and>\n                            (\\<exists>a b.\n                                (a, b) \\<in> C \\<and>\n                                l_comb R M n s fa \\<in> fgs R M a \\<and>\n                                y = b (l_comb R M n s fa))\n 2. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac a = xb and b = y in mem_fsps_snd_mHom[of N H f],\n          assumption+, simp add:subsetD,\n          frule_tac a = xb in fgs_submodule,\n          frule_tac H = \"fgs R M xb\" in mdl_is_module,\n          frule_tac R = R and M = \"mdl M (fgs R M xb)\" and N = N and\n                f = y and m = x in Module.mHom_mem, assumption+,\n          simp add:mdl_carrier, simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x);\n        ya \\<in> carrier N \\<and>\n        (\\<exists>a b.\n            (a, b) \\<in> C \\<and>\n            x \\<in> fgs R M a \\<and> ya = b x)\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply ((erule conjE)+, (erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y ya a aa b ba.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<noteq> {};\n        y \\<in> carrier N; ya \\<in> carrier N; (a, b) \\<in> C;\n        (aa, ba) \\<in> C; x \\<in> fgs R M a; y = b x; x \\<in> fgs R M aa;\n        ya = ba x\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac x = \"(a, b)\" in bspec, assumption,\n         rotate_tac -1,\n         frule_tac x = \"(aa, ba)\" in bspec, assumption,\n         thin_tac \"\\<forall>ba\\<in>C. fst (a, b) \\<subseteq> fst ba \\<or> fst ba \\<subseteq> fst (a, b)\",\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y ya a aa b ba.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        x \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> x \\<noteq> {};\n        b x \\<in> carrier N; ba x \\<in> carrier N; (a, b) \\<in> C;\n        (aa, ba) \\<in> C; x \\<in> fgs R M a; y = b x; x \\<in> fgs R M aa;\n        ya = ba x; a \\<subseteq> aa \\<or> aa \\<subseteq> a\\<rbrakk>\n       \\<Longrightarrow> b x = ba x", "apply (rule_tac a = a and b = b and ?a1.0 = aa and ?b1.0 = ba and x = x in \n        fsps_chain_boundTr2_2[of N H f C], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Un_C_submodule:\"\\<lbrakk>R module N; free_generator R M H; \n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {};\n     \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk> \\<Longrightarrow> \n       submodule R M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>\n    \\<Longrightarrow> submodule R M\n                       (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))", "apply (cut_tac sc_Ring, frule free_generator_sub[of H],\n        frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     Ring R; H \\<subseteq> carrier M; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> submodule R M\n                       (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))", "apply (subst fgs_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     Ring R; H \\<subseteq> carrier M; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> submodule R M\n                       (linear_span R M (carrier R)\n                         (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))", "apply (rule linear_span_subModule, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     Ring R; H \\<subseteq> carrier M; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n                      \\<subseteq> carrier M", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        Ring R; H \\<subseteq> carrier M; ideal R (carrier R);\n        \\<exists>xa.\n           (\\<exists>b. (xa, b) \\<in> C) \\<and> x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (erule exE, erule conjE, erule exE,\n        frule_tac c = \"(xa, b)\" in subsetD[of C \"fsps R M N f H\"], assumption+,\n        frule_tac a = xa and b = b in mem_fsps_fst_sub[of N H f], assumption+,\n        frule free_generator_sub, frule_tac A = xa in \n               subset_trans[of _ H \"carrier M\"], assumption+,\n        simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Un_C_fgs_sub:\"\\<lbrakk>R module N; free_generator R M H; \n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {};\n     \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk> \\<Longrightarrow>\n     \\<Union>{a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n                      \\<subseteq> fgs R M\n                                   (\\<Union>\n                                     {a. \\<exists>b. (a, b) \\<in> C})", "apply (simp add:fgs_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n                      \\<subseteq> linear_span R M (carrier R)\n                                   (\\<Union>\n                                     {a. \\<exists>b. (a, b) \\<in> C})", "apply (rule l_span_cont_H)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n                      \\<subseteq> carrier M", "apply (frule Un_C_submodule[of N H f C], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     submodule R M\n      (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n                      \\<subseteq> carrier M", "apply (rule subsetI, simp, erule exE, erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        x \\<in> xa; (xa, b) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier M", "apply (frule_tac a = xa and b = b in mem_fsps_fst_sub[of N H f], assumption+,\n       simp add:subsetD,\n       frule free_generator_sub[of H],\n       frule_tac A = xa and B = H and C = \"carrier M\" in subset_trans, \n       assumption+, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) Chain_3_supset:\"\\<lbrakk>R module N; free_generator R M H; \n    f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {};\n   \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; (a1, b1) \\<in> C; (a2, b2) \\<in> C;\n   (a3, b3) \\<in> C\\<rbrakk> \\<Longrightarrow> \\<exists>(g, h)\\<in>C. a1 \\<subseteq> g \\<and> a2 \\<subseteq> g \\<and> a3 \\<subseteq> g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "assume \"(a1, b1) \\<in> C\"\n    \"(a2, b2) \\<in> C\"\n    \"(a3, b3) \\<in> C\""], ["proof (state)\nthis:\n  (a1, b1) \\<in> C\n  (a2, b2) \\<in> C\n  (a3, b3) \\<in> C\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "then"], ["proof (chain)\npicking this:\n  (a1, b1) \\<in> C\n  (a2, b2) \\<in> C\n  (a3, b3) \\<in> C", "have A: \"a1 \\<in> fst ` C\"\n    \"a2 \\<in> fst ` C\"\n    \"a3 \\<in> fst ` C\""], ["proof (prove)\nusing this:\n  (a1, b1) \\<in> C\n  (a2, b2) \\<in> C\n  (a3, b3) \\<in> C\n\ngoal (1 subgoal):\n 1. a1 \\<in> fst ` C &&& a2 \\<in> fst ` C &&& a3 \\<in> fst ` C", "by (simp_all add: image_iff) force+"], ["proof (state)\nthis:\n  a1 \\<in> fst ` C\n  a2 \\<in> fst ` C\n  a3 \\<in> fst ` C\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "assume \"\\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\""], ["proof (state)\nthis:\n  \\<forall>a\\<in>C.\n     \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "with A"], ["proof (chain)\npicking this:\n  a1 \\<in> fst ` C\n  a2 \\<in> fst ` C\n  a3 \\<in> fst ` C\n  \\<forall>a\\<in>C.\n     \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a", "have \"a1 \\<subseteq> a2 \\<or> a2 \\<subseteq> a1\"\n    \"a1 \\<subseteq> a3 \\<or> a3 \\<subseteq> a1\"\n    \"a2 \\<subseteq> a3 \\<or> a3 \\<subseteq> a2\""], ["proof (prove)\nusing this:\n  a1 \\<in> fst ` C\n  a2 \\<in> fst ` C\n  a3 \\<in> fst ` C\n  \\<forall>a\\<in>C.\n     \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\n\ngoal (1 subgoal):\n 1. a1 \\<subseteq> a2 \\<or> a2 \\<subseteq> a1 &&&\n    a1 \\<subseteq> a3 \\<or> a3 \\<subseteq> a1 &&&\n    a2 \\<subseteq> a3 \\<or> a3 \\<subseteq> a2", "by auto"], ["proof (state)\nthis:\n  a1 \\<subseteq> a2 \\<or> a2 \\<subseteq> a1\n  a1 \\<subseteq> a3 \\<or> a3 \\<subseteq> a1\n  a2 \\<subseteq> a3 \\<or> a3 \\<subseteq> a2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "with A"], ["proof (chain)\npicking this:\n  a1 \\<in> fst ` C\n  a2 \\<in> fst ` C\n  a3 \\<in> fst ` C\n  a1 \\<subseteq> a2 \\<or> a2 \\<subseteq> a1\n  a1 \\<subseteq> a3 \\<or> a3 \\<subseteq> a1\n  a2 \\<subseteq> a3 \\<or> a3 \\<subseteq> a2", "have \"\\<exists>a\\<in>fst ` C. a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a\""], ["proof (prove)\nusing this:\n  a1 \\<in> fst ` C\n  a2 \\<in> fst ` C\n  a3 \\<in> fst ` C\n  a1 \\<subseteq> a2 \\<or> a2 \\<subseteq> a1\n  a1 \\<subseteq> a3 \\<or> a3 \\<subseteq> a1\n  a2 \\<subseteq> a3 \\<or> a3 \\<subseteq> a2\n\ngoal (1 subgoal):\n 1. \\<exists>a\\<in>fst ` C.\n       a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a", "by auto"], ["proof (state)\nthis:\n  \\<exists>a\\<in>fst ` C.\n     a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "then"], ["proof (chain)\npicking this:\n  \\<exists>a\\<in>fst ` C.\n     a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a", "obtain a where \"a \\<in> fst ` C\" and C: \"a1 \\<subseteq> a\" \"a2 \\<subseteq> a\" \"a3 \\<subseteq> a\""], ["proof (prove)\nusing this:\n  \\<exists>a\\<in>fst ` C.\n     a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a\n\ngoal (1 subgoal):\n 1. (\\<And>a.\n        \\<lbrakk>a \\<in> fst ` C; a1 \\<subseteq> a; a2 \\<subseteq> a;\n         a3 \\<subseteq> a\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  a \\<in> fst ` C\n  a1 \\<subseteq> a\n  a2 \\<subseteq> a\n  a3 \\<subseteq> a\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "then"], ["proof (chain)\npicking this:\n  a \\<in> fst ` C\n  a1 \\<subseteq> a\n  a2 \\<subseteq> a\n  a3 \\<subseteq> a", "obtain b where \"(a, b) \\<in> C\""], ["proof (prove)\nusing this:\n  a \\<in> fst ` C\n  a1 \\<subseteq> a\n  a2 \\<subseteq> a\n  a3 \\<subseteq> a\n\ngoal (1 subgoal):\n 1. (\\<And>b. (a, b) \\<in> C \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (a, b) \\<in> C\n\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     (a1, b1) \\<in> C; (a2, b2) \\<in> C; (a3, b3) \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<exists>(g, h)\\<in>C.\n                         a1 \\<subseteq> g \\<and>\n                         a2 \\<subseteq> g \\<and> a3 \\<subseteq> g", "with C"], ["proof (chain)\npicking this:\n  a1 \\<subseteq> a\n  a2 \\<subseteq> a\n  a3 \\<subseteq> a\n  (a, b) \\<in> C", "show \"\\<exists>(a, b)\\<in>C. a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a\""], ["proof (prove)\nusing this:\n  a1 \\<subseteq> a\n  a2 \\<subseteq> a\n  a3 \\<subseteq> a\n  (a, b) \\<in> C\n\ngoal (1 subgoal):\n 1. \\<exists>(a, b)\\<in>C.\n       a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a", "by auto"], ["proof (state)\nthis:\n  \\<exists>(a, b)\\<in>C.\n     a1 \\<subseteq> a \\<and> a2 \\<subseteq> a \\<and> a3 \\<subseteq> a\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in Module) fsps_chain_bound1:\"\\<lbrakk>R module N; free_generator R M H;  \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;  \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a; C \\<noteq> {}\\<rbrakk>  \\<Longrightarrow> \n      (\\<lambda>x\\<in>(fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})). (THE y. y \\<in> carrier N \\<and> \n                    (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))) \\<in> \n       mHom R (mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))) N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> mHom R\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b. (a, b) \\<in> C})))\n                             N", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> mHom R\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b. (a, b) \\<in> C})))\n                             N", "apply (frule Un_C_submodule[of N H f C], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M\n      (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> mHom R\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b. (a, b) \\<in> C})))\n                             N", "apply (frule mdl_is_module[of \"fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> mHom R\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b. (a, b) \\<in> C})))\n                             N", "apply (rule Module.mHom_test[of \"mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\" R N \n      \"\\<lambda>x\\<in>fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). THE y. y \\<in> carrier N \\<and> \n        (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> carrier\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C}))) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> extensional\n                             (carrier\n                               (mdl M\n                                 (fgs R M\n                                   (\\<Union>\n                                     {a.\n\\<exists>b. (a, b) \\<in> C})))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> carrier\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b.\n    (a, b) \\<in> C}))) \\<rightarrow>\n                            carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> extensional\n                             (carrier\n                               (mdl M\n                                 (fgs R M\n                                   (\\<Union>\n                                     {a.\n\\<exists>b. (a, b) \\<in> C})))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m)", "apply (rule Pi_I,\n        frule submodule_subset[of \"fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\"],\n        simp add:mdl_carrier, simp add:fsps_chain_boundTr2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> extensional\n                             (carrier\n                               (mdl M\n                                 (fgs R M\n                                   (\\<Union>\n                                     {a.\n\\<exists>b. (a, b) \\<in> C})))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> extensional\n                             (carrier\n                               (mdl M\n                                 (fgs R M\n                                   (\\<Union>\n                                     {a. \\<exists>b. (a, b) \\<in> C}))))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                 THE y.\n                                    y \\<in> carrier N \\<and>\n                                    (\\<exists>a b.\n  (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                              m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m\\<in>carrier\n(mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                         \\<forall>n\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              n) =\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m \\<plusminus>\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        n \\<in> carrier\n                 (mdl M\n                   (fgs R M\n                     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})))\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           n) =\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule Module.module_is_ag[of \"mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\"\n         R])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        n \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        aGroup\n         (mdl M\n           (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})))\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           n) =\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac x = m and y = n in aGroup.ag_pOp_closed[of \n          \"mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        n \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> carrier\n               (mdl M\n                 (fgs R M\n                   (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})))\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           n) =\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac x = m in fsps_chain_boundTr2[of N H f C], assumption+,\n        simp add:mdl_carrier, assumption, erule conjE, (erule exE)+, \n        (erule conjE)+,\n        frule_tac x = n in fsps_chain_boundTr2[of N H f C], assumption+,\n        simp add:mdl_carrier, assumption, erule conjE, (erule exE)+, \n        (erule conjE)+,\n        frule_tac x = \"m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> n\" in \n        fsps_chain_boundTr2[of N H f C], assumption+,\n        simp add:mdl_carrier, assumption, erule conjE, (erule exE)+, \n        (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        n \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> carrier\n               (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m))\n        \\<in> carrier N;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m)) =\n        b1 m;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> n \\<in> fgs R M a \\<and> y = b n))\n        \\<in> carrier N;\n        (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> n \\<in> fgs R M a \\<and> y = b n)) =\n        b1a n;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                n\n                \\<in> fgs R M a \\<and>\n                y =\n                b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   n)))\n        \\<in> carrier N;\n        (a1b, b1b) \\<in> C;\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M a1b;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                n\n                \\<in> fgs R M a \\<and>\n                y =\n                b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   n))) =\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           n) =\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m \\<plusminus>\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m)) =\n        b1 m;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> n \\<in> fgs R M a \\<and> y = b n)) =\n        b1a n;\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\n        \\<in> carrier N;\n        (a1b, b1b) \\<in> C;\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M a1b;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                n\n                \\<in> fgs R M a \\<and>\n                y =\n                b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   n))) =\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (thin_tac \"(THE y.\n            y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m)) =\n        b1 m\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> n \\<in> fgs R M a \\<and> y = b n)) =\n        b1a n;\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\n        \\<in> carrier N;\n        (a1b, b1b) \\<in> C;\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M a1b;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                n\n                \\<in> fgs R M a \\<and>\n                y =\n                b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   n))) =\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (\n        thin_tac \"(THE y.\n            y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> n \\<in> fgs R M a \\<and> y = b n)) =\n        b1a n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\n        \\<in> carrier N;\n        (a1b, b1b) \\<in> C;\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M a1b;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and>\n                m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                n\n                \\<in> fgs R M a \\<and>\n                y =\n                b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   n))) =\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (\n        thin_tac \"(THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b. (a, b) \\<in> C \\<and>\n                   m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> n \\<in> fgs R M a \\<and>\n                   y = b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> n))) =\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> n)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             n)\n        \\<in> carrier N;\n        (a1b, b1b) \\<in> C;\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        n\n        \\<in> fgs R M a1b\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (thin_tac \"m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> n\n        \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\",\n        thin_tac \"b1b (m \\<plusminus>\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> n) \\<in> carrier N\",\n        simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus> n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (cut_tac ?a1.0 = a1 and ?b1.0 = b1 and ?a2.0 = a1a and ?b2.0 = b1a and \n        ?a3.0 = a1b and ?b3.0 = b1b in Chain_3_supset[of N H f C], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b;\n        \\<exists>(g, h)\\<in>C.\n           a1 \\<subseteq> g \\<and>\n           a1a \\<subseteq> g \\<and> a1b \\<subseteq> g\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus> n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b; x \\<in> C;\n        case x of\n        (g, h) \\<Rightarrow>\n          a1 \\<subseteq> g \\<and>\n          a1a \\<subseteq> g \\<and> a1b \\<subseteq> g\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus> n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (cut_tac p = x in PairE_lemma, (erule exE)+, simp, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b;\n        (xa, y) \\<in> C; x = (xa, y); a1 \\<subseteq> xa; a1a \\<subseteq> xa;\n        a1b \\<subseteq> xa\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus> n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac J = a1b and K = xa in fgs_mono[of H], assumption+,\n        rule_tac a = xa and b = y in mem_fsps_fst_sub[of N H f], assumption+, \n        simp add:subsetD,\n        frule_tac J = a1 and K = xa in fgs_mono[of H], assumption+,\n        rule_tac a = xa and b = y in mem_fsps_fst_sub[of N H f], assumption+,\n        simp add:subsetD, \n        frule_tac J = a1a and K = xa in fgs_mono[of H], assumption+,\n        rule_tac a = xa and b = y in mem_fsps_fst_sub[of N H f], assumption+, \n        simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b;\n        (xa, y) \\<in> C; x = (xa, y); a1 \\<subseteq> xa; a1a \\<subseteq> xa;\n        a1b \\<subseteq> xa; fgs R M a1b \\<subseteq> fgs R M xa;\n        fgs R M a1 \\<subseteq> fgs R M xa;\n        fgs R M a1a \\<subseteq> fgs R M xa\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus> n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac c = m and A = \"fgs R M a1\" and B = \"fgs R M xa\" in subsetD,\n          assumption+,\n         frule_tac c = n and A = \"fgs R M a1a\" and B = \"fgs R M xa\" in subsetD,\n          assumption+,\n         frule_tac c = \"m \\<plusminus> n\" and A = \"fgs R M a1b\" and B = \"fgs R M xa\" in \n          subsetD, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        b1a n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b;\n        (xa, y) \\<in> C; x = (xa, y); a1 \\<subseteq> xa; a1a \\<subseteq> xa;\n        a1b \\<subseteq> xa; fgs R M a1b \\<subseteq> fgs R M xa;\n        fgs R M a1 \\<subseteq> fgs R M xa;\n        fgs R M a1a \\<subseteq> fgs R M xa; m \\<in> fgs R M xa;\n        n \\<in> fgs R M xa; m \\<plusminus> n \\<in> fgs R M xa\\<rbrakk>\n       \\<Longrightarrow> b1b (m \\<plusminus> n) =\n                         b1 m \\<plusminus>\\<^bsub>N\\<^esub> b1a n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac a = a1 and b = b1 and aa = xa and ba = y in \n          fsps_chain_boundTr2_1[of N H f C], assumption+, simp,\n         frule_tac a = a1a and b = b1a and aa = xa and ba = y in \n          fsps_chain_boundTr2_1[of N H f C], assumption+, simp,\n         frule_tac a = a1b and b = b1b and aa = xa and ba = y in \n          fsps_chain_boundTr2_1[of N H f C], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        n \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        aGroup (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        y m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        y n \\<in> carrier N; (a1a, b1a) \\<in> C; n \\<in> fgs R M a1a;\n        (a1b, b1b) \\<in> C; m \\<plusminus> n \\<in> fgs R M a1b;\n        (xa, y) \\<in> C; x = (xa, y); a1 \\<subseteq> xa; a1a \\<subseteq> xa;\n        a1b \\<subseteq> xa; fgs R M a1b \\<subseteq> fgs R M xa;\n        fgs R M a1 \\<subseteq> fgs R M xa;\n        fgs R M a1a \\<subseteq> fgs R M xa; m \\<in> fgs R M xa;\n        n \\<in> fgs R M xa; m \\<plusminus> n \\<in> fgs R M xa; b1 m = y m;\n        b1a n = y n; b1b (m \\<plusminus> n) = y (m \\<plusminus> n)\\<rbrakk>\n       \\<Longrightarrow> y (m \\<plusminus> n) =\n                         y m \\<plusminus>\\<^bsub>N\\<^esub> y n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (thin_tac \"submodule R M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\",\n         thin_tac \"R module mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\",\n         thin_tac \"m \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\",\n         thin_tac \"n \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\",\n         thin_tac \"aGroup (mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})))\",\n         thin_tac \"y m \\<in> carrier N\",  thin_tac \"(a1, b1) \\<in> C\",\n         thin_tac \"m \\<in> fgs R M a1\",   thin_tac \"y n \\<in> carrier N\",\n         thin_tac \"(a1a, b1a) \\<in> C\",   thin_tac \"n \\<in> fgs R M a1a\",\n         thin_tac \"(a1b, b1b) \\<in> C\",   thin_tac \"m \\<plusminus> n \\<in> fgs R M a1b\",\n         thin_tac \"a1 \\<subseteq> xa\",          thin_tac \"a1a \\<subseteq> xa\",\n         thin_tac \"a1b \\<subseteq> xa\",         thin_tac \"fgs R M a1 \\<subseteq> fgs R M xa\",\n         thin_tac \"fgs R M a1a \\<subseteq> fgs R M xa\",\n         thin_tac \"b1b (m \\<plusminus> n) = y (m \\<plusminus> n)\",\n         thin_tac \"b1 m = y m\", thin_tac \"b1a n = y n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); (xa, y) \\<in> C;\n        x = (xa, y); fgs R M a1b \\<subseteq> fgs R M xa; m \\<in> fgs R M xa;\n        n \\<in> fgs R M xa; m \\<plusminus> n \\<in> fgs R M xa\\<rbrakk>\n       \\<Longrightarrow> y (m \\<plusminus> n) =\n                         y m \\<plusminus>\\<^bsub>N\\<^esub> y n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (cut_tac a = xa in fgs_submodule, \n         frule_tac c = \"(xa, y)\" in subsetD[of C \"fsps R M N f H\"], \n         assumption+,\n         simp add:mem_fsps_fst_sub1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); (xa, y) \\<in> C;\n        x = (xa, y); fgs R M a1b \\<subseteq> fgs R M xa; m \\<in> fgs R M xa;\n        n \\<in> fgs R M xa; m \\<plusminus> n \\<in> fgs R M xa;\n        submodule R M (fgs R M xa)\\<rbrakk>\n       \\<Longrightarrow> y (m \\<plusminus> n) =\n                         y m \\<plusminus>\\<^bsub>N\\<^esub> y n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac H = \"fgs R M xa\" in mdl_is_module)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); (xa, y) \\<in> C;\n        x = (xa, y); fgs R M a1b \\<subseteq> fgs R M xa; m \\<in> fgs R M xa;\n        n \\<in> fgs R M xa; m \\<plusminus> n \\<in> fgs R M xa;\n        submodule R M (fgs R M xa); R module mdl M (fgs R M xa)\\<rbrakk>\n       \\<Longrightarrow> y (m \\<plusminus> n) =\n                         y m \\<plusminus>\\<^bsub>N\\<^esub> y n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac a = xa and b = y in mem_fsps_snd_mHom[of N H f],\n         assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m n a1 b1 a1a b1a a1b b1b x xa y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); (xa, y) \\<in> C;\n        x = (xa, y); fgs R M a1b \\<subseteq> fgs R M xa; m \\<in> fgs R M xa;\n        n \\<in> fgs R M xa; m \\<plusminus> n \\<in> fgs R M xa;\n        submodule R M (fgs R M xa); R module mdl M (fgs R M xa);\n        y \\<in> mHom R (mdl M (fgs R M xa)) N\\<rbrakk>\n       \\<Longrightarrow> y (m \\<plusminus> n) =\n                         y m \\<plusminus>\\<^bsub>N\\<^esub> y n\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (frule_tac R = R and M = \"mdl M (fgs R M xa)\" and N = N and f = y and \n         m = m and n = n in Module.mHom_add, assumption+,\n         simp add:mdl_carrier, simp add:mdl_carrier, simp add:mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "(************** mHom_add ***********************)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n     C \\<noteq> {}; Ring R; ideal R (carrier R);\n     submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n     R module\n     mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))).\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                            (\\<lambda>x\\<in>fgs R M\n       (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                                THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n                             m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        a \\<in> carrier R;\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M\n                     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})))\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m", "apply (frule_tac a = a and m = m in Module.sc_mem[of \n          \"mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\" R], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        a \\<in> carrier R;\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        m\n        \\<in> carrier\n               (mdl M\n                 (fgs R M\n                   (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})))\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m", "apply (frule_tac x = m in fsps_chain_boundTr2[of N H f C], assumption+,\n        simp add:mdl_carrier, assumption, erule conjE, (erule exE)+, \n        (erule conjE)+,\n        frule_tac x = \"a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> m\" in \n        fsps_chain_boundTr2[of N H f C], assumption+,\n        simp add:mdl_carrier, assumption, erule conjE, (erule exE)+, \n        (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        a \\<in> carrier R;\n        m \\<in> carrier\n                 (mdl M\n                   (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        m\n        \\<in> carrier\n               (mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})));\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m))\n        \\<in> carrier N;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m)) =\n        b1 m;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>aa b.\n                (aa, b) \\<in> C \\<and>\n                a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                m\n                \\<in> fgs R M aa \\<and>\n                y =\n                b (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   m)))\n        \\<in> carrier N;\n        (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        m\n        \\<in> fgs R M a1a;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>aa b.\n                (aa, b) \\<in> C \\<and>\n                a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                m\n                \\<in> fgs R M aa \\<and>\n                y =\n                b (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   m))) =\n        b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             m)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          m", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R);\n        submodule R M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        R module mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}));\n        a \\<in> carrier R;\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        m\n        \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m)) =\n        b1 m;\n        b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             m)\n        \\<in> carrier N;\n        (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        m\n        \\<in> fgs R M a1a;\n        (THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>aa b.\n                (aa, b) \\<in> C \\<and>\n                a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                m\n                \\<in> fgs R M aa \\<and>\n                y =\n                b (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                   m))) =\n        b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n             m)\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (thin_tac \"(THE y.\n            y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> m \\<in> fgs R M a \\<and> y = b m)) =\n        b1 m\",\n        thin_tac \"b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> m) \\<in> carrier N\",\n        thin_tac \"(THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>aa b.\n                (aa, b) \\<in> C \\<and>\n                a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> m \\<in> fgs R M aa \\<and>\n                y = b (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> m))) =\n        b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> m)\",\n        thin_tac \"a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\\<^esub> m\n        \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\",\n        thin_tac \"submodule R M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\",\n        thin_tac \"R module mdl M (fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        m \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 m \\<in> carrier N; (a1, b1) \\<in> C; m \\<in> fgs R M a1;\n        (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n        m\n        \\<in> fgs R M a1a\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}))\\<^esub>\n                              m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (simp add:mdl_def,\n        thin_tac \"m \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\",\n        thin_tac \"b1 m \\<in> carrier N\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (frule_tac x = \"(a1, b1)\" in bspec, assumption,\n         rotate_tac -1,\n         drule_tac x = \"(a1a, b1a)\" in bspec, assumption,\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a;\n        a1 \\<subseteq> a1a \\<or> a1a \\<subseteq> a1\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (erule disjE,\n        frule_tac J = a1 and K = a1a in fgs_mono[of H], assumption+,\n        rule_tac a = a1a and b = b1a in mem_fsps_fst_sub[of N H f], \n        assumption+, simp add:subsetD,\n        frule_tac c = m and A = \"fgs R M a1\" and B = \"fgs R M a1a\" in subsetD,\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1 \\<subseteq> a1a;\n        fgs R M a1 \\<subseteq> fgs R M a1a; m \\<in> fgs R M a1a\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m\n 2. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (cut_tac a = a1a in fgs_submodule,\n         frule_tac c = \"(a1a, b1a)\" in subsetD[of C \"fsps R M N f H\"],\n                               assumption+, simp add:mem_fsps_fst_sub1,\n         frule_tac H = \"fgs R M a1a\" in mdl_is_module,\n         frule_tac a = a1a and b = b1a in mem_fsps_snd_mHom[of N H f],\n          assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1 \\<subseteq> a1a;\n        fgs R M a1 \\<subseteq> fgs R M a1a; m \\<in> fgs R M a1a;\n        submodule R M (fgs R M a1a); R module mdl M (fgs R M a1a);\n        b1a \\<in> mHom R (mdl M (fgs R M a1a)) N\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m\n 2. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (frule_tac R = R and M = \"mdl M (fgs R M a1a)\" and N = N and m = m \n         and f = b1a and a = a in Module.mHom_lin, assumption+,\n         simp add:mdl_carrier, assumption+, simp add:mdl_def,\n                fold mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1 \\<subseteq> a1a;\n        fgs R M a1 \\<subseteq> fgs R M a1a; m \\<in> fgs R M a1a;\n        submodule R M (fgs R M a1a); R module mdl M (fgs R M a1a);\n        b1a \\<in> mHom R (mdl M (fgs R M a1a)) N;\n        b1a (a \\<cdot>\\<^sub>s m) =\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1a m\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1a m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m\n 2. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (frule_tac a = a1 and b = b1 and ?a1.0 = a1a and ?b1.0 = b1a and x = m\n         in fsps_chain_boundTr2_2[of N H f C], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (frule_tac J = a1a and K = a1 in fgs_mono[of H], assumption+,\n        rule_tac a = a1 and b = b1 in mem_fsps_fst_sub[of N H f], \n        assumption+, simp add:subsetD,\n        frule_tac c = \"a \\<cdot>\\<^sub>s m\" and A = \"fgs R M a1a\" and B = \"fgs R M a1\" in \n        subsetD, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1;\n        fgs R M a1a \\<subseteq> fgs R M a1;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1\\<rbrakk>\n       \\<Longrightarrow> b1a (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (frule_tac a = a1a and b = b1a and ?a1.0 = a1 and ?b1.0 = b1 and \n         x = \"a \\<cdot>\\<^sub>s m\" in fsps_chain_boundTr2_2[of N H f C], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1;\n        fgs R M a1a \\<subseteq> fgs R M a1;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1;\n        b1a (a \\<cdot>\\<^sub>s m) = b1 (a \\<cdot>\\<^sub>s m)\\<rbrakk>\n       \\<Longrightarrow> b1 (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (cut_tac a = a1 in fgs_submodule,\n         frule_tac c = \"(a1, b1)\" in subsetD[of C \"fsps R M N f H\"],\n           assumption+, simp add:mem_fsps_fst_sub1,\n         frule_tac H = \"fgs R M a1\" in mdl_is_module,\n         frule_tac a = a1 and b = b1 in mem_fsps_snd_mHom[of N H f],\n          assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m a1 b1 a1a b1a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        C \\<noteq> {}; Ring R; ideal R (carrier R); a \\<in> carrier R;\n        (a1, b1) \\<in> C; m \\<in> fgs R M a1; (a1a, b1a) \\<in> C;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1a; a1a \\<subseteq> a1;\n        fgs R M a1a \\<subseteq> fgs R M a1;\n        a \\<cdot>\\<^sub>s m \\<in> fgs R M a1;\n        b1a (a \\<cdot>\\<^sub>s m) = b1 (a \\<cdot>\\<^sub>s m);\n        submodule R M (fgs R M a1); R module mdl M (fgs R M a1);\n        b1 \\<in> mHom R (mdl M (fgs R M a1)) N\\<rbrakk>\n       \\<Longrightarrow> b1 (a \\<cdot>\\<^sub>s m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> b1 m", "apply (frule_tac R = R and M = \"mdl M (fgs R M a1)\" and N = N and m = m \n         and f = b1 and a = a in Module.mHom_lin, assumption+,\n         simp add:mdl_carrier, assumption+, simp add:mdl_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fsps_chain_bound2:\"\\<lbrakk>R module N; free_generator R M H;  \n       f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H; C \\<noteq> {}; \n       \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>  \\<Longrightarrow> \n   \\<forall>y\\<in>(\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). (\\<lambda>x\\<in>(fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})). \n   (THE y. y \\<in> carrier N \\<and> (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))) y =\n    f y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n     C \\<noteq> {};\n     \\<forall>a\\<in>C.\n        \\<forall>b\\<in>C.\n           fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\\<rbrakk>\n    \\<Longrightarrow> \\<forall>y\\<in>\\<Union>\n{a. \\<exists>b. (a, b) \\<in> C}.\n                         (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply (subgoal_tac \"y \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y\n 2. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n       \\<Longrightarrow> y \\<in> fgs R M\n                                  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\\<rbrakk>\n       \\<Longrightarrow> y \\<in> fgs R M\n                                  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\n 2. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> y \\<in> x\\<rbrakk>\n       \\<Longrightarrow> y \\<in> fgs R M\n                                  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\n 2. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply (erule exE, erule conjE, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y x b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> x; (x, b) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> y \\<in> fgs R M\n                                  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\n 2. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply (frule  Un_C_fgs_sub[of N H f C], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y x b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> x; (x, b) \\<in> C;\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n        \\<subseteq> fgs R M\n                     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> y \\<in> fgs R M\n                                  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\n 2. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply (rule_tac c = y in subsetD[of \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C}\"\n                   \"fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y x b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> x; (x, b) \\<in> C;\n        \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n        \\<subseteq> fgs R M\n                     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n 2. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply (simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C};\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))\n                          y =\n                         f y", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> y \\<in> x;\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n       \\<Longrightarrow> (THE ya.\n                             ya \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 y \\<in> fgs R M a \\<and> ya = b y)) =\n                         f y", "apply (frule_tac x = y in fsps_chain_boundTr2[of N H f C], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        \\<exists>x. (\\<exists>b. (x, b) \\<in> C) \\<and> y \\<in> x;\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        (THE ya.\n            ya \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> y \\<in> fgs R M a \\<and> ya = b y))\n        \\<in> carrier N \\<and>\n        (\\<exists>a1 b1.\n            (a1, b1) \\<in> C \\<and>\n            y \\<in> fgs R M a1 \\<and>\n            (THE ya.\n                ya \\<in> carrier N \\<and>\n                (\\<exists>a b.\n                    (a, b) \\<in> C \\<and>\n                    y \\<in> fgs R M a \\<and> ya = b y)) =\n            b1 y)\\<rbrakk>\n       \\<Longrightarrow> (THE ya.\n                             ya \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 y \\<in> fgs R M a \\<and> ya = b y)) =\n                         f y", "apply (erule conjE, (erule exE)+, erule conjE, erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y x a1 b1 b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        (THE ya.\n            ya \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> y \\<in> fgs R M a \\<and> ya = b y))\n        \\<in> carrier N;\n        y \\<in> x; (x, b) \\<in> C; (a1, b1) \\<in> C; y \\<in> fgs R M a1;\n        (THE ya.\n            ya \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> y \\<in> fgs R M a \\<and> ya = b y)) =\n        b1 y\\<rbrakk>\n       \\<Longrightarrow> (THE ya.\n                             ya \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 y \\<in> fgs R M a \\<and> ya = b y)) =\n                         f y", "apply (simp,\n       thin_tac \"(THE ya. ya \\<in> carrier N \\<and>\n            (\\<exists>a b. (a, b) \\<in> C \\<and> y \\<in> fgs R M a \\<and> ya = b y)) = b1 y\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y x a1 b1 b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<subseteq> fsps R M N f H;\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 y \\<in> carrier N; y \\<in> x; (x, b) \\<in> C; (a1, b1) \\<in> C;\n        y \\<in> fgs R M a1\\<rbrakk>\n       \\<Longrightarrow> b1 y = f y", "apply (frule_tac c = \"(x, b)\" in subsetD[of C \"fsps R M N f H\"],\n        assumption+,\n        simp add:fsps_def fsp_def, (erule conjE)+,\n        thin_tac \"\\<forall>z\\<in>x. f z = b z\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y x a1 b1 b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        C \\<subseteq> {(A, g).\n                       g \\<in> mHom R (mdl M (fgs R M A)) N \\<and>\n                       (\\<forall>z\\<in>A. f z = g z) \\<and>\n                       A \\<subseteq> H};\n        C \\<noteq> {};\n        \\<forall>a\\<in>C.\n           \\<forall>b\\<in>C.\n              fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a;\n        y \\<in> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C});\n        b1 y \\<in> carrier N; y \\<in> x; (x, b) \\<in> C; (a1, b1) \\<in> C;\n        y \\<in> fgs R M a1; b \\<in> mHom R (mdl M (fgs R M x)) N;\n        x \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> b1 y = b y", "apply (frule_tac x = y and a = x and b = b and ?a1.0 = a1 and ?b1.0 = b1 in\n        fsps_chain_boundTr2_2[of N H f C], assumption+,\n        simp add:fsps_def fsp_def, assumption+, subst fgs_def,\n        rule_tac c = y and A = x and B = \"linear_span R M (carrier R) x\"\n        in subsetD,\n        rule l_span_cont_H,\n        frule free_generator_sub[of H], rule subset_trans[of _ H \"carrier M\"],\n         assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) od_fm_fun_Chain:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk> \\<Longrightarrow> \n      \\<forall>a\\<in>C. \\<forall>b\\<in>C. fst a \\<subseteq> fst b \\<or> fst b \\<subseteq> fst a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>C.\n                         \\<forall>b\\<in>C.\n                            fst a \\<subseteq> fst b \\<or>\n                            fst b \\<subseteq> fst a", "apply (frule Order_od_fm_fun[of N H f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; Order (od_fm_fun R M N f H)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>C.\n                         \\<forall>b\\<in>C.\n                            fst a \\<subseteq> fst b \\<or>\n                            fst b \\<subseteq> fst a", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; Order (od_fm_fun R M N f H); a \\<in> C;\n        b \\<in> C\\<rbrakk>\n       \\<Longrightarrow> fst a \\<subseteq> fst b \\<or>\n                         fst b \\<subseteq> fst a", "apply (simp add:Algebra2.Chain_def, erule conjE, simp add:Torder_def, erule conjE,\n        simp add:Torder_axioms_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<noteq> {};\n        Order (od_fm_fun R M N f H); a \\<in> C; b \\<in> C;\n        C \\<subseteq> carrier (od_fm_fun R M N f H);\n        Order (Iod (od_fm_fun R M N f H) C);\n        \\<forall>a b.\n           (a, b)\n           \\<in> carrier (Iod (od_fm_fun R M N f H) C) \\<longrightarrow>\n           (\\<forall>aa ba.\n               (aa, ba)\n               \\<in> carrier (Iod (od_fm_fun R M N f H) C) \\<longrightarrow>\n               (a, b) \\<preceq>\\<^bsub>Iod (od_fm_fun R M N f H) C\\<^esub>\n               (aa, ba) \\<or>\n               (aa, ba) \\<preceq>\\<^bsub>Iod (od_fm_fun R M N f H) C\\<^esub>\n               (a, b))\\<rbrakk>\n       \\<Longrightarrow> fst a \\<subseteq> fst b \\<or>\n                         fst b \\<subseteq> fst a", "apply (simp add:Order.Iod_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<noteq> {};\n        Order (od_fm_fun R M N f H); a \\<in> C; b \\<in> C;\n        C \\<subseteq> carrier (od_fm_fun R M N f H);\n        Order (Iod (od_fm_fun R M N f H) C);\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow>\n           (\\<forall>aa ba.\n               (aa, ba) \\<in> C \\<longrightarrow>\n               (a, b) \\<preceq>\\<^bsub>Iod (od_fm_fun R M N f H) C\\<^esub>\n               (aa, ba) \\<or>\n               (aa, ba) \\<preceq>\\<^bsub>Iod (od_fm_fun R M N f H) C\\<^esub>\n               (a, b))\\<rbrakk>\n       \\<Longrightarrow> fst a \\<subseteq> fst b \\<or>\n                         fst b \\<subseteq> fst a", "apply (auto simp add: Iod_def od_fm_fun_def ole_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b aa ba x xa ab bb.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N;\n        Order\n         \\<lparr>carrier = fsps R M N f H,\n            rel =\n              {Y \\<in> fsps R M N f H \\<times> fsps R M N f H.\n               fst (fst Y) \\<subseteq> fst (snd Y)}\\<rparr>;\n        (a, b) \\<in> C; (aa, ba) \\<in> C; C \\<subseteq> fsps R M N f H;\n        Order\n         \\<lparr>carrier = C,\n            rel =\n              {(a, b).\n               a \\<in> fsps R M N f H \\<and>\n               b \\<in> fsps R M N f H \\<and>\n               fst a \\<subseteq> fst b \\<and>\n               a \\<in> C \\<and> b \\<in> C}\\<rparr>;\n        \\<forall>a b.\n           (a, b) \\<in> C \\<longrightarrow>\n           (\\<forall>aa ba.\n               (aa, ba) \\<in> C \\<longrightarrow>\n               (a, b) \\<in> fsps R M N f H \\<and>\n               (aa, ba) \\<in> fsps R M N f H \\<and> a \\<subseteq> aa \\<or>\n               (aa, ba) \\<in> fsps R M N f H \\<and>\n               (a, b) \\<in> fsps R M N f H \\<and> aa \\<subseteq> a);\n        x \\<in> aa; x \\<notin> a; xa \\<in> a; xa \\<notin> aa;\n        (ab, bb) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> False", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) od_fm_fun_inPr0:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {};\n       \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>  \\<Longrightarrow> z \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n    \\<Longrightarrow> z \\<in> fgs R M\n                               (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})", "apply (frule Un_C_fgs_sub[of N H f C], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n    \\<Longrightarrow> C \\<subseteq> fsps R M N f H\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n    \\<Longrightarrow> C \\<noteq> {}\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>C.\n                         \\<forall>b\\<in>C.\n                            fst a \\<subseteq> fst b \\<or>\n                            fst b \\<subseteq> fst a\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n     \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n     \\<subseteq> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n    \\<Longrightarrow> z \\<in> fgs R M\n                               (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})", "apply (simp add:Algebra2.Chain_def od_fm_fun_def, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>C.\n                         \\<forall>b\\<in>C.\n                            fst a \\<subseteq> fst b \\<or>\n                            fst b \\<subseteq> fst a\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n     \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n     \\<subseteq> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n    \\<Longrightarrow> z \\<in> fgs R M\n                               (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})", "apply (simp add:od_fm_fun_Chain)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n     \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n     \\<subseteq> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n    \\<Longrightarrow> z \\<in> fgs R M\n                               (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})", "apply (rule_tac subsetD[of \"\\<Union>{a. \\<exists>b. (a, b) \\<in> C}\" \n                     \"fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C})\" z], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n     \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n     \\<subseteq> fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C})\\<rbrakk>\n    \\<Longrightarrow> z \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}", "apply (simp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) od_fm_fun_indPr1:\" \\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk> \\<Longrightarrow>\n      (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}, \n         \\<lambda>x \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). THE y. y \\<in> carrier N \\<and>\n         (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x)) \\<in> fsps R M N f H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n                       \\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> fsps R M N f H", "apply (simp add:fsps_def fsp_def, rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> mHom R\n                             (mdl M\n                               (fgs R M\n                                 (\\<Union>\n                                   {a. \\<exists>b. (a, b) \\<in> C})))\n                             N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>y.\n                          (\\<exists>b. (y, b) \\<in> C) \\<longrightarrow>\n                          (\\<forall>z\\<in>y.\n                              (z \\<in> fgs R M\n  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z =\n                               (THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> z \\<in> fgs R M a \\<and> y = b z))) \\<and>\n                              (z \\<notin> fgs R M\n     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z = undefined))) \\<and>\n                      \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (rule fsps_chain_bound1[of N H f C], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> C \\<subseteq> fsps R M N f H\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>C.\n                         \\<forall>b\\<in>C.\n                            fst a \\<subseteq> fst b \\<or>\n                            fst b \\<subseteq> fst a\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> C \\<noteq> {}\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>y.\n                          (\\<exists>b. (y, b) \\<in> C) \\<longrightarrow>\n                          (\\<forall>z\\<in>y.\n                              (z \\<in> fgs R M\n  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z =\n                               (THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> z \\<in> fgs R M a \\<and> y = b z))) \\<and>\n                              (z \\<notin> fgs R M\n     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z = undefined))) \\<and>\n                      \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (simp add:od_fm_fun_def Algebra2.Chain_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>C.\n                         \\<forall>b\\<in>C.\n                            fst a \\<subseteq> fst b \\<or>\n                            fst b \\<subseteq> fst a\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> C \\<noteq> {}\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>y.\n                          (\\<exists>b. (y, b) \\<in> C) \\<longrightarrow>\n                          (\\<forall>z\\<in>y.\n                              (z \\<in> fgs R M\n  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z =\n                               (THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> z \\<in> fgs R M a \\<and> y = b z))) \\<and>\n                              (z \\<notin> fgs R M\n     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z = undefined))) \\<and>\n                      \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (simp add:od_fm_fun_Chain, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>y.\n                          (\\<exists>b. (y, b) \\<in> C) \\<longrightarrow>\n                          (\\<forall>z\\<in>y.\n                              (z \\<in> fgs R M\n  (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z =\n                               (THE y.\n                                   y \\<in> carrier N \\<and>\n                                   (\\<exists>a b.\n (a, b) \\<in> C \\<and> z \\<in> fgs R M a \\<and> y = b z))) \\<and>\n                              (z \\<notin> fgs R M\n     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                               f z = undefined))) \\<and>\n                      \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>y.\n                         (\\<exists>b. (y, b) \\<in> C) \\<longrightarrow>\n                         (\\<forall>z\\<in>y.\n                             (z \\<in> fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                              f z =\n                              (THE y.\n                                  y \\<in> carrier N \\<and>\n                                  (\\<exists>a b.\n(a, b) \\<in> C \\<and> z \\<in> fgs R M a \\<and> y = b z))) \\<and>\n                             (z \\<notin> fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                              f z = undefined))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<forall>z\\<in>y.\n                            (z \\<in> fgs R M\n(\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                             f z =\n                             (THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     z \\<in> fgs R M a \\<and>\n                                     y = b z))) \\<and>\n                            (z \\<notin> fgs R M\n   (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                             f z = undefined)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n       \\<Longrightarrow> (z \\<in> fgs R M\n                                   (\\<Union>\n                                     {a.\n\\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                          f z =\n                          (THE y.\n                              y \\<in> carrier N \\<and>\n                              (\\<exists>a b.\n                                  (a, b) \\<in> C \\<and>\n                                  z \\<in> fgs R M a \\<and> y = b z))) \\<and>\n                         (z \\<notin> fgs R M\n(\\<Union> {a. \\<exists>b. (a, b) \\<in> C}) \\<longrightarrow>\n                          f z = undefined)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (simp add:od_fm_fun_inPr0[of N H f C])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n       \\<Longrightarrow> f z =\n                         (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 z \\<in> fgs R M a \\<and> y = b z))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (frule fsps_chain_bound2[of N H f C], assumption+,\n        simp add:Algebra2.Chain_def od_fm_fun_def, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n       \\<Longrightarrow> \\<forall>a\\<in>C.\n                            \\<forall>b\\<in>C.\n                               fst a \\<subseteq> fst b \\<or>\n                               fst b \\<subseteq> fst a\n 2. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n        \\<forall>y\\<in>\\<Union> {a. \\<exists>b. (a, b) \\<in> C}.\n           (\\<lambda>x\\<in>fgs R M\n                            (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n               THE y.\n                  y \\<in> carrier N \\<and>\n                  (\\<exists>a b.\n                      (a, b) \\<in> C \\<and>\n                      x \\<in> fgs R M a \\<and> y = b x))\n            y =\n           f y\\<rbrakk>\n       \\<Longrightarrow> f z =\n                         (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 z \\<in> fgs R M a \\<and> y = b z))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (simp add:od_fm_fun_Chain)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n        \\<forall>y\\<in>\\<Union> {a. \\<exists>b. (a, b) \\<in> C}.\n           (\\<lambda>x\\<in>fgs R M\n                            (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n               THE y.\n                  y \\<in> carrier N \\<and>\n                  (\\<exists>a b.\n                      (a, b) \\<in> C \\<and>\n                      x \\<in> fgs R M a \\<and> y = b x))\n            y =\n           f y\\<rbrakk>\n       \\<Longrightarrow> f z =\n                         (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 z \\<in> fgs R M a \\<and> y = b z))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (drule_tac x = z in bspec)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y\\<rbrakk>\n       \\<Longrightarrow> z \\<in> \\<Union> {a. \\<exists>b. (a, b) \\<in> C}\n 2. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n        (\\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n            THE y.\n               y \\<in> carrier N \\<and>\n               (\\<exists>a b.\n                   (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n         z =\n        f z\\<rbrakk>\n       \\<Longrightarrow> f z =\n                         (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 z \\<in> fgs R M a \\<and> y = b z))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; \\<exists>b. (y, b) \\<in> C; z \\<in> y;\n        (\\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n            THE y.\n               y \\<in> carrier N \\<and>\n               (\\<exists>a b.\n                   (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n         z =\n        f z\\<rbrakk>\n       \\<Longrightarrow> f z =\n                         (THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 z \\<in> fgs R M a \\<and> y = b z))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (simp add:od_fm_fun_inPr0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> {a. \\<exists>b. (a, b) \\<in> C} \\<subseteq> H", "apply (rule subsetI, simp, erule exE, erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; x \\<in> xa; (xa, b) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H", "apply (frule Order_od_fm_fun[of N H f], assumption+,\n        frule Order.Chain_sub[of \"od_fm_fun R M N f H\" C], assumption,\n        thin_tac \"Algebra2.Chain (od_fm_fun R M N f H) C\",\n        thin_tac \"Order (od_fm_fun R M N f H)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<noteq> {}; x \\<in> xa;\n        (xa, b) \\<in> C;\n        C \\<subseteq> carrier (od_fm_fun R M N f H)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H", "apply (simp add:od_fm_fun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; C \\<noteq> {}; x \\<in> xa;\n        (xa, b) \\<in> C; C \\<subseteq> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H", "apply (frule_tac a = xa and b = b in mem_fsps_fst_sub[of N H f], assumption+,\n        simp add:subsetD, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) od_fm_fun_indPr2:\" \\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; Algebra2.Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk> \\<Longrightarrow>\n     ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}, \n         \\<lambda>x \\<in> fgs R M (\\<Union>{a. \\<exists>b. (a, b) \\<in> C}). THE y. y \\<in> carrier N \\<and>\n                          (\\<exists>a b. (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C\n                         (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n                          \\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))", "apply (frule Order_od_fm_fun[of N H f], assumption+,\n       simp add:upper_bound_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; Order (od_fm_fun R M N f H)\\<rbrakk>\n    \\<Longrightarrow> (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n                       \\<lambda>x\\<in>fgs R M\n (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                          THE y.\n                             y \\<in> carrier N \\<and>\n                             (\\<exists>a b.\n                                 (a, b) \\<in> C \\<and>\n                                 x \\<in> fgs R M a \\<and> y = b x))\n                      \\<in> carrier (od_fm_fun R M N f H) \\<and>\n                      (\\<forall>s\\<in>C.\n                          s \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n                          (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n                           \\<lambda>x\\<in>fgs R M\n     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                              THE y.\n                                 y \\<in> carrier N \\<and>\n                                 (\\<exists>a b.\n                                     (a, b) \\<in> C \\<and>\n                                     x \\<in> fgs R M a \\<and> y = b x)))", "apply (simp add:od_fm_fun_def, fold od_fm_fun_def,\n        frule od_fm_fun_indPr1[of N H f C], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n     C \\<noteq> {}; Order (od_fm_fun R M N f H);\n     (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n      \\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n         THE y.\n            y \\<in> carrier N \\<and>\n            (\\<exists>a b.\n                (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n     \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s\\<in>C.\n                         s \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n                         (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n                          \\<lambda>x\\<in>fgs R M\n    (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n                             THE y.\n                                y \\<in> carrier N \\<and>\n                                (\\<exists>a b.\n                                    (a, b) \\<in> C \\<and>\n                                    x \\<in> fgs R M a \\<and> y = b x))", "apply (rule ballI,\n        subst od_fm_fun_def, subst ole_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; Order (od_fm_fun R M N f H);\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n         \\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n            THE y.\n               y \\<in> carrier N \\<and>\n               (\\<exists>a b.\n                   (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n        \\<in> fsps R M N f H;\n        s \\<in> C\\<rbrakk>\n       \\<Longrightarrow> s \\<in> fsps R M N f H \\<and>\n                         fst s\n                         \\<subseteq> \\<Union>\n{a. \\<exists>b. (a, b) \\<in> C}", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; Order (od_fm_fun R M N f H);\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n         \\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n            THE y.\n               y \\<in> carrier N \\<and>\n               (\\<exists>a b.\n                   (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n        \\<in> fsps R M N f H;\n        s \\<in> C\\<rbrakk>\n       \\<Longrightarrow> s \\<in> fsps R M N f H\n 2. \\<And>s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; Order (od_fm_fun R M N f H);\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n         \\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n            THE y.\n               y \\<in> carrier N \\<and>\n               (\\<exists>a b.\n                   (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n        \\<in> fsps R M N f H;\n        s \\<in> C\\<rbrakk>\n       \\<Longrightarrow> fst s\n                         \\<subseteq> \\<Union>\n{a. \\<exists>b. (a, b) \\<in> C}", "apply (frule Order.Chain_sub[of \"od_fm_fun R M N f H\" C], assumption,\n        simp add:od_fm_fun_carrier, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Chain (od_fm_fun R M N f H) C;\n        C \\<noteq> {}; Order (od_fm_fun R M N f H);\n        (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n         \\<lambda>x\\<in>fgs R M (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n            THE y.\n               y \\<in> carrier N \\<and>\n               (\\<exists>a b.\n                   (a, b) \\<in> C \\<and> x \\<in> fgs R M a \\<and> y = b x))\n        \\<in> fsps R M N f H;\n        s \\<in> C\\<rbrakk>\n       \\<Longrightarrow> fst s\n                         \\<subseteq> \\<Union>\n{a. \\<exists>b. (a, b) \\<in> C}", "apply (unfold split_paired_all,\n        rule subsetI, simp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) od_fm_fun_inductive:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> inductive_set (od_fm_fun R M N f H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> inductive_set (od_fm_fun R M N f H)", "apply (frule Order_od_fm_fun[of N H f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H)\\<rbrakk>\n    \\<Longrightarrow> inductive_set (od_fm_fun R M N f H)", "apply (simp add:inductive_set_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>C.\n                         Chain (od_fm_fun R M N f H) C \\<longrightarrow>\n                         (\\<exists>a b.\n                             ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) C\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b)", "apply (case_tac \"C \\<noteq> {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) C; C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b)\n 2. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) C; \\<not> C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b)", "apply (frule_tac C = C in od_fm_fun_indPr2[of N H f], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) C; C \\<noteq> {};\n        ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C\n           (\\<Union> {a. \\<exists>b. (a, b) \\<in> C},\n            \\<lambda>x\\<in>fgs R M\n                            (\\<Union> {a. \\<exists>b. (a, b) \\<in> C}).\n               THE y.\n                  y \\<in> carrier N \\<and>\n                  (\\<exists>a b.\n                      (a, b) \\<in> C \\<and>\n                      x \\<in> fgs R M a \\<and> y = b x))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b)\n 2. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) C; \\<not> C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) C; \\<not> C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> C (a, b)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) {}; C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            ub\\<^bsub>od_fm_fun R M N f H\\<^esub> {} (a, b)", "apply (simp add:upper_bound_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) {}; C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            (a, b) \\<in> carrier (od_fm_fun R M N f H)", "apply (subst od_fm_fun_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        Chain (od_fm_fun R M N f H) {}; C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b. (a, b) \\<in> fsps R M N f H", "apply (frule empty_fsp[of N H f], assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sSum_eq:\"\\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; \n      h \\<in> H - H1\\<rbrakk> \\<Longrightarrow>  (fgs R M H1) \\<minusplus> (fgs R M {h}) = fgs R M (H1 \\<union> {h})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1\\<rbrakk>\n    \\<Longrightarrow> fgs R M H1 \\<minusplus> fgs R M {h} =\n                      fgs R M (H1 \\<union> {h})", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R)\\<rbrakk>\n    \\<Longrightarrow> fgs R M H1 \\<minusplus> fgs R M {h} =\n                      fgs R M (H1 \\<union> {h})", "apply (frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M H1 \\<minusplus> fgs R M {h} =\n                      fgs R M (H1 \\<union> {h})", "apply (frule subset_trans[of H1 H \"carrier M\"], assumption+,\n        frule fgs_sub_carrier[of H1])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M H1 \\<minusplus> fgs R M {h} =\n                      fgs R M (H1 \\<union> {h})", "apply (cut_tac subset_trans[of \"{h}\" \"H - H1\" \"carrier M\"],\n         frule fgs_sub_carrier[of \"{h}\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n     {h} \\<subseteq> carrier M; fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M H1 \\<minusplus> fgs R M {h} =\n                      fgs R M (H1 \\<union> {h})\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (simp add:set_sum[of \"fgs R M H1\" \"fgs R M {h}\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>ha\\<in>fgs R M H1.\n                             \\<exists>k\\<in>fgs R M {h}.\n                                x = ha \\<plusminus> k} =\n                      fgs R M (insert h H1)\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule equalityI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>ha\\<in>fgs R M H1.\n                             \\<exists>k\\<in>fgs R M {h}.\n                                x = ha \\<plusminus> k}\n                      \\<subseteq> fgs R M (insert h H1)\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule subsetI, simp, (erule bexE)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M (insert h H1)\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (case_tac \"H1 = {}\", simp add:empty_fgs)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; h \\<in> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        \\<zero> \\<in> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha = \\<zero>;\n        k \\<in> fgs R M {h}; x = \\<zero> \\<plusminus> k; H1 = {}\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> k \\<in> fgs R M {h}\n 2. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M (insert h H1)\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac c = k in subsetD[of \"fgs R M {h}\" \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; h \\<in> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        \\<zero> \\<in> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha = \\<zero>;\n        k \\<in> fgs R M {h}; x = \\<zero> \\<plusminus> k; H1 = {};\n        k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> k \\<in> fgs R M {h}\n 2. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M (insert h H1)\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (simp add:ag_l_zero)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M (insert h H1)\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (cut_tac fgs_mono[of H H1 \"insert h H1\"],\n         frule_tac c = ha in subsetD[of \"fgs R M H1\" \"fgs R M (insert h H1)\"],\n          assumption+,\n         cut_tac fgs_mono[of H \"{h}\" \"insert h H1\"],\n         frule_tac c = k in subsetD[of \"fgs R M {h}\" \"fgs R M (insert h H1)\"],\n          assumption+)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {};\n        fgs R M H1 \\<subseteq> fgs R M (insert h H1);\n        ha \\<in> fgs R M (insert h H1);\n        fgs R M {h} \\<subseteq> fgs R M (insert h H1);\n        k \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> fgs R M (insert h H1)\n 2. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {};\n        fgs R M H1 \\<subseteq> fgs R M (insert h H1);\n        ha \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> free_generator R M H\n 3. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {};\n        fgs R M H1 \\<subseteq> fgs R M (insert h H1);\n        ha \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> {h} \\<subseteq> insert h H1\n 4. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {};\n        fgs R M H1 \\<subseteq> fgs R M (insert h H1);\n        ha \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> insert h H1 \\<subseteq> H\n 5. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> free_generator R M H\n 6. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> H1 \\<subseteq> insert h H1\n 7. \\<And>x ha k.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> insert h H1 \\<subseteq> H\n 8. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 9. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 10. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n      h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n      H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n     \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (simp add:fgs_def,\n         cut_tac sc_Ring, frule Ring.whole_ideal,\n         rule linear_span_pOp_closed, assumption+,\n         rule subsetI, simp, erule disjE, simp, simp add:subsetD, assumption+,\n         rule subsetI, simp, rule subsetI, simp, erule disjE, simp, \n         simp add:subsetD, assumption+, rule subsetI, simp,\n         rule subsetI, simp, erule disjE, simp, simp add:subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> fgs R M (insert h H1)\n                      \\<subseteq> {x. \\<exists>ha\\<in>fgs R M H1.\n   \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (cut_tac x = x in mem_fgs_l_comb[of \"insert h H1\"],\n        simp,\n        rule subsetI, simp, erule disjE, simp, simp add:subsetD, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> insert h H1.\n              \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n                 x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (case_tac \"f ` {j. j \\<le> n} \\<subseteq> H1\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac s = s and n = n and f = f in \n           l_comb_mem_linear_span[of \"carrier R\" H1], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> H1\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> linear_span R M (carrier R) H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule Pi_I)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x n f s xa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        xa \\<in> {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> f xa \\<in> H1\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> linear_span R M (carrier R) H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" and B = \"insert h H1\" and \n         a = xa in mem_in_image, assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> linear_span R M (carrier R) H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (fold fgs_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> fgs R M H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule fgs_sub_carrier[of H1])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> fgs R M H1;\n        fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac c = \"l_comb R M n s f\" in subsetD[of \"fgs R M H1\" \n             \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> fgs R M H1; fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac t = \"l_comb R M n s f\" in ag_r_zero[THEN sym], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; f ` {j. j \\<le> n} \\<subseteq> H1;\n        l_comb R M n s f \\<in> fgs R M H1; fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M n s f \\<in> carrier M;\n        l_comb R M n s f = l_comb R M n s f \\<plusminus> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M n s f = ha \\<plusminus> k\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (cut_tac fgs_submodule[of \"{h}\"],\n        frule submodule_inc_0[of \"fgs R M {h}\"], blast,\n        rule subsetI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f;\n        \\<not> f ` {j. j \\<le> n} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" and B = \"insert h H1\" in\n          image_sub0)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; \\<not> f ` {j. j \\<le> n} \\<subseteq> H1;\n        f ` {j. j \\<le> n} \\<subseteq> insert h H1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (frule_tac Y = \"f ` {j. j \\<le> n}\" and a = h and X = H1 in sub_inserted1,\n         assumption+, erule conjE,\n         thin_tac \"\\<not> f ` {j. j \\<le> n} \\<subseteq> H1\", \n         thin_tac \"f ` {j. j \\<le> n} \\<subseteq> insert h H1\", erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (cut_tac H = \"insert h H1\" and f = f and n = n and s = s in   \n         unique_expression2)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> insert h H1 \\<subseteq> carrier M\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1\n 3. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 4. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n};\n        \\<exists>m g t.\n           g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1 \\<and>\n           bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 6. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule subsetI, simp, erule disjE, simp, simp add:subsetD)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1\n 2. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\n 3. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n};\n        \\<exists>m g t.\n           g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1 \\<and>\n           bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply assumption+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        x \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; h \\<in> H; h \\<notin> H1; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n};\n        \\<exists>m g t.\n           g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1 \\<and>\n           bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n}) \\<and>\n           t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R \\<and>\n           l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>ha\\<in>fgs R M H1.\n  \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k}\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply ((erule exE)+, (erule conjE)+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M m t g; h \\<in> H; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n};\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1;\n        bij_to g {j. j \\<le> m} (f ` {j. j \\<le> n});\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (simp add:bij_to_def, erule conjE,\n         simp add:surj_to_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; fgs R M {h} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1);\n        f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M m t g; h \\<in> H; h \\<notin> H1;\n        h \\<in> f ` {j. j \\<le> n};\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        l_comb R M n s f = l_comb R M m t g;\n        g ` {j. j \\<le> m} = f ` {j. j \\<le> n};\n        inj_on g {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rotate_tac -2, frule sym, thin_tac \"g ` {j. j \\<le> m} = f ` {j. j \\<le> n}\",\n         simp, thin_tac \"f ` {j. j \\<le> n} = g ` {j. j \\<le> m}\", simp add:image_def,\n         erule exE,\n         thin_tac \"f \\<in> {j. j \\<le> n} \\<rightarrow> insert h H1\",\n         thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n         thin_tac \"l_comb R M n s f = l_comb R M m t g\", erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n f s m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (case_tac \"m = 0\", simp,\n         frule_tac a = H1 in fgs_submodule,\n         frule submodule_inc_0[of \"fgs R M H1\"],\n         cut_tac a = \"insert (g 0) H1\" in fgs_submodule,\n         rule subsetI, simp, erule disjE, simp, simp add:subsetD,\n         frule_tac H = \"fgs R M (insert (g 0) H1)\" in submodule_subset,\n         frule_tac c = \"l_comb R M 0 t g\" and A = \"fgs R M (insert (g 0) H1)\" \n                 and B = \"carrier M\" in subsetD, assumption+,\n         frule_tac t = \"l_comb R M 0 t g\" in ag_l_zero[THEN sym],\n         subgoal_tac \"l_comb R M 0 t g \\<in> fgs R M {g 0}\", blast)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        g 0 \\<in> carrier M; fgs R M {g 0} \\<subseteq> carrier M;\n        l_comb R M 0 t g \\<in> fgs R M (insert (g 0) H1);\n        x = l_comb R M 0 t g; g 0 \\<in> H; g 0 \\<notin> H1;\n        t 0 \\<in> carrier R; xa = 0; h = g 0; m = 0;\n        submodule R M (fgs R M H1); \\<zero> \\<in> fgs R M H1;\n        submodule R M (fgs R M (insert (g 0) H1));\n        fgs R M (insert (g 0) H1) \\<subseteq> carrier M;\n        l_comb R M 0 t g \\<in> carrier M;\n        l_comb R M 0 t g = \\<zero> \\<plusminus> l_comb R M 0 t g\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0 t g \\<in> fgs R M {g 0}\n 2. \\<And>x n f s m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; h \\<in> carrier M;\n        fgs R M {h} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert h H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (subst fgs_def,\n         cut_tac s = t and n = m and f = g in \n                l_comb_mem_linear_span[of \"carrier R\" \"{h}\"], assumption+,\n         rule subsetI, simp, simp, simp, \n         simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "(** case n \\<noteq> 0 **)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (cut_tac f = g and n = \"m - Suc 0\" and s = t and l = xa in\n          unique_expression3[of \"insert h H1\"],\n         rule subsetI, simp, erule disjE, simp, simp add:subsetD)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {k. k \\<le> Suc (m - Suc 0)} \\<rightarrow>\n                                 insert h H1\n 2. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {k. k \\<le> Suc (m - Suc 0)} \\<rightarrow>\n                                 carrier R\n 3. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> xa \\<le> Suc (m - Suc 0)\n 4. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> g xa\n                         \\<notin> g ` ({k. k \\<le> Suc (m - Suc 0)} - {xa})\n 5. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>ga ma ta.\n           ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1 \\<and>\n           inj_on ga {k. k \\<le> ma} \\<and>\n           ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R \\<and>\n           l_comb R M (Suc (m - Suc 0)) t g = l_comb R M ma ta ga \\<and>\n           ta ma = t xa \\<and> ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 6. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 7. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply simp+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m\\<rbrakk>\n       \\<Longrightarrow> g xa \\<notin> g ` ({k. k \\<le> m} - {xa})\n 2. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>ga ma ta.\n           ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1 \\<and>\n           inj_on ga {k. k \\<le> ma} \\<and>\n           ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R \\<and>\n           l_comb R M (Suc (m - Suc 0)) t g = l_comb R M ma ta ga \\<and>\n           ta ma = t xa \\<and> ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule contrapos_pp, simp+, simp add:image_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>x\\<in>{k. k \\<le> m} - {xa}. g xa = g x\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>ga ma ta.\n           ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1 \\<and>\n           inj_on ga {k. k \\<le> ma} \\<and>\n           ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R \\<and>\n           l_comb R M (Suc (m - Suc 0)) t g = l_comb R M ma ta ga \\<and>\n           ta ma = t xa \\<and> ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (erule bexE, simp add:inj_on_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x m g t xa xb.\n       \\<lbrakk>\\<forall>x\\<le>m.\n                   \\<forall>y\\<le>m. g x = g y \\<longrightarrow> x = y;\n        R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        g xb \\<in> carrier M; fgs R M {g xb} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xb) H1);\n        x = l_comb R M m t g; g xb \\<in> H; g xb \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xb) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xb; xb \\<le> m \\<and> xb \\<noteq> xa; g xa = g xb\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>ga ma ta.\n           ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1 \\<and>\n           inj_on ga {k. k \\<le> ma} \\<and>\n           ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R \\<and>\n           l_comb R M (Suc (m - Suc 0)) t g = l_comb R M ma ta ga \\<and>\n           ta ma = t xa \\<and> ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (drule_tac a = xa in forall_spec, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x m g t xa xb.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        g xb \\<in> carrier M; fgs R M {g xb} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xb) H1);\n        x = l_comb R M m t g; g xb \\<in> H; g xb \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xb) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xb; xb \\<le> m \\<and> xb \\<noteq> xa; g xa = g xb;\n        \\<forall>y\\<le>m. g xa = g y \\<longrightarrow> xa = y\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>ga ma ta.\n           ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1 \\<and>\n           inj_on ga {k. k \\<le> ma} \\<and>\n           ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R \\<and>\n           l_comb R M (Suc (m - Suc 0)) t g = l_comb R M ma ta ga \\<and>\n           ta ma = t xa \\<and> ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (drule_tac a = xb in forall_spec,\n                erule conjE, assumption, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x m g t xa.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M m t g; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        \\<exists>ga ma ta.\n           ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1 \\<and>\n           inj_on ga {k. k \\<le> ma} \\<and>\n           ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R \\<and>\n           l_comb R M (Suc (m - Suc 0)) t g = l_comb R M ma ta ga \\<and>\n           ta ma = t xa \\<and> ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M m t g = h \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply ((erule exE)+, (erule conjE)+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x m g t xa ga ma ta.\n       \\<lbrakk>inj_on g {j. j \\<le> m}; R module N; free_generator R M H;\n        H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; g xa \\<in> carrier M;\n        fgs R M {g xa} \\<subseteq> carrier M;\n        l_comb R M ma ta ga \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M ma ta ga; g xa \\<in> H; g xa \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R; xa \\<le> m;\n        h = g xa; 0 < m;\n        ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert (g xa) H1;\n        inj_on ga {k. k \\<le> ma};\n        ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R;\n        l_comb R M m t g = l_comb R M ma ta ga; ta ma = t xa;\n        ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M ma ta ga = h \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (thin_tac \"g \\<in> {j. j \\<le> m} \\<rightarrow> insert (g xa) H1\",\n                thin_tac \"t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\",\n                thin_tac \"l_comb R M m t g = l_comb R M ma ta ga\",\n                thin_tac \"inj_on g {j. j \\<le> m}\",\n                thin_tac \"g xa \\<in> carrier M\",\n                thin_tac \"fgs R M {g xa} \\<subseteq> carrier M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x m g t xa ga ma ta.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M ma ta ga \\<in> fgs R M (insert (g xa) H1);\n        x = l_comb R M ma ta ga; g xa \\<in> H; g xa \\<notin> H1; xa \\<le> m;\n        h = g xa; 0 < m;\n        ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert (g xa) H1;\n        inj_on ga {k. k \\<le> ma};\n        ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R; ta ma = t xa;\n        ga ma = g xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {g xa}.\n                               l_comb R M ma ta ga = h \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rotate_tac 13, frule sym, thin_tac \"h = g xa\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x m g t xa ga ma ta.\n       \\<lbrakk>0 < m; ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1;\n        inj_on ga {k. k \\<le> ma};\n        ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R; ta ma = t xa;\n        ga ma = h; R module N; free_generator R M H; H1 \\<subseteq> H;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M ma ta ga \\<in> fgs R M (insert h H1);\n        x = l_comb R M ma ta ga; h \\<in> H; h \\<notin> H1; xa \\<le> m;\n        g xa = h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M ma ta ga = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (thin_tac \"g xa = h\", thin_tac \"0 < m\", thin_tac \"xa \\<le> m\",\n                thin_tac \"ta ma = t xa\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x ga ma ta.\n       \\<lbrakk>ga \\<in> {k. k \\<le> ma} \\<rightarrow> insert h H1;\n        inj_on ga {k. k \\<le> ma};\n        ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R; ga ma = h;\n        R module N; free_generator R M H; H1 \\<subseteq> H; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M ma ta ga \\<in> fgs R M (insert h H1);\n        x = l_comb R M ma ta ga; h \\<in> H; h \\<notin> H1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M ma ta ga = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rename_tac x g m t)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (case_tac \"m = 0\", simp,\n         frule_tac a = H1 in fgs_submodule,\n         frule submodule_inc_0[of \"fgs R M H1\"],\n         cut_tac a = \"insert h H1\" in fgs_submodule,\n         rule subsetI, simp, erule disjE, simp, simp add:subsetD,\n         frule subset_trans[of H1 H \"carrier M\"], assumption+, \n         simp add:subsetD,\n         frule_tac H = \"fgs R M (insert h H1)\" in submodule_subset,\n         frule_tac c = \"l_comb R M 0 t g\" and A = \"fgs R M (insert h H1)\" \n                 and B = \"carrier M\" in subsetD, assumption+,\n         frule_tac t = \"l_comb R M 0 t g\" in ag_l_zero[THEN sym],\n         subgoal_tac \"l_comb R M 0 t g \\<in> fgs R M {h}\", blast)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x g m t.\n       \\<lbrakk>t 0 \\<in> carrier R; g 0 = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M 0 t g \\<in> fgs R M (insert h H1); x = l_comb R M 0 t g;\n        h \\<in> H; h \\<notin> H1; m = 0; submodule R M (fgs R M H1);\n        \\<zero> \\<in> fgs R M H1; submodule R M (fgs R M (insert h H1));\n        fgs R M (insert h H1) \\<subseteq> carrier M;\n        l_comb R M 0 t g \\<in> carrier M;\n        l_comb R M 0 t g = \\<zero> \\<plusminus> l_comb R M 0 t g\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0 t g \\<in> fgs R M {h}\n 2. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (subst fgs_def,\n         cut_tac s = t and n = 0 and f = g in \n                l_comb_mem_linear_span[of \"carrier R\" \"{h}\"],\n         assumption, rule subsetI, simp, simp add:subsetD,\n         simp, simp, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M m t g = ha \\<plusminus> k\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (subgoal_tac \"l_comb R M m t g = l_comb R M (Suc (m - Suc 0)) t g\",\n         simp del:Suc_pred,\n         frule insert_sub[of H1 H h], assumption+,\n         frule subset_trans[of \"insert h H1\" H \"carrier M\"], assumption+,\n         subst l_comb_Suc[of \"insert h H1\" \"carrier R\"], assumption+,\n         (subst Suc_pred, assumption,\n          thin_tac \"l_comb R M m t g = l_comb R M (Suc (m - Suc 0)) t g\",\n                simp)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>fgs R M H1.\n                            \\<exists>k\\<in>fgs R M {h}.\n                               l_comb R M (m - Suc 0) t g \\<plusminus>\n                               t m \\<cdot>\\<^sub>s h =\n                               ha \\<plusminus> k\n 2. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g = l_comb R M (Suc (m - Suc 0)) t g\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (subgoal_tac \"l_comb R M (m - Suc 0) t g \\<in> fgs R M H1\",\n         subgoal_tac \"t m \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\", blast,\n         subst fgs_def,\n         rule_tac h = h and a = \"t m\" in \n                 sc_linear_span[of \"carrier R\" \"{h}\"], assumption+,\n         rule subsetI, simp, simp add:Pi_def, simp,\n         cut_tac a = \"{h}\" in fgs_submodule, rule subsetI, simp,\n         cut_tac s = t and n = \"m - Suc 0\" and f = g in \n                   l_comb_mem_linear_span[of \"carrier R\" H1], assumption,\n         simp add:subset_trans[of H1 H \"carrier M\"],\n         rule func_pre, simp,\n         rule Pi_I, simp,\n         frule_tac f = g and A = \"{k. k \\<le> m}\" and B = \"insert h H1\"\n                and x = xa in funcset_mem, simp, simp, simp add:inj_on_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x g m t xa.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        \\<forall>x\\<le>m.\n           \\<forall>y\\<le>m. g x = g y \\<longrightarrow> x = y;\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M;\n        submodule R M (fgs R M {h}); xa \\<le> m - Suc 0;\n        g xa = h \\<or> g xa \\<in> H1\\<rbrakk>\n       \\<Longrightarrow> g xa \\<in> H1\n 2. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M;\n        submodule R M (fgs R M {h});\n        l_comb R M (m - Suc 0) t g\n        \\<in> linear_span R M (carrier R) H1\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (m - Suc 0) t g \\<in> fgs R M H1\n 3. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g = l_comb R M (Suc (m - Suc 0)) t g\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (erule disjE)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x g m t xa.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        \\<forall>x\\<le>m.\n           \\<forall>y\\<le>m. g x = g y \\<longrightarrow> x = y;\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M;\n        submodule R M (fgs R M {h}); xa \\<le> m - Suc 0; g xa = h\\<rbrakk>\n       \\<Longrightarrow> g xa \\<in> H1\n 2. \\<And>x g m t xa.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        \\<forall>x\\<le>m.\n           \\<forall>y\\<le>m. g x = g y \\<longrightarrow> x = y;\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M;\n        submodule R M (fgs R M {h}); xa \\<le> m - Suc 0;\n        g xa \\<in> H1\\<rbrakk>\n       \\<Longrightarrow> g xa \\<in> H1\n 3. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M;\n        submodule R M (fgs R M {h});\n        l_comb R M (m - Suc 0) t g\n        \\<in> linear_span R M (carrier R) H1\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (m - Suc 0) t g \\<in> fgs R M H1\n 4. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g = l_comb R M (Suc (m - Suc 0)) t g\n 5. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 6. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (drule_tac a = m in forall_spec, simp,\n         drule_tac a = xa in forall_spec, simp, simp, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; 0 < m; h \\<in> carrier M;\n        submodule R M (fgs R M {h});\n        l_comb R M (m - Suc 0) t g\n        \\<in> linear_span R M (carrier R) H1\\<rbrakk>\n       \\<Longrightarrow> l_comb R M (m - Suc 0) t g \\<in> fgs R M H1\n 2. \\<And>x g m t.\n       \\<lbrakk>g \\<in> {k. k \\<le> m} \\<rightarrow> insert h H1;\n        inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R; g m = h; R module N;\n        free_generator R M H; H1 \\<subseteq> H; Ring R; ideal R (carrier R);\n        H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        l_comb R M m t g \\<in> fgs R M (insert h H1); x = l_comb R M m t g;\n        h \\<in> H; h \\<notin> H1; m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> l_comb R M m t g = l_comb R M (Suc (m - Suc 0)) t g\n 3. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 4. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (cut_tac n1 = xa and m1 = \"xa - Suc 0\" in Suc_le_mono[THEN sym],\n              simp, simp add:fgs_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> H - H1\n 2. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n     H1 \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H - H1 \\<subseteq> carrier M", "apply (rule subsetI, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  monofun :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, \n            ('b, 'r, 'm2) Module_scheme, 'a \\<Rightarrow> 'b, 'a set, 'a] \\<Rightarrow> ('a \\<Rightarrow> 'b)\" where\n  \"monofun R M N f H h = (\\<lambda>x\\<in>fgs R M {h}. \n          (THE y. (\\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>s\\<^bsub>M\\<^esub> h \\<and>  y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f h))))\""], ["", "lemma (in Module) fgs_single_span:\"\\<lbrakk>h \\<in> carrier M; x \\<in> (fgs R M {h})\\<rbrakk> \\<Longrightarrow> \n              \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> carrier M; x \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h", "apply (simp add:fgs_def linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> carrier M;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> {h}.\n           \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> carrier R.\n              x = l_comb R M n s f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>h \\<in> carrier M; f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h", "apply (cut_tac sc_Ring, frule Ring.whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>h \\<in> carrier M; f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; Ring R; ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h", "apply (frule_tac A = \"carrier R\" and z = h and h = f and n = n and t = s in \n        single_span, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s.\n       \\<lbrakk>h \\<in> carrier M; f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = l_comb R M n s f; Ring R; ideal R (carrier R);\n        \\<exists>sa\\<in>{0} \\<rightarrow> carrier R.\n           \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n           sa 0 \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h", "apply (erule bexE, simp add:l_comb_def del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f s sa.\n       \\<lbrakk>h \\<in> carrier M; f \\<in> {j. j \\<le> n} \\<rightarrow> {h};\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        x = sa 0 \\<cdot>\\<^sub>s h; Ring R; ideal R (carrier R);\n        sa \\<in> {0} \\<rightarrow> carrier R;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s f j) n =\n        sa 0 \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            sa 0 \\<cdot>\\<^sub>s h = a \\<cdot>\\<^sub>s h", "apply (frule_tac f = sa and A = \"{0}\" and B = \"carrier R\" and \n                 x = 0 in funcset_mem,  simp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_mHomTr:\"\\<lbrakk>h \\<in> H; free_generator R M H; \n      a \\<in> carrier R; r \\<in> carrier R; a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h\\<rbrakk> \\<Longrightarrow> a = r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R; a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (cut_tac sc_Ring, frule free_generator_sub,\n       frule subsetD[of H \"carrier M\" h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R; a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h; Ring R;\n     H \\<subseteq> carrier M; h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (frule_tac a = a and m = h in sc_mem, assumption+,\n       frule_tac a = r and m = h in sc_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R; a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h; Ring R;\n     H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (frule ag_eq_diffzero[of \"a \\<cdot>\\<^sub>s h\" \"r \\<cdot>\\<^sub>s h\"], assumption+,\n       simp only:sc_minus_am1, thin_tac \"(a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h) = (\\<zero> = \\<zero>)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     a \\<cdot>\\<^sub>s h \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (frule Ring.ring_is_ag[of R],\n       frule aGroup.ag_mOp_closed[of R r], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     a \\<cdot>\\<^sub>s h \\<plusminus>\n     (-\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (simp add:sc_l_distr[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     (a \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s\n     h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (frule free_gen_coeff_zero[of H h \"a \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> r\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     (a \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s\n     h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus>\\<^bsub>R\\<^esub>\n                      -\\<^sub>a\\<^bsub>R\\<^esub> r\n                      \\<in> carrier R\n 2. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     (a \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s\n     h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s\n                      h =\n                      \\<zero>\n 3. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     (a \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s\n     h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R;\n     a \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> r =\n     \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> H; free_generator R M H; a \\<in> carrier R;\n     r \\<in> carrier R;\n     (a \\<plusminus>\\<^bsub>R\\<^esub>\n      -\\<^sub>a\\<^bsub>R\\<^esub> r) \\<cdot>\\<^sub>s\n     h =\n     \\<zero>;\n     Ring R; H \\<subseteq> carrier M; h \\<in> carrier M;\n     a \\<cdot>\\<^sub>s h \\<in> carrier M;\n     r \\<cdot>\\<^sub>s h \\<in> carrier M; aGroup R;\n     -\\<^sub>a\\<^bsub>R\\<^esub> r \\<in> carrier R;\n     a \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> r =\n     \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> a = r", "apply (simp add:aGroup.ag_eq_diffzero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_mhomTr1:\"\\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R\\<rbrakk>  \\<Longrightarrow> \n                monofun R M N f H h (a \\<cdot>\\<^sub>s h) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h (a \\<cdot>\\<^sub>s h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h", "apply (frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h (a \\<cdot>\\<^sub>s h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h", "apply (simp add:monofun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> (a \\<cdot>\\<^sub>s h\n                       \\<in> fgs R M {h} \\<longrightarrow>\n                       (THE y.\n                           \\<exists>r\\<in>carrier R.\n                              a \\<cdot>\\<^sub>s h =\n                              r \\<cdot>\\<^sub>s h \\<and>\n                              y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                       a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) \\<and>\n                      (a \\<cdot>\\<^sub>s h\n                       \\<notin> fgs R M {h} \\<longrightarrow>\n                       undefined = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h)", "apply (cut_tac a = \"{h}\" and x = h in elem_fgs, rule subsetI, \n        simp add:subsetD, simp,\n        cut_tac fgs_submodule[of \"{h}\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h})\\<rbrakk>\n    \\<Longrightarrow> (a \\<cdot>\\<^sub>s h\n                       \\<in> fgs R M {h} \\<longrightarrow>\n                       (THE y.\n                           \\<exists>r\\<in>carrier R.\n                              a \\<cdot>\\<^sub>s h =\n                              r \\<cdot>\\<^sub>s h \\<and>\n                              y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                       a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) \\<and>\n                      (a \\<cdot>\\<^sub>s h\n                       \\<notin> fgs R M {h} \\<longrightarrow>\n                       undefined = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h)\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (frule submodule_sc_closed[of \"fgs R M {h}\" a h], assumption+,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> (THE y.\n                          \\<exists>r\\<in>carrier R.\n                             a \\<cdot>\\<^sub>s h =\n                             r \\<cdot>\\<^sub>s h \\<and>\n                             y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (subgoal_tac \"\\<exists>!y. \\<exists>r\\<in>carrier R. a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and> y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\",\n        subgoal_tac \"\\<exists>r\\<in>carrier R. a \\<cdot>\\<^sub>s h =  r \\<cdot>\\<^sub>s h \\<and>\n         (THE y. \\<exists>s\\<in>carrier R.  a \\<cdot>\\<^sub>s h =  s \\<cdot>\\<^sub>s h \\<and> y =  s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f h)) = \n            r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (f h)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n     \\<exists>r\\<in>carrier R.\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n        (THE y.\n            \\<exists>s\\<in>carrier R.\n               a \\<cdot>\\<^sub>s h = s \\<cdot>\\<^sub>s h \\<and>\n               y = s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n        r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n    \\<Longrightarrow> (THE y.\n                          \\<exists>r\\<in>carrier R.\n                             a \\<cdot>\\<^sub>s h =\n                             r \\<cdot>\\<^sub>s h \\<and>\n                             y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                         (THE y.\n                             \\<exists>s\\<in>carrier R.\n                                a \\<cdot>\\<^sub>s h =\n                                s \\<cdot>\\<^sub>s h \\<and>\n                                y =\n                                s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                         r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 3. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 4. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "prefer 2"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                         (THE y.\n                             \\<exists>s\\<in>carrier R.\n                                a \\<cdot>\\<^sub>s h =\n                                s \\<cdot>\\<^sub>s h \\<and>\n                                y =\n                                s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                         r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n     \\<exists>r\\<in>carrier R.\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n        (THE y.\n            \\<exists>s\\<in>carrier R.\n               a \\<cdot>\\<^sub>s h = s \\<cdot>\\<^sub>s h \\<and>\n               y = s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n        r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n    \\<Longrightarrow> (THE y.\n                          \\<exists>r\\<in>carrier R.\n                             a \\<cdot>\\<^sub>s h =\n                             r \\<cdot>\\<^sub>s h \\<and>\n                             y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 3. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 4. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (rule theI', simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n     \\<exists>r\\<in>carrier R.\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n        (THE y.\n            \\<exists>s\\<in>carrier R.\n               a \\<cdot>\\<^sub>s h = s \\<cdot>\\<^sub>s h \\<and>\n               y = s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n        r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n    \\<Longrightarrow> (THE y.\n                          \\<exists>r\\<in>carrier R.\n                             a \\<cdot>\\<^sub>s h =\n                             r \\<cdot>\\<^sub>s h \\<and>\n                             y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 3. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (thin_tac \"\\<exists>!y. \\<exists>r\\<in>carrier R. a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and> y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n     \\<exists>r\\<in>carrier R.\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n        (THE y.\n            \\<exists>s\\<in>carrier R.\n               a \\<cdot>\\<^sub>s h = s \\<cdot>\\<^sub>s h \\<and>\n               y = s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n        r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n    \\<Longrightarrow> (THE y.\n                          \\<exists>r\\<in>carrier R.\n                             a \\<cdot>\\<^sub>s h =\n                             r \\<cdot>\\<^sub>s h \\<and>\n                             y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 3. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (erule bexE, erule conjE, simp, \n        thin_tac \"(THE y. \\<exists>s\\<in>carrier R. r \\<cdot>\\<^sub>s h = s \\<cdot>\\<^sub>s h \\<and> y = s \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h) = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n        H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n        submodule R M (fgs R M {h}); r \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        r \\<in> carrier R;\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 3. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (frule_tac r = r in monofun_mHomTr[of h H a], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n     submodule R M (fgs R M {h});\n     a \\<cdot>\\<^sub>s h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         \\<exists>r\\<in>carrier R.\n                            a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n                            y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n 2. \\<And>y ya.\n       \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n        H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n        submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           ya = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 3. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y ya.\n       \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n        H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n        submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n        \\<exists>r\\<in>carrier R.\n           a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h \\<and>\n           ya = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply ((erule bexE)+, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y ya r ra.\n       \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n        H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n        submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        r \\<in> carrier R; ra \\<in> carrier R;\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h;\n        y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n        a \\<cdot>\\<^sub>s h = ra \\<cdot>\\<^sub>s h;\n        ya = ra \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (frule_tac r = r in monofun_mHomTr[of h H a], assumption+,\n        frule_tac r = ra in monofun_mHomTr[of h H a], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>y ya r ra.\n       \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n        H \\<subseteq> carrier M; h \\<in> fgs R M {h};\n        submodule R M (fgs R M {h}); a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        r \\<in> carrier R; ra \\<in> carrier R;\n        a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h;\n        y = r \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n        a \\<cdot>\\<^sub>s h = ra \\<cdot>\\<^sub>s h;\n        ya = ra \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h; a = r; a = ra\\<rbrakk>\n       \\<Longrightarrow> y = ya\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (thin_tac \"a \\<cdot>\\<^sub>s h = r \\<cdot>\\<^sub>s h\", thin_tac \"a \\<cdot>\\<^sub>s h = ra \\<cdot>\\<^sub>s h\",\n        rotate_tac -2, frule sym, thin_tac \"a = r\", frule sym, \n        thin_tac \"a = ra\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; a \\<in> carrier R;\n     H \\<subseteq> carrier M; h \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (rule subsetI, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_mem:\"\\<lbrakk>R module N; h \\<in> H; free_generator R M H; \n       x \\<in> fgs R M {h}; f \\<in> H \\<rightarrow> carrier N\\<rbrakk>  \\<Longrightarrow>  \n       monofun R M N f H h x \\<in> carrier N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     x \\<in> fgs R M {h}; f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h x \\<in> carrier N", "apply (frule free_generator_sub,\n       frule subsetD[of H \"carrier M\" h], assumption+,\n       frule fgs_single_span[of h x], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     x \\<in> fgs R M {h}; f \\<in> H \\<rightarrow> carrier N;\n     H \\<subseteq> carrier M; h \\<in> carrier M;\n     \\<exists>a\\<in>carrier R. x = a \\<cdot>\\<^sub>s h\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h x \\<in> carrier N", "apply (erule bexE, simp add:monofun_mhomTr1,\n       frule funcset_mem[of f H \"carrier N\" h], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        f \\<in> H \\<rightarrow> carrier N; H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; x = a \\<cdot>\\<^sub>s h;\n        f h \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h\n                         \\<in> carrier N", "apply (simp add:Module.sc_mem[of N R _ \"f h\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_eq_f:\"\\<lbrakk>R module N; h \\<in> H; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N\\<rbrakk>  \\<Longrightarrow>  monofun R M N f H h h = f h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h h = f h", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Ring R\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h h = f h", "apply (frule_tac N = N and h = h and f = f and a = \"1\\<^sub>r\\<^bsub>R\\<^esub>\" in  monofun_mhomTr1,\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Ring R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\n 2. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Ring R;\n     monofun R M N f H h (1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h) =\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n     f h\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h h = f h", "apply (simp add:Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Ring R;\n     monofun R M N f H h (1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h) =\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n     f h\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h h = f h", "apply (frule free_generator_sub, frule subsetD[of H \"carrier M\" h],\n                           assumption+,\n        frule funcset_mem[of f H \"carrier N\" h], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; h \\<in> H; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Ring R;\n     monofun R M N f H h (1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h) =\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h;\n     H \\<subseteq> carrier M; h \\<in> carrier M;\n     f h \\<in> carrier N\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h h = f h", "apply (simp add:sprod_one, simp add:Module.sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) sSum_unique:\"\\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H; \n       h \\<in> H - H1; x1 \\<in>(fgs R M H1); x2 \\<in> (fgs R M H1); \n       y1 \\<in> (fgs R M {h}); y2 \\<in> (fgs R M {h}); x1 \\<plusminus> y1 = x2 \\<plusminus> y2\\<rbrakk> \\<Longrightarrow>\n       x1 = x2 \\<and> y1 = y2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n     y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n     x1 \\<plusminus> y1 = x2 \\<plusminus> y2\\<rbrakk>\n    \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (cut_tac sc_Ring, frule Ring.whole_ideal [of \"R\"],\n       frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n     y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n     x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule_tac subset_trans[of H1 H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n     y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n     x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule subsetD[of H \"carrier M\" h], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n     y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n     x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule_tac fgs_single_span[of h y1], assumption+,\n        frule_tac fgs_single_span[of h y2], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n     h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n     y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n     x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R; ideal R (carrier R);\n     H \\<subseteq> carrier M; H1 \\<subseteq> carrier M; h \\<in> carrier M;\n     \\<exists>a\\<in>carrier R. y1 = a \\<cdot>\\<^sub>s h;\n     \\<exists>a\\<in>carrier R. y2 = a \\<cdot>\\<^sub>s h\\<rbrakk>\n    \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (erule bexE, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n        x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; h \\<in> carrier M; a \\<in> carrier R;\n        y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule_tac  a = a and m = h in sc_mem, assumption+,\n        frule_tac  a = aa and m = h in sc_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n        x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; h \\<in> carrier M; a \\<in> carrier R;\n        y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule subset_trans[of H1 H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n        x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; h \\<in> carrier M; a \\<in> carrier R;\n        y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M;\n        H1 \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule_tac A = \"carrier R\" and H = H1 in lin_span_sub_carrier, \n                      assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n        x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; h \\<in> carrier M; a \\<in> carrier R;\n        y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        linear_span R M (carrier R) H1 \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (fold fgs_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n        x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; h \\<in> carrier M; a \\<in> carrier R;\n        y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply (frule subsetD[of \"fgs R M H1\" \"carrier M\" x1], assumption+,\n        frule subsetD[of \"fgs R M H1\" \"carrier M\" x2], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H - H1; x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        y1 \\<in> fgs R M {h}; y2 \\<in> fgs R M {h};\n        x1 \\<plusminus> y1 = x2 \\<plusminus> y2; Ring R;\n        ideal R (carrier R); H \\<subseteq> carrier M;\n        H1 \\<subseteq> carrier M; h \\<in> carrier M; a \\<in> carrier R;\n        y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and> y1 = y2", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule ag_mOp_closed[of x2])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule_tac z = \"a \\<cdot>\\<^sub>s h\" in ag_pOp_assoc[of \"-\\<^sub>a x2\" \"x1\"], assumption+,\n        simp only:ag_pOp_assoc[THEN sym], simp add:ag_l_inv1,\n        simp add:ag_l_zero,\n        frule ag_pOp_closed[of \"-\\<^sub>a x2\" x1], assumption+,\n        frule_tac x = \"a \\<cdot>\\<^sub>s h\" in ag_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        aa \\<cdot>\\<^sub>s h;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule_tac y = \"a \\<cdot>\\<^sub>s h\" and z = \"-\\<^sub>a (a \\<cdot>\\<^sub>s h)\" in \n                    ag_pOp_assoc[of \"-\\<^sub>a x2 \\<plusminus> x1\"], assumption+,\n        simp add:ag_r_inv1 ag_r_zero, thin_tac \"-\\<^sub>a x2 \\<plusminus> x1 \\<plusminus> a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule fgs_submodule[of H1])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1)\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule submodule_mOp_closed[of \"fgs R M H1\" x2], assumption,\n        frule submodule_pOp_closed[of \"fgs R M H1\" \"-\\<^sub>a x2\" \"x1\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (case_tac \"H1 = {}\", simp add:empty_fgs)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; h \\<in> H; x1 = \\<zero>;\n        x2 = \\<zero>; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        \\<zero> \\<plusminus> a \\<cdot>\\<^sub>s h =\n        \\<zero> \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; \\<zero> \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        \\<zero>;\n        submodule R M {\\<zero>}; -\\<^sub>a \\<zero> = \\<zero>;\n        \\<zero> \\<plusminus> \\<zero> = \\<zero>; H1 = {}\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 2. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1;\n        H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (simp add:ag_eq_diffzero[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1;\n        H1 \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule mem_fgs_l_comb[of H1 \"-\\<^sub>a x2 \\<plusminus> x1\"], assumption+,\n        erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M n s f\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (case_tac \"-\\<^sub>a\\<^bsub>M\\<^esub> x2 \\<plusminus>\\<^bsub>M\\<^esub> x1 = \\<zero>\\<^bsub>M\\<^esub>\", simp, rotate_tac -2, frule sym,\n        thin_tac \"\\<zero> = l_comb R M n s f\", simp,\n        simp add:ag_pOp_commute[of \"-\\<^sub>a x2\" \" x1\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a aa n f s.\n       \\<lbrakk>x1 \\<plusminus> -\\<^sub>a x2 = \\<zero>; R module N;\n        free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        \\<zero> \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        \\<zero>;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        \\<zero> \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n s f = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 2. \\<And>a aa n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M n s f;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (simp add:ag_eq_diffzero[of x1 x2])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a aa n f s.\n       \\<lbrakk>x1 \\<plusminus> -\\<^sub>a x2 = \\<zero>; R module N;\n        free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        \\<zero> \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        \\<zero>;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        \\<zero> \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        l_comb R M n s f = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 2. \\<And>a aa n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M n s f;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (simp add:ag_eq_diffzero[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        -\\<^sub>a x2 \\<plusminus> x1;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M n s f;\n        -\\<^sub>a x2 \\<plusminus> x1 \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa n f s.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        h \\<in> H \\<and> h \\<notin> H1; x1 \\<in> fgs R M H1;\n        x2 \\<in> fgs R M H1; a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M n s f \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        l_comb R M n s f;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M n s f \\<in> fgs R M H1; H1 \\<noteq> {};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> H1;\n        s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M n s f;\n        l_comb R M n s f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule_tac f = f and n = n and s = s in unique_expression2[of H1],\n        assumption+, (erule exE)+, (erule conjE)+, simp,\n        simp add:bij_to_def, erule conjE,\n        thin_tac \"f \\<in> {j. j \\<le> n} \\<rightarrow> H1\",\n        thin_tac \"s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\",\n        thin_tac \"surj_to g {j. j \\<le> m} (f ` {j. j \\<le> n})\",\n        thin_tac \"l_comb R M n s f = l_comb R M m t g\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        inj_on g {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule_tac f = g and A = \"{j. j \\<le> m}\" and B = H1 and ?B1.0 = H in\n                  extend_fun, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        inj_on g {j. j \\<le> m};\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule_tac f = g and n = m and s = t in unique_expression4[of H],\n        simp, (erule exE)+, (erule conjE)+, erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t ma ga ta.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> H1;\n        t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R;\n        inj_on g {j. j \\<le> m}; g \\<in> {j. j \\<le> m} \\<rightarrow> H;\n        ga \\<in> {k. k \\<le> ma} \\<rightarrow> H; inj_on ga {k. k \\<le> ma};\n        ga ` {k. k \\<le> ma} \\<subseteq> g ` {k. k \\<le> m};\n        ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>ma. ta l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        l_comb R M m t g = l_comb R M ma ta ga\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (frule_tac f = g and A = \"{j. j \\<le> m}\" and B = H1 in image_sub0,\n        frule_tac A = \"ga ` {k. k \\<le> ma}\" and B = \"g ` {j. j \\<le> m}\" and \n        C = H1 in subset_trans, assumption+, simp,\n        thin_tac \"g \\<in> {j. j \\<le> m} \\<rightarrow> H1\",\n        thin_tac \"t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\",\n        thin_tac \"ga ` {k. k \\<le> ma} \\<subseteq> g ` {k. k \\<le> m}\",\n        thin_tac \"l_comb R M m t g = l_comb R M ma ta ga\",\n        thin_tac \"g ` {j. j \\<le> m} \\<subseteq> H1\",\n        thin_tac \"inj_on g {j. j \\<le> m}\",\n        thin_tac \"g \\<in> {j. j \\<le> m} \\<rightarrow> H\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa ma ga ta.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M ma ta ga \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        l_comb R M ma ta ga;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M ma ta ga \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M ma ta ga;\n        l_comb R M ma ta ga \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        ga \\<in> {k. k \\<le> ma} \\<rightarrow> H; inj_on ga {k. k \\<le> ma};\n        ta \\<in> {k. k \\<le> ma} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>ma. ta l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        ga ` {k. k \\<le> ma} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (rename_tac a aa m g t)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>s h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (simp add:sc_minus_am1,\n         cut_tac sc_Ring, frule Ring.ring_is_ag,\n         frule_tac x = a in aGroup.ag_mOp_closed[of R], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        Ring R; ideal R (carrier R); H \\<subseteq> carrier M;\n        h \\<in> carrier M; a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h;\n        aa \\<in> carrier R; y2 = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (simp add:sc_l_distr[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (case_tac \"aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a = \\<zero>\\<^bsub>R\\<^esub>\", simp add:sc_0_m,\n         frule_tac x = aa and y = \"-\\<^sub>a\\<^bsub>R\\<^esub> a\" in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h", "apply (subgoal_tac \"(\\<lambda>x\\<in>{0::nat}. (aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)) \\<in>\n                               {j. j \\<le> (0::nat)} \\<rightarrow> carrier R\",\n         subgoal_tac \"(\\<lambda>x\\<in>{0::nat}. h) \\<in>\n                               {j. j \\<le> (0::nat)} \\<rightarrow> H\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (frule_tac f = \"\\<lambda>x\\<in>{0::nat}. h\" and n = 0 and \n         s = \"\\<lambda>x\\<in>{0::nat}. (aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\" and g = g and m = m and t = t in \n         unique_expression5[of H])"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> inj_on (\\<lambda>x\\<in>{0}. h) {j. j \\<le> 0}\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 4. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> m} \\<rightarrow> H\n 5. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> m}\n 6. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\n 7. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0\n                          (\\<lambda>x\\<in>{0}.\n                              aa \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                          (\\<lambda>x\\<in>{0}. h) =\n                         l_comb R M m t g\n 8. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> 0}.\n                            (\\<lambda>x\\<in>{0}.\n                                aa \\<plusminus>\\<^bsub>R\\<^esub>\n                                -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                             j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 9. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> m}.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 10. \\<And>a aa m g t.\n        \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n         x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n         a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n         aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n         x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n         x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n         ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n         a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n         y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n         aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n         fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n         x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n         l_comb R M m t g \\<in> carrier M;\n         (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n         (aa \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n         h =\n         l_comb R M m t g;\n         submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n         l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n         -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n         l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n         g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n         t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n         \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n         aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n         \\<zero>\\<^bsub>R\\<^esub>;\n         aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n         \\<in> carrier R;\n         (\\<lambda>x\\<in>{0}.\n             aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n         (\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n         (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\n         \\<subseteq> g ` {j. j \\<le> m}\\<rbrakk>\n        \\<Longrightarrow> x1 = x2 \\<and>\n                          a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\nA total of 12 subgoals...", "apply (simp)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> inj_on (\\<lambda>x\\<in>{0}. h) {j. j \\<le> 0}\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> m} \\<rightarrow> H\n 4. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> m}\n 5. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\n 6. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0\n                          (\\<lambda>x\\<in>{0}.\n                              aa \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                          (\\<lambda>x\\<in>{0}. h) =\n                         l_comb R M m t g\n 7. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> 0}.\n                            (\\<lambda>x\\<in>{0}.\n                                aa \\<plusminus>\\<^bsub>R\\<^esub>\n                                -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                             j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 8. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> m}.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 9. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\n        \\<subseteq> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 10. \\<And>a aa m g t.\n        \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n         x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n         a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n         aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n         x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n         x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n         ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n         a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n         y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n         aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n         fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n         x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n         l_comb R M m t g \\<in> carrier M;\n         (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n         (aa \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n         h =\n         l_comb R M m t g;\n         submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n         l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n         -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n         l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n         g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n         t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n         \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n         aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n         \\<zero>\\<^bsub>R\\<^esub>;\n         aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n         \\<in> carrier R;\n         (\\<lambda>x\\<in>{0}.\n             aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n        \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                          \\<in> {j. j \\<le> 0} \\<rightarrow> H\nA total of 11 subgoals...", "apply (simp add:inj_on_def)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> g \\<in> {j. j \\<le> m} \\<rightarrow> H\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> inj_on g {j. j \\<le> m}\n 4. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> t \\<in> {j. j \\<le> m} \\<rightarrow> carrier R\n 5. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0\n                          (\\<lambda>x\\<in>{0}.\n                              aa \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                          (\\<lambda>x\\<in>{0}. h) =\n                         l_comb R M m t g\n 6. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> 0}.\n                            (\\<lambda>x\\<in>{0}.\n                                aa \\<plusminus>\\<^bsub>R\\<^esub>\n                                -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                             j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 7. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> m}.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 8. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\n        \\<subseteq> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 9. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 10. \\<And>a aa m g t.\n        \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n         x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n         a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n         aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n         x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n         x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n         ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n         a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n         y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n         aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n         fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n         x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n         l_comb R M m t g \\<in> carrier M;\n         (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n         (aa \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n         h =\n         l_comb R M m t g;\n         submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n         l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n         -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n         l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n         g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n         t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n         \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n         g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n         aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n         \\<zero>\\<^bsub>R\\<^esub>;\n         aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n         \\<in> carrier R\\<rbrakk>\n        \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                              aa \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                          \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (simp, assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> l_comb R M 0\n                          (\\<lambda>x\\<in>{0}.\n                              aa \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                          (\\<lambda>x\\<in>{0}. h) =\n                         l_comb R M m t g\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>{j. j \\<le> 0}.\n                            (\\<lambda>x\\<in>{0}.\n                                aa \\<plusminus>\\<^bsub>R\\<^esub>\n                                -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                             j \\<noteq>\n                            \\<zero>\\<^bsub>R\\<^esub>\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> m}.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 4. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\n        \\<subseteq> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 5. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 6. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (simp add:l_comb_def[of _ _ 0], rule ballI, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> m}.\n                            t k \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\n        \\<subseteq> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 4. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n        (\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H;\n        (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\n        \\<subseteq> g ` {j. j \\<le> m}\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (frule_tac A = \"(\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0}\" and B = \"g ` {j. j \\<le> m}\" \n         and C = H1 in subset_trans, assumption+,\n         thin_tac \"(\\<lambda>x\\<in>{0}. h) \\<in> {j. j \\<le> 0} \\<rightarrow> H\",\n         thin_tac \"(\\<lambda>x\\<in>{0}. aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\",\n         thin_tac \"(\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0} \\<subseteq> g ` {j. j \\<le> m}\",\n         thin_tac \"g ` {k. k \\<le> m} \\<subseteq> H1\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>; Ring R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}. h) ` {j. j \\<le> 0} \\<subseteq> H1\\<rbrakk>\n       \\<Longrightarrow> x1 = x2 \\<and>\n                         a \\<cdot>\\<^sub>s h = aa \\<cdot>\\<^sub>s h\n 2. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R;\n        (\\<lambda>x\\<in>{0}.\n            aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. h)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> H\n 3. \\<And>a aa m g t.\n       \\<lbrakk>R module N; free_generator R M H; H1 \\<subseteq> H;\n        x1 \\<in> fgs R M H1; x2 \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        x1 \\<plusminus> a \\<cdot>\\<^sub>s h =\n        x2 \\<plusminus> aa \\<cdot>\\<^sub>s h;\n        ideal R (carrier R); H \\<subseteq> carrier M; h \\<in> carrier M;\n        a \\<in> carrier R; y1 = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y2 = aa \\<cdot>\\<^sub>s h; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        aa \\<cdot>\\<^sub>s h \\<in> carrier M; H1 \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M; x1 \\<in> carrier M;\n        x2 \\<in> carrier M; -\\<^sub>a x2 \\<in> carrier M;\n        l_comb R M m t g \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (aa \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s\n        h =\n        l_comb R M m t g;\n        submodule R M (fgs R M H1); -\\<^sub>a x2 \\<in> fgs R M H1;\n        l_comb R M m t g \\<in> fgs R M H1; H1 \\<noteq> {};\n        -\\<^sub>a x2 \\<plusminus> x1 = l_comb R M m t g;\n        l_comb R M m t g \\<noteq> \\<zero>; h \\<in> H; h \\<notin> H1;\n        g \\<in> {k. k \\<le> m} \\<rightarrow> H; inj_on g {k. k \\<le> m};\n        t \\<in> {k. k \\<le> m} \\<rightarrow> carrier R;\n        \\<forall>l\\<le>m. t l \\<noteq> \\<zero>\\<^bsub>R\\<^esub>;\n        g ` {k. k \\<le> m} \\<subseteq> H1; Ring R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        aa \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> a \\<noteq>\n        \\<zero>\\<^bsub>R\\<^esub>;\n        aa \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}.\n                             aa \\<plusminus>\\<^bsub>R\\<^esub>\n                             -\\<^sub>a\\<^bsub>R\\<^esub> a)\n                         \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R", "apply (simp, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) ex_extensionTr:\"\\<lbrakk>R module N; free_generator R M H;  \n       f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H; h \\<notin> H1; \n       g \\<in> mHom R (mdl M (fgs R M H1)) N; \n       x \\<in> fgs R M H1 \\<minusplus> (fgs R M {h})\\<rbrakk> \\<Longrightarrow> \n     \\<exists>k1\\<in> fgs R M H1. \\<exists>k2\\<in>fgs R M {h}. x = k1 \\<plusminus> k2 \\<and> \n (THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}. x = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> \n         (monofun R M N f H h h2)) = g k1  \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h k2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2", "apply (frule free_generator_sub)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2", "apply (frule sSum_eq[THEN sym, of N H H1 h], assumption+, simp,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2", "apply (subgoal_tac \"\\<exists>!y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}. x = h1 \\<plusminus> h2 \\<and> \n                          y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h h2)\",\n       subgoal_tac \"\\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}. x = h1 \\<plusminus> h2 \\<and> \n  (THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}. x =  h1 \\<plusminus> h2 \\<and> \n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h h2)) = g h1 \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h h2)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n     \\<exists>h1\\<in>fgs R M H1.\n        \\<exists>h2\\<in>fgs R M {h}.\n           x = h1 \\<plusminus> h2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     x = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h1\\<in>fgs R M H1.\n                         \\<exists>h2\\<in>fgs R M {h}.\n                            x = h1 \\<plusminus> h2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h h2\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2", "prefer 2"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h1\\<in>fgs R M H1.\n                         \\<exists>h2\\<in>fgs R M {h}.\n                            x = h1 \\<plusminus> h2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n     \\<exists>h1\\<in>fgs R M H1.\n        \\<exists>h2\\<in>fgs R M {h}.\n           x = h1 \\<plusminus> h2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     x = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2", "apply (rule theI')"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!xa.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               xa =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n     \\<exists>h1\\<in>fgs R M H1.\n        \\<exists>h2\\<in>fgs R M {h}.\n           x = h1 \\<plusminus> h2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     x = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>!y.\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n     \\<exists>h1\\<in>fgs R M H1.\n        \\<exists>h2\\<in>fgs R M {h}.\n           x = h1 \\<plusminus> h2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     x = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2", "apply (thin_tac \" \\<exists>!y. \\<exists>h1\\<in>fgs R M H1.\n        \\<exists>h2\\<in>fgs R M {h}. x = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n     \\<exists>h1\\<in>fgs R M H1.\n        \\<exists>h2\\<in>fgs R M {h}.\n           x = h1 \\<plusminus> h2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     x = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h h2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k1\\<in>fgs R M H1.\n                         \\<exists>k2\\<in>fgs R M {h}.\n                            x = k1 \\<plusminus> k2 \\<and>\n                            (THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                            g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                            monofun R M N f H h k2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2\n 2. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (thin_tac \"fgs R M (insert h H1) = fgs R M H1 \\<minusplus> (fgs R M {h})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2\n 2. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (cut_tac fgs_sub_carrier[of H1], cut_tac fgs_sub_carrier[of \"{h}\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 4. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (simp add:set_sum)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<exists>ha\\<in>fgs R M H1.\n        \\<exists>k\\<in>fgs R M {h}. x = ha \\<plusminus> k;\n     H \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n     fgs R M {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         \\<exists>h1\\<in>fgs R M H1.\n                            \\<exists>h2\\<in>fgs R M {h}.\n                               x = h1 \\<plusminus> h2 \\<and>\n                               y =\n                               g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                               monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 4. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (erule bexE)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>ha k.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        H \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            \\<exists>h1\\<in>fgs R M H1.\n                               \\<exists>h2\\<in>fgs R M {h}.\n                                  x = h1 \\<plusminus> h2 \\<and>\n                                  y =\n                                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                  monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 4. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule subsetD[of H \"carrier M\" h], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>ha k.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        H \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k;\n        h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            \\<exists>h1\\<in>fgs R M H1.\n                               \\<exists>h2\\<in>fgs R M {h}.\n                                  x = h1 \\<plusminus> h2 \\<and>\n                                  y =\n                                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                  monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 4. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (frule_tac x = k in monofun_mem[of N h H _ f], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>ha k.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        H \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        fgs R M {h} \\<subseteq> carrier M; ha \\<in> fgs R M H1;\n        k \\<in> fgs R M {h}; x = ha \\<plusminus> k; h \\<in> carrier M;\n        monofun R M N f H h k \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            \\<exists>h1\\<in>fgs R M H1.\n                               \\<exists>h2\\<in>fgs R M {h}.\n                                  x = h1 \\<plusminus> h2 \\<and>\n                                  y =\n                                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                  monofun R M N f H h h2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 4. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h}; H \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n     h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n     H \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 3. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply (rule subsetI, simp, simp add:subsetD,\n        rule subset_trans[of H1 H \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y ya.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        \\<exists>h1\\<in>fgs R M H1.\n           \\<exists>h2\\<in>fgs R M {h}.\n              x = h1 \\<plusminus> h2 \\<and>\n              ya =\n              g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h h2\\<rbrakk>\n       \\<Longrightarrow> y = ya", "apply ((erule bexE)+, (erule conjE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y ya h1 h1a h2 h2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        h1 \\<plusminus> h2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        h1 \\<in> fgs R M H1; h1a \\<in> fgs R M H1; h2 \\<in> fgs R M {h};\n        h2a \\<in> fgs R M {h}; h1a \\<plusminus> h2a = h1 \\<plusminus> h2;\n        y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        x = h1 \\<plusminus> h2;\n        ya =\n        g h1a \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2a\\<rbrakk>\n       \\<Longrightarrow> g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h h2 =\n                         g h1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h h2a", "apply (frule_tac ?x1.0 = h1a and ?x2.0 = h1 and ?y1.0 = h2a and ?y2.0 = h2 \n        in sSum_unique[of N H H1 h], assumption+, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y ya h1 h1a h2 h2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        h1 \\<plusminus> h2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        H \\<subseteq> carrier M;\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        h1 \\<in> fgs R M H1; h1a \\<in> fgs R M H1; h2 \\<in> fgs R M {h};\n        h2a \\<in> fgs R M {h}; h1a \\<plusminus> h2a = h1 \\<plusminus> h2;\n        y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2;\n        x = h1 \\<plusminus> h2;\n        ya = g h1a \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2a;\n        h1a = h1 \\<and> h2a = h2\\<rbrakk>\n       \\<Longrightarrow> g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h h2 =\n                         g h1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h h2a", "apply ((erule conjE)+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_add:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; h \\<in> H; x \\<in> fgs R M {h}; y \\<in> fgs R M {h}\\<rbrakk> \\<Longrightarrow> \n       monofun R M N f H h (x \\<plusminus> y) = \n                   monofun R M N f H h x \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H; x \\<in> fgs R M {h};\n     y \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h (x \\<plusminus> y) =\n                      monofun R M N f H h x \\<plusminus>\\<^bsub>N\\<^esub>\n                      monofun R M N f H h y", "apply (frule free_generator_sub,\n       cut_tac sc_Ring, frule Ring.ring_is_ag,\n       frule subsetD[of H \"carrier M\" h], assumption+,\n       frule fgs_single_span[of h x], assumption+,\n       frule fgs_single_span[of h y], assumption+, (erule bexE)+, simp,\n       simp add:sc_l_distr[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h}; H \\<subseteq> carrier M;\n        Ring R; aGroup R; h \\<in> carrier M; a \\<in> carrier R;\n        x = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y = aa \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> monofun R M N f H h\n                          ((a \\<plusminus>\\<^bsub>R\\<^esub>\n                            aa) \\<cdot>\\<^sub>s\n                           h) =\n                         monofun R M N f H h\n                          (a \\<cdot>\\<^sub>s\n                           h) \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (aa \\<cdot>\\<^sub>s h)", "apply (frule_tac x = a and y = aa in aGroup.ag_pOp_closed[of R], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h}; H \\<subseteq> carrier M;\n        Ring R; aGroup R; h \\<in> carrier M; a \\<in> carrier R;\n        x = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y = aa \\<cdot>\\<^sub>s h;\n        a \\<plusminus>\\<^bsub>R\\<^esub> aa \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> monofun R M N f H h\n                          ((a \\<plusminus>\\<^bsub>R\\<^esub>\n                            aa) \\<cdot>\\<^sub>s\n                           h) =\n                         monofun R M N f H h\n                          (a \\<cdot>\\<^sub>s\n                           h) \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (aa \\<cdot>\\<^sub>s h)", "apply (simp add:monofun_mhomTr1,\n       frule funcset_mem[of f H \"carrier N\" h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n        a \\<cdot>\\<^sub>s h \\<in> fgs R M {h};\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h}; H \\<subseteq> carrier M;\n        Ring R; aGroup R; h \\<in> carrier M; a \\<in> carrier R;\n        x = a \\<cdot>\\<^sub>s h; aa \\<in> carrier R;\n        y = aa \\<cdot>\\<^sub>s h;\n        a \\<plusminus>\\<^bsub>R\\<^esub> aa \\<in> carrier R;\n        f h \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>R\\<^esub>\n                          aa) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f h =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f h \\<plusminus>\\<^bsub>N\\<^esub>\n                         aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h", "apply (simp add:Module.sc_l_distr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_sprod:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; h \\<in> H; x \\<in> fgs R M {h}; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n      monofun R M N f H h ( a \\<cdot>\\<^sub>s x) = a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> (monofun R M N f H h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H; x \\<in> fgs R M {h};\n     a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h (a \\<cdot>\\<^sub>s x) =\n                      a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                      monofun R M N f H h x", "apply (frule free_generator_sub,\n       cut_tac sc_Ring,\n       frule subsetD[of H \"carrier M\" h], assumption+,\n       frule fgs_single_span[of h x], assumption+,\n       erule bexE, simp add:sc_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h}; a \\<in> carrier R;\n        H \\<subseteq> carrier M; Ring R; h \\<in> carrier M;\n        aa \\<in> carrier R; x = aa \\<cdot>\\<^sub>s h\\<rbrakk>\n       \\<Longrightarrow> monofun R M N f H h\n                          ((a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            aa) \\<cdot>\\<^sub>s\n                           h) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (aa \\<cdot>\\<^sub>s h)", "apply (frule_tac x = a and y = aa in Ring.ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h}; a \\<in> carrier R;\n        H \\<subseteq> carrier M; Ring R; h \\<in> carrier M;\n        aa \\<in> carrier R; x = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> aa \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> monofun R M N f H h\n                          ((a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            aa) \\<cdot>\\<^sub>s\n                           h) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (aa \\<cdot>\\<^sub>s h)", "apply (simp add:monofun_mhomTr1,\n       frule funcset_mem[of f H \"carrier N\" h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n        aa \\<cdot>\\<^sub>s h \\<in> fgs R M {h}; a \\<in> carrier R;\n        H \\<subseteq> carrier M; Ring R; h \\<in> carrier M;\n        aa \\<in> carrier R; x = aa \\<cdot>\\<^sub>s h;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> aa \\<in> carrier R;\n        f h \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                          aa) \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         f h =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (aa \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> f h)", "apply (simp add:Module.sc_assoc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) monofun_0:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N; h \\<in> H\\<rbrakk> \\<Longrightarrow>  monofun R M N f H h  \\<zero>  = \\<zero>\\<^bsub>N\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h \\<zero> = \\<zero>\\<^bsub>N\\<^esub>", "apply (cut_tac fgs_submodule[of \"{h}\"],\n       frule submodule_inc_0[of \"fgs R M {h}\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n     submodule R M (fgs R M {h}); \\<zero> \\<in> fgs R M {h}\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (cut_tac sc_Ring, frule Ring.ring_zero,\n       frule monofun_sprod[of N H f h \\<zero> \"\\<zero>\\<^bsub>R\\<^esub>\"], assumption+,\n       cut_tac ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H;\n     submodule R M (fgs R M {h}); \\<zero> \\<in> fgs R M {h}; Ring R;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R;\n     monofun R M N f H h\n      (\\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s \\<zero>) =\n     \\<zero>\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n     monofun R M N f H h \\<zero>;\n     \\<zero> \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> monofun R M N f H h \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (simp add:sc_0_m,\n       frule monofun_mem[of N h H \\<zero> f], assumption+,\n       simp add:Module.sc_0_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> {h} \\<subseteq> carrier M", "apply (frule free_generator_sub, rule subsetI, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) ex_extension:\"\\<lbrakk>R module N; free_generator R M H; \n       f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H - H1; (H1, g) \\<in> fsps R M N f H\\<rbrakk> \\<Longrightarrow>\n       \\<exists>k. ((H1 \\<union> {h}), k) \\<in> fsps R M N f H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H; h \\<in> H - H1;\n     (H1, g) \\<in> fsps R M N f H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. (H1 \\<union> {h}, k) \\<in> fsps R M N f H", "apply (frule free_generator_sub,\n       cut_tac sc_Ring,\n       frule subset_trans[of H1 H \"carrier M\"], assumption+,\n       frule subsetD[of H \"carrier M\" h], simp+,\n       frule singleton_sub[of h \"carrier M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; (H1, g) \\<in> fsps R M N f H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; {h} \\<subseteq> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. (insert h H1, k) \\<in> fsps R M N f H", "apply (frule fgs_submodule[of \"{h}\"],\n       frule fgs_submodule[of H1],\n       frule submodule_subset[of \"fgs R M {h}\"],\n       frule submodule_subset[of \"fgs R M H1\"],\n       frule insert_sub[of H1 \"carrier M\" h], assumption,\n       frule fgs_submodule[of \"insert h H1\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1; (H1, g) \\<in> fsps R M N f H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; {h} \\<subseteq> carrier M;\n     submodule R M (fgs R M {h}); submodule R M (fgs R M H1);\n     fgs R M {h} \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n     insert h H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. (insert h H1, k) \\<in> fsps R M N f H", "apply (simp add:fsps_def fsp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     h \\<in> H \\<and> h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N \\<and>\n     (\\<forall>z\\<in>H1. f z = g z);\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k.\n                         k \\<in> mHom R (mdl M (fgs R M (insert h H1)))\n                                  N \\<and>\n                         f h = k h \\<and> (\\<forall>z\\<in>H1. g z = k z)", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k.\n                         k \\<in> mHom R (mdl M (fgs R M (insert h H1)))\n                                  N \\<and>\n                         f h = k h \\<and> (\\<forall>z\\<in>H1. g z = k z)", "apply (subgoal_tac \"(\\<lambda>x \\<in> (fgs R M (H1 \\<union> {h})). \n        (THE y. (\\<exists>h1\\<in>(fgs R M H1). \\<exists>h2\\<in>(fgs R M {h}). x = h1 \\<plusminus> h2 \\<and> \n                 y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h h2)))) \\<in> \n        mHom R (mdl M (fgs R M (insert h H1))) N \\<and> \n  f h = (\\<lambda>x \\<in> (fgs R M (H1 \\<union> {h})). \n        (THE y. (\\<exists>h1\\<in>(fgs R M H1). \\<exists>h2\\<in>(fgs R M {h}). x = h1 \\<plusminus> h2 \\<and> \n            y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h h2)))) h \\<and> \n        (\\<forall>z\\<in>H1. g z = (\\<lambda>x \\<in> (fgs R M (H1 \\<union> {h})). \n        (THE y. (\\<exists>h1\\<in>(fgs R M H1). \\<exists>h2\\<in>(fgs R M {h}). x = h1 \\<plusminus> h2 \\<and> \n                  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> (monofun R M N f H h h2)))) z)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n     (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n         THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {h}.\n                  x = h1 \\<plusminus> h2 \\<and>\n                  y =\n                  g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n     \\<in> mHom R (mdl M (fgs R M (insert h H1))) N \\<and>\n     f h =\n     (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n         THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {h}.\n                  x = h1 \\<plusminus> h2 \\<and>\n                  y =\n                  g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n      h \\<and>\n     (\\<forall>z\\<in>H1.\n         g z =\n         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n             THE y.\n                \\<exists>h1\\<in>fgs R M H1.\n                   \\<exists>h2\\<in>fgs R M {h}.\n                      x = h1 \\<plusminus> h2 \\<and>\n                      y =\n                      g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                      monofun R M N f H h h2)\n          z)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k.\n                         k \\<in> mHom R (mdl M (fgs R M (insert h H1)))\n                                  N \\<and>\n                         f h = k h \\<and> (\\<forall>z\\<in>H1. g z = k z)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> mHom R (mdl M (fgs R M (insert h H1))) N \\<and>\n                      f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> mHom R (mdl M (fgs R M (insert h H1))) N \\<and>\n                      f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> mHom R (mdl M (fgs R M (insert h H1))) N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule Module.mHom_test)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> R module mdl M (fgs R M (insert h H1))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> R module N\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> carrier\n                             (mdl M (fgs R M (insert h H1))) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule mdl_is_module, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> carrier\n                             (mdl M (fgs R M (insert h H1))) \\<rightarrow>\n                            carrier N \\<and>\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule conjI,\n        rule Pi_I, simp add:mdl_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        x \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                         \\<in> carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule sSum_eq[THEN sym, of N H H1 h], assumption+, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                         \\<in> carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and x = x and N = N\n        in ex_extensionTr, assumption+,\n        (erule bexE)+, erule conjE, rotate_tac -1,\n         frule sym,\n        thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}.\n                  x = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                  g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h}; x = k1 \\<plusminus> k2;\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2 =\n        (THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {h}.\n                  x = h1 \\<plusminus> h2 \\<and>\n                  y =\n                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                  monofun R M N f H h h2)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                         \\<in> carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule mdl_is_module[of \"fgs R M H1\"],\n        frule_tac f = g and m = k1 in Module.mHom_mem[of \"mdl M (fgs R M H1)\" \n                   R N], assumption+, simp add:mdl_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h}; x = k1 \\<plusminus> k2;\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2 =\n        (THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {h}.\n                  x = h1 \\<plusminus> h2 \\<and>\n                  y =\n                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                  monofun R M N f H h h2);\n        R module mdl M (fgs R M H1); g k1 \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                         \\<in> carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac x = k2 in monofun_mem[of N h H _ f], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        x \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h}; x = k1 \\<plusminus> k2;\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2 =\n        (THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {h}.\n                  x = h1 \\<plusminus> h2 \\<and>\n                  y =\n                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                  monofun R M N f H h h2);\n        R module mdl M (fgs R M H1); g k1 \\<in> carrier N;\n        monofun R M N f H h k2 \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                         \\<in> carrier N\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule Module.module_is_ag[of N],\n        frule_tac x = \"g k1\" and y = \"monofun R M N f H h k2 \" in \n        aGroup.ag_pOp_closed[of N], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                      \\<in> extensional\n                             (carrier\n                               (mdl M (fgs R M (insert h H1)))) \\<and>\n                      (\\<forall>m\\<in>carrier\n (mdl M (fgs R M (insert h H1))).\n                          \\<forall>n\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               n) =\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m \\<plusminus>\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (mdl M (fgs R M (insert h H1))).\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                                 THE y.\n                                    \\<exists>h1\\<in>fgs R M H1.\n \\<exists>h2\\<in>fgs R M {h}.\n    x = h1 \\<plusminus> h2 \\<and>\n    y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                              m)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:mdl_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>m\\<in>fgs R M (insert h H1).\n                          \\<forall>n\\<in>fgs R M (insert h H1).\n                             (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                              n\n                              \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> n =\n  h1 \\<plusminus> h2 \\<and>\n  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  m = h1 \\<plusminus> h2 \\<and>\n  y =\n  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n  monofun R M N f H h h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  n = h1 \\<plusminus> h2 \\<and>\n  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                             (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                              n\n                              \\<notin> fgs R M\n  (insert h H1) \\<longrightarrow>\n                              undefined =\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  m = h1 \\<plusminus> h2 \\<and>\n  y =\n  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n  monofun R M N f H h h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  n = h1 \\<plusminus> h2 \\<and>\n  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>fgs R M (insert h H1).\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                              m\n                              \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n  h1 \\<plusminus> h2 \\<and>\n  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                              a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  m = h1 \\<plusminus> h2 \\<and>\n  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                             (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                              m\n                              \\<notin> fgs R M\n  (insert h H1) \\<longrightarrow>\n                              undefined =\n                              a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                              (THE y.\n                                  \\<exists>h1\\<in>fgs R M H1.\n                                     \\<exists>h2\\<in>fgs R M {h}.\n  m = h1 \\<plusminus> h2 \\<and>\n  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule conjI, (rule ballI)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        m \\<in> fgs R M (insert h H1);\n        n \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                          n\n                          \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                    n =\n                                    h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2) =\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h\n                                     h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    n = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2)) \\<and>\n                         (m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                          n\n                          \\<notin> fgs R M (insert h H1) \\<longrightarrow>\n                          undefined =\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h\n                                     h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    n = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule mdl_is_module[of \"fgs R M (insert h H1)\"],\n        frule Module.module_is_ag[of \"mdl M (fgs R M (insert h H1))\"],\n        frule_tac x = m and y = n in aGroup.ag_pOp_closed[of\n         \"mdl M (fgs R M (insert h H1))\"],\n        (simp add:mdl_carrier)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        m \\<in> fgs R M (insert h H1); n \\<in> fgs R M (insert h H1);\n        R module mdl M (fgs R M (insert h H1));\n        aGroup (mdl M (fgs R M (insert h H1)));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> n\n        \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m \\<plusminus>\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                   n =\n                                   h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2) =\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h\n                                    h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   n = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule sSum_eq[THEN sym, of N H H1 h], assumption+, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        m \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        n \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub>\n        n\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m \\<plusminus>\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub>\n                                   n =\n                                   h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2) =\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h\n                                    h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   n = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n       x = \"m \\<plusminus>\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub> n\" in ex_extensionTr, assumption+,\n       (erule bexE)+, (erule conjE)+, simp,\n       thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}.\n                  k1 \\<plusminus> k2 = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        m \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        n \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        m \\<plusminus>\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub>\n        n =\n        k1 \\<plusminus> k2\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h\n                                    h2) \\<plusminus>\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   n = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n       x = m in ex_extensionTr, assumption+, (erule bexE)+, (erule conjE)+, \n       simp,\n       thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}.\n                  k1a \\<plusminus> k2a = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n        g k1a \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2a\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        n \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus>\n        k2a \\<plusminus>\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub>\n        n =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   n = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n       x = n in ex_extensionTr, assumption+, (erule bexE)+, (erule conjE)+, \n       simp,\n       thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1.  \\<exists>h2\\<in>fgs R M {h}.\n                  k1b \\<plusminus> k2b = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n        g k1b \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2b\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus>\n        k2a \\<plusminus>\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub>\n        (k1b \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:mdl_def[of M \"fgs R M H1 \\<minusplus> fgs R M {h}\"],\n         fold mdl_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus> k2a \\<plusminus> (k1b \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac c = k1a in subsetD[of \"fgs R M H1\" \"carrier M\"], \n         assumption+,\n         frule_tac c = k1b in subsetD[of \"fgs R M H1\" \"carrier M\"], \n         assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus> k2a \\<plusminus> (k1b \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (\n         frule_tac c = k2a in subsetD[of \"fgs R M {h}\" \"carrier M\"], \n         assumption+,\n         frule_tac c = k2b in subsetD[of \"fgs R M {h}\" \"carrier M\"], \n         assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus> k2a \\<plusminus> (k1b \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:pOp_assocTr41[THEN sym], simp add:pOp_assocTr42,\n        frule_tac x = k2a and y = k1b in ag_pOp_commute, assumption+, simp,\n        thin_tac \"k2a \\<plusminus> k1b = k1b \\<plusminus> k2a\", simp add:pOp_assocTr42[THEN sym],\n        simp add:pOp_assocTr41)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply(frule_tac h = k1a and k = k1b in submodule_pOp_closed[of \"fgs R M H1\"],\n        assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M; k1a \\<plusminus> k1b \\<in> fgs R M H1\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply(frule_tac h = k2a and k = k2b in \n          submodule_pOp_closed[of \"fgs R M {h}\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b) =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M; k1a \\<plusminus> k1b \\<in> fgs R M H1;\n        k2a \\<plusminus> k2b \\<in> fgs R M {h}\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac ?x1.0 = \"k1a \\<plusminus> k1b\" and ?x2.0 = k1 and ?y1.0 = \"k2a \\<plusminus> k2b\" \n         and ?y2.0 = k2 in sSum_unique[of N H H1 h], assumption+, simp,\n         assumption+, erule conjE, rotate_tac -2, frule sym,\n         thin_tac \"k1a \\<plusminus> k1b = k1\", frule sym, thin_tac \"k2a \\<plusminus> k2b = k2\",\n         thin_tac \"k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b) = k1 \\<plusminus> k2\", simp,\n         frule mdl_is_module[of \"fgs R M H1\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b)\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M; k1a \\<plusminus> k1b \\<in> fgs R M H1;\n        k2a \\<plusminus> k2b \\<in> fgs R M {h}; k1 = k1a \\<plusminus> k1b;\n        k2 = k2a \\<plusminus> k2b; R module mdl M (fgs R M H1)\\<rbrakk>\n       \\<Longrightarrow> g (k1a \\<plusminus>\n                            k1b) \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (k2a \\<plusminus> k2b) =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac m = k1a and n = k1b in Module.mHom_add[of \n                           \"mdl M (fgs R M H1)\" R N g], assumption+,\n         simp add:mdl_carrier, simp add:mdl_carrier, \n         simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b)\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M; k1a \\<plusminus> k1b \\<in> fgs R M H1;\n        k2a \\<plusminus> k2b \\<in> fgs R M {h}; k1 = k1a \\<plusminus> k1b;\n        k2 = k2a \\<plusminus> k2b; R module mdl M (fgs R M H1);\n        g (k1a \\<plusminus> k1b) =\n        g k1a \\<plusminus>\\<^bsub>N\\<^esub> g k1b\\<rbrakk>\n       \\<Longrightarrow> g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (k2a \\<plusminus> k2b) =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add: monofun_add)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b)\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M; k1a \\<plusminus> k1b \\<in> fgs R M H1;\n        k2a \\<plusminus> k2b \\<in> fgs R M {h}; k1 = k1a \\<plusminus> k1b;\n        k2 = k2a \\<plusminus> k2b; R module mdl M (fgs R M H1);\n        g (k1a \\<plusminus> k1b) =\n        g k1a \\<plusminus>\\<^bsub>N\\<^esub> g k1b\\<rbrakk>\n       \\<Longrightarrow> g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                         (monofun R M N f H h\n                           k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b) =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac m = k1a in Module.mHom_mem[of \"mdl M (fgs R M H1)\" R N g],\n         assumption+, simp add:mdl_carrier,\n         frule_tac m = k1b in Module.mHom_mem[of \"mdl M (fgs R M H1)\" R N g],\n         assumption+, simp add:mdl_carrier,\n         frule_tac x = k2a in monofun_mem[of N h H _ f], assumption+,\n         frule_tac x = k2b in monofun_mem[of N h H _ f], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m n k1 k2 k1a k2a k1b k2b.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        k1b \\<plusminus> k2b \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        aGroup (mdl M (fgs R M H1 \\<minusplus> fgs R M {h}));\n        k1a \\<plusminus> k1b \\<plusminus> (k2a \\<plusminus> k2b)\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1b \\<in> fgs R M H1;\n        k2b \\<in> fgs R M {h}; n = k1b \\<plusminus> k2b;\n        k1a \\<in> carrier M; k1b \\<in> carrier M; k2a \\<in> carrier M;\n        k2b \\<in> carrier M; k1a \\<plusminus> k1b \\<in> fgs R M H1;\n        k2a \\<plusminus> k2b \\<in> fgs R M {h}; k1 = k1a \\<plusminus> k1b;\n        k2 = k2a \\<plusminus> k2b; R module mdl M (fgs R M H1);\n        g (k1a \\<plusminus> k1b) =\n        g k1a \\<plusminus>\\<^bsub>N\\<^esub> g k1b;\n        g k1a \\<in> carrier N; g k1b \\<in> carrier N;\n        monofun R M N f H h k2a \\<in> carrier N;\n        monofun R M N f H h k2b \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                         (monofun R M N f H h\n                           k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b) =\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h\n                          k2a \\<plusminus>\\<^bsub>N\\<^esub>\n                         (g k1b \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2b)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule Module.module_is_ag[of N],\n         simp add:aGroup.pOp_assocTr41[of N, THEN sym], \n         simp add:aGroup.pOp_assocTr42[of N],\n         simp add:aGroup.ag_pOp_commute[of N])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>fgs R M (insert h H1).\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m =\n h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)) \\<and>\n                            (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                             m\n                             \\<notin> fgs R M\n (insert h H1) \\<longrightarrow>\n                             undefined =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                             (THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n m = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        a \\<in> carrier R; m \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                          m\n                          \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                    m =\n                                    h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2) =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2)) \\<and>\n                         (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                          m\n                          \\<notin> fgs R M (insert h H1) \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule mdl_is_module[of \"fgs R M (insert h H1)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        a \\<in> carrier R; m \\<in> fgs R M (insert h H1);\n        R module mdl M (fgs R M (insert h H1))\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                          m\n                          \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                    m =\n                                    h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2) =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2)) \\<and>\n                         (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                          m\n                          \\<notin> fgs R M (insert h H1) \\<longrightarrow>\n                          undefined =\n                          a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                          (THE y.\n                              \\<exists>h1\\<in>fgs R M H1.\n                                 \\<exists>h2\\<in>fgs R M {h}.\n                                    m = h1 \\<plusminus> h2 \\<and>\n                                    y =\n                                    g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                    monofun R M N f H h h2))\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac a = a and m = m in Module.sc_mem[of \n             \"mdl M (fgs R M (insert h H1))\" R], assumption+,\n        simp add:mdl_carrier, simp add:mdl_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        a \\<in> carrier R; m \\<in> fgs R M (insert h H1);\n        R module mdl M (fgs R M (insert h H1));\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m\n        \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                   m =\n                                   h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule sSum_eq[THEN sym, of N H H1 h], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        a \\<in> carrier R; m \\<in> fgs R M (insert h H1);\n        R module mdl M (fgs R M (insert h H1));\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m\n        \\<in> fgs R M (insert h H1);\n        fgs R M (H1 \\<union> {h}) =\n        fgs R M H1 \\<minusplus> fgs R M {h}\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                   m =\n                                   h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n       x = \"a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m\" in ex_extensionTr, assumption+,\n       simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        a \\<in> carrier R; m \\<in> fgs R M (insert h H1);\n        R module mdl M (fgs R M (insert h H1));\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub> m\n        \\<in> fgs R M (insert h H1);\n        fgs R M (H1 \\<union> {h}) = fgs R M H1 \\<minusplus> fgs R M {h};\n        \\<exists>k1\\<in>fgs R M H1.\n           \\<exists>k2\\<in>fgs R M {h}.\n              a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n              m =\n              k1 \\<plusminus> k2 \\<and>\n              (THE y.\n                  \\<exists>h1\\<in>fgs R M H1.\n                     \\<exists>h2\\<in>fgs R M {h}.\n                        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                        m =\n                        h1 \\<plusminus> h2 \\<and>\n                        y =\n                        g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                        monofun R M N f H h h2) =\n              g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h k2\\<rbrakk>\n       \\<Longrightarrow> (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M (insert h H1))\\<^esub>\n                                   m =\n                                   h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply ((erule bexE)+, erule conjE, simp,\n       thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}.\n                  k1 \\<plusminus> k2 = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                  g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        m \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M H1 \\<minusplus> fgs R M {h})\\<^esub>\n        m =\n        k1 \\<plusminus> k2\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        m \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        a \\<cdot>\\<^sub>s m = k1 \\<plusminus> k2\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   m = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n       x = m in ex_extensionTr, assumption+,\n       (erule bexE)+, erule conjE, simp,\n       thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}.\n                  k1a \\<plusminus> k2a = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n                  g k1a \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2a\",\n       frule_tac c = k1a in subsetD[of \"fgs R M H1\" \"carrier M\"], assumption+,\n       frule_tac c = k1 in subsetD[of \"fgs R M H1\" \"carrier M\"], assumption+,\n       frule_tac c = k2a in subsetD[of \"fgs R M {h}\" \"carrier M\"], assumption+,\n       frule_tac c = k2 in subsetD[of \"fgs R M {h}\" \"carrier M\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k2 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        a \\<cdot>\\<^sub>s (k1a \\<plusminus> k2a) = k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M; k1 \\<in> carrier M;\n        k2a \\<in> carrier M; k2 \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:sc_r_distr,\n              frule_tac a = a and h = k1a in \n                    submodule_sc_closed[of \"fgs R M H1\"], assumption+,\n              frule_tac a = a and h = k2a in \n                    submodule_sc_closed[of \"fgs R M {h}\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k2 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        k1 \\<plusminus> k2 \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {h};\n        a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a =\n        k1 \\<plusminus> k2;\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M; k1 \\<in> carrier M;\n        k2a \\<in> carrier M; k2 \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s k2a \\<in> fgs R M {h}\\<rbrakk>\n       \\<Longrightarrow> g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2 =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac ?x1.0 = k1 and ?x2.0 = \"a \\<cdot>\\<^sub>s k1a\" and ?y1.0 = k2 and\n          ?y2.0 = \"a \\<cdot>\\<^sub>s k2a\" in sSum_unique[of N H H1 h], assumption+,\n          simp, assumption+, rule sym, assumption,\n          thin_tac \"a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a = k1 \\<plusminus> k2\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> carrier M; k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s k2a \\<in> fgs R M {h};\n        k1 = a \\<cdot>\\<^sub>s k1a\\<rbrakk>\n       \\<Longrightarrow> g (a \\<cdot>\\<^sub>s\n                            k1a) \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (a \\<cdot>\\<^sub>s k2a) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule subset_trans[of H1 H \"carrier M\"], assumption+,\n          frule mdl_is_module[of \"fgs R M H1\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> carrier M; k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s k2a \\<in> fgs R M {h}; k1 = a \\<cdot>\\<^sub>s k1a;\n        H1 \\<subseteq> carrier M; R module mdl M (fgs R M H1)\\<rbrakk>\n       \\<Longrightarrow> g (a \\<cdot>\\<^sub>s\n                            k1a) \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (a \\<cdot>\\<^sub>s k2a) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac a = a and m = k1a in Module.mHom_lin[of \"mdl M (fgs R M H1)\"\n          R N _ g], assumption+, simp add:mdl_carrier, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> carrier M; k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s k2a \\<in> fgs R M {h}; k1 = a \\<cdot>\\<^sub>s k1a;\n        H1 \\<subseteq> carrier M; R module mdl M (fgs R M H1);\n        g (a \\<cdot>\\<^sub>s\\<^bsub>mdl M (fgs R M H1)\\<^esub> k1a) =\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g k1a\\<rbrakk>\n       \\<Longrightarrow> g (a \\<cdot>\\<^sub>s\n                            k1a) \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (a \\<cdot>\\<^sub>s k2a) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; h \\<in> carrier M;\n        submodule R M (fgs R M {h}); submodule R M (fgs R M H1);\n        fgs R M {h} \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> carrier M; k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s k2a \\<in> fgs R M {h}; k1 = a \\<cdot>\\<^sub>s k1a;\n        H1 \\<subseteq> carrier M; R module mdl M (fgs R M H1);\n        g (a \\<cdot>\\<^sub>s k1a) =\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g k1a\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h (a \\<cdot>\\<^sub>s k2a) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (simp add:monofun_sprod)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a m k1 k1a k2a.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; h \\<in> carrier M;\n        submodule R M (fgs R M {h}); submodule R M (fgs R M H1);\n        fgs R M {h} \\<subseteq> carrier M; fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M H1 \\<minusplus> fgs R M {h}); h \\<in> H;\n        h \\<notin> H1; g \\<in> mHom R (mdl M (fgs R M H1)) N;\n        \\<forall>z\\<in>H1. f z = g z; a \\<in> carrier R;\n        k1a \\<plusminus> k2a \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        R module mdl M (fgs R M H1 \\<minusplus> fgs R M {h});\n        a \\<cdot>\\<^sub>s k1a \\<plusminus> a \\<cdot>\\<^sub>s k2a\n        \\<in> fgs R M H1 \\<minusplus> fgs R M {h};\n        fgs R M (insert h H1) = fgs R M H1 \\<minusplus> fgs R M {h};\n        k1a \\<in> fgs R M H1; k2a \\<in> fgs R M {h};\n        m = k1a \\<plusminus> k2a; k1a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> carrier M; k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k2a \\<in> carrier M;\n        a \\<cdot>\\<^sub>s k1a \\<in> fgs R M H1;\n        a \\<cdot>\\<^sub>s k2a \\<in> fgs R M {h}; k1 = a \\<cdot>\\<^sub>s k1a;\n        H1 \\<subseteq> carrier M; R module mdl M (fgs R M H1);\n        g (a \\<cdot>\\<^sub>s k1a) =\n        a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g k1a\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2a =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub>\n                         (g k1a \\<plusminus>\\<^bsub>N\\<^esub>\n                          monofun R M N f H h k2a)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (frule_tac m = k1a in Module.mHom_mem[of \"mdl M (fgs R M H1)\" R N g],\n          assumption+, simp add:mdl_carrier,\n         frule_tac x = k2a in monofun_mem[of N h H _ f], assumption+,\n         simp add:Module.sc_r_distr[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h \\<and>\n                      (\\<forall>z\\<in>H1.\n                          g z =\n                          (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                              THE y.\n                                 \\<exists>h1\\<in>fgs R M H1.\n                                    \\<exists>h2\\<in>fgs R M {h}.\n x = h1 \\<plusminus> h2 \\<and>\n y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                           z)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                          THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   x = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)\n                       h\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> (h \\<in> fgs R M (insert h H1) \\<longrightarrow>\n                       f h =\n                       (THE y.\n                           \\<exists>h1\\<in>fgs R M H1.\n                              \\<exists>h2\\<in>fgs R M {h}.\n                                 h = h1 \\<plusminus> h2 \\<and>\n                                 y =\n                                 g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                 monofun R M N f H h h2)) \\<and>\n                      (h \\<notin> fgs R M (insert h H1) \\<longrightarrow>\n                       f h = undefined)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (cut_tac insert_sub[of H1 \"carrier M\" h], \n         frule elem_fgs[of \"insert h H1\" h], simp, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n     h \\<in> fgs R M (insert h H1)\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (THE y.\n                          \\<exists>h1\\<in>fgs R M H1.\n                             \\<exists>h2\\<in>fgs R M {h}.\n                                h = h1 \\<plusminus> h2 \\<and>\n                                y =\n                                g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n         x = h in ex_extensionTr, assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n     h \\<in> fgs R M (insert h H1)\\<rbrakk>\n    \\<Longrightarrow> h \\<in> fgs R M H1 \\<minusplus> fgs R M {h}\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n     h \\<in> fgs R M (insert h H1);\n     \\<exists>k1\\<in>fgs R M H1.\n        \\<exists>k2\\<in>fgs R M {h}.\n           h = k1 \\<plusminus> k2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     h = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h k2\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (THE y.\n                          \\<exists>h1\\<in>fgs R M H1.\n                             \\<exists>h2\\<in>fgs R M {h}.\n                                h = h1 \\<plusminus> h2 \\<and>\n                                y =\n                                g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                monofun R M N f H h h2)\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 5. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (frule sSum_eq[THEN sym, of N H H1 h], assumption+, simp, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n     h \\<in> fgs R M (insert h H1);\n     \\<exists>k1\\<in>fgs R M H1.\n        \\<exists>k2\\<in>fgs R M {h}.\n           h = k1 \\<plusminus> k2 \\<and>\n           (THE y.\n               \\<exists>h1\\<in>fgs R M H1.\n                  \\<exists>h2\\<in>fgs R M {h}.\n                     h = h1 \\<plusminus> h2 \\<and>\n                     y =\n                     g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                     monofun R M N f H h h2) =\n           g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n           monofun R M N f H h k2\\<rbrakk>\n    \\<Longrightarrow> f h =\n                      (THE y.\n                          \\<exists>h1\\<in>fgs R M H1.\n                             \\<exists>h2\\<in>fgs R M {h}.\n                                h = h1 \\<plusminus> h2 \\<and>\n                                y =\n                                g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                monofun R M N f H h h2)\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply ((erule bexE)+, (erule conjE), simp,\n         thin_tac \"(THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {k1 \\<plusminus> k2}.\n                  k1 \\<plusminus> k2 = h1 \\<plusminus> h2 \\<and>\n                  y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H (k1 \\<plusminus> k2) h2) =\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H (k1 \\<plusminus> k2) k2\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        k1 \\<plusminus> k2 \\<in> carrier M;\n        submodule R M (fgs R M {k1 \\<plusminus> k2});\n        submodule R M (fgs R M H1);\n        fgs R M {k1 \\<plusminus> k2} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert (k1 \\<plusminus> k2) H1));\n        k1 \\<plusminus> k2 \\<in> H; k1 \\<plusminus> k2 \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        k1 \\<plusminus> k2 \\<in> fgs R M (insert (k1 \\<plusminus> k2) H1);\n        k1 \\<in> fgs R M H1; k2 \\<in> fgs R M {k1 \\<plusminus> k2};\n        h = k1 \\<plusminus> k2\\<rbrakk>\n       \\<Longrightarrow> f (k1 \\<plusminus> k2) =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H (k1 \\<plusminus> k2) k2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (rotate_tac -1, frule sym, thin_tac \"h = k1 \\<plusminus> k2\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> f h =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2\n 2. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 3. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (cut_tac elem_fgs[of \"{h}\" h], \n          frule ag_l_zero[THEN sym, of h])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h; h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> f h =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2\n 2. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {h}\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 5. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 6. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (frule submodule_inc_0[of \"fgs R M H1\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h; h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h; \\<zero> \\<in> fgs R M H1\\<rbrakk>\n       \\<Longrightarrow> f h =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2\n 2. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {h}\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 5. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 6. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (frule_tac ?x1.0 = k1 and ?x2.0 = \\<zero> and ?y1.0 = k2 and ?y2.0 = h in \n          sSum_unique[of N H H1 h], assumption+, simp, assumption+,\n          simp, simp, simp add: monofun_eq_f)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h; \\<zero> \\<in> fgs R M H1;\n        k1 = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> f h = g \\<zero> \\<plusminus>\\<^bsub>N\\<^esub> f h\n 2. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> {h} \\<subseteq> carrier M\n 3. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {h}\n 4. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 5. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 6. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (cut_tac Module.mHom_0[of \"mdl M (fgs R M H1)\" R N g],\n          simp add:mdl_def, fold mdl_def)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<And>k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h; \\<zero> \\<in> fgs R M H1; k1 = \\<zero>;\n        g \\<zero> = \\<zero>\\<^bsub>N\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f h =\n                         \\<zero>\\<^bsub>N\\<^esub> \\<plusminus>\\<^bsub>N\\<^esub>\n                         f h\n 2. \\<And>k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h; \\<zero> \\<in> fgs R M H1;\n        k1 = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> R module mdl M (fgs R M H1)\n 3. \\<And>k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h; \\<zero> \\<in> fgs R M H1;\n        k1 = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> R module N\n 4. \\<And>k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); h \\<in> fgs R M {h};\n        h = \\<zero> \\<plusminus> h; \\<zero> \\<in> fgs R M H1;\n        k1 = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> g \\<in> mHom R (mdl M (fgs R M H1)) N\n 5. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> {h} \\<subseteq> carrier M\n 6. \\<And>k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        h \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {h}\n 7. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> H1 \\<subseteq> carrier M\n 8. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier M\n 9. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (frule funcset_mem[of f H \"carrier N\" h], assumption+,\n          frule Module.module_is_ag[of N], simp add:aGroup.l_zero,\n          rule mdl_is_module, assumption+,\n          rule subsetI, simp, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n     H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n     h \\<in> carrier M; submodule R M (fgs R M {h});\n     submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n     fgs R M H1 \\<subseteq> carrier M;\n     submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n     g \\<in> mHom R (mdl M (fgs R M H1)) N;\n     \\<forall>z\\<in>H1. f z = g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>z\\<in>H1.\n                         g z =\n                         (\\<lambda>x\\<in>fgs R M (H1 \\<union> {h}).\n                             THE y.\n                                \\<exists>h1\\<in>fgs R M H1.\n                                   \\<exists>h2\\<in>fgs R M {h}.\nx = h1 \\<plusminus> h2 \\<and>\ny = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2)\n                          z", "apply (rule ballI, simp,\n       cut_tac x = z in elem_fgs[of \"insert h H1\"],\n       rule subsetI, simp, erule disjE, simp, simp add:subsetD, \n       rule_tac c = z in subsetD[of \"H1\" \"insert h H1\"],\n       rule subsetI, simp, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   z = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)", "apply (frule_tac h = h and H = H and ?H1.0 = H1 and g = g and N = N and\n         x = z in ex_extensionTr, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1)\\<rbrakk>\n       \\<Longrightarrow> z \\<in> fgs R M H1 \\<minusplus> fgs R M {h}\n 2. \\<And>z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1);\n        \\<exists>k1\\<in>fgs R M H1.\n           \\<exists>k2\\<in>fgs R M {h}.\n              z = k1 \\<plusminus> k2 \\<and>\n              (THE y.\n                  \\<exists>h1\\<in>fgs R M H1.\n                     \\<exists>h2\\<in>fgs R M {h}.\n                        z = h1 \\<plusminus> h2 \\<and>\n                        y =\n                        g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                        monofun R M N f H h h2) =\n              g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h k2\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   z = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)", "apply (frule sSum_eq[THEN sym, of N H H1 h], assumption+, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1);\n        \\<exists>k1\\<in>fgs R M H1.\n           \\<exists>k2\\<in>fgs R M {h}.\n              z = k1 \\<plusminus> k2 \\<and>\n              (THE y.\n                  \\<exists>h1\\<in>fgs R M H1.\n                     \\<exists>h2\\<in>fgs R M {h}.\n                        z = h1 \\<plusminus> h2 \\<and>\n                        y =\n                        g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                        monofun R M N f H h h2) =\n              g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n              monofun R M N f H h k2\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         (THE y.\n                             \\<exists>h1\\<in>fgs R M H1.\n                                \\<exists>h2\\<in>fgs R M {h}.\n                                   z = h1 \\<plusminus> h2 \\<and>\n                                   y =\n                                   g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                                   monofun R M N f H h h2)", "apply ((erule bexE)+, (erule conjE), simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        k1 \\<plusminus> k2 \\<in> H1;\n        k1 \\<plusminus> k2 \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; z = k1 \\<plusminus> k2;\n        (THE y.\n            \\<exists>h1\\<in>fgs R M H1.\n               \\<exists>h2\\<in>fgs R M {h}.\n                  k1 \\<plusminus> k2 = h1 \\<plusminus> h2 \\<and>\n                  y =\n                  g h1 \\<plusminus>\\<^bsub>N\\<^esub>\n                  monofun R M N f H h h2) =\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2\\<rbrakk>\n       \\<Longrightarrow> g (k1 \\<plusminus> k2) =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2", "apply (thin_tac \"(THE y. \\<exists>h1\\<in>fgs R M H1. \\<exists>h2\\<in>fgs R M {h}.\n                  k1 \\<plusminus> k2 = h1 \\<plusminus> h2 \\<and> y = g h1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h h2) =\n        g k1 \\<plusminus>\\<^bsub>N\\<^esub> monofun R M N f H h k2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        k1 \\<plusminus> k2 \\<in> H1;\n        k1 \\<plusminus> k2 \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; z = k1 \\<plusminus> k2\\<rbrakk>\n       \\<Longrightarrow> g (k1 \\<plusminus> k2) =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2", "apply (rotate_tac -1, frule sym, thin_tac \"z = k1 \\<plusminus> k2\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = z\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2", "apply (frule_tac x = z in elem_fgs[of H1], assumption,\n       frule_tac c = z in subsetD[of H1 \"carrier M\"], assumption+,\n       frule_tac t = z in ag_r_zero[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1 k2.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1); k1 \\<in> fgs R M H1;\n        k2 \\<in> fgs R M {h}; k1 \\<plusminus> k2 = z; z \\<in> fgs R M H1;\n        z \\<in> carrier M; z = z \\<plusminus> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         g k1 \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h k2", "apply (frule_tac ?x1.0 = k1 and ?x2.0 = z and ?y1.0 = k2 and ?y2.0 = \\<zero>  in \n        sSum_unique[of N H H1 h], assumption+, simp, assumption+,\n        simp add:submodule_inc_0, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1);\n        \\<zero> \\<in> fgs R M {h}; z \\<in> fgs R M H1; z \\<in> carrier M;\n        z = z \\<plusminus> \\<zero>; k1 = z\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         g z \\<plusminus>\\<^bsub>N\\<^esub>\n                         monofun R M N f H h \\<zero>", "apply (simp add: monofun_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1);\n        \\<zero> \\<in> fgs R M {h}; z \\<in> fgs R M H1; z \\<in> carrier M;\n        z = z \\<plusminus> \\<zero>; k1 = z\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         g z \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule mdl_is_module[of \"fgs R M H1\"],\n        frule_tac m = z in Module.mHom_mem[of \"mdl M (fgs R M H1)\" R N g],\n        assumption+, simp add:mdl_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k1.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; H1 \\<subseteq> H;\n        H \\<subseteq> carrier M; Ring R; H1 \\<subseteq> carrier M;\n        h \\<in> carrier M; submodule R M (fgs R M {h});\n        submodule R M (fgs R M H1); fgs R M {h} \\<subseteq> carrier M;\n        fgs R M H1 \\<subseteq> carrier M;\n        submodule R M (fgs R M (insert h H1)); h \\<in> H; h \\<notin> H1;\n        g \\<in> mHom R (mdl M (fgs R M H1)) N; \\<forall>z\\<in>H1. f z = g z;\n        z \\<in> H1; z \\<in> fgs R M (insert h H1);\n        \\<zero> \\<in> fgs R M {h}; z \\<in> fgs R M H1; z \\<in> carrier M;\n        z = z \\<plusminus> \\<zero>; k1 = z; R module mdl M (fgs R M H1);\n        g z \\<in> carrier N\\<rbrakk>\n       \\<Longrightarrow> g z =\n                         g z \\<plusminus>\\<^bsub>N\\<^esub>\n                         \\<zero>\\<^bsub>N\\<^esub>", "apply (frule Module.module_is_ag[of N],\n        simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) mHom_mHom:\"\\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n       \\<Longrightarrow> g \\<in> mHom R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n    \\<Longrightarrow> g \\<in> mHom R M N", "apply (rule mHom_test, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n    \\<Longrightarrow> g \\<in> carrier M \\<rightarrow> carrier N \\<and>\n                      g \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             g (m \\<plusminus> n) =\n                             g m \\<plusminus>\\<^bsub>N\\<^esub> g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n    \\<Longrightarrow> g \\<in> carrier M \\<rightarrow> carrier N\n 2. \\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n    \\<Longrightarrow> g \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             g (m \\<plusminus> n) =\n                             g m \\<plusminus>\\<^bsub>N\\<^esub> g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m)", "apply (simp add:mHom_def aHom_def mdl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; g \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n    \\<Longrightarrow> g \\<in> extensional (carrier M) \\<and>\n                      (\\<forall>m\\<in>carrier M.\n                          \\<forall>n\\<in>carrier M.\n                             g (m \\<plusminus> n) =\n                             g m \\<plusminus>\\<^bsub>N\\<^esub> g n) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier M.\n                             g (a \\<cdot>\\<^sub>s m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>N\\<^esub> g m)", "apply (simp add:mHom_def aHom_def mdl_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) exist_extension_mhom:\"\\<lbrakk>R module N; free_generator R M H; \n      f \\<in> H \\<rightarrow> carrier N\\<rbrakk> \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x", "supply [[simproc del: defined_all]]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x", "apply (frule Order_od_fm_fun[of N H f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x", "apply (frule_tac  N = N and H = H and f = f in od_fm_fun_inductive, \n             assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n     inductive_set (od_fm_fun R M N f H)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x", "apply (frule_tac D = \"od_fm_fun R M N f H\" in Order.g_Zorn_lemma3,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R module N; free_generator R M H;\n     f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n     inductive_set (od_fm_fun R M N f H);\n     \\<exists>m\\<in>carrier (od_fm_fun R M N f H).\n        maximal\\<^bsub>od_fm_fun R M N f H\\<^esub> m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>mHom R M N. \\<forall>x\\<in>H. g x = f x", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H);\n        m \\<in> carrier (od_fm_fun R M N f H);\n        maximal\\<^bsub>od_fm_fun R M N f H\\<^esub> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g\\<in>mHom R M N.\n                            \\<forall>x\\<in>H. g x = f x", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H);\n        m \\<in> carrier (od_fm_fun R M N f H);\n        maximal\\<^bsub>od_fm_fun R M N f H\\<^esub> m;\n        \\<forall>g\\<in>mHom R M N.\n           \\<exists>x\\<in>H. g x \\<noteq> f x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:maximal_element_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H);\n        m \\<in> carrier (od_fm_fun R M N f H);\n        \\<forall>b\\<in>carrier (od_fm_fun R M N f H).\n           m \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           m = b;\n        \\<forall>g\\<in>mHom R M N.\n           \\<exists>x\\<in>H. g x \\<noteq> f x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:od_fm_fun_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); m \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           m \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           m = b;\n        \\<forall>g\\<in>mHom R M N.\n           \\<exists>x\\<in>H. g x \\<noteq> f x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac p = m in PairE_lemma, (erule exE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = x and b = y in mem_fsps_fst_sub[of N H f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (case_tac \"x \\<noteq> H\", frule not_sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H; x \\<noteq> H; H \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H; \\<not> x \\<noteq> H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac A = H and B = x in diff_nonempty, assumption,\n        frule_tac A = \"H - x\" in nonempty_ex, erule exE,\n        rename_tac m H1 g h)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m H1 g h.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (H1, g) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (H1, g) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (H1, g) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H1, g); H1 \\<subseteq> H; H1 \\<noteq> H; H \\<noteq> H1;\n        H - H1 \\<noteq> {}; h \\<in> H - H1\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H; \\<not> x \\<noteq> H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac ?H1.0 = H1 and h = h and g = g in ex_extension[of N H f],\n        assumption+, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m H1 g h k.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (H1, g) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (H1, g) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (H1, g) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H1, g); H1 \\<subseteq> H; H1 \\<noteq> H; H \\<noteq> H1;\n        H - H1 \\<noteq> {}; h \\<in> H - H1;\n        (H1 \\<union> {h}, k) \\<in> fsps R M N f H\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H; \\<not> x \\<noteq> H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (drule_tac x = \"(H1 \\<union> {h}, k)\" in bspec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m H1 g h k.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (H1, g) \\<in> fsps R M N f H;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H1, g); H1 \\<subseteq> H; H1 \\<noteq> H; H \\<noteq> H1;\n        H - H1 \\<noteq> {}; h \\<in> H - H1;\n        (H1 \\<union> {h}, k) \\<in> fsps R M N f H;\n        (H1, g) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n        (H1 \\<union> {h}, k) \\<longrightarrow>\n        (H1, g) = (H1 \\<union> {h}, k)\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H; \\<not> x \\<noteq> H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:od_fm_fun_def ole_def, fold od_fm_fun_def,\n        simp add:insert_inc1, (erule conjE)+,\n        cut_tac a = h and A = H1 in insert_inc2,\n        rotate_tac -3, frule sym, thin_tac \"H1 = insert h H1\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (x, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (x, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (x, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (x, y); x \\<subseteq> H; \\<not> x \\<noteq> H\\<rbrakk>\n       \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (H, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (H, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (H, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H, y); x = H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = H and b = y in mem_fsps_snd_mHom[of N H f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; free_generator R M H;\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (H, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (H, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (H, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H, y); x = H; y \\<in> mHom R (mdl M (fgs R M H)) N\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:fgs_def free_generator_def generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N;\n        H \\<subseteq> carrier M \\<and>\n        linear_span R M (carrier R) H = carrier M \\<and>\n        (\\<forall>n s.\n            s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n            (\\<exists>f.\n                f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n                inj_on f {j. j \\<le> n} \\<and>\n                l_comb R M n s f = \\<zero>) \\<longrightarrow>\n            s \\<in> {j. j \\<le> n} \\<rightarrow>\n                    {\\<zero>\\<^bsub>R\\<^esub>});\n        f \\<in> H \\<rightarrow> carrier N; Order (od_fm_fun R M N f H);\n        inductive_set (od_fm_fun R M N f H); (H, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (H, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (H, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H, y); x = H; y \\<in> mHom R (mdl M (carrier M)) N\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac g = y in mHom_mHom[of N], assumption+,\n        (erule conjE)+, thin_tac \"\\<forall>n s. s \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n               (\\<exists>f. f \\<in> {j. j \\<le> n} \\<rightarrow> H \\<and>\n                    inj_on f {j. j \\<le> n} \\<and> l_comb R M n s f = \\<zero>) \\<longrightarrow>\n               s \\<in> {j. j \\<le> n} \\<rightarrow> {\\<zero>\\<^bsub>R\\<^esub>}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m x y.\n       \\<lbrakk>R module N; f \\<in> H \\<rightarrow> carrier N;\n        Order (od_fm_fun R M N f H); inductive_set (od_fm_fun R M N f H);\n        (H, y) \\<in> fsps R M N f H;\n        \\<forall>b\\<in>fsps R M N f H.\n           (H, y) \\<preceq>\\<^bsub>od_fm_fun R M N f H\\<^esub>\n           b \\<longrightarrow>\n           (H, y) = b;\n        \\<forall>g\\<in>mHom R M N. \\<exists>x\\<in>H. g x \\<noteq> f x;\n        m = (H, y); x = H; y \\<in> mHom R (mdl M (carrier M)) N;\n        y \\<in> mHom R M N; H \\<subseteq> carrier M;\n        linear_span R M (carrier R) H = carrier M\\<rbrakk>\n       \\<Longrightarrow> False", "apply (drule_tac x = y in bspec, assumption+,\n        simp add:fsps_def fsp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Nakayama lemma\""], ["", "definition\n  Lcg :: \"[('r, 'm) Ring_scheme, ('a, 'r, 'm1) Module_scheme, nat] \\<Rightarrow> bool\" where\n  \"Lcg R M j \\<longleftrightarrow> (\\<exists>H. finite_generator R M H \\<and> j = card H)\""], ["", "(* Least cardinality of generator *)"], ["", "lemma (in Module) NAKTr1:\"M fgover R \\<Longrightarrow> \n      \\<exists>H. finite_generator R M H \\<and> (LEAST j. \n        \\<exists>L. finite_generator R M L \\<and> j = card L) = card H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M fgover R \\<Longrightarrow>\n    \\<exists>H.\n       finite_generator R M H \\<and>\n       (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n       card H", "apply (simp add:fGOver_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>H. finite_generator R M H \\<Longrightarrow>\n    \\<exists>H.\n       finite_generator R M H \\<and>\n       (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n       card H", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       finite_generator R M H \\<Longrightarrow>\n       \\<exists>H.\n          finite_generator R M H \\<and>\n          (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n          card H", "apply (rule LeastI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       finite_generator R M H \\<Longrightarrow>\n       \\<exists>Ha. finite_generator R M Ha \\<and> ?k2 H = card Ha", "apply (rule_tac x = H in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       finite_generator R M H \\<Longrightarrow>\n       finite_generator R M H \\<and> ?k2 H = card H", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) NAKTr2:\"\\<lbrakk>Lcg R M j; k < (LEAST j. Lcg R M j)\\<rbrakk> \\<Longrightarrow>\n                            \\<not> Lcg R M k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Lcg R M j; k < (LEAST j. Lcg R M j)\\<rbrakk>\n    \\<Longrightarrow> \\<not> Lcg R M k", "apply (rule not_less_Least, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) NAKTr3:\"\\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n       card H < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L)\\<rbrakk> \\<Longrightarrow>\n              \\<not> finite_generator R M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n     card H\n     < (LEAST j.\n           \\<exists>L. finite_generator R M L \\<and> j = card L)\\<rbrakk>\n    \\<Longrightarrow> \\<not> finite_generator R M H", "apply (frule NAKTr1, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha\\<rbrakk>\n       \\<Longrightarrow> \\<not> finite_generator R M H", "apply (cut_tac j = \"card Ha\" and k = \"card H\" in NAKTr2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha\\<rbrakk>\n       \\<Longrightarrow> Lcg R M (card Ha)\n 2. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha\\<rbrakk>\n       \\<Longrightarrow> card H < (LEAST j. Lcg R M j)\n 3. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha;\n        \\<not> Lcg R M (card H)\\<rbrakk>\n       \\<Longrightarrow> \\<not> finite_generator R M H", "apply (simp add:Lcg_def, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha\\<rbrakk>\n       \\<Longrightarrow> card H < (LEAST j. Lcg R M j)\n 2. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha;\n        \\<not> Lcg R M (card H)\\<rbrakk>\n       \\<Longrightarrow> \\<not> finite_generator R M H", "apply (simp add:Lcg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H\n        < (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L);\n        finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha;\n        \\<not> Lcg R M (card H)\\<rbrakk>\n       \\<Longrightarrow> \\<not> finite_generator R M H", "apply (simp add:Lcg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H < card Ha; finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha;\n        \\<forall>Ha.\n           finite_generator R M Ha \\<longrightarrow>\n           card H \\<noteq> card Ha\\<rbrakk>\n       \\<Longrightarrow> \\<not> finite_generator R M H", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H < card Ha; finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha;\n        \\<forall>Ha.\n           finite_generator R M Ha \\<longrightarrow>\n           card H \\<noteq> card Ha;\n        finite_generator R M H\\<rbrakk>\n       \\<Longrightarrow> False", "apply (drule_tac a = H in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>Ha.\n       \\<lbrakk>M fgover R; H \\<subseteq> carrier M; finite H;\n        card H < card Ha; finite_generator R M Ha;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card Ha;\n        finite_generator R M H; card H \\<noteq> card H\\<rbrakk>\n       \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) finite_gen_over_ideal:\"\\<lbrakk>ideal R A; h \\<in> {j. j \\<le> (n::nat)} \\<rightarrow>\n carrier M; generator R M (h ` {j. j \\<le> n}); A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; \n m \\<in> carrier M \\<rbrakk>  \\<Longrightarrow>  \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A. m = l_comb R M n s h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (frule l_span_closed3[of \"A\" \"h ` {j. j \\<le> n}\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     linear_span R M A (h ` {j. j \\<le> n}) = carrier M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (rotate_tac -1, frule sym, \n        thin_tac \"linear_span R M A (h ` {j. j \\<le> n}) = carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     carrier M = linear_span R M A (h ` {j. j \\<le> n})\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (frule eq_set_inc[of m \"carrier M\" \n                  \"linear_span R M A (h ` {j. j \\<le> n})\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     carrier M = linear_span R M A (h ` {j. j \\<le> n});\n     m \\<in> linear_span R M A (h ` {j. j \\<le> n})\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (thin_tac \"carrier M = linear_span R M A (h ` {j. j \\<le> n})\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     m \\<in> linear_span R M A (h ` {j. j \\<le> n})\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (simp add:linear_span_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     m \\<in> (if \\<forall>x. \\<not> x \\<le> n then {\\<zero>}\n              else {x. \\<exists>na.\n                          \\<exists>f\\<in>{j. j \\<le> na} \\<rightarrow>\n   h ` {j. j \\<le> n}.\n                             \\<exists>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                x = l_comb R M na s f})\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (cut_tac Nset_nonempty[of n], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     m \\<in> (if \\<forall>x. \\<not> x \\<le> n then {\\<zero>}\n              else {x. \\<exists>na.\n                          \\<exists>f\\<in>{j. j \\<le> na} \\<rightarrow>\n   h ` {j. j \\<le> n}.\n                             \\<exists>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n                                x = l_comb R M na s f});\n     \\<exists>x. x \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (case_tac \"\\<forall>x. \\<not> x \\<le> n\", simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     \\<exists>na.\n        \\<exists>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n           \\<exists>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              m = l_comb R M na s f;\n     \\<exists>x. x \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "(** simp no good **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n     generator R M (h ` {j. j \\<le> n});\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n     \\<exists>na.\n        \\<exists>f\\<in>{j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n}.\n           \\<exists>s\\<in>{j. j \\<le> na} \\<rightarrow> A.\n              m = l_comb R M na s f;\n     \\<exists>x. x \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                         m = l_comb R M n s h", "apply (erule exE, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na f s.\n       \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> n} \\<rightarrow> carrier M;\n        generator R M (h ` {j. j \\<le> n});\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; m \\<in> carrier M;\n        \\<exists>x. x \\<le> n;\n        f \\<in> {j. j \\<le> na} \\<rightarrow> h ` {j. j \\<le> n};\n        s \\<in> {j. j \\<le> na} \\<rightarrow> A;\n        m = l_comb R M na s f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s\\<in>{j. j \\<le> n} \\<rightarrow> A.\n                            m = l_comb R M n s h", "apply (simp add:finite_lin_span)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) NAKTr4:\"\\<lbrakk>ideal R A; h \\<in> {j. j \\<le> (k::nat)} \\<rightarrow> carrier M; \n 0 < k;  h ` {j. j \\<le> k} \\<subseteq> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A; \n h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (h j)) (k - Suc 0) \\<plusminus> (s k \\<cdot>\\<^sub>s (h k))\\<rbrakk> \\<Longrightarrow> \n  (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k))) \\<cdot>\\<^sub>s (h k) = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s (h j)) (k - Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (frule funcset_mem[of h \"{j. j \\<le> k}\" \"carrier M\" k], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (frule_tac funcset_mem[of s \"{j. j \\<le> k}\" A k], simp,\n       frule_tac h = \"s k\" in Ring.ideal_subset[of R A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (cut_tac n = \"k - Suc 0\" and f = \"\\<lambda>j. s j \\<cdot>\\<^sub>s h j\" in nsum_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k - Suc 0.\n                         s j \\<cdot>\\<^sub>s h j \\<in> carrier M\n 2. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (rule allI, rule impI, rule sc_mem,\n       frule_tac x = j in funcset_mem[of s \"{j. j \\<le> k}\" A ],\n       simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n        0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\n                               h j) (k - Suc 0) \\<plusminus>\n        s k \\<cdot>\\<^sub>s h k;\n        Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n        j \\<le> k - Suc 0; s j \\<in> A\\<rbrakk>\n       \\<Longrightarrow> s j \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n        0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\n                               h j) (k - Suc 0) \\<plusminus>\n        s k \\<cdot>\\<^sub>s h k;\n        Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n        j \\<le> k - Suc 0\\<rbrakk>\n       \\<Longrightarrow> h j \\<in> carrier M\n 3. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (simp add:Ring.ideal_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n        0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\n                               h j) (k - Suc 0) \\<plusminus>\n        s k \\<cdot>\\<^sub>s h k;\n        Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n        j \\<le> k - Suc 0\\<rbrakk>\n       \\<Longrightarrow> h j \\<in> carrier M\n 2. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (cut_tac i = j and j = \"k - Suc 0\" and k = k in \n        le_trans, assumption+, simp,\n        rule_tac x = j in funcset_mem[of h \"{j. j \\<le> k}\" \"carrier M\"],\n        assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (frule sc_mem[of \"s k\" \"h k\"], assumption+,\n        frule ag_mOp_closed[of \"s k \\<cdot>\\<^sub>s h k\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n     h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s\n                            h j) (k - Suc 0) \\<plusminus>\n     s k \\<cdot>\\<^sub>s h k;\n     Ring R; h k \\<in> carrier M; s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M;\n     s k \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     -\\<^sub>a s k \\<cdot>\\<^sub>s h k \\<in> carrier M\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (frule_tac ag_pOp_add_r[of \"h k\"\n        \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0) \\<plusminus> s k \\<cdot>\\<^sub>s h k\" \"-\\<^sub>a (s k \\<cdot>\\<^sub>s h k)\"],\n         rule ag_pOp_closed, assumption+,\n        thin_tac \"h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0) \\<plusminus> s k \\<cdot>\\<^sub>s h k\",\n        simp add:ag_pOp_assoc ag_r_inv1 ag_r_zero,\n        simp add:sc_minus_am1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A; Ring R; h k \\<in> carrier M;\n     s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M;\n     s k \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     h k \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                            s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (frule Ring.ring_is_ag, \n        frule aGroup.ag_mOp_closed[of R \"s k\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A; Ring R; h k \\<in> carrier M;\n     s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M;\n     s k \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     h k \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "(** I don't know how to change s k to 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s s k **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A; Ring R; h k \\<in> carrier M;\n     s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M;\n     s k \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     h k \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k =\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      \\<Sigma>\\<^sub>e M (\\<lambda>j.\n       s j \\<cdot>\\<^sub>s h j) (k - Suc 0)", "apply (subgoal_tac \"(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k))) \\<cdot>\\<^sub>s h k = h k \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s h k\",\n        simp,\n        thin_tac \"h k \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M;\n     0 < k; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n     s \\<in> {j. j \\<le> k} \\<rightarrow> A; Ring R; h k \\<in> carrier M;\n     s k \\<in> A; s k \\<in> carrier R;\n     \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n     \\<in> carrier M;\n     s k \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k \\<in> carrier M;\n     aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                       -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                      h k =\n                      h k \\<plusminus>\n                      (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s h k", "apply (cut_tac Ring.ring_one[of R],\n        simp add:sc_l_distr sprod_one, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) NAKTr5:\"\\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R; \n       A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H; card H = Suc k; 0 < k\\<rbrakk> \\<Longrightarrow>\n     \\<exists>h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M. H = h ` {j. j \\<le> k} \\<and>  \n             h k \\<in> linear_span R M A (h ` {j. j \\<le> (k - Suc 0)})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (insert Nset2_finiteTr [of \"k\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (subgoal_tac \"\\<exists>h. h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and> surj_to h {j. j \\<le> k} H\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A);\n     \\<exists>h.\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})\n 2. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n                         surj_to h {j. j \\<le> k} H", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n                         surj_to h {j. j \\<le> k} H\n 2. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A);\n     \\<exists>h.\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (subgoal_tac \"finite H\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A);\n     finite H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n                         surj_to h {j. j \\<le> k} H\n 2. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A)\\<rbrakk>\n    \\<Longrightarrow> finite H\n 3. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A);\n     \\<exists>h.\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A)\\<rbrakk>\n    \\<Longrightarrow> finite H\n 2. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A);\n     \\<exists>h.\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (simp add:finite_generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<forall>A.\n        finite A \\<and> card A = Suc k \\<longrightarrow>\n        (\\<exists>f.\n            f \\<in> {i. i \\<le> k} \\<rightarrow> A \\<and>\n            surj_to f {i. i \\<le> k} A);\n     \\<exists>h.\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (thin_tac \" \\<forall>A. finite A \\<and> card A = Suc k \\<longrightarrow>\n           (\\<exists>f. f \\<in> {j. j \\<le> k} \\<rightarrow> A \\<and> surj_to f {j. j \\<le> k} A)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n     card H = Suc k; 0 < k; Ring R;\n     \\<exists>h.\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow> carrier M.\n                         H = h ` {j. j \\<le> k} \\<and>\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n        card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H \\<and>\n        surj_to h {j. j \\<le> k} H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow>\n  carrier M.\n                            H = h ` {j. j \\<le> k} \\<and>\n                            h k\n                            \\<in> linear_span R M A\n                                   (h ` {j. j \\<le> k - Suc 0})", "apply (simp add:surj_to_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n        card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H;\n        h ` {j. j \\<le> k} = H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow>\n  carrier M.\n                            H = h ` {j. j \\<le> k} \\<and>\n                            h k\n                            \\<in> linear_span R M A\n                                   (h ` {j. j \\<le> k - Suc 0})", "apply (rotate_tac -1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>h ` {j. j \\<le> k} = H; \\<not> zeroring R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        finite_generator R M H; card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow>\n  carrier M.\n                            H = h ` {j. j \\<le> k} \\<and>\n                            h k\n                            \\<in> linear_span R M A\n                                   (h ` {j. j \\<le> k - Suc 0})", "apply (drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n        card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H;\n        H = h ` {j. j \\<le> k}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow>\n  carrier M.\n                            H = h ` {j. j \\<le> k} \\<and>\n                            h k\n                            \\<in> linear_span R M A\n                                   (h ` {j. j \\<le> k - Suc 0})", "apply (frule_tac f = h and A = \"{j. j \\<le> k}\" and B = \"H\" and x = k in \n       funcset_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n        card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H;\n        H = h ` {j. j \\<le> k}\\<rbrakk>\n       \\<Longrightarrow> k \\<in> {j. j \\<le> k}\n 2. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n        card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H; H = h ` {j. j \\<le> k};\n        h k \\<in> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow>\n  carrier M.\n                            H = h ` {j. j \\<le> k} \\<and>\n                            h k\n                            \\<in> linear_span R M A\n                                   (h ` {j. j \\<le> k - Suc 0})", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M; finite_generator R M H;\n        card H = Suc k; 0 < k; Ring R;\n        h \\<in> {j. j \\<le> k} \\<rightarrow> H; H = h ` {j. j \\<le> k};\n        h k \\<in> H\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>{j. j \\<le> k} \\<rightarrow>\n  carrier M.\n                            H = h ` {j. j \\<le> k} \\<and>\n                            h k\n                            \\<in> linear_span R M A\n                                   (h ` {j. j \\<le> k - Suc 0})", "apply (simp add:finite_generator_def,\n        simp add:generator_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) =\n        carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (cut_tac A = \"h ` {j. j \\<le> k}\" and B = \"carrier M\" and c = \"h k\" in\n   subsetD, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (frule_tac h = h and n = k and m = \"h k\" in finite_gen_over_ideal [of \n       \"A\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M\n 2. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (h ` {j. j \\<le> k})\n 3. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\n 4. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h k \\<in> carrier M\n 5. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M;\n        \\<exists>s\\<in>{j. j \\<le> k} \\<rightarrow> A.\n           h k = l_comb R M k s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (fastforce simp add:Pi_def image_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> generator R M (h ` {j. j \\<le> k})\n 2. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\n 3. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h k \\<in> carrier M\n 4. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M;\n        \\<exists>s\\<in>{j. j \\<le> k} \\<rightarrow> A.\n           h k = l_comb R M k s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (simp add:generator_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\n 2. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h k \\<in> carrier M\n 3. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M;\n        \\<exists>s\\<in>{j. j \\<le> k} \\<rightarrow> A.\n           h k = l_comb R M k s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M;\n        \\<exists>s\\<in>{j. j \\<le> k} \\<rightarrow> A.\n           h k = l_comb R M k s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = l_comb R M k s h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (frule_tac f = s and A = \"{j. j \\<le> k}\" and B = A and x = k in \n           funcset_mem, simp, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})", "apply (subgoal_tac \"l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h\",\n        simp del:Suc_pred,\n        thin_tac \"l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M (Suc (k - Suc 0)) s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = l_comb R M (Suc (k - Suc 0)) s h; s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (cut_tac s = s and n = \"k - Suc 0\" and f = h and H = \"h ` {j. j \\<le> k}\" \n       in l_comb_Suc[of _ A], assumption+,\n       frule Ring.ideal_subset1[of R A], assumption,\n       simp add:extend_fun, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M (Suc (k - Suc 0)) s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = l_comb R M (Suc (k - Suc 0)) s h; s k \\<in> A;\n        l_comb R M (Suc (k - Suc 0)) s h =\n        l_comb R M (k - Suc 0) s h \\<plusminus>\n        s (Suc (k - Suc 0)) \\<cdot>\\<^sub>s h (Suc (k - Suc 0))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (rotate_tac -3, frule sym, \n       thin_tac \"h k = l_comb R M (Suc (k - Suc 0)) s h\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (frule_tac h = h and k = k and s = s in NAKTr4[of A])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k} \\<rightarrow> carrier M\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> 0 < k\n 3. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k} \\<subseteq> carrier M\n 4. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> k} \\<rightarrow> A\n 5. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> h k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) (k - Suc 0) \\<plusminus>\n                         s k \\<cdot>\\<^sub>s h k\n 6. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 7. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (fastforce simp add:Pi_def image_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> 0 < k\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k} \\<subseteq> carrier M\n 3. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> k} \\<rightarrow> A\n 4. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k\\<rbrakk>\n       \\<Longrightarrow> h k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) (k - Suc 0) \\<plusminus>\n                         s k \\<cdot>\\<^sub>s h k\n 5. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 6. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply(assumption+, rule sym, simp add:l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (cut_tac H = \"h ` {j. j \\<le> (k - Suc 0)}\" and s = s and n = \"k - Suc 0\" \n       and f = h in l_comb_mem_linear_span[of A], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k - Suc 0} \\<subseteq> carrier M\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow> A\n 3. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> k - Suc 0}\n 4. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        l_comb R M (k - Suc 0) s h\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 5. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (rule_tac A = \"h ` {j. j \\<le> k - Suc 0}\" and \n           B = \"h ` {j. j \\<le> k}\" and C = \"carrier M\" in  subset_trans)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k - Suc 0}\n                         \\<subseteq> h ` {j. j \\<le> k}\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k} \\<subseteq> carrier M\n 3. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow> A\n 4. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> k - Suc 0}\n 5. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        l_comb R M (k - Suc 0) s h\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 6. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (rule subsetI, simp add:image_def, erule exE, erule conjE,\n          cut_tac i = xa and j = \"k - Suc 0\" and k = k in le_trans,\n           assumption, subst Suc_le_mono[THEN sym], simp, blast, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> s \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow> A\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> k - Suc 0}\n 3. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        l_comb R M (k - Suc 0) s h\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 4. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>h s x.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        x \\<le> k - Suc 0\\<rbrakk>\n       \\<Longrightarrow> s x \\<in> A\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> k - Suc 0}\n 3. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        l_comb R M (k - Suc 0) s h\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 4. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (frule_tac x = x in le_pre_le[of _ k], simp add:Pi_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\\<rbrakk>\n       \\<Longrightarrow> h \\<in> {j. j \\<le> k - Suc 0} \\<rightarrow>\n                                 h ` {j. j \\<le> k - Suc 0}\n 2. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        l_comb R M (k - Suc 0) s h\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 3. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (rule Pi_I, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A; l_comb R M k s h = h k; \\<not> zeroring R;\n        ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        l_comb R M (k - Suc 0) s h \\<plusminus> s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        l_comb R M (k - Suc 0) s h\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        l_comb R M k s h \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A; h k = l_comb R M k s h;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> l_comb R M k s h = l_comb R M (Suc (k - Suc 0)) s h", "apply (unfold l_comb_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s\n                               h j) (k - Suc 0) \\<plusminus>\n        s k \\<cdot>\\<^sub>s h k =\n        h k;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n        h k =\n        \\<Sigma>\\<^sub>e M (\\<lambda>j.\n                               s j \\<cdot>\\<^sub>s h j) (k - Suc 0);\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (rotate_tac -2, frule sym,\n    thin_tac \"(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0)\",\n    thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0) \\<plusminus> s k \\<cdot>\\<^sub>s h k = h k\",\n    simp,\n    thin_tac \"\\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) (k - Suc 0) = (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>s h k\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (frule_tac x = \"s k\" in Ring.J_rad_unit [of R], assumption,\n           frule_tac f = s and A = \"{j. j \\<le> k}\" and B = A and x = k in \n           funcset_mem, simp, simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        \\<forall>y.\n           y \\<in> carrier R \\<longrightarrow>\n           Unit R\n            (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n             (-\\<^sub>a\\<^bsub>R\\<^esub> s\n    k) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n             y)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (frule Ring.ring_one[of R],\n           frule_tac a = \"1\\<^sub>r\\<^bsub>R\\<^esub>\" in forall_spec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        \\<forall>y.\n           y \\<in> carrier R \\<longrightarrow>\n           Unit R\n            (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n             (-\\<^sub>a\\<^bsub>R\\<^esub> s\n    k) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n             y);\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R;\n        Unit R\n         (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n          (-\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n          1\\<^sub>r\\<^bsub>R\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (frule_tac h = \"s k\" in Ring.ideal_subset[of R A], assumption+,\n           frule Ring.ring_is_ag[of R],\n           frule_tac x = \"s k\" in aGroup.ag_mOp_closed[of R], assumption,\n           thin_tac \"\\<forall>y. y \\<in> carrier R \\<longrightarrow> Unit R (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k)) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y)\",\n           simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R;\n        Unit R\n         (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> s k);\n        s k \\<in> carrier R; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (simp add:Unit_def, erule conjE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        b =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (simp add:Ring.ring_tOp_commute)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (frule_tac H = \"h ` {j. j \\<le> k - Suc 0}\" and r = b and \n          x = \"(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (s k))) \\<cdot>\\<^sub>s h k\" in linear_span_sc_closed[of A])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k - Suc 0} \\<subseteq> carrier M\n 2. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier R\n 3. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})\n 4. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>;\n        b \\<cdot>\\<^sub>s\n        ((1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n         h k)\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 5. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (rule_tac A = \"h ` {j. j \\<le> k - Suc 0}\" and B = \"h ` {j. j \\<le> k}\"\n           and C = \"carrier M\" in subset_trans,\n           rule subsetI, simp add:image_def, erule exE, erule conjE)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>h s b x xa.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A\n                       {y. \\<exists>x\\<le>k - Suc 0. y = h x};\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card {y. \\<exists>x\\<le>k. y = h x} = Suc k; 0 < k; Ring R;\n        H = {y. \\<exists>x\\<le>k. y = h x};\n        {y. \\<exists>x\\<le>k. y = h x} \\<subseteq> carrier M;\n        linear_span R M (carrier R) {y. \\<exists>x\\<le>k. y = h x} =\n        carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>;\n        xa \\<le> k - Suc 0; x = h xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<le>k. x = h xa\n 2. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> k} \\<subseteq> carrier M\n 3. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier R\n 4. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                         h k\n                         \\<in> linear_span R M A\n                                (h ` {j. j \\<le> k - Suc 0})\n 5. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>;\n        b \\<cdot>\\<^sub>s\n        ((1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n         h k)\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 6. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (frule_tac x = xa and n = k in le_pre_le, blast, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>;\n        b \\<cdot>\\<^sub>s\n        ((1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n         h k)\n        \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply (simp add:sc_assoc[THEN sym] sprod_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        s k \\<in> A;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>;\n        h k \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>{j. j \\<le> k} \\<rightarrow>\n   carrier M.\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply(simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h s b.\n       \\<lbrakk>(1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                 -\\<^sub>a\\<^bsub>R\\<^esub> s k) \\<cdot>\\<^sub>s\n                h k\n                \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0});\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k = h k;\n        \\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        h k \\<in> carrier M; \\<forall>x\\<le>k. s x \\<in> A;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R; s k \\<in> carrier R;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> s k \\<in> carrier R;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n        -\\<^sub>a\\<^bsub>R\\<^esub> s k\n        \\<in> carrier R;\n        b \\<in> carrier R;\n        b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n        (1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n         -\\<^sub>a\\<^bsub>R\\<^esub> s k) =\n        1\\<^sub>r\\<^bsub>R\\<^esub>;\n        h k \\<in> linear_span R M A (h ` {j. j \\<le> k - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            (\\<forall>x\\<le>k. ha x \\<in> carrier M) \\<and>\n                            h ` {j. j \\<le> k} = ha ` {j. j \\<le> k} \\<and>\n                            ha k\n                            \\<in> linear_span R M A\n                                   (ha ` {j. j \\<le> k - Suc 0})\n 2. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h s.\n       \\<lbrakk>\\<not> zeroring R; ideal R A; A \\<subseteq> J_rad R;\n        A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        card (h ` {j. j \\<le> k}) = Suc k; 0 < k; Ring R;\n        H = h ` {j. j \\<le> k}; h ` {j. j \\<le> k} \\<subseteq> carrier M;\n        linear_span R M (carrier R) (h ` {j. j \\<le> k}) = carrier M;\n        \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k\n        \\<in> carrier M;\n        s \\<in> {j. j \\<le> k} \\<rightarrow> A;\n        h k = \\<Sigma>\\<^sub>e M (\\<lambda>j. s j \\<cdot>\\<^sub>s h j) k;\n        s k \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) k =\n                         \\<Sigma>\\<^sub>e M (\\<lambda>j.\n          s j \\<cdot>\\<^sub>s h j) Suc (k - Suc 0)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) NAK:\"\\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A; A \\<subseteq> J_rad R;  \n       A \\<odot>\\<^bsub>R\\<^esub> M = carrier M \\<rbrakk> \\<Longrightarrow> carrier M = {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n     A \\<subseteq> J_rad R;\n     A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\\<rbrakk>\n    \\<Longrightarrow> carrier M = {\\<zero>}", "apply (cut_tac sc_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n     A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule NAKTr1, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j. \\<exists>L. finite_generator R M L \\<and> j = card L) =\n        card H\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (simp add:finite_generator_def, frule conjunct1, frule conjunct2,\n       fold finite_generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (case_tac \"H = {}\", simp add:generator_def linear_span_def,\n       frule_tac A = H in nonempty_card_pos1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        Suc 0 \\<le> card H\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (case_tac \"card H = Suc 0\", simp,\n       frule_tac A = H in nonempty_ex, erule exE, rename_tac H h,\n       frule_tac t = H and a1 = h in card1_tr0[THEN sym], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M {h};\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        Suc 0;\n        generator R M {h}; H = {h}\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac H = \"{h}\" in generator_sub_carrier,\n       frule sym, thin_tac \"A \\<odot>\\<^bsub>R\\<^esub> M = carrier M\", simp,\n       thin_tac \"carrier M = A \\<odot>\\<^bsub>R\\<^esub> M\", simp add:smodule_ideal_coeff_def,\n       simp add:generator_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h};\n        (LEAST j.\n            \\<exists>L.\n               finite L \\<and>\n               L \\<subseteq> carrier M \\<and>\n               linear_span R M (carrier R) L = carrier M \\<and>\n               j = card L) =\n        Suc 0;\n        h \\<in> carrier M \\<and>\n        linear_span R M (carrier R) {h} = carrier M;\n        H = {h}; h \\<in> linear_span R M A (carrier M)\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A (carrier M) = {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (erule conjE, rotate_tac -1, frule sym, \n        thin_tac \"linear_span R M (carrier R) {h} = carrier M\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h};\n        (LEAST j.\n            \\<exists>L.\n               finite L \\<and>\n               L \\<subseteq> linear_span R M (carrier R) {h} \\<and>\n               linear_span R M (carrier R) L =\n               linear_span R M (carrier R) {h} \\<and>\n               j = card L) =\n        Suc 0;\n        H = {h};\n        h \\<in> linear_span R M A (linear_span R M (carrier R) {h});\n        h \\<in> linear_span R M (carrier R) {h};\n        carrier M = linear_span R M (carrier R) {h}\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A\n                          (linear_span R M (carrier R) {h}) =\n                         {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rotate_tac -1, frule sym,\n        frule_tac a = h and A = \"linear_span R M (carrier R) {h}\" and\n                  B = \"carrier M\" in eq_set_inc, assumption+,\n        frule_tac a = h and A = \"carrier M\" in singleton_sub)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>carrier M = linear_span R M (carrier R) {h};\n        \\<not> zeroring R; M fgover R; ideal R A; A \\<subseteq> J_rad R;\n        Ring R; finite_generator R M {h};\n        (LEAST j.\n            \\<exists>L.\n               finite L \\<and>\n               L \\<subseteq> linear_span R M (carrier R) {h} \\<and>\n               linear_span R M (carrier R) L =\n               linear_span R M (carrier R) {h} \\<and>\n               j = card L) =\n        Suc 0;\n        H = {h};\n        h \\<in> linear_span R M A (linear_span R M (carrier R) {h});\n        h \\<in> linear_span R M (carrier R) {h};\n        linear_span R M (carrier R) {h} = carrier M; h \\<in> carrier M;\n        {h} \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A\n                          (linear_span R M (carrier R) {h}) =\n                         {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac H = \"{h}\" in l_spanA_l_span[of A], assumption+,\n        thin_tac \"carrier M = linear_span R M (carrier R) {h}\",\n        thin_tac \"linear_span R M (carrier R) {h} = carrier M\", simp,\n        thin_tac \"h \\<in> linear_span R M (carrier R) {h}\",\n        thin_tac \"linear_span R M A (linear_span R M (carrier R) {h}) =\n           linear_span R M A {h}\",\n        thin_tac \"(LEAST j. \\<exists>L. finite L \\<and>\n                   L \\<subseteq> linear_span R M (carrier R) {h} \\<and>\n                   linear_span R M (carrier R) L =\n                   linear_span R M (carrier R) {h} \\<and>\n                   j = card L) = Suc 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h}; H = {h};\n        h \\<in> linear_span R M A {h}; h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A {h} = {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac h = h and x = h in mem_single_l_span1[of A],\n        assumption+, erule bexE,\n       frule_tac h = a in Ring.ideal_subset[of R A], assumption+,\n       frule_tac a = a and m = h in sc_mem, assumption+,\n       frule_tac x = \"a \\<cdot>\\<^sub>s h\" in ag_mOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h a.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h}; H = {h};\n        h \\<in> linear_span R M A {h}; h \\<in> carrier M; a \\<in> A;\n        h = a \\<cdot>\\<^sub>s h; a \\<in> carrier R;\n        a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        -\\<^sub>a a \\<cdot>\\<^sub>s h \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A {h} = {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac a = h and b = \"a \\<cdot>\\<^sub>s h\" and c = \"-\\<^sub>a (a \\<cdot>\\<^sub>s h)\" in\n       ag_pOp_add_r, assumption+,\n       thin_tac \"h = a \\<cdot>\\<^sub>s h\", simp add:ag_r_inv1,\n       simp add:sc_minus_am1,\n       frule Ring.ring_is_ag[of R],\n       frule_tac x = a in aGroup.ag_mOp_closed, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h a.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h}; H = {h};\n        h \\<in> linear_span R M A {h}; h \\<in> carrier M; a \\<in> A;\n        a \\<in> carrier R; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        h \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h =\n        \\<zero>;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A {h} = {\\<zero>}\n 2. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (subgoal_tac \"h \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h = 1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h \\<plusminus>  (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>H h a.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h}; H = {h};\n        h \\<in> linear_span R M A {h}; h \\<in> carrier M; a \\<in> A;\n        a \\<in> carrier R; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s h \\<plusminus>\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h =\n        \\<zero>;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R;\n        h \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> linear_span R M A {h} = {\\<zero>}\n 2. \\<And>H h a.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; Ring R; finite_generator R M {h}; H = {h};\n        h \\<in> linear_span R M A {h}; h \\<in> carrier M; a \\<in> A;\n        a \\<in> carrier R; a \\<cdot>\\<^sub>s h \\<in> carrier M;\n        (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h \\<in> carrier M;\n        h \\<plusminus> (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h =\n        \\<zero>;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h =\n                         1\\<^sub>r\\<^bsub>R\\<^esub> \\<cdot>\\<^sub>s\n                         h \\<plusminus>\n                         (-\\<^sub>a\\<^bsub>R\\<^esub> a) \\<cdot>\\<^sub>s h\n 3. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule Ring.ring_one[of R],\n       simp add:sc_l_distr[THEN sym],\n       frule_tac x = a in Ring.J_rad_unit [of R], assumption, \n       simp add:subsetD,\n       drule_tac a = \"1\\<^sub>r\\<^bsub>R\\<^esub>\" in forall_spec, assumption,\n       simp add:Ring.ring_r_one,\n       simp add:Unit_def, erule conjE, erule bexE,\n       simp add:Ring.ring_tOp_commute,\n       frule_tac a = b and b = \"1\\<^sub>r\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> a\" and m = h in sc_assoc,\n       rule aGroup.ag_pOp_closed, assumption+, simp add:sprod_one sc_a_0,\n       simp add:l_span_zero, simp add:sprod_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<le> card H;\n        card H \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rotate_tac -1, frule not_sym,\n        frule_tac m = \"Suc 0\" and n = \"card H\" in noteq_le_less, assumption,\n        thin_tac \"Suc 0 \\<le> card H\", thin_tac \"card H \\<noteq> Suc 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 < card H\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac a = \"Suc 0\" and b = \"card H\" and c = \"Suc 0\" in\n                  diff_less_mono, simp,\n        thin_tac \"Suc 0 < card H\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac H = H and k = \"card H - Suc 0\" in NAKTr5[of A],\n         assumption+, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        \\<exists>h\\<in>{j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M.\n           H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n           h (card H - Suc 0)\n           \\<in> linear_span R M A\n                  (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A\n               (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac H = H and ?H1.0 = \"h ` {j. j \\<le> card H - Suc 0 - Suc 0}\" in\n        generator_generator,\n       frule_tac f = h and A = \"{j. j \\<le> card H - Suc 0}\" and B = \"carrier M\"\n       and ?A1.0 = \"{j. j \\<le> card H - Suc 0 - Suc 0}\" in image_sub,\n       rule subsetI, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 < card H;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 < card H;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (cut_tac f = h and n = \"card H - Suc (Suc 0)\" in image_Nset_Suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 < card H;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h ` {j. j \\<le> Suc (card H - Suc (Suc 0))} =\n        insert (h (Suc (card H - Suc (Suc 0))))\n         (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac m = \"Suc 0\" and n = \"card H\" in Suc_leI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 < card H;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h ` {j. j \\<le> Suc (card H - Suc (Suc 0))} =\n        insert (h (Suc (card H - Suc (Suc 0))))\n         (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (simp add:Suc_Suc_Tr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac f = h and A = \"{j. j \\<le> card H - Suc 0}\" and \n          B = \"carrier M\" and ?A1.0 = \"{j. j \\<le> card H - Suc 0 - Suc 0}\" in \n         image_sub,\n         rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc 0 - Suc 0}\n        \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac H = \"h ` {j. j \\<le> card H - Suc 0 - Suc 0}\" in \n          lin_span_coeff_mono[of A], simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac c = \"h (card H - Suc 0)\" and A = \n          \"linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\" and \n           B = \"linear_span R M (carrier R)\n              (h ` {j. j \\<le> card H - Suc (Suc 0)})\" in subsetD, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> linear_span R M (carrier R)\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rule_tac A = H and B = \"insert (h (card H - Suc 0)) \n                        (h ` {j. j \\<le> card H - Suc (Suc 0)})\" and \n          C = \"linear_span R M (carrier R)\n                  (h ` {j. j \\<le> card H - Suc (Suc 0)})\" in subset_trans)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> H \\<subseteq> insert (h (card H - Suc 0))\n  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> insert (h (card H - Suc 0))\n                          (h ` {j. j \\<le> card H - Suc (Suc 0)})\n                         \\<subseteq> linear_span R M (carrier R)\n(h ` {j. j \\<le> card H - Suc (Suc 0)})\n 3. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> insert (h (card H - Suc 0))\n                          (h ` {j. j \\<le> card H - Suc (Suc 0)})\n                         \\<subseteq> linear_span R M (carrier R)\n(h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rule_tac A = \"h ` {j. j \\<le> card H - Suc (Suc 0)}\" and \n         B = \"linear_span R M (carrier R)\n           (h ` {j. j \\<le> card H - Suc (Suc 0)})\" and a = \"h (card H - Suc 0)\" \n        in insert_sub)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> card H - Suc (Suc 0)}\n                         \\<subseteq> linear_span R M (carrier R)\n(h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> h (card H - Suc 0)\n                         \\<in> linear_span R M (carrier R)\n                                (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 3. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>H h x.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        x \\<in> h ` {j. j \\<le> card H - Suc (Suc 0)}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R M (carrier R)\n                                  (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {};\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0};\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        H =\n        insert (h (card H - Suc 0)) (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        Suc (Suc 0) \\<le> card H;\n        h ` {j. j \\<le> card H - Suc (Suc 0)} \\<subseteq> carrier M;\n        linear_span R M A (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<subseteq> linear_span R M (carrier R)\n                     (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        h (card H - Suc 0)\n        \\<in> linear_span R M (carrier R)\n               (h ` {j. j \\<le> card H - Suc (Suc 0)})\\<rbrakk>\n       \\<Longrightarrow> h (card H - Suc 0)\n                         \\<in> linear_span R M (carrier R)\n                                (h ` {j. j \\<le> card H - Suc (Suc 0)})\n 3. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rule_tac H = \"h ` {j. j \\<le> card H - Suc (Suc 0)}\" and h = x in\n         h_in_linear_span, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac H = \"h ` {j. j \\<le> card H - Suc 0 - Suc 0}\" in NAKTr3)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> h ` {j. j \\<le> card H - Suc 0 - Suc 0}\n                         \\<subseteq> carrier M\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> finite (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\n 3. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> card (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\n                         < (LEAST j.\n                               \\<exists>L.\n                                  finite_generator R M L \\<and> j = card L)\n 4. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (simp add:generator_sub_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> finite (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> card (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\n                         < (LEAST j.\n                               \\<exists>L.\n                                  finite_generator R M L \\<and> j = card L)\n 3. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (rule finite_imageI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> card (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\n                         < (LEAST j.\n                               \\<exists>L.\n                                  finite_generator R M L \\<and> j = card L)\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (thin_tac \"H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n           h (card H - Suc 0)\n           \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> card (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\n                         < (LEAST j.\n                               \\<exists>L.\n                                  finite_generator R M L \\<and> j = card L)\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (cut_tac k = \"card H - Suc 0 - Suc 0\" in finite_Collect_le_nat,\n         frule_tac A = \"{j. j \\<le> card H - Suc 0 - Suc 0}\" and f = h in \n                   card_image_le,\n         simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 < card H;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        generator R M (h ` {j. j \\<le> card H - Suc (Suc 0)});\n        card (h ` {j. j \\<le> card H - Suc (Suc 0)})\n        \\<le> Suc (card H - Suc (Suc 0))\\<rbrakk>\n       \\<Longrightarrow> card (h ` {j. j \\<le> card H - Suc (Suc 0)})\n                         < (LEAST j.\n                               \\<exists>L.\n                                  finite_generator R M L \\<and> j = card L)\n 2. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (frule_tac m = \"Suc 0\" and n = \"card H\" in  Suc_leI,\n         simp add:Suc_Suc_Tr, simp add:finite_generator_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "(*\n  apply (rule_tac i = \"card (h ` {j. j \\<le> card H - Suc (Suc 0)})\" and \n         j = \"card H - Suc 0\" and k = \"card H\" in Nat.le_less_trans, assumption+)  \n  apply simp*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H h.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; ideal R A;\n        A \\<subseteq> J_rad R; A \\<odot>\\<^bsub>R\\<^esub> M = carrier M;\n        Ring R; finite_generator R M H;\n        (LEAST j.\n            \\<exists>L. finite L \\<and> generator R M L \\<and> j = card L) =\n        card H;\n        finite H; generator R M H; H \\<noteq> {}; Suc 0 \\<noteq> card H;\n        Suc 0 - Suc 0 < card H - Suc 0;\n        h \\<in> {j. j \\<le> card H - Suc 0} \\<rightarrow> carrier M;\n        H = h ` {j. j \\<le> card H - Suc 0} \\<and>\n        h (card H - Suc 0)\n        \\<in> linear_span R M A (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        generator R M (h ` {j. j \\<le> card H - Suc 0 - Suc 0});\n        \\<not> finite_generator R M\n                (h ` {j. j \\<le> card H - Suc 0 - Suc 0})\\<rbrakk>\n       \\<Longrightarrow> carrier M = {\\<zero>}", "apply (cut_tac k = \"card H - Suc 0 - Suc 0\" in finite_Collect_le_nat,\n         frule_tac F = \"{j. j \\<le> card H - Suc 0 - Suc 0}\" and h = h in \n         finite_imageI, simp add:finite_generator_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) fg_qmodule:\"\\<lbrakk> M fgover R; submodule R M N\\<rbrakk> \\<Longrightarrow>\n                          (M /\\<^sub>m N) fgover R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>M fgover R; submodule R M N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m N fgover R", "apply (frule mpj_mHom[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m N fgover R", "apply (frule mpj_surjec [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> M /\\<^sub>m N fgover R", "apply (rule surjec_finitely_gen [of \"M /\\<^sub>m N\" \"mpj M N\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> R module M /\\<^sub>m N\n 2. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> mpj M N \\<in> mHom R M (M /\\<^sub>m N)\n 3. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\n 4. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> M fgover R", "apply (simp add:qmodule_module)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> mpj M N \\<in> mHom R M (M /\\<^sub>m N)\n 2. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\n 3. \\<lbrakk>M fgover R; submodule R M N;\n     mpj M N \\<in> mHom R M (M /\\<^sub>m N);\n     surjec\\<^bsub>M,M /\\<^sub>m N\\<^esub> mpj M N\\<rbrakk>\n    \\<Longrightarrow> M fgover R", "apply assumption+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Module) NAK1:\"\\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; \n      ideal R A; A \\<subseteq> J_rad R;  carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N \\<rbrakk> \\<Longrightarrow> carrier M = N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> carrier M = N", "apply (subgoal_tac \"A \\<odot>\\<^bsub>R\\<^esub> (M /\\<^sub>m N) = carrier (M /\\<^sub>m N)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n     carrier (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> carrier M = N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (frule fg_qmodule [of N], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N = carrier (M /\\<^sub>m N);\n     M /\\<^sub>m N fgover R\\<rbrakk>\n    \\<Longrightarrow> carrier M = N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (frule qmodule_module [of N])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N = carrier (M /\\<^sub>m N);\n     M /\\<^sub>m N fgover R; R module M /\\<^sub>m N\\<rbrakk>\n    \\<Longrightarrow> carrier M = N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (frule Module.NAK [of \"M /\\<^sub>m N\" R \"A\"], assumption+,\n       thin_tac \"R module M /\\<^sub>m N\", thin_tac \"M /\\<^sub>m N fgover R\",\n       thin_tac \"A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N = carrier (M /\\<^sub>m N)\",\n       thin_tac \"carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier (M /\\<^sub>m N) =\n     {\\<zero>\\<^bsub>M /\\<^sub>m N\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> carrier M = N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (simp add:qmodule_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> carrier M = N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> carrier M \\<subseteq> N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> N \\<subseteq> carrier M\n 3. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; set_mr_cos M N = {N};\n        x \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> N \\<subseteq> carrier M\n 3. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (frule_tac m = x in set_mr_cos_mem[of N], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; set_mr_cos M N = {N}; x \\<in> carrier M;\n        x \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> N \\<subseteq> carrier M\n 3. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; set_mr_cos M N = {N}; x \\<in> carrier M;\n        x \\<uplus>\\<^bsub>M\\<^esub> N = N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> N\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> N \\<subseteq> carrier M\n 3. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (frule_tac m = x in m_in_mr_coset[of N], assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R; set_mr_cos M N = {N}\\<rbrakk>\n    \\<Longrightarrow> N \\<subseteq> carrier M\n 2. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (simp add:submodule_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> A \\<odot>\\<^bsub>R\\<^esub> M /\\<^sub>m N =\n                      carrier (M /\\<^sub>m N)", "apply (subst smodule_ideal_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\\<rbrakk>\n    \\<Longrightarrow> linear_span R (M /\\<^sub>m N) A\n                       (carrier (M /\\<^sub>m N)) =\n                      carrier (M /\\<^sub>m N)", "apply (frule qmodule_module [of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     R module M /\\<^sub>m N\\<rbrakk>\n    \\<Longrightarrow> linear_span R (M /\\<^sub>m N) A\n                       (carrier (M /\\<^sub>m N)) =\n                      carrier (M /\\<^sub>m N)", "apply (frule Module.lin_span_sub_carrier[of \"M /\\<^sub>m N\" R A \"carrier (M /\\<^sub>m N)\"],\n        assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     R module M /\\<^sub>m N;\n     linear_span R (M /\\<^sub>m N) A (carrier (M /\\<^sub>m N))\n     \\<subseteq> carrier (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> linear_span R (M /\\<^sub>m N) A\n                       (carrier (M /\\<^sub>m N)) =\n                      carrier (M /\\<^sub>m N)", "apply (rule equalityI, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     R module M /\\<^sub>m N;\n     linear_span R (M /\\<^sub>m N) A (carrier (M /\\<^sub>m N))\n     \\<subseteq> carrier (M /\\<^sub>m N)\\<rbrakk>\n    \\<Longrightarrow> carrier (M /\\<^sub>m N)\n                      \\<subseteq> linear_span R (M /\\<^sub>m N) A\n                                   (carrier (M /\\<^sub>m N))", "apply (thin_tac \"linear_span R (M /\\<^sub>m N) A (carrier (M /\\<^sub>m N)) \\<subseteq> \n                                                      carrier (M /\\<^sub>m N)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n     A \\<subseteq> J_rad R;\n     carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n     R module M /\\<^sub>m N\\<rbrakk>\n    \\<Longrightarrow> carrier (M /\\<^sub>m N)\n                      \\<subseteq> linear_span R (M /\\<^sub>m N) A\n                                   (carrier (M /\\<^sub>m N))", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N; x \\<in> carrier (M /\\<^sub>m N)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (M /\\<^sub>m N) A\n                                  (carrier (M /\\<^sub>m N))", "apply (simp add:qmodule_carr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N; x \\<in> set_mr_cos M N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (M /\\<^sub>m N) A\n                                  (set_mr_cos M N)", "apply (frule_tac x = x in mem_set_mr_cos[of N], assumption, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N; x \\<in> set_mr_cos M N; m \\<in> carrier M;\n        x = m \\<uplus>\\<^bsub>M\\<^esub> N\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (M /\\<^sub>m N) A\n                                  (set_mr_cos M N)", "apply (frule smodule_ideal_coeff_is_Submodule[of A],\n        frule submodule_subset,\n        frule submodule_subset[of \"A \\<odot>\\<^bsub>R\\<^esub> M\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N; x \\<in> set_mr_cos M N; m \\<in> carrier M;\n        x = m \\<uplus>\\<^bsub>M\\<^esub> N;\n        submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M);\n        N \\<subseteq> carrier M;\n        A \\<odot>\\<^bsub>R\\<^esub> M \\<subseteq> carrier M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (M /\\<^sub>m N) A\n                                  (set_mr_cos M N)", "apply (frule_tac x = m in mem_set_sum[of \"A \\<odot>\\<^bsub>R\\<^esub> M\" \"N\"], assumption+,\n        simp, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N; x \\<in> set_mr_cos M N; m \\<in> carrier M;\n        x = m \\<uplus>\\<^bsub>M\\<^esub> N;\n        submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M);\n        N \\<subseteq> carrier M;\n        A \\<odot>\\<^bsub>R\\<^esub> M \\<subseteq> carrier M;\n        h \\<in> A \\<odot>\\<^bsub>R\\<^esub> M; k \\<in> N;\n        m = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> linear_span R (M /\\<^sub>m N) A\n                                  (set_mr_cos M N)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N;\n        (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        h \\<plusminus> k \\<in> A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        x = (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N;\n        submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M);\n        N \\<subseteq> A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        A \\<odot>\\<^bsub>R\\<^esub> M\n        \\<subseteq> A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        h \\<in> A \\<odot>\\<^bsub>R\\<^esub> M; k \\<in> N;\n        m = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (frule submodule_asubg[of N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R;\n        carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        R module M /\\<^sub>m N;\n        (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        h \\<plusminus> k \\<in> A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        x = (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N;\n        submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M);\n        N \\<subseteq> A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        A \\<odot>\\<^bsub>R\\<^esub> M\n        \\<subseteq> A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N;\n        h \\<in> A \\<odot>\\<^bsub>R\\<^esub> M; k \\<in> N;\n        m = h \\<plusminus> k; M +> N\\<rbrakk>\n       \\<Longrightarrow> (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (frule sym, thin_tac \"carrier M = A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; R module M /\\<^sub>m N;\n        (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        h \\<plusminus> k \\<in> carrier M;\n        x = (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N;\n        submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M);\n        N \\<subseteq> carrier M;\n        A \\<odot>\\<^bsub>R\\<^esub> M \\<subseteq> carrier M;\n        h \\<in> A \\<odot>\\<^bsub>R\\<^esub> M; k \\<in> N;\n        m = h \\<plusminus> k; M +> N;\n        A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N = carrier M\\<rbrakk>\n       \\<Longrightarrow> (h \\<plusminus> k) \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (frule_tac c = h in subsetD[of \"A \\<odot>\\<^bsub>R\\<^esub> M\" \"carrier M\"], assumption+,\n         frule_tac c = k in subsetD[of N \"carrier M\"], assumption+,\n         frule_tac x = h and y = k in ag_pOp_commute, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; R module M /\\<^sub>m N;\n        (k \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        k \\<plusminus> h \\<in> carrier M;\n        x = (k \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> N;\n        submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M);\n        N \\<subseteq> carrier M;\n        A \\<odot>\\<^bsub>R\\<^esub> M \\<subseteq> carrier M;\n        h \\<in> A \\<odot>\\<^bsub>R\\<^esub> M; k \\<in> N;\n        m = k \\<plusminus> h; M +> N;\n        A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N = carrier M;\n        h \\<in> carrier M; k \\<in> carrier M;\n        h \\<plusminus> k = k \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> (k \\<plusminus> h) \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (simp add:arcos_fixed[THEN sym, of N], thin_tac \"h \\<plusminus> k = k \\<plusminus> h\",\n         thin_tac \"m = k \\<plusminus> h\",\n         thin_tac \"submodule R M (A \\<odot>\\<^bsub>R\\<^esub> M)\",\n         thin_tac \"A \\<odot>\\<^bsub>R\\<^esub> M \\<subseteq> carrier M\",\n         thin_tac \"A \\<odot>\\<^bsub>R\\<^esub> M \\<minusplus> N = carrier M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x m h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; R module M /\\<^sub>m N;\n        h \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        k \\<plusminus> h \\<in> carrier M; x = h \\<uplus>\\<^bsub>M\\<^esub> N;\n        N \\<subseteq> carrier M; h \\<in> A \\<odot>\\<^bsub>R\\<^esub> M;\n        k \\<in> N; M +> N; h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (simp add:smodule_ideal_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; R module M /\\<^sub>m N;\n        h \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        k \\<plusminus> h \\<in> carrier M; x = h \\<uplus>\\<^bsub>M\\<^esub> N;\n        N \\<subseteq> carrier M; h \\<in> linear_span R M A (carrier M);\n        k \\<in> N; M +> N; h \\<in> carrier M; k \\<in> carrier M\\<rbrakk>\n       \\<Longrightarrow> h \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (frule_tac h = h in linmap_im_linspan1 [of A \"M /\\<^sub>m N\" \"mpj M N\" \n         \"carrier M\"], assumption+,\n         rule mpj_mHom[of N], assumption, simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>\\<not> zeroring R; M fgover R; submodule R M N; ideal R A;\n        A \\<subseteq> J_rad R; R module M /\\<^sub>m N;\n        h \\<uplus>\\<^bsub>M\\<^esub> N \\<in> set_mr_cos M N;\n        k \\<plusminus> h \\<in> carrier M; x = h \\<uplus>\\<^bsub>M\\<^esub> N;\n        N \\<subseteq> carrier M; h \\<in> linear_span R M A (carrier M);\n        k \\<in> N; M +> N; h \\<in> carrier M; k \\<in> carrier M;\n        mpj M N h\n        \\<in> linear_span R (M /\\<^sub>m N) A (mpj M N ` carrier M)\\<rbrakk>\n       \\<Longrightarrow> h \\<uplus>\\<^bsub>M\\<^esub> N\n                         \\<in> linear_span R (M /\\<^sub>m N) A\n                                (set_mr_cos M N)", "apply (frule_tac m = h in elem_mpj[of _ N], assumption,\n         frule_tac mpj_surjec[of N], \n         simp add:surjec_def surj_to_def qmodule_carr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Direct sum and direct products of modules\""], ["", "definition\n  prodM_sprod :: \"[('r, 'm) Ring_scheme, 'i set, \n      'i \\<Rightarrow> ('a, 'r, 'm1) Module_scheme] \\<Rightarrow>  'r \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow>  ('i \\<Rightarrow> 'a)\" where\n  \"prodM_sprod R I A = (\\<lambda>a\\<in>carrier R. \\<lambda>g\\<in>carr_prodag I A. \n                                         (\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>(A j)\\<^esub> (g j)))\""], ["", "definition\n  prodM :: \"[('r, 'm) Ring_scheme, 'i set, 'i \\<Rightarrow> ('a, 'r, 'm1) Module_scheme] \\<Rightarrow>\n     \\<lparr> carrier:: ('i \\<Rightarrow> 'a) set, \n       pop::['i \\<Rightarrow> 'a, 'i \\<Rightarrow> 'a] \\<Rightarrow> ('i \\<Rightarrow> 'a),\n       mop:: ('i \\<Rightarrow> 'a) \\<Rightarrow> ('i \\<Rightarrow> 'a), zero::('i \\<Rightarrow> 'a), \n       sprod :: ['r, 'i \\<Rightarrow> 'a] \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<rparr>\" where\n  \"prodM R I A = \\<lparr>carrier = carr_prodag I A, \n    pop = prod_pOp I A, mop = prod_mOp I A,\n    zero = prod_zero I A, sprod = prodM_sprod R I A \\<rparr>\""], ["", "definition\n  mProject :: \"[('r, 'm) Ring_scheme, 'i set,\n             'i \\<Rightarrow> ('a, 'r, 'more) Module_scheme, 'i] \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow> 'a\" where\n  \"mProject R I A j = (\\<lambda>f\\<in>carr_prodag I A. f j)\""], ["", "abbreviation\n  PRODMODULES  (\"(3m\\<Pi>\\<^bsub>_ _\\<^esub> _)\" [72,72,73]72) where\n  \"m\\<Pi>\\<^bsub>R I\\<^esub> A == prodM R I A\""], ["", "lemma (in Ring) prodM_carr:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i))\\<rbrakk> \\<Longrightarrow> \n                                carrier (prodM R I M) = carr_prodag I M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M) = carr_prodag I M", "apply (simp add:prodM_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prodM_mem_eq:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); \n      m1 \\<in> carrier (prodM R I M); m2 \\<in> carrier (prodM R I M); \n      \\<forall>i\\<in>I. m1 i = m2 i \\<rbrakk> \\<Longrightarrow> m1 = m2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     m1 \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n     m2 \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n     \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> m1 = m2", "apply (simp add:prodM_carr [of I M])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> m1 = m2", "apply (rule carr_prodag_mem_eq [of I M])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> m1 \\<in> carr_prodag I M\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> m2 \\<in> carr_prodag I M\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I. m1 l = m2 l", "apply (rule ballI, drule_tac x = k in bspec, assumption,\n       simp add:Module.module_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> m1 \\<in> carr_prodag I M\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> m2 \\<in> carr_prodag I M\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i; m1 \\<in> carr_prodag I M;\n     m2 \\<in> carr_prodag I M; \\<forall>i\\<in>I. m1 i = m2 i\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I. m1 l = m2 l", "apply assumption+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prodM_sprod_mem:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); a \\<in> carrier R;\n       m \\<in> carr_prodag I M\\<rbrakk> \\<Longrightarrow> prodM_sprod R I M a m \\<in> carr_prodag I M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> prodM_sprod R I M a m \\<in> carr_prodag I M", "apply (simp add:prodM_sprod_def carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I \\<and>\n     m \\<in> I \\<rightarrow> Un_carrier I M \\<and>\n     (\\<forall>i\\<in>I. m i \\<in> carrier (M i))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                          a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n                      \\<in> I \\<rightarrow> Un_carrier I M \\<and>\n                      (\\<forall>i\\<in>I.\n                          a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                          \\<in> carrier (M i))", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                          a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n                      \\<in> I \\<rightarrow> Un_carrier I M \\<and>\n                      (\\<forall>i\\<in>I.\n                          a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                          \\<in> carrier (M i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                          a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n                      \\<in> I \\<rightarrow> Un_carrier I M\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                         \\<in> carrier (M i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n        \\<forall>i\\<in>I. m i \\<in> carrier (M i); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n                          x\n                         \\<in> Un_carrier I M\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                         \\<in> carrier (M i)", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> extensional I;\n        m \\<in> I \\<rightarrow>\n                \\<Union> {X. \\<exists>i\\<in>I. X = carrier (M i)};\n        \\<forall>i\\<in>I. m i \\<in> carrier (M i); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (M i)) \\<and>\n                            a \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x\n                            \\<in> xa\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                         \\<in> carrier (M i)", "apply (drule_tac x = x in bspec, assumption,\n        drule_tac x = x in bspec, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> extensional I;\n        m \\<in> I \\<rightarrow>\n                \\<Union> {X. \\<exists>i\\<in>I. X = carrier (M i)};\n        x \\<in> I; R module M x; m x \\<in> carrier (M x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (M i)) \\<and>\n                            a \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x\n                            \\<in> xa\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                         \\<in> carrier (M i)", "apply (frule_tac R = R and M = \"M x\" and a = a and m = \"m x\" in\n        Module.sc_mem, assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. m i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                         \\<in> carrier (M i)", "apply (rule ballI, \n        drule_tac x = i in bspec, assumption,\n        drule_tac x = i in bspec, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> extensional I;\n        m \\<in> I \\<rightarrow> Un_carrier I M; i \\<in> I; R module M i;\n        m i \\<in> carrier (M i)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n                         \\<in> carrier (M i)", "apply (frule_tac M = \"M i\" and a = a and m = \"m i\" in \n            Module.sc_mem [of _ \"R\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prodM_sprod_val:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); a \\<in> carrier R;\n m \\<in> carr_prodag I M; j \\<in> I\\<rbrakk> \\<Longrightarrow> (prodM_sprod R I M a m) j = a \\<cdot>\\<^sub>s\\<^bsub>(M j)\\<^esub> (m j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     m \\<in> carr_prodag I M; j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> prodM_sprod R I M a m j =\n                      a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j", "apply (simp add:prodM_sprod_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prodM_Module:\"\\<forall>i\\<in>I. (R module (M i)) \\<Longrightarrow> \n                                      R module (prodM R I M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    R module m\\<Pi>\\<^bsub>R I\\<^esub> M", "apply (rule Module.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    aGroup (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (cut_tac prodag_aGroup[of I M])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> M)\\<rbrakk>\n    \\<Longrightarrow> aGroup (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (simp add:prodM_def prodag_def aGroup_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_prodag I M \\<longrightarrow>\n                         prod_pOp I M a (prod_zero I M) = a\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (erule conjE)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M;\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I M \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_prodag I M \\<longrightarrow>\n                prod_pOp I M (prod_pOp I M a b) c =\n                prod_pOp I M a (prod_pOp I M b c)));\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I M \\<longrightarrow>\n            prod_pOp I M a b = prod_pOp I M b a);\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M;\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        prod_pOp I M (prod_mOp I M a) a = prod_zero I M;\n     prod_zero I M \\<in> carr_prodag I M;\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        prod_pOp I M (prod_zero I M) a = a\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_prodag I M \\<longrightarrow>\n                         prod_pOp I M a (prod_zero I M) = a\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        prod_pOp I M\n        \\<in> carr_prodag I M \\<rightarrow>\n              carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           (\\<forall>b.\n               b \\<in> carr_prodag I M \\<longrightarrow>\n               (\\<forall>c.\n                   c \\<in> carr_prodag I M \\<longrightarrow>\n                   prod_pOp I M (prod_pOp I M a b) c =\n                   prod_pOp I M a (prod_pOp I M b c)));\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           (\\<forall>b.\n               b \\<in> carr_prodag I M \\<longrightarrow>\n               prod_pOp I M a b = prod_pOp I M b a);\n        prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_mOp I M a) a = prod_zero I M;\n        prod_zero I M \\<in> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_zero I M) a = a;\n        a \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M a (prod_zero I M) = a\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (rotate_tac -2,\n        frule_tac a = a in forall_spec, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>a.\n                   a \\<in> carr_prodag I M \\<longrightarrow>\n                   prod_pOp I M (prod_zero I M) a = a;\n        a \\<in> carr_prodag I M; \\<forall>i\\<in>I. R module M i;\n        prod_pOp I M\n        \\<in> carr_prodag I M \\<rightarrow>\n              carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           (\\<forall>b.\n               b \\<in> carr_prodag I M \\<longrightarrow>\n               (\\<forall>c.\n                   c \\<in> carr_prodag I M \\<longrightarrow>\n                   prod_pOp I M (prod_pOp I M a b) c =\n                   prod_pOp I M a (prod_pOp I M b c)));\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           (\\<forall>b.\n               b \\<in> carr_prodag I M \\<longrightarrow>\n               prod_pOp I M a b = prod_pOp I M b a);\n        prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_mOp I M a) a = prod_zero I M;\n        prod_zero I M \\<in> carr_prodag I M;\n        prod_pOp I M (prod_zero I M) a = a\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M a (prod_zero I M) = a\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (thin_tac \"\\<forall>a. a \\<in> carr_prodag I M \\<longrightarrow> \n                                      prod_pOp I M (prod_zero I M) a = a\",\n        thin_tac \"\\<forall>i\\<in>I. R module M i\",\n        thin_tac \"\\<forall>a. a \\<in> carr_prodag I M \\<longrightarrow> (\\<forall>b. b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c. c \\<in> carr_prodag I M \\<longrightarrow> prod_pOp I M (prod_pOp I M a b) c =\n                       prod_pOp I M a (prod_pOp I M b c)))\",\n        thin_tac \"\\<forall>a. a \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M (prod_mOp I M a) a = prod_zero I M\",\n        frule_tac a = \"prod_zero I M\" in forall_spec, assumption,\n        thin_tac \"\\<forall>a. a \\<in> carr_prodag I M \\<longrightarrow> (\\<forall>b. b \\<in> carr_prodag I M \\<longrightarrow>\n                  prod_pOp I M a b = prod_pOp I M b a)\",\n        frule_tac a = a in forall_spec, assumption,\n        thin_tac \"\\<forall>b. b \\<in> carr_prodag I M \\<longrightarrow> prod_pOp I M (prod_zero I M) b =\n             prod_pOp I M b (prod_zero I M)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (rule ballI, drule_tac x = k in bspec, assumption,\n        simp add:Module.module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (m\\<Pi>\\<^bsub>R I\\<^esub> M) R", "apply (rule Module_axioms.intro)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow> Ring R\n 2. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m\n                         \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m\n 4. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 5. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 6. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac Ring, assumption)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m\n                         \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m\n 3. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 4. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 5. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr, simp add:prodM_def prodM_sprod_mem)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr, simp add:prodM_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac a = a and m = m in prodM_sprod_mem[of I M], assumption+,\n        frule_tac a = b and m = m in prodM_sprod_mem[of I M], assumption+,\n       (cut_tac ring_is_ag,\n        frule_tac x = a and y = b in aGroup.ag_pOp_closed[of R], assumption+),\n        frule_tac a = \"a \\<plusminus> b\" and m = m in prodM_sprod_mem[of I M], \n        assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M a m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M (a \\<plusminus> b) m\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule prodM_mem_eq[of I M], assumption, simp add:prodM_carr)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M a m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M (a \\<plusminus> b) m\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n                         \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M a m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M (a \\<plusminus> b) m\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M (a \\<plusminus> b) m i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M b m) i\n 3. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 4. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 5. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr,\n        rule_tac X = \"prodM_sprod R I M a m\" and Y = \"prodM_sprod R I M b m\" \n        in prod_pOp_mem[of I M],\n        (rule ballI, drule_tac x = k in bspec, assumption,\n        simp add:Module.module_is_ag),\n        assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M a m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M (a \\<plusminus> b) m\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M (a \\<plusminus> b) m i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M b m) i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule ballI,\n        simp add:prodM_sprod_def prod_pOp_def,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\",\n        thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. (a \\<plusminus> b) \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n        simp add:carr_prodag_def, (erule conjE)+,\n        drule_tac x = i in bspec, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m i.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<plusminus> b \\<in> carrier R; i \\<in> I; R module M i;\n        m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n        m i \\<in> carrier (M i)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac Ring, simp add:Module.sc_l_distr)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M);\n        n \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         n\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac X = m and Y = n in prod_pOp_mem[of I M],\n         (rule ballI, frule_tac x = k in bspec, assumption,\n          thin_tac \"\\<forall>i\\<in>I. R module M i\", simp add:Module.module_is_ag),\n          assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac a = a and m = \"prod_pOp I M m n\" in prodM_sprod_mem[of I M],\n         assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule prodM_mem_eq[of I M], assumption, simp add:prodM_carr)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n)\n                         \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M a (prod_pOp I M m n) i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M a n) i\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr,\n         frule_tac a = a and m = m in prodM_sprod_mem[of I M], assumption+,\n         frule_tac a = a and m = n in prodM_sprod_mem[of I M], assumption+,\n         rule_tac X = \"prodM_sprod R I M a m\" and Y = \"prodM_sprod R I M a n\" \n        in prod_pOp_mem[of I M],\n        (rule ballI, drule_tac x = k in bspec, assumption,\n        simp add:Module.module_is_ag),\n        assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M a (prod_pOp I M m n) i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M a n) i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n) \\<in> carr_prodag I M;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) i =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n) i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac a = a and m = m in prodM_sprod_mem[of I M], assumption+,\n         frule_tac a = a and m = n in prodM_sprod_mem[of I M], assumption+,\n         simp add:prod_pOp_def prodM_sprod_def,\n         drule_tac x = i in bspec, assumption,\n         thin_tac \"(\\<lambda>x\\<in>I. m x \\<plusminus>\\<^bsub>M x\\<^esub> n x) \\<in> carr_prodag I M\",\n         thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> (if j \\<in> I then m j \\<plusminus>\\<^bsub>M j\\<^esub> n j else undefined))\n        \\<in> carr_prodag I M\",\n         thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n         thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> n j) \\<in> carr_prodag I M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carr_prodag I M;\n        n \\<in> carr_prodag I M; i \\<in> I; R module M i\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         (m i \\<plusminus>\\<^bsub>M i\\<^esub> n i) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> n i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:carr_prodag_def, (erule conjE)+,\n          drule_tac x = i in bspec, assumption,\n          drule_tac x = i in bspec, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>a \\<in> carrier R; i \\<in> I; R module M i;\n        m \\<in> extensional I; n \\<in> extensional I;\n        m \\<in> I \\<rightarrow> Un_carrier I M;\n        n \\<in> I \\<rightarrow> Un_carrier I M; m i \\<in> carrier (M i);\n        n i \\<in> carrier (M i)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         (m i \\<plusminus>\\<^bsub>M i\\<^esub> n i) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> n i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:Module.sc_r_distr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr,\n         frule_tac a = b and m = m in prodM_sprod_mem[of I M], assumption+,\n         frule_tac a = a and m = \"prodM_sprod R I M b m\" in prodM_sprod_mem[of\n          I M], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac x = a and y = b in ring_tOp_closed, assumption+,\n         frule_tac a = \"a \\<cdot>\\<^sub>r b\" and m = m in prodM_sprod_mem[of I M], \n         assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prodM_sprod R I M b m) \\<in> carr_prodag I M;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_def,\n         rule prodM_mem_eq, assumption+, simp add:prodM_carr,\n         simp add:prodM_carr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_prodag I M;\n        prodM_sprod R I M b m \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prodM_sprod R I M b m) \\<in> carr_prodag I M;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m i =\n                            prodM_sprod R I M a (prodM_sprod R I M b m) i\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule ballI, simp add:prodM_sprod_def,\n         drule_tac x = i in bspec, assumption,\n         thin_tac \"(\\<lambda>j\\<in>I. b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n         thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> (if j \\<in> I then b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j else undefined))\n        \\<in> carr_prodag I M\",\n         thin_tac \"(\\<lambda>j\\<in>I. (a \\<cdot>\\<^sub>r b) \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n         simp add:carr_prodag_def, (erule conjE)+,\n         drule_tac x = i in bspec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m i.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R; i \\<in> I; R module M i;\n        m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n        m i \\<in> carrier (M i)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:Module.sc_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_carr, cut_tac ring_one,\n         frule_tac a = \"1\\<^sub>r\"  and m = m in prodM_sprod_mem[of I M], assumption+,\n         rule prodM_mem_eq, assumption+, simp add:prodM_carr,\n         simp add:prodM_def, simp add:prodM_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; m \\<in> carr_prodag I M;\n        1\\<^sub>r \\<in> carrier R;\n        prodM_sprod R I M 1\\<^sub>r m \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            (1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>m\\<Pi>\\<^bsub>R I\\<^esub> M\\<^esub>\n                             m)\n                             i =\n                            m i", "apply (rule ballI, simp add:prodM_def,\n         thin_tac \"prodM_sprod R I M 1\\<^sub>r m \\<in> carr_prodag I M\",\n         simp add:prodM_sprod_def,\n         drule_tac x = i in bspec, assumption,\n         simp add:carr_prodag_def, (erule conjE)+,\n         drule_tac x = i in bspec, assumption,\n         simp add:Module.sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  dsumM :: \"[('r, 'm) Ring_scheme, 'i set, 'i \\<Rightarrow> ('a, 'r, 'more) Module_scheme]\n  \\<Rightarrow>  \\<lparr> carrier:: ('i \\<Rightarrow> 'a) set, \n        pop::['i \\<Rightarrow> 'a, 'i \\<Rightarrow> 'a] \\<Rightarrow> ('i \\<Rightarrow> 'a),\n        mop:: ('i \\<Rightarrow> 'a) \\<Rightarrow> ('i \\<Rightarrow> 'a), \n        zero::('i \\<Rightarrow> 'a), \n        sprod :: ['r, 'i \\<Rightarrow> 'a] \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<rparr>\" where\n \n  \"dsumM R I A = \\<lparr> carrier = carr_dsumag I A, \n     pop = prod_pOp I A, mop = prod_mOp I A,\n     zero = prod_zero I A, sprod = prodM_sprod R I A\\<rparr>\""], ["", "abbreviation\n  DSUMMOD  (\"(3\\<^bsub>_\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>_\\<^esub> _)\" [72,72,73]72) where\n  \"\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> A == dsumM R I A\""], ["", "lemma (in Ring) dsumM_carr:\"carrier (dsumM R I M) = carr_dsumag I M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) =\n    carr_dsumag I M", "by (simp add:dsumM_def)"], ["", "lemma (in Ring) dsum_sprod_mem:\"\\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n       b \\<in> carr_dsumag I M\\<rbrakk>  \\<Longrightarrow> prodM_sprod R I M a b \\<in> carr_dsumag I M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     b \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> prodM_sprod R I M a b \\<in> carr_dsumag I M", "apply (simp add:carr_dsumag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n     finiteHom I M b\\<rbrakk>\n    \\<Longrightarrow> finiteHom I M (prodM_sprod R I M a b)", "apply (simp add:finiteHom_def, erule conjE, erule exE, (erule conjE)+,\n        frule_tac a = a and m = b in prodM_sprod_mem[of I M], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carr_prodag I M; H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. b j = \\<zero>\\<^bsub>M j\\<^esub>;\n        prodM_sprod R I M a b \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a b \\<in> carr_prodag I M \\<and>\n                         (\\<exists>H\\<subseteq>I.\n                             finite H \\<and>\n                             (\\<forall>j\\<in>I - H.\n                                 prodM_sprod R I M a b j =\n                                 \\<zero>\\<^bsub>M j\\<^esub>))", "apply (subgoal_tac \"\\<forall>j\\<in>I - H. prodM_sprod R I M a b j = \\<zero>\\<^bsub>M j\\<^esub>\", blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carr_prodag I M; H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. b j = \\<zero>\\<^bsub>M j\\<^esub>;\n        prodM_sprod R I M a b \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - H.\n                            prodM_sprod R I M a b j =\n                            \\<zero>\\<^bsub>M j\\<^esub>", "apply (rule ballI, \n        drule_tac x = j in bspec, assumption,\n        drule_tac x = j in bspec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H j.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carr_prodag I M; H \\<subseteq> I;\n        finite H; prodM_sprod R I M a b \\<in> carr_prodag I M;\n        j \\<in> I - H; b j = \\<zero>\\<^bsub>M j\\<^esub>;\n        R module M j\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a b j =\n                         \\<zero>\\<^bsub>M j\\<^esub>", "apply (subst prodM_sprod_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H j.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carr_prodag I M; H \\<subseteq> I;\n        finite H; prodM_sprod R I M a b \\<in> carr_prodag I M;\n        j \\<in> I \\<and> j \\<notin> H; b j = \\<zero>\\<^bsub>M j\\<^esub>;\n        R module M j\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub>\n                         \\<zero>\\<^bsub>M j\\<^esub> =\n                         \\<zero>\\<^bsub>M j\\<^esub>", "apply (simp add:Module.sc_a_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) carr_dsum_prod:\"carr_dsumag I M \\<subseteq> carr_prodag I M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carr_dsumag I M \\<subseteq> carr_prodag I M", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carr_dsumag I M \\<Longrightarrow> x \\<in> carr_prodag I M", "apply (simp add:carr_dsumag_def finiteHom_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) carr_dsum_prod1:\"\n                 \\<forall>x. x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x.\n       x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M", "apply (rule allI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carr_dsumag I M \\<Longrightarrow> x \\<in> carr_prodag I M", "apply (cut_tac carr_dsum_prod [of I M])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> carr_dsumag I M;\n        carr_dsumag I M \\<subseteq> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carr_prodag I M", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) carr_dsumM_mem_eq:\"\\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n      y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j\\<rbrakk> \\<Longrightarrow> x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n     y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (cut_tac carr_dsum_prod [of I M])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n     y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j;\n     carr_dsumag I M \\<subseteq> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule subsetD [of \"carr_dsumag I M\" \"carr_prodag I M\" \"x\"], assumption+,\n       frule subsetD [of \"carr_dsumag I M\" \"carr_prodag I M\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n     y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j;\n     carr_dsumag I M \\<subseteq> carr_prodag I M; x \\<in> carr_prodag I M;\n     y \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (subgoal_tac \"\\<forall>i\\<in>I. aGroup (M i)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n     y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j;\n     carr_dsumag I M \\<subseteq> carr_prodag I M; x \\<in> carr_prodag I M;\n     y \\<in> carr_prodag I M; \\<forall>i\\<in>I. aGroup (M i)\\<rbrakk>\n    \\<Longrightarrow> x = y\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n     y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j;\n     carr_dsumag I M \\<subseteq> carr_prodag I M; x \\<in> carr_prodag I M;\n     y \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)", "apply (rule carr_prodag_mem_eq [of \"I\" \"M\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n     y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j;\n     carr_dsumag I M \\<subseteq> carr_prodag I M; x \\<in> carr_prodag I M;\n     y \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; x \\<in> carr_dsumag I M;\n        y \\<in> carr_dsumag I M; \\<forall>j\\<in>I. x j = y j;\n        carr_dsumag I M \\<subseteq> carr_prodag I M;\n        x \\<in> carr_prodag I M; y \\<in> carr_prodag I M; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (M i)", "apply (drule_tac x = i in bspec, assumption,\n       simp add:Module.module_is_ag)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) dsumM_Module:\"\\<forall>i\\<in>I. R module (M i) \\<Longrightarrow> R module (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    R module \\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M", "apply (rule Module.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    aGroup (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (cut_tac prodag_aGroup[of I M])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> M)\\<rbrakk>\n    \\<Longrightarrow> aGroup\n                       (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (cut_tac carr_dsum_prod1[of I M])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> M);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> aGroup\n                       (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (simp add:dsumM_def prodag_def aGroup_def,\n       cut_tac dsum_pOp_func[of I M], simp,\n       cut_tac dsum_iOp_func[of I M], simp,\n       cut_tac dsum_zero_func[of I M], simp)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_zero I M \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I M \\<longrightarrow>\n                         prod_pOp I M a (prod_zero I M) = a\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M\n     \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 5. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 6. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (erule conjE)+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_zero I M \\<in> carr_dsumag I M;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M;\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I M \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_prodag I M \\<longrightarrow>\n                prod_pOp I M (prod_pOp I M a b) c =\n                prod_pOp I M a (prod_pOp I M b c)));\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I M \\<longrightarrow>\n            prod_pOp I M a b = prod_pOp I M b a);\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M;\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        prod_pOp I M (prod_mOp I M a) a = prod_zero I M;\n     \\<forall>a.\n        a \\<in> carr_prodag I M \\<longrightarrow>\n        prod_pOp I M (prod_zero I M) a = a\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I M \\<longrightarrow>\n                         prod_pOp I M a (prod_zero I M) = a\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M\n     \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 5. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 6. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (rule allI, rule impI,\n        thin_tac \"\\<forall>a. a \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>b. b \\<in> carr_prodag I M \\<longrightarrow>\n                  (\\<forall>c. c \\<in> carr_prodag I M \\<longrightarrow>\n                       prod_pOp I M (prod_pOp I M a b) c =\n                       prod_pOp I M a (prod_pOp I M b c)))\",\n        thin_tac \"\\<forall>i\\<in>I. R module M i\")"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x.\n                   x \\<in> carr_dsumag I M \\<longrightarrow>\n                   x \\<in> carr_prodag I M;\n        prod_pOp I M\n        \\<in> carr_dsumag I M \\<rightarrow>\n              carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n        prod_mOp I M \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n        prod_zero I M \\<in> carr_dsumag I M;\n        prod_pOp I M\n        \\<in> carr_prodag I M \\<rightarrow>\n              carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           (\\<forall>b.\n               b \\<in> carr_prodag I M \\<longrightarrow>\n               prod_pOp I M a b = prod_pOp I M b a);\n        prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_mOp I M a) a = prod_zero I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_zero I M) a = a;\n        a \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M a (prod_zero I M) = a\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M\n     \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 5. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 6. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (frule_tac a = a in forall_spec, assumption,\n         drule_tac a = \"prod_zero I M\" in forall_spec, assumption)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>prod_pOp I M\n                \\<in> carr_dsumag I M \\<rightarrow>\n                      carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n        prod_mOp I M \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n        prod_zero I M \\<in> carr_dsumag I M;\n        prod_pOp I M\n        \\<in> carr_prodag I M \\<rightarrow>\n              carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           (\\<forall>b.\n               b \\<in> carr_prodag I M \\<longrightarrow>\n               prod_pOp I M a b = prod_pOp I M b a);\n        prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_mOp I M a) a = prod_zero I M;\n        \\<forall>a.\n           a \\<in> carr_prodag I M \\<longrightarrow>\n           prod_pOp I M (prod_zero I M) a = a;\n        a \\<in> carr_dsumag I M; a \\<in> carr_prodag I M;\n        prod_zero I M \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M a (prod_zero I M) = a\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M\n     \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 5. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 6. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (drule_tac a = a in forall_spec, assumption,\n         rotate_tac -1,\n         drule_tac a = \"prod_zero I M\" in forall_spec, assumption, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M;\n     prod_mOp I M\n     \\<in> carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 4. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 5. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (rule ballI, drule_tac x = k in bspec, assumption,\n         simp add:Module.module_is_ag)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M;\n     prod_pOp I M\n     \\<in> carr_dsumag I M \\<rightarrow>\n           carr_dsumag I M \\<rightarrow> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 4. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (rule ballI, drule_tac x = k in bspec, assumption,\n         (simp add:Module.module_is_ag)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n     prod_pOp I M\n     \\<in> carr_prodag I M \\<rightarrow>\n           carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             (\\<forall>c.\n                 c \\<in> carr_prodag I M \\<longrightarrow>\n                 prod_pOp I M (prod_pOp I M a b) c =\n                 prod_pOp I M a (prod_pOp I M b c)))) \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         (\\<forall>b.\n             b \\<in> carr_prodag I M \\<longrightarrow>\n             prod_pOp I M a b = prod_pOp I M b a)) \\<and>\n     prod_mOp I M \\<in> carr_prodag I M \\<rightarrow> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_mOp I M a) a = prod_zero I M) \\<and>\n     prod_zero I M \\<in> carr_prodag I M \\<and>\n     (\\<forall>a.\n         a \\<in> carr_prodag I M \\<longrightarrow>\n         prod_pOp I M (prod_zero I M) a = a);\n     \\<forall>x.\n        x \\<in> carr_dsumag I M \\<longrightarrow>\n        x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (M k)\n 2. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    \\<forall>k\\<in>I. aGroup (M k)\n 3. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (rule ballI, drule_tac x = k in bspec, assumption+,\n         simp add:Module.module_is_ag)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow>\n    Module_axioms (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M) R", "apply (rule Module_axioms.intro)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<forall>i\\<in>I. R module M i \\<Longrightarrow> Ring R\n 2. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m\n                         \\<in> carrier\n                                (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m\n 4. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 5. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 6. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac Ring, simp del: Pi_split_insert_domain,\n        simp add:dsumM_carr dsumM_def del: Pi_split_insert_domain,\n        simp add:dsum_sprod_mem del: Pi_split_insert_domain)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "(* sc_l_distr *)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac ring_is_ag,\n        frule_tac x = a and y = b in aGroup.ag_pOp_closed, assumption+,\n        simp add:dsumM_carr del: Pi_split_insert_domain,\n        frule_tac a = a and b = m in dsum_sprod_mem[of I M], assumption+,\n        frule_tac a = b and b = m in dsum_sprod_mem[of I M], assumption+,\n        frule_tac a = \"a \\<plusminus> b\" and b = m in dsum_sprod_mem[of I M], assumption+,\n        simp add:dsumM_def del: Pi_split_insert_domain,\n        cut_tac X = \"prodM_sprod R I M a m\" and Y = \"prodM_sprod R I M b m\" in\n        prod_pOp_mem[of I M],\n        (rule ballI, frule_tac x = k in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\", simp add:Module.module_is_ag del: Pi_split_insert_domain),\n        (cut_tac carr_dsum_prod[of I M], simp add:subsetD del: Pi_split_insert_domain)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply(cut_tac carr_dsum_prod1[of I M])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply(rule prodM_mem_eq)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>?I81 a b m. R module ?M81 a b m i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m\n                         \\<in> carrier\n                                (m\\<Pi>\\<^bsub>R ?I81 a b\n            m\\<^esub> ?M81 a b m)\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n                         \\<in> carrier\n                                (m\\<Pi>\\<^bsub>R ?I81 a b\n            m\\<^esub> ?M81 a b m)\n 4. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>?I81 a b m.\n                            prodM_sprod R I M (a \\<plusminus> b) m i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M b m) i\n 5. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 6. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 7. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply(assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m\n                         \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m)\n                         \\<in> carrier (m\\<Pi>\\<^bsub>R I\\<^esub> M)\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M (a \\<plusminus> b) m i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M b m) i\n 4. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 5. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 6. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply((simp add:prodM_carr del: Pi_split_insert_domain)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M (a \\<plusminus> b) m i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M b m) i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply(rule ballI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m i.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<plusminus> b) m \\<in> carr_dsumag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M b m)\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M (a \\<plusminus> b) m i =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M b m) i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply(simp add:prodM_sprod_def prod_pOp_def del: Pi_split_insert_domain PiE_restrict)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m i.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        (\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>j\\<in>I. b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>j\\<in>I.\n            (a \\<plusminus> b) \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then a \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x\n             else undefined) \\<plusminus>\\<^bsub>M x\\<^esub>\n            (if x \\<in> I then b \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x\n             else undefined))\n        \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply(thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. (a \\<plusminus> b) \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n        thin_tac \"(\\<lambda>x\\<in>I. (if x \\<in> I then a \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x else undefined) \\<plusminus>\\<^bsub>M x\\<^esub>\n               (if x \\<in> I then b \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x else undefined))\n        \\<in> carr_prodag I M\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m i.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M; aGroup R;\n        a \\<plusminus> b \\<in> carrier R;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac a = m in forall_spec, assumption,\n               thin_tac \"\\<forall>x. x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M\",\n               frule_tac x = i in bspec, assumption,\n               thin_tac \"\\<forall>i\\<in>I. R module M i\",\n               thin_tac \"m \\<in> carr_dsumag I M\",\n               simp add:carr_prodag_def, (erule conjE)+,\n               frule_tac x = i in bspec, assumption,\n               thin_tac \"\\<forall>i\\<in>I. m i \\<in> carrier (M i)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b m i.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<plusminus> b \\<in> carrier R; i \\<in> I; R module M i;\n        m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n        m i \\<in> carrier (M i)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i\n 2. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 3. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 4. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:Module.sc_l_distr)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "(** sc_r_distr **)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        n \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:dsumM_carr,\n        frule_tac a = a and b = m in dsum_sprod_mem[of I M], assumption+,\n        frule_tac a = a and b = n in dsum_sprod_mem[of I M], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_dsumag I M; n \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a n \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         n\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:dsumM_def, cut_tac carr_dsum_prod1[of I M],\n        cut_tac X = m and Y = n in prod_pOp_mem[of I M],\n        (rule ballI, frule_tac x = k in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\", simp add:Module.module_is_ag), simp+,\n        frule_tac a = a and m = \"prod_pOp I M m n\" in prodM_sprod_mem[of I M],\n        assumption, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_dsumag I M; n \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a n \\<in> carr_dsumag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n)\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac X = \"prodM_sprod R I M a m\" and Y = \"prodM_sprod R I M a n\" in\n        prod_pOp_mem[of I M],\n        (rule ballI, frule_tac x = k in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\", simp add:Module.module_is_ag), simp+,\n        rule_tac ?m1.0 = \"prodM_sprod R I M a (prod_pOp I M m n)\" and \n        ?m2.0 = \"prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M a n)\"\n        in prodM_mem_eq[of I M], assumption, (simp add:prodM_carr)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_dsumag I M; n \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a n \\<in> carr_dsumag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n) \\<in> carr_prodag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M a n)\n        \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M a (prod_pOp I M m n) i =\n                            prod_pOp I M (prodM_sprod R I M a m)\n                             (prodM_sprod R I M a n) i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule ballI,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"prodM_sprod R I M a m \\<in> carr_dsumag I M\",\n        thin_tac \"prodM_sprod R I M a n \\<in> carr_dsumag I M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        m \\<in> carr_dsumag I M; n \\<in> carr_dsumag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n) \\<in> carr_prodag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M a n)\n        \\<in> carr_prodag I M;\n        i \\<in> I; R module M i\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) i =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n) i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rotate_tac 1,\n        frule_tac a = m in forall_spec, assumption,\n        frule_tac a = n in forall_spec, assumption,\n        thin_tac \"\\<forall>x. x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M\",\n        thin_tac \"m \\<in> carr_dsumag I M\",\n        thin_tac \"n \\<in> carr_dsumag I M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>a \\<in> carrier R; prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n) \\<in> carr_prodag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M a n)\n        \\<in> carr_prodag I M;\n        i \\<in> I; R module M i; \\<forall>i\\<in>I. R module M i;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) i =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n) i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac a = a and m = m in prodM_sprod_mem[of I M], assumption+, \n        frule_tac a = a and m = n in prodM_sprod_mem[of I M], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>a \\<in> carrier R; prod_pOp I M m n \\<in> carr_prodag I M;\n        prodM_sprod R I M a (prod_pOp I M m n) \\<in> carr_prodag I M;\n        prod_pOp I M (prodM_sprod R I M a m) (prodM_sprod R I M a n)\n        \\<in> carr_prodag I M;\n        i \\<in> I; R module M i; \\<forall>i\\<in>I. R module M i;\n        m \\<in> carr_prodag I M; n \\<in> carr_prodag I M;\n        prodM_sprod R I M a m \\<in> carr_prodag I M;\n        prodM_sprod R I M a n \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M a (prod_pOp I M m n) i =\n                         prod_pOp I M (prodM_sprod R I M a m)\n                          (prodM_sprod R I M a n) i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:prodM_sprod_def prod_pOp_def del: PiE_restrict,\n        thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> (if j \\<in> I then m j \\<plusminus>\\<^bsub>M j\\<^esub> n j else undefined))\n        \\<in> carr_prodag I M\",\n        thin_tac \"(\\<lambda>x\\<in>I. (if x \\<in> I then a \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> m x else undefined) \\<plusminus>\\<^bsub>M x\\<^esub>\n               (if x \\<in> I then a \\<cdot>\\<^sub>s\\<^bsub>M x\\<^esub> n x else undefined))\n        \\<in> carr_prodag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> n j) \\<in> carr_prodag I M\",\n        thin_tac \"(\\<lambda>x\\<in>I. m x \\<plusminus>\\<^bsub>M x\\<^esub> n x) \\<in> carr_prodag I M\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a m n i.\n       \\<lbrakk>a \\<in> carrier R; i \\<in> I;\n        \\<forall>i\\<in>I. R module M i; m \\<in> carr_prodag I M;\n        n \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         (m i \\<plusminus>\\<^bsub>M i\\<^esub> n i) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub>\n                         m i \\<plusminus>\\<^bsub>M i\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> n i\n 2. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 3. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:carr_prodag_def, (erule conjE)+,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\",\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. m i \\<in> carrier (M i)\",\n        frule_tac x = i in bspec, assumption,\n        simp add:Module.sc_r_distr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (frule_tac x = a and y = b in ring_tOp_closed, assumption+,\n        simp add:dsumM_carr,\n     frule_tac a = b and b = m in dsum_sprod_mem[of I M], assumption+,\n     frule_tac a = a and b = \"prodM_sprod R I M b m\" in dsum_sprod_mem[of I M],\n     assumption+,\n     frule_tac a = \"a \\<cdot>\\<^sub>r b\" and b = m in dsum_sprod_mem[of I M], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a (prodM_sprod R I M b m) \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m\n        \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (cut_tac carr_dsum_prod1[of I M])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a (prodM_sprod R I M b m) \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m \\<in> carr_dsumag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                          m)\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:dsumM_def,\n        rule_tac ?m1.0 = \"prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m\" and \n        ?m2.0 = \"prodM_sprod R I M a (prodM_sprod R I M b m)\"\n        in prodM_mem_eq[of I M], assumption, (simp add:prodM_carr)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; a \\<in> carrier R;\n        b \\<in> carrier R; m \\<in> carr_dsumag I M;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        prodM_sprod R I M b m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a (prodM_sprod R I M b m) \\<in> carr_dsumag I M;\n        prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m \\<in> carr_dsumag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M (a \\<cdot>\\<^sub>r b) m i =\n                            prodM_sprod R I M a (prodM_sprod R I M b m) i\n 2. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (rule ballI, simp add:prodM_sprod_def,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\",\n        thin_tac \"(\\<lambda>j\\<in>I. b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> (if j \\<in> I then b \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j else undefined))\n        \\<in> carr_dsumag I M\",\n        thin_tac \"(\\<lambda>j\\<in>I. (a \\<cdot>\\<^sub>r b) \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n        frule_tac a = m in forall_spec, assumption,\n        thin_tac \"\\<forall>x. x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M\",\n        thin_tac \"m \\<in> carr_dsumag I M\",\n        simp add:carr_prodag_def, (erule conjE)+,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. m i \\<in> carrier (M i)\",\n        simp add:Module.sc_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:dsumM_carr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                         m =\n                         m", "apply (simp add:dsumM_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        m \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M 1\\<^sub>r m = m", "apply (cut_tac ring_one,\n         cut_tac carr_dsum_prod1[of I M],\n         frule_tac a = \"1\\<^sub>r\" and b = m in dsum_sprod_mem[of I M], assumption+,\n         rule_tac ?m1.0 = \"prodM_sprod R I M 1\\<^sub>r m\" and\n         ?m2.0 = m in prodM_mem_eq[of I M], assumption, (simp add:prodM_carr)+,\n         frule_tac a = m in forall_spec, assumption,\n         frule_tac a = \"prodM_sprod R I M 1\\<^sub>r m\" in forall_spec, assumption,\n         thin_tac \"\\<forall>x. x \\<in> carr_dsumag I M \\<longrightarrow> x \\<in> carr_prodag I M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i; m \\<in> carr_dsumag I M;\n        1\\<^sub>r \\<in> carrier R;\n        prodM_sprod R I M 1\\<^sub>r m \\<in> carr_dsumag I M;\n        m \\<in> carr_prodag I M;\n        prodM_sprod R I M 1\\<^sub>r m \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prodM_sprod R I M 1\\<^sub>r m i = m i", "apply (rule ballI,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. R module M i\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m i.\n       \\<lbrakk>m \\<in> carr_dsumag I M; 1\\<^sub>r \\<in> carrier R;\n        prodM_sprod R I M 1\\<^sub>r m \\<in> carr_dsumag I M;\n        m \\<in> carr_prodag I M;\n        prodM_sprod R I M 1\\<^sub>r m \\<in> carr_prodag I M; i \\<in> I;\n        R module M i\\<rbrakk>\n       \\<Longrightarrow> prodM_sprod R I M 1\\<^sub>r m i = m i", "apply (simp add:prodM_sprod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m i.\n       \\<lbrakk>m \\<in> carr_dsumag I M; 1\\<^sub>r \\<in> carrier R;\n        (\\<lambda>j\\<in>I. 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n        \\<in> carr_dsumag I M;\n        m \\<in> carr_prodag I M;\n        (\\<lambda>j\\<in>I. 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n        \\<in> carr_prodag I M;\n        i \\<in> I; R module M i\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i =\n                         m i", "apply (thin_tac \"(\\<lambda>j\\<in>I. 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n         thin_tac \"(\\<lambda>j\\<in>I. 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_prodag I M\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m i.\n       \\<lbrakk>m \\<in> carr_dsumag I M; 1\\<^sub>r \\<in> carrier R;\n        m \\<in> carr_prodag I M; i \\<in> I; R module M i\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M i\\<^esub> m i =\n                         m i", "apply (simp add:carr_prodag_def, (erule conjE)+,\n         frule_tac x = i in bspec, assumption,\n         simp add:Module.sprod_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ringModule :: \"('r, 'b) Ring_scheme \\<Rightarrow> ('r, 'r) Module\"\n                (\"(M\\<^bsub>_\\<^esub>)\" [998]999) where\n  \"M\\<^bsub>R\\<^esub> = \\<lparr>carrier = carrier R, pop = pop R, mop = mop R,\n        zero = zero R, sprod = tp R\\<rparr>\""], ["", "lemma (in Ring) ringModule_Module:\"R module M\\<^bsub>R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R module M\\<^bsub>R\\<^esub>", "apply (rule Module.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup (M\\<^bsub>R\\<^esub>)\n 2. Module_axioms (M\\<^bsub>R\\<^esub>) R", "apply (simp add:aGroup_def,  simp add:ringModule_def,\n        simp add:pop_closed,  simp add:pop_aassoc,\n        simp add:pop_commute, simp add:mop_closed,\n        simp add:l_m,         simp add:ex_zero,\n        simp add:l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Module_axioms (M\\<^bsub>R\\<^esub>) R", "apply (rule Module_axioms.intro)"], ["proof (prove)\ngoal (6 subgoals):\n 1. Ring R\n 2. \\<And>a m.\n       \\<lbrakk>a \\<in> carrier R;\n        m \\<in> carrier (M\\<^bsub>R\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         m\n                         \\<in> carrier (M\\<^bsub>R\\<^esub>)\n 3. \\<And>a b m.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M\\<^bsub>R\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         m \\<plusminus>\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         b \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         m\n 4. \\<And>a m n.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carrier (M\\<^bsub>R\\<^esub>);\n        n \\<in> carrier (M\\<^bsub>R\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         (m \\<plusminus>\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                          n) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         m \\<plusminus>\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         a \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         n\n 5. \\<And>a b m.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        m \\<in> carrier (M\\<^bsub>R\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> (a \\<cdot>\\<^sub>r\n                          b) \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         m =\n                         a \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                         (b \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub>\n                          m)\n 6. \\<And>m.\n       m \\<in> carrier (M\\<^bsub>R\\<^esub>) \\<Longrightarrow>\n       1\\<^sub>r \\<cdot>\\<^sub>s\\<^bsub>M\\<^bsub>R\\<^esub>\\<^esub> m = m", "apply (cut_tac Ring, assumption,\n        simp add:ringModule_def, simp add:ring_tOp_closed,\n        simp add:ringModule_def, simp add:ring_distrib2,\n        simp add:ringModule_def, simp add:ring_distrib1,\n        simp add:ringModule_def, simp add:ring_tOp_assoc,\n        simp add:ringModule_def, simp add:rg_l_unit)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  dsumMhom :: \"['i set, 'i \\<Rightarrow> ('a, 'r, 'm) Module_scheme, \n    'i \\<Rightarrow> ('b, 'r, 'm1) Module_scheme, 'i \\<Rightarrow> ('a \\<Rightarrow> 'b)] \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow> \n    ('i \\<Rightarrow> 'b)\" where\n\n  \"dsumMhom I A B S = (\\<lambda>f\\<in>carr_dsumag I A. (\\<lambda>k\\<in>I. (S k) (f k)))\""], ["", "(**     I \\<longrightarrow> A\n          \\   |\n           \\  | S\n              B        **)"], ["", "lemma (in Ring) dsumMhom_mem:\"\\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n                \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); x \\<in> carr_dsumag I M\\<rbrakk>\n                 \\<Longrightarrow> dsumMhom I M N S x \\<in> carr_dsumag I N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S x \\<in> carr_dsumag I N", "apply (subst carr_dsumag_def, simp, simp add:finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S x \\<in> carr_prodag I N \\<and>\n                      (\\<exists>H\\<subseteq>I.\n                          finite H \\<and>\n                          (\\<forall>j\\<in>I - H.\n                              dsumMhom I M N S x j =\n                              \\<zero>\\<^bsub>N j\\<^esub>))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S x \\<in> carr_prodag I N\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (simp add:dsumMhom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>I. S k (x k)) \\<in> carr_prodag I N\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (cut_tac carr_dsum_prod1[of I M],\n        drule_tac a = x in forall_spec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>I. S k (x k)) \\<in> carr_prodag I N\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (\n         subst carr_prodag_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>k\\<in>I. S k (x k))\n                      \\<in> I \\<rightarrow> Un_carrier I N \\<and>\n                      (\\<forall>i\\<in>I. S i (x i) \\<in> carrier (N i))\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (rule conjI,\n          rule Pi_I,\n          thin_tac \"x \\<in> carr_dsumag I M\", simp,\n          simp add:Un_carrier_def,\n          drule_tac x = xa in bspec, assumption,\n          drule_tac x = xa in bspec, assumption,\n          drule_tac x = xa in bspec, assumption,\n          simp add:carr_prodag_def, (erule conjE)+,\n          drule_tac x = xa in bspec, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>xa \\<in> I; R module M xa; R module N xa;\n        S xa \\<in> mHom R (M xa) (N xa); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I M;\n        x xa \\<in> carrier (M xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (N i)) \\<and>\n                            S xa (x xa) \\<in> xb\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i (x i) \\<in> carrier (N i)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (frule_tac R = R and M = \"M xa\" and N = \"N xa\" and f = \"S xa\" and \n          m = \"x xa\" in Module.mHom_mem, assumption+, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i (x i) \\<in> carrier (N i)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (rule ballI,\n         drule_tac x = i in bspec, assumption,\n         drule_tac x = i in bspec, assumption,\n         drule_tac x = i in bspec, assumption,\n         simp add:carr_prodag_def, (erule conjE)+,\n         drule_tac x = i in bspec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carr_dsumag I M; i \\<in> I; R module M i;\n        R module N i; S i \\<in> mHom R (M i) (N i); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I M;\n        x i \\<in> carrier (M i)\\<rbrakk>\n       \\<Longrightarrow> S i (x i) \\<in> carrier (N i)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (simp add:Module.mHom_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (cut_tac carr_dsum_prod1[of I M],\n         drule_tac a = x in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             dsumMhom I M N S x j =\n                             \\<zero>\\<^bsub>N j\\<^esub>)", "apply (simp add:dsumMhom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> carr_prodag I M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             S j (x j) = \\<zero>\\<^bsub>N j\\<^esub>)", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_dsumag I M; x \\<in> extensional I;\n     x \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. x i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             S j (x j) = \\<zero>\\<^bsub>N j\\<^esub>)", "apply (simp add:carr_dsumag_def, simp add:finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n     x \\<in> carr_prodag I M \\<and>\n     (\\<exists>H\\<subseteq>I.\n         finite H \\<and>\n         (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>M j\\<^esub>));\n     x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I M;\n     \\<forall>i\\<in>I. x i \\<in> carrier (M i)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             S j (x j) = \\<zero>\\<^bsub>N j\\<^esub>)", "apply (erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I M;\n        \\<forall>i\\<in>I. x i \\<in> carrier (M i); x \\<in> carr_prodag I M;\n        H \\<subseteq> I \\<and>\n        finite H \\<and>\n        (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>M j\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                S j (x j) = \\<zero>\\<^bsub>N j\\<^esub>)", "apply (subgoal_tac \"\\<forall>j\\<in>I - H. S j (x j) = \\<zero>\\<^bsub>N j\\<^esub>\", blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I M;\n        \\<forall>i\\<in>I. x i \\<in> carrier (M i); x \\<in> carr_prodag I M;\n        H \\<subseteq> I \\<and>\n        finite H \\<and>\n        (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>M j\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - H.\n                            S j (x j) = \\<zero>\\<^bsub>N j\\<^esub>", "apply (rule ballI,\n         drule_tac x = j in bspec, simp,\n         drule_tac x = j in bspec, simp,\n         drule_tac x = j in bspec, simp,\n         simp add:carr_prodag_def, (erule conjE)+,\n         drule_tac x = j in bspec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>H j.\n       \\<lbrakk>x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I M; R module M j; R module N j;\n        S j \\<in> mHom R (M j) (N j); H \\<subseteq> I; j \\<in> I;\n        j \\<notin> H; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>M j\\<^esub>;\n        x j \\<in> carrier (M j)\\<rbrakk>\n       \\<Longrightarrow> S j \\<zero>\\<^bsub>M j\\<^esub> =\n                         \\<zero>\\<^bsub>N j\\<^esub>", "apply (simp add:Module.mHom_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) dsumMhom_mHom:\"\\<lbrakk>\\<forall>i\\<in>I. (R module (M i)); \n      \\<forall>i\\<in>I. (R module (N i)); \\<forall>i\\<in>I. ((S i) \\<in> mHom R (M i) (N i))\\<rbrakk> \\<Longrightarrow> \n                dsumMhom I M N S \\<in> mHom R (dsumM R I M) (dsumM R I N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S\n                      \\<in> mHom R\n                             (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n                             (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N)", "apply (subst mHom_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S\n                      \\<in> aHom\n                             (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n                             (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>m\\<in>carrier\n    (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                             dsumMhom I M N S\n                              (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                               m) =\n                             a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                             dsumMhom I M N S m)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S\n                      \\<in> aHom\n                             (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\n                             (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (simp add:aHom_def,\n        rule conjI,\n        simp add:dsumM_def dsumMhom_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> dsumMhom I M N S\n                      \\<in> extensional\n                             (carrier\n                               (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)) \\<and>\n                      (\\<forall>a\\<in>carrier\n (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                          \\<forall>b\\<in>carrier\n    (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                             dsumMhom I M N S\n                              (a \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                               b) =\n                             dsumMhom I M N S\n                              a \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                             dsumMhom I M N S b)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (rule conjI,\n        simp add:dsumMhom_def extensional_def dsumM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                         \\<forall>b\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              b) =\n                            dsumMhom I M N S\n                             a \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S b\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M);\n        b \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S\n                          (a \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                           b) =\n                         dsumMhom I M N S\n                          a \\<plusminus>\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                         dsumMhom I M N S b\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (simp add:dsumM_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prod_pOp I M a b) =\n                         prod_pOp I N (dsumMhom I M N S a)\n                          (dsumMhom I M N S b)\n 2. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (subgoal_tac \"\\<forall>i\\<in>I. aGroup (M i)\",\n        frule_tac X = a and Y = b in dsum_pOp_mem [of I M], assumption+,\n        frule_tac x = \"prod_pOp I M a b\" in dsumMhom_mem [of I M N S], \n        assumption+,\n        frule_tac x = a in dsumMhom_mem [of I M N S], assumption+,\n        frule_tac x = b in dsumMhom_mem [of I M N S], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prod_pOp I M a b) =\n                         prod_pOp I N (dsumMhom I M N S a)\n                          (dsumMhom I M N S b)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 3. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (subgoal_tac \"\\<forall>i\\<in>I. aGroup (N i)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i)\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prod_pOp I M a b) =\n                         prod_pOp I N (dsumMhom I M N S a)\n                          (dsumMhom I M N S b)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (frule_tac X = \"dsumMhom I M N S a\" and Y = \"dsumMhom I M N S b\" in \n                                      dsum_pOp_mem [of I N], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        prod_pOp I N (dsumMhom I M N S a) (dsumMhom I M N S b)\n        \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prod_pOp I M a b) =\n                         prod_pOp I N (dsumMhom I M N S a)\n                          (dsumMhom I M N S b)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (rule carr_dsumM_mem_eq [of I N], assumption+, rule ballI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        prod_pOp I N (dsumMhom I M N S a) (dsumMhom I M N S b)\n        \\<in> carr_dsumag I N;\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prod_pOp I M a b) j =\n                         prod_pOp I N (dsumMhom I M N S a)\n                          (dsumMhom I M N S b) j\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (cut_tac carr_dsum_prod1 [of  I M], cut_tac carr_dsum_prod1 [of I N])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        prod_pOp I N (dsumMhom I M N S a) (dsumMhom I M N S b)\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prod_pOp I M a b) j =\n                         prod_pOp I N (dsumMhom I M N S a)\n                          (dsumMhom I M N S b) j\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        dsumMhom I M N S\n         (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            dsumMhom I M N S a x \\<plusminus>\\<^bsub>N x\\<^esub>\n            dsumMhom I M N S b x)\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S\n                          (\\<lambda>x\\<in>I.\n                              a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n                          j =\n                         dsumMhom I M N S a\n                          j \\<plusminus>\\<^bsub>N j\\<^esub>\n                         dsumMhom I M N S b j\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (simp add:dsumMhom_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> S j (a j \\<plusminus>\\<^bsub>M j\\<^esub> b j) =\n                         S j (a j) \\<plusminus>\\<^bsub>N j\\<^esub> S j (b j)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 4. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (rule_tac R = R and M = \"M j\" and N = \"N j\" and m = \"a j\" and n = \"b j\"\n        in  Module.mHom_add)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> R module M j\n 2. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> R module N j\n 3. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> S j \\<in> mHom R (M j) (N j)\n 4. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> a j \\<in> carrier (M j)\n 5. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> b j \\<in> carrier (M j)\n 6. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 7. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 8. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply simp+"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> a j \\<in> carrier (M j)\n 2. \\<And>a b j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>M x\\<^esub> b x)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a k \\<plusminus>\\<^bsub>M k\\<^esub> b k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (a k)) \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (b k)) \\<in> carr_dsumag I N;\n        \\<forall>i\\<in>I. aGroup (N i);\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x (a x)\n             else undefined) \\<plusminus>\\<^bsub>N x\\<^esub>\n            (if x \\<in> I then S x (b x) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I M \\<longrightarrow>\n           x \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> b j \\<in> carrier (M j)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M;\n        \\<forall>i\\<in>I. aGroup (M i);\n        prod_pOp I M a b \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prod_pOp I M a b) \\<in> carr_dsumag I N;\n        dsumMhom I M N S a \\<in> carr_dsumag I N;\n        dsumMhom I M N S b \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (N i)\n 4. \\<And>a b.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i);\n        a \\<in> carr_dsumag I M; b \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I. aGroup (M i)\n 5. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (simp add:carr_dsumag_def carr_prodag_def finiteHom_def,\n         simp add:carr_dsumag_def carr_prodag_def finiteHom_def,\n         rule ballI, rotate_tac 1,\n         drule_tac x = i in bspec, assumption,\n         simp add:Module.module_is_ag,\n         rule ballI, drule_tac x = i in bspec, assumption, \n         simp add:Module.module_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>I. R module M i; \\<forall>i\\<in>I. R module N i;\n     \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>m\\<in>carrier\n   (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M).\n                            dsumMhom I M N S\n                             (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                              m) =\n                            a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                            dsumMhom I M N S m", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carrier\n                 (\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M)\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S\n                          (a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> M\\<^esub>\n                           m) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>\\<^bsub>R\\<^esub>\\<Sigma>\\<^sub>d\\<^bsub>I\\<^esub> N\\<^esub>\n                         dsumMhom I M N S m", "apply (simp add:dsumM_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) =\n                         prodM_sprod R I N a (dsumMhom I M N S m)", "apply (frule_tac a = a and b = m in dsum_sprod_mem [of I M], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) =\n                         prodM_sprod R I N a (dsumMhom I M N S m)", "apply (frule_tac x = \"prodM_sprod R I M a m\" in \n                  dsumMhom_mem [of I M N S], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m)\n        \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) =\n                         prodM_sprod R I N a (dsumMhom I M N S m)", "apply (frule_tac x = m in dsumMhom_mem [of I M N S], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) =\n                         prodM_sprod R I N a (dsumMhom I M N S m)", "apply (frule_tac a = a and b = \"dsumMhom I M N S m\" in \n                    dsum_sprod_mem [of I N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N;\n        prodM_sprod R I N a (dsumMhom I M N S m)\n        \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) =\n                         prodM_sprod R I N a (dsumMhom I M N S m)", "apply (rule carr_dsumM_mem_eq [of I N], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N;\n        prodM_sprod R I N a (dsumMhom I M N S m)\n        \\<in> carr_dsumag I N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I.\n                            dsumMhom I M N S (prodM_sprod R I M a m) j =\n                            prodM_sprod R I N a (dsumMhom I M N S m) j", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N;\n        prodM_sprod R I N a (dsumMhom I M N S m) \\<in> carr_dsumag I N;\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) j =\n                         prodM_sprod R I N a (dsumMhom I M N S m) j", "apply (cut_tac carr_dsum_prod1 [of I])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N;\n        prodM_sprod R I N a (dsumMhom I M N S m) \\<in> carr_dsumag I N;\n        j \\<in> I;\n        \\<forall>x.\n           x \\<in> carr_dsumag I (?M64 a m j) \\<longrightarrow>\n           x \\<in> carr_prodag I (?M64 a m j)\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) j =\n                         prodM_sprod R I N a (dsumMhom I M N S m) j", "apply (drule_tac a = m in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N;\n        prodM_sprod R I N a (dsumMhom I M N S m) \\<in> carr_dsumag I N;\n        j \\<in> I; m \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) j =\n                         prodM_sprod R I N a (dsumMhom I M N S m) j", "apply (cut_tac carr_dsum_prod1 [of I N],\n         frule_tac a = \"dsumMhom I M N S m\" in forall_spec,\n         assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        prodM_sprod R I M a m \\<in> carr_dsumag I M;\n        dsumMhom I M N S (prodM_sprod R I M a m) \\<in> carr_dsumag I N;\n        dsumMhom I M N S m \\<in> carr_dsumag I N;\n        prodM_sprod R I N a (dsumMhom I M N S m) \\<in> carr_dsumag I N;\n        j \\<in> I; m \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N;\n        dsumMhom I M N S m \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> dsumMhom I M N S (prodM_sprod R I M a m) j =\n                         prodM_sprod R I N a (dsumMhom I M N S m) j", "apply (simp add:dsumMhom_def prodM_sprod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M;\n        (\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j)\n        \\<in> carr_dsumag I M;\n        (\\<lambda>k\\<in>I.\n            S k (if k \\<in> I then a \\<cdot>\\<^sub>s\\<^bsub>M k\\<^esub> m k\n                 else undefined))\n        \\<in> carr_dsumag I N;\n        (\\<lambda>k\\<in>I. S k (m k)) \\<in> carr_dsumag I N;\n        (\\<lambda>j\\<in>I.\n            a \\<cdot>\\<^sub>s\\<^bsub>N j\\<^esub>\n            (if j \\<in> I then S j (m j) else undefined))\n        \\<in> carr_dsumag I N;\n        j \\<in> I; m \\<in> carr_prodag I M;\n        \\<forall>x.\n           x \\<in> carr_dsumag I N \\<longrightarrow>\n           x \\<in> carr_prodag I N\\<rbrakk>\n       \\<Longrightarrow> S j (a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N j\\<^esub> S j (m j)", "apply (thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) \\<in> carr_dsumag I M\",\n         thin_tac \"(\\<lambda>k\\<in>I. S k (if k \\<in> I then a \\<cdot>\\<^sub>s\\<^bsub>M k\\<^esub> m k else undefined))\n        \\<in> carr_dsumag I N\",\n         thin_tac \"(\\<lambda>k\\<in>I. S k (m k)) \\<in> carr_dsumag I N\",\n         thin_tac \"(\\<lambda>j\\<in>I. a \\<cdot>\\<^sub>s\\<^bsub>N j\\<^esub> (if j \\<in> I then S j (m j) else undefined))\n        \\<in> carr_dsumag I N\",\n         thin_tac \"\\<forall>x. x \\<in> carr_dsumag I N \\<longrightarrow> x \\<in> carr_prodag I N\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>\\<forall>i\\<in>I. R module M i;\n        \\<forall>i\\<in>I. R module N i;\n        \\<forall>i\\<in>I. S i \\<in> mHom R (M i) (N i); a \\<in> carrier R;\n        m \\<in> carr_dsumag I M; j \\<in> I; m \\<in> carr_prodag I M\\<rbrakk>\n       \\<Longrightarrow> S j (a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N j\\<^esub> S j (m j)", "apply (drule_tac x = j in bspec, assumption,\n         drule_tac x = j in bspec, assumption,\n         drule_tac x = j in bspec, assumption,\n         simp add:carr_prodag_def, (erule conjE)+,\n         drule_tac x = j in bspec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a m j.\n       \\<lbrakk>a \\<in> carrier R; m \\<in> carr_dsumag I M; j \\<in> I;\n        R module M j; R module N j; S j \\<in> mHom R (M j) (N j);\n        m \\<in> extensional I; m \\<in> I \\<rightarrow> Un_carrier I M;\n        m j \\<in> carrier (M j)\\<rbrakk>\n       \\<Longrightarrow> S j (a \\<cdot>\\<^sub>s\\<^bsub>M j\\<^esub> m j) =\n                         a \\<cdot>\\<^sub>s\\<^bsub>N j\\<^esub> S j (m j)", "apply (simp add:Module.mHom_lin)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "end"]]}