{"file_name": "/home/qj213/afp-2021-10-22/thys/Launchbury/ResourcedAdequacy.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Launchbury", "problem_names": ["lemma demand_not_0: \"demand (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) \\<noteq> \\<bottom>\"", "lemma restr_can_restrict_env: \"(\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub>\"", "lemma can_restrict_env:\n  \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r) = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r)\"", "lemma add_BH:\n  assumes \"map_of \\<Gamma> x = Some e\"\n  assumes  \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r' \\<noteq> \\<bottom>\"\n  shows \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r' \\<noteq> \\<bottom>\"", "lemma resourced_adequacy:\n  assumes \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\"\n  shows \"\\<exists> \\<Delta> v. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : v\""], "translations": [["", "lemma demand_not_0: \"demand (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) \\<noteq> \\<bottom>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) \\<noteq>\n    \\<bottom>", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) =\n    \\<bottom> \\<Longrightarrow>\n    False", "assume \"demand (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) = \\<bottom>\""], ["proof (state)\nthis:\n  demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) = \\<bottom>\n\ngoal (1 subgoal):\n 1. demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) =\n    \\<bottom> \\<Longrightarrow>\n    False", "with demand_suffices'[where n = 0, simplified, OF this]"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n  (demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)) \\<noteq>\n  \\<bottom>\n  demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) = \\<bottom>", "have \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n  (demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)) \\<noteq>\n  \\<bottom>\n  demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) = \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> \\<noteq>\n    \\<bottom>", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) =\n    \\<bottom> \\<Longrightarrow>\n    False", "thus False"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\nThe semantics of an expression, given only @{term r} resources, will only use values from the\nenvironment with less resources.\n\\<close>"], ["", "lemma restr_can_restrict_env: \"(\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub> =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                  r\\<^esub>", "proof(induction e arbitrary: \\<rho> r rule: exp_induct)"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>var \\<rho> r.\n       (\\<N>\\<lbrakk> Var var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n       (\\<N>\\<lbrakk> Var var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\n 2. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 3. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 4. \\<And>var exp \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub> =\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                  r\\<^esub>\n 5. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 6. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "case (Var x)"], ["proof (state)\nthis:\n  \n\ngoal (6 subgoals):\n 1. \\<And>var \\<rho> r.\n       (\\<N>\\<lbrakk> Var var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n       (\\<N>\\<lbrakk> Var var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\n 2. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 3. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 4. \\<And>var exp \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub> =\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                  r\\<^esub>\n 5. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 6. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>", "proof (rule C_restr_C_cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "fix r'"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "assume \"r' \\<sqsubseteq> r\""], ["proof (state)\nthis:\n  r' \\<sqsubseteq> r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"(\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') = \\<rho> x\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    \\<rho> x\\<cdot>r'", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') =\n  \\<rho> x\\<cdot>r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') =\n  \\<rho> x\\<cdot>r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"\\<dots> = ((\\<rho> x)|\\<^bsub>r\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<rho> x\\<cdot>r' = (\\<rho> x|\\<^bsub>r\\<^esub>)\\<cdot>r'", "using \\<open>r' \\<sqsubseteq> r\\<close>"], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. \\<rho> x\\<cdot>r' = (\\<rho> x|\\<^bsub>r\\<^esub>)\\<cdot>r'", "by simp"], ["proof (state)\nthis:\n  \\<rho> x\\<cdot>r' = (\\<rho> x|\\<^bsub>r\\<^esub>)\\<cdot>r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "also"], ["proof (state)\nthis:\n  \\<rho> x\\<cdot>r' = (\\<rho> x|\\<^bsub>r\\<^esub>)\\<cdot>r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"\\<dots> =  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<rho> x|\\<^bsub>r\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "by simp"], ["proof (state)\nthis:\n  (\\<rho> x|\\<^bsub>r\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "finally"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') =\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')", "show \"(\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') = (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r')\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') =\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "."], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') =\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\\<bottom> =\n    (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "qed simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub> =\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                    r\\<^esub>\n\ngoal (5 subgoals):\n 1. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 2. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 3. \\<And>var exp \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub> =\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                  r\\<^esub>\n 4. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 5. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 2. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 3. \\<And>var exp \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub> =\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                  r\\<^esub>\n 4. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 5. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "case (Lam x e)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       ?r\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                  ?r\\<^esub>\n\ngoal (5 subgoals):\n 1. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 2. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 3. \\<And>var exp \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub> =\n       (\\<N>\\<lbrakk> Lam [var]. exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                  r\\<^esub>\n 4. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 5. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>", "proof(rule C_restr_C_cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "fix r'"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "assume \"r' \\<sqsubseteq> r\""], ["proof (state)\nthis:\n  r' \\<sqsubseteq> r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"r' \\<sqsubseteq> C\\<cdot>r\""], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. r' \\<sqsubseteq> C\\<cdot>r", "by (metis below_C below_trans)"], ["proof (state)\nthis:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "{"], ["proof (state)\nthis:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "fix v"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"\\<rho>(x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> = (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)(x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<rho>(x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n    (x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "by simp"], ["proof (state)\nthis:\n  \\<rho>(x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n  (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n  (x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"(\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>(x := v)\\<^esub>)|\\<^bsub>r'\\<^esub> = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)(x := v)\\<^esub>)|\\<^bsub>r'\\<^esub>\""], ["proof (prove)\nusing this:\n  \\<rho>(x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n  (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n  (x := v)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\n     (x := v)\\<^esub>)|\\<^bsub>r'\\<^esub> =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     (x := v)\\<^esub>)|\\<^bsub>r'\\<^esub>", "by  (subst (1 2) C_restr_eq_lower[OF Lam \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close> ]) simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\n   (x := v)\\<^esub>)|\\<^bsub>r'\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   (x := v)\\<^esub>)|\\<^bsub>r'\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "}"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\n   (x := ?v2)\\<^esub>)|\\<^bsub>r'\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   (x := ?v2)\\<^esub>)|\\<^bsub>r'\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "thus \"(\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') = (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r')\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\n   (x := ?v2)\\<^esub>)|\\<^bsub>r'\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   (x := ?v2)\\<^esub>)|\\<^bsub>r'\\<^esub>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n  (C\\<cdot>r') =\n  (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "qed simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                               r\\<^esub> =\n  (\\<N>\\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                         r\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 2. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 3. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 4. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 2. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 3. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 4. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "case (App e x)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       ?r\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                  ?r\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>exp var \\<rho> r.\n       (\\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>) \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub> =\n       (\\<N>\\<lbrakk> App exp\n                       var \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                        r\\<^esub>\n 2. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 3. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 4. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                         r\\<^esub> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                   r\\<^esub>", "proof (rule C_restr_C_cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> App e\n                       x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "fix r'"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> App e\n                       x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "assume \"r' \\<sqsubseteq> r\""], ["proof (state)\nthis:\n  r' \\<sqsubseteq> r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> App e\n                       x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"r' \\<sqsubseteq> C\\<cdot>r\""], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. r' \\<sqsubseteq> C\\<cdot>r", "by (metis below_C below_trans)"], ["proof (state)\nthis:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> App e\n                       x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"(\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "by (rule C_restr_eqD[OF App])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> App e\n                       x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "thus \"(\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') = (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r')\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "using \\<open>r' \\<sqsubseteq> r\\<close>"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n  (C\\<cdot>r') =\n  (\\<N>\\<lbrakk> App e\n                  x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> App e\n                    x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "qed simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> App e\n                  x \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       r\\<^esub> =\n  (\\<N>\\<lbrakk> App e\n                  x \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                 r\\<^esub>\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 2. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 3. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 2. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 3. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "case (Bool b)"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 2. \\<And>b \\<rho> r.\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub> =\n       (\\<N>\\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      r\\<^esub>\n 3. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Bool\n                    b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                         r\\<^esub> =\n    (\\<N>\\<lbrakk> Bool\n                    b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                   r\\<^esub>", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       r\\<^esub> =\n  (\\<N>\\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                 r\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 2. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 2. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "case (IfThenElse scrut e\\<^sub>1 e\\<^sub>2)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           ?r\\<^esub> =\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                      ?r\\<^esub>\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                               ?r\\<^esub> =\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          ?r\\<^esub>\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                               ?r\\<^esub> =\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          ?r\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>\n 2. \\<And>scrut e1 e2 \\<rho> r.\n       \\<lbrakk>\\<And>\\<rho> r.\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n     r\\<^esub> =\n                   (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                     r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                r\\<^esub> =\n           (\\<N>\\<lbrakk> e2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> (scrut ? e1\n   : e2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n      r\\<^esub>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                    r\\<^esub> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                              r\\<^esub>", "proof (rule C_restr_C_cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "fix r'"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "assume \"r' \\<sqsubseteq> r\""], ["proof (state)\nthis:\n  r' \\<sqsubseteq> r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"r' \\<sqsubseteq> C\\<cdot>r\""], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. r' \\<sqsubseteq> C\\<cdot>r", "by (metis below_C below_trans)"], ["proof (state)\nthis:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"(\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' = (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "using \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close>"], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "by (rule C_restr_eqD[OF IfThenElse(1)])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "moreover"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"(\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' = (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "using \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close>"], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "by (rule C_restr_eqD[OF IfThenElse(2)])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "moreover"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"(\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' = (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "using \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close>"], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n    (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "by (rule C_restr_eqD[OF IfThenElse(3)])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                       : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "ultimately"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'", "show \"(\\<N>\\<lbrakk> (scrut ? e\\<^sub>1 : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') = (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1 : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r')\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "using \\<open>r' \\<sqsubseteq> r\\<close>"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>r' =\n  (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                  : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n  (C\\<cdot>r') =\n  (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                  : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "qed simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                  : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                  r\\<^esub> =\n  (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                  : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                            r\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>", "case (Let \\<Gamma> e)"], ["proof (state)\nthis:\n  ?x \\<in> domA \\<Gamma> \\<Longrightarrow>\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       ?x) \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                               ?r\\<^esub> =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       ?x) \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          ?r\\<^esub>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       ?r\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                  ?r\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>", "txt \\<open>The lemma, lifted to heaps\\<close>"], ["proof (state)\nthis:\n  ?x \\<in> domA \\<Gamma> \\<Longrightarrow>\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       ?x) \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                               ?r\\<^esub> =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       ?x) \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                          ?r\\<^esub>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       ?r\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>?\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                  ?r\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>", "have restr_can_restrict_env_heap : \"\\<And> r. (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> = (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "proof(rule has_ESem.parallel_HSem_ind)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>r.\n       adm (\\<lambda>\\<rho>'.\n               fst \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n               snd \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n 2. \\<And>r.\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n 3. \\<And>r y z.\n       y|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       z|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>y\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>z\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "fix \\<rho>\\<^sub>1 \\<rho>\\<^sub>2 :: CEnv and r :: C"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>r.\n       adm (\\<lambda>\\<rho>'.\n               fst \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n               snd \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n 2. \\<And>r.\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n 3. \\<And>r y z.\n       y|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       z|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>y\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>z\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "assume \"\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> = \\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\""], ["proof (state)\nthis:\n  \\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n  \\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n\ngoal (3 subgoals):\n 1. \\<And>r.\n       adm (\\<lambda>\\<rho>'.\n               fst \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n               snd \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n 2. \\<And>r.\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n 3. \\<And>r y z.\n       y|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       z|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>y\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>z\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "show \" (\\<rho> ++\\<^bsub>domA \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> = (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "proof(rule env_C_restr_cong)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n        x\\<cdot>\n       r' =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n        x\\<cdot>\n       r'", "fix x and r'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n        x\\<cdot>\n       r' =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n        x\\<cdot>\n       r'", "assume \"r' \\<sqsubseteq> r\""], ["proof (state)\nthis:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. \\<And>x r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n        x\\<cdot>\n       r' =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n        x\\<cdot>\n       r'", "hence \"r' \\<sqsubseteq> C\\<cdot>r\""], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. r' \\<sqsubseteq> C\\<cdot>r", "by (metis below_C below_trans)"], ["proof (state)\nthis:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (1 subgoal):\n 1. \\<And>x r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<rho> ++\\<^bsub>domA\n                          \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n        x\\<cdot>\n       r' =\n       (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                    \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n        x\\<cdot>\n       r'", "show \"(\\<rho> ++\\<^bsub>domA \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>) x\\<cdot>r' = (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>) x\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "proof(cases \"x \\<in> domA \\<Gamma>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "case True"], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "have \"(\\<N>\\<lbrakk> the (map_of \\<Gamma> x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>r' = (\\<N>\\<lbrakk> the (map_of \\<Gamma> x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>\n    r' =\n    (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "by (rule C_restr_eqD[OF Let(1)[OF True] \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close>])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "have \"\\<dots> = (\\<N>\\<lbrakk> the (map_of \\<Gamma> x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r' =\n    (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "unfolding \\<open>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> = \\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r' =\n    (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", ".."], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "have \"\\<dots>   = (\\<N>\\<lbrakk> the (map_of \\<Gamma> x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r' =\n    (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\\<cdot>\n    r'", "by (rule C_restr_eqD[OF Let(1)[OF True] \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close>, symmetric])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "finally"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\\<cdot>\n  r'", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\\<cdot>\n  r'\n\ngoal (1 subgoal):\n 1. (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "using True"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\\<cdot>\n  r'\n  x \\<in> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "by (simp add: lookupEvalHeap)"], ["proof (state)\nthis:\n  (\\<rho> ++\\<^bsub>domA\n                     \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n   x\\<cdot>\n  r' =\n  (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n               \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n   x\\<cdot>\n  r'\n\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "case False"], ["proof (state)\nthis:\n  x \\<notin> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "with \\<open>r' \\<sqsubseteq> r\\<close>"], ["proof (chain)\npicking this:\n  r' \\<sqsubseteq> r\n  x \\<notin> domA \\<Gamma>", "show ?thesis"], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n  x \\<notin> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<rho> ++\\<^bsub>domA\n                       \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n     x\\<cdot>\n    r' =\n    (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n                 \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n     x\\<cdot>\n    r'", "by simp"], ["proof (state)\nthis:\n  (\\<rho> ++\\<^bsub>domA\n                     \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n   x\\<cdot>\n  r' =\n  (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n               \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n   x\\<cdot>\n  r'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<rho> ++\\<^bsub>domA\n                     \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)\n   x\\<cdot>\n  r' =\n  (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n               \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)\n   x\\<cdot>\n  r'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<rho> ++\\<^bsub>domA\n                     \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>1\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n  (\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> ++\\<^bsub>domA\n               \\<Gamma>\\<^esub> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^sub>2\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>r.\n       adm (\\<lambda>\\<rho>'.\n               fst \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n               snd \\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n 2. \\<And>r.\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n       \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "qed simp_all"], ["proof (state)\nthis:\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub> =\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>?r\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp \\<rho> r.\n       \\<lbrakk>\\<And>x \\<rho> r.\n                   x \\<in> domA \\<Gamma> \\<Longrightarrow>\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                   (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n  x) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n  r\\<^esub>;\n        \\<And>\\<rho> r.\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                                 r\\<^esub> =\n           (\\<N>\\<lbrakk> exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                           r\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>r\\<^esub> =\n                         (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n   exp \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n    r\\<^esub>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                         r\\<^esub> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                   r\\<^esub>", "proof (rule C_restr_C_cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "fix r'"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "assume \"r' \\<sqsubseteq> r\""], ["proof (state)\nthis:\n  r' \\<sqsubseteq> r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"r' \\<sqsubseteq> C\\<cdot>r\""], ["proof (prove)\nusing this:\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. r' \\<sqsubseteq> C\\<cdot>r", "by (metis below_C below_trans)"], ["proof (state)\nthis:\n  r' \\<sqsubseteq> C\\<cdot>r\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "have \"(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> = (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>(\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>))|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n    (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>", "by (rule restr_can_restrict_env_heap)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "hence \"(\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>r' = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> =\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    r' =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    r'", "by (subst (1 2) C_restr_eqD[OF Let(2) \\<open>r' \\<sqsubseteq> C\\<cdot>r\\<close>]) simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (2 subgoals):\n 1. \\<And>r'.\n       r' \\<sqsubseteq> r \\<Longrightarrow>\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n       (C\\<cdot>r') =\n       (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                       e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n       (C\\<cdot>r')\n 2. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "thus \"(\\<N>\\<lbrakk> Let \\<Gamma> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r') = (\\<N>\\<lbrakk> Let \\<Gamma> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r')\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "using \\<open>r' \\<sqsubseteq> r\\<close>"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  r' =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  r'\n  r' \\<sqsubseteq> r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    (C\\<cdot>r') =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r')", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                  e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n  (C\\<cdot>r') =\n  (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                  e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r')\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>\n    \\<bottom> =\n    (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                    e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    \\<bottom>", "qed simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                  e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>C\\<cdot>\n                       r\\<^esub> =\n  (\\<N>\\<lbrakk> Terms.Let \\<Gamma>\n                  e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>C\\<cdot>\n                 r\\<^esub>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma can_restrict_env:\n  \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r) = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)\\<cdot>(C\\<cdot>r) =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r)", "by (rule C_restr_eqD[OF restr_can_restrict_env below_refl])"], ["", "text \\<open>\nWhen an expression @{term e} terminates, then we can remove such an expression from the heap and it\nstill terminates. This is the crucial trick to handle black-holing in the resourced semantics.\n\\<close>"], ["", "lemma add_BH:\n  assumes \"map_of \\<Gamma> x = Some e\"\n  assumes  \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r' \\<noteq> \\<bottom>\"\n  shows \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r' \\<noteq> \\<bottom>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "obtain r where r: \"C\\<cdot>r = demand (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>r.\n        C\\<cdot>r =\n        demand\n         (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using demand_not_0"], ["proof (prove)\nusing this:\n  demand (\\<N>\\<lbrakk> ?e \\<rbrakk>\\<^bsub>?\\<rho>\\<^esub>) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        C\\<cdot>r =\n        demand\n         (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (cases \"demand (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\") auto"], ["proof (state)\nthis:\n  C\\<cdot>r =\n  demand\n   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "from  assms(2)"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r' \\<noteq>\n  \\<bottom>", "have \"C\\<cdot>r \\<sqsubseteq> r'\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r' \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. C\\<cdot>r \\<sqsubseteq> r'", "unfolding r not_bot_demand"], ["proof (prove)\nusing this:\n  demand\n   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>) \\<noteq>\n  C\\<^sup>\\<infinity> \\<and>\n  demand\n   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>) \\<sqsubseteq>\n  r'\n\ngoal (1 subgoal):\n 1. demand\n     (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>) \\<sqsubseteq>\n    r'", "by simp"], ["proof (state)\nthis:\n  C\\<cdot>r \\<sqsubseteq> r'\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "from assms(1)"], ["proof (chain)\npicking this:\n  map_of \\<Gamma> x = Some e", "have [simp]: \"the (map_of \\<Gamma> x) = e\""], ["proof (prove)\nusing this:\n  map_of \\<Gamma> x = Some e\n\ngoal (1 subgoal):\n 1. the (map_of \\<Gamma> x) = e", "by (metis option.sel)"], ["proof (state)\nthis:\n  the (map_of \\<Gamma> x) = e\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "from assms(1)"], ["proof (chain)\npicking this:\n  map_of \\<Gamma> x = Some e", "have [simp]: \"x \\<in> domA \\<Gamma>\""], ["proof (prove)\nusing this:\n  map_of \\<Gamma> x = Some e\n\ngoal (1 subgoal):\n 1. x \\<in> domA \\<Gamma>", "by (metis domIff dom_map_of_conv_domA not_Some_eq)"], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "define ub where \"ub = \\<N>\\<lbrace>\\<Gamma>\\<rbrace>\" \\<comment> \\<open>An upper bound for the induction\\<close>"], ["proof (state)\nthis:\n  ub = \\<N>\\<lbrace>\\<Gamma>\\<rbrace>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "have heaps: \"(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq> \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\" and \"\\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq> ub\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> &&&\n    \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq> ub", "proof (induction rule: HSem_bot_ind)"], ["proof (state)\ngoal (5 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                         \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 5. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "fix \\<rho>"], ["proof (state)\ngoal (5 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                         \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 5. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "assume \"\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq> \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\""], ["proof (state)\nthis:\n  \\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n\ngoal (5 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                         \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 5. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "assume \"\\<rho> \\<sqsubseteq> ub\""], ["proof (state)\nthis:\n  \\<rho> \\<sqsubseteq> ub\n\ngoal (5 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                         \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 5. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "show \"(\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq> \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>", "proof (rule fun_belowI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n        xa \\<sqsubseteq>\n       (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) xa", "fix y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n        xa \\<sqsubseteq>\n       (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) xa", "show \"((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>) y \\<sqsubseteq> (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "proof (cases \"y = x\")"], ["proof (state)\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "case True"], ["proof (state)\nthis:\n  y = x\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>) x = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     x =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub>", "by (simp add: lookupEvalHeap)"], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   x =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "also"], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   x =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"\\<dots> \\<sqsubseteq> (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub>", "using \\<open>\\<rho> \\<sqsubseteq> ub\\<close>"], ["proof (prove)\nusing this:\n  \\<rho> \\<sqsubseteq> ub\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub>", "by (intro monofun_cfun_arg)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"\\<dots> = (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub> =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub>", "unfolding ub_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub> =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub>", ".."], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>ub\\<^esub>)|\\<^bsub>r\\<^esub> =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"\\<dots> = \\<bottom>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub> =\n    \\<bottom>", "using r"], ["proof (prove)\nusing this:\n  C\\<cdot>r =\n  demand\n   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub> =\n    \\<bottom>", "by (rule  C_restr_bot_demand[OF eq_imp_below])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub> =\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)|\\<^bsub>r\\<^esub> =\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"\\<dots> = (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bottom> = (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x", "by (simp add: lookup_HSem_other)"], ["proof (state)\nthis:\n  \\<bottom> = (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x\n\ngoal (2 subgoals):\n 1. y = x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "finally"], ["proof (chain)\npicking this:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   x \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x", "show ?thesis"], ["proof (prove)\nusing this:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   x \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x\n\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "unfolding True"], ["proof (prove)\nusing this:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   x \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x\n\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     x \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) x", "."], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   y \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n\ngoal (1 subgoal):\n 1. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "case False"], ["proof (state)\nthis:\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. y \\<noteq> x \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "proof (cases \"y \\<in> domA \\<Gamma>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "case True"], ["proof (state)\nthis:\n  y \\<in> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"(\\<N>\\<lbrakk> the (map_of \\<Gamma> y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> = (\\<N>\\<lbrakk> the (map_of \\<Gamma> y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> =\n    (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub>", "by (rule C_restr_eq_lower[OF restr_can_restrict_env below_C])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> =\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub>\n\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "have \"\\<dots> \\<sqsubseteq> \\<N>\\<lbrakk> the (map_of \\<Gamma> y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrakk> the (map_of \\<Gamma>\n                        y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>", "by (rule C_restr_below)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> the (map_of \\<Gamma>\n                      y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>\n\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> the (map_of \\<Gamma>\n                      y) \\<rbrakk>\\<^bsub>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>\n\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "note \\<open>\\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq> \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<close>"], ["proof (state)\nthis:\n  \\<rho>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n\ngoal (2 subgoals):\n 1. y \\<in> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n 2. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "finally"], ["proof (chain)\npicking this:\n  cont (ESem_syn (the (map_of \\<Gamma> y))) \\<Longrightarrow>\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> the (map_of \\<Gamma>\n                      y) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>\\<^esub>", "show ?thesis"], ["proof (prove)\nusing this:\n  cont (ESem_syn (the (map_of \\<Gamma> y))) \\<Longrightarrow>\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> the (map_of \\<Gamma>\n                      y) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>\\<^esub>\n\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "using \\<open>y \\<in> domA \\<Gamma>\\<close> \\<open>y \\<noteq> x\\<close>"], ["proof (prove)\nusing this:\n  cont (ESem_syn (the (map_of \\<Gamma> y))) \\<Longrightarrow>\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       y) \\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> the (map_of \\<Gamma>\n                      y) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>\\<^esub>\n  y \\<in> domA \\<Gamma>\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "by (simp add: lookupEvalHeap lookup_HSem_heap)"], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   y \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n\ngoal (1 subgoal):\n 1. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "case False"], ["proof (state)\nthis:\n  y \\<notin> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. y \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<notin> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n     y \\<sqsubseteq>\n    (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y", "by simp"], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   y \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   y \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ((\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>)\n   y \\<sqsubseteq>\n  (\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>) y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n\ngoal (4 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "from \\<open>\\<rho> \\<sqsubseteq> ub\\<close>"], ["proof (chain)\npicking this:\n  \\<rho> \\<sqsubseteq> ub", "have \"(\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) \\<sqsubseteq> (\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>ub\\<^esub>)\""], ["proof (prove)\nusing this:\n  \\<rho> \\<sqsubseteq> ub\n\ngoal (1 subgoal):\n 1. \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n    \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>ub\\<^esub>", "by (rule cont2monofunE[rotated]) simp"], ["proof (state)\nthis:\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>ub\\<^esub>\n\ngoal (4 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "also"], ["proof (state)\nthis:\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>ub\\<^esub>\n\ngoal (4 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "have \"\\<dots> = ub\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>ub\\<^esub> = ub", "unfolding ub_def HSem_bot_eq[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<N>\\<lbrace>\\<Gamma>\\<rbrace> = \\<N>\\<lbrace>\\<Gamma>\\<rbrace>", ".."], ["proof (state)\nthis:\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>ub\\<^esub> = ub\n\ngoal (4 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub\n 4. \\<And>\\<rho>'.\n       \\<lbrakk>\\<rho>'|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n                \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>;\n        \\<rho>' \\<sqsubseteq> ub\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>'\\<^esub> \\<sqsubseteq>\n                         ub", "finally"], ["proof (chain)\npicking this:\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n  ub", "show \"(\\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub>) \\<sqsubseteq> ub\""], ["proof (prove)\nusing this:\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n  ub\n\ngoal (1 subgoal):\n 1. \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n    ub", "."], ["proof (state)\nthis:\n  \\<^bold>\\<N>\\<lbrakk> \\<Gamma> \\<^bold>\\<rbrakk>\\<^bsub>\\<rho>\\<^esub> \\<sqsubseteq>\n  ub\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n            \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace> \\<and>\n            a \\<sqsubseteq> ub)\n 2. \\<bottom>|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n 3. \\<bottom> \\<sqsubseteq> ub", "qed simp_all"], ["proof (state)\nthis:\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq> ub\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "from assms(2)"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r' \\<noteq>\n  \\<bottom>", "have \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>(C\\<cdot>r) \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r' \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    (C\\<cdot>r) \\<noteq>\n    \\<bottom>", "unfolding r"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r' \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    (demand\n      (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)) \\<noteq>\n    \\<bottom>", "by (rule demand_suffices[OF infinite_resources_suffice])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "have \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>(C\\<cdot>r) = (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>(C\\<cdot>r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    (C\\<cdot>r) =\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r)", "by (rule can_restrict_env)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) =\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "have \"\\<dots> \\<sqsubseteq> (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>(C\\<cdot>r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n    (C\\<cdot>r) \\<sqsubseteq>\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    (C\\<cdot>r)", "by (intro monofun_cfun_arg monofun_cfun_fun heaps )"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<sqsubseteq>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>)|\\<^sup>\\<circ>\\<^bsub>r\\<^esub>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<sqsubseteq>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "have \"\\<dots> \\<sqsubseteq> (\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    (C\\<cdot>r) \\<sqsubseteq>\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r'", "using \\<open>C\\<cdot>r \\<sqsubseteq> r'\\<close>"], ["proof (prove)\nusing this:\n  C\\<cdot>r \\<sqsubseteq> r'\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    (C\\<cdot>r) \\<sqsubseteq>\n    (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r'", "by (rule monofun_cfun_arg)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<sqsubseteq>\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r'\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>cont (\\<lambda>a. a); cont (\\<lambda>a. a)\\<rbrakk>\n  \\<Longrightarrow> (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                    r' \\<noteq>\n                    \\<bottom>", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>cont (\\<lambda>a. a); cont (\\<lambda>a. a)\\<rbrakk>\n  \\<Longrightarrow> (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                    r' \\<noteq>\n                    \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r' \\<noteq>\n    \\<bottom>", "by this (intro cont2cont)+"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r' \\<noteq>\n  \\<bottom>\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\nThe semantics is continuous, so we can apply induction here:\n\\<close>"], ["", "lemma resourced_adequacy:\n  assumes \"(\\<N>\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\"\n  shows \"\\<exists> \\<Delta> v. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> v. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : v", "using assms"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> v. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : v", "proof(induction r arbitrary: \\<Gamma> e S rule: C.induct[case_names adm bot step])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x xa.\n               (\\<N>\\<lbrakk> xa \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>x\\<rbrace>\\<^esub>)\\<cdot>\n               a \\<noteq>\n               \\<bottom> \\<longrightarrow>\n               (\\<forall>xb. \\<exists>\\<Delta>. Ex (reds x xa xb \\<Delta>)))\n 2. \\<And>\\<Gamma> e S.\n       (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n       \\<bottom> \\<noteq>\n       \\<bottom> \\<Longrightarrow>\n       \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)\n 3. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "case adm"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x xa.\n               (\\<N>\\<lbrakk> xa \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>x\\<rbrace>\\<^esub>)\\<cdot>\n               a \\<noteq>\n               \\<bottom> \\<longrightarrow>\n               (\\<forall>xb. \\<exists>\\<Delta>. Ex (reds x xa xb \\<Delta>)))\n 2. \\<And>\\<Gamma> e S.\n       (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n       \\<bottom> \\<noteq>\n       \\<bottom> \\<Longrightarrow>\n       \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)\n 3. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x xa.\n               (\\<N>\\<lbrakk> xa \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>x\\<rbrace>\\<^esub>)\\<cdot>\n               a \\<noteq>\n               \\<bottom> \\<longrightarrow>\n               (\\<forall>xb.\n                   \\<exists>\\<Delta> a.\n                      x : xa \\<Down>\\<^bsub>xb\\<^esub> \\<Delta> : a))", "by simp"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x xa.\n             (\\<N>\\<lbrakk> xa \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>x\\<rbrace>\\<^esub>)\\<cdot>\n             a \\<noteq>\n             \\<bottom> \\<longrightarrow>\n             (\\<forall>xb.\n                 \\<exists>\\<Delta> a.\n                    x : xa \\<Down>\\<^bsub>xb\\<^esub> \\<Delta> : a))\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> e S.\n       (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n       \\<bottom> \\<noteq>\n       \\<bottom> \\<Longrightarrow>\n       \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)\n 2. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> e S.\n       (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n       \\<bottom> \\<noteq>\n       \\<bottom> \\<Longrightarrow>\n       \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)\n 2. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "case bot"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  \\<bottom> \\<noteq>\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> e S.\n       (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n       \\<bottom> \\<noteq>\n       \\<bottom> \\<Longrightarrow>\n       \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)\n 2. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "hence False"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  \\<bottom> \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> e S.\n       (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n       \\<bottom> \\<noteq>\n       \\<bottom> \\<Longrightarrow>\n       \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)\n 2. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "thus ?case"], ["proof (prove)\nusing this:\n  False\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", ".."], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "case (step r)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> ?e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>?\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom> \\<Longrightarrow>\n  \\<exists>\\<Delta> a. ?\\<Gamma> : ?e \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a\n  (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. \\<And>Ca \\<Gamma> e S.\n       \\<lbrakk>\\<And>\\<Gamma> e S.\n                   (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                   Ca \\<noteq>\n                   \\<bottom> \\<Longrightarrow>\n                   \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>);\n        (\\<N>\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n        (C\\<cdot>Ca) \\<noteq>\n        \\<bottom>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta>. Ex (reds \\<Gamma> e S \\<Delta>)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "proof(cases e rule:exp_strong_exhaust(1)[where c = \"(\\<Gamma>,S)\", case_names Var App Let Lam Bool IfThenElse])"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "case (Var x)"], ["proof (state)\nthis:\n  e = Var x\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "let ?e = \"the (map_of \\<Gamma> x)\""], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.prems[unfolded Var]"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>", "have \"x \\<in> domA \\<Gamma>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. x \\<in> domA \\<Gamma>", "by (auto intro: ccontr simp add: lookup_HSem_other)"], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma>\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"map_of \\<Gamma> x = Some ?e\""], ["proof (prove)\nusing this:\n  x \\<in> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))", "by (rule domA_map_of_Some_the)"], ["proof (state)\nthis:\n  map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "moreover"], ["proof (state)\nthis:\n  map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.prems[unfolded Var] \\<open>map_of \\<Gamma> x = Some ?e\\<close> \\<open>x \\<in> domA \\<Gamma>\\<close>"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n  map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))\n  x \\<in> domA \\<Gamma>", "have \"(\\<N>\\<lbrakk>?e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n  map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))\n  x \\<in> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by (auto simp add: lookup_HSem_heap  simp del: app_strict)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"(\\<N>\\<lbrakk>?e\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                         x) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                     \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by (rule add_BH[OF \\<open>map_of \\<Gamma> x = Some ?e\\<close>])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> the (map_of \\<Gamma>\n                       x) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>delete x\n                   \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.IH[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>\\<Delta> a.\n     delete x\n      \\<Gamma> : the (map_of \\<Gamma>\n                       x) \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a", "obtain \\<Delta> v where \"delete x \\<Gamma> : ?e \\<Down>\\<^bsub>x # S\\<^esub> \\<Delta> : v\""], ["proof (prove)\nusing this:\n  \\<exists>\\<Delta> a.\n     delete x\n      \\<Gamma> : the (map_of \\<Gamma>\n                       x) \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Delta> v.\n        delete x\n         \\<Gamma> : the (map_of \\<Gamma>\n                          x) \\<Down>\\<^bsub>x #\n      S\\<^esub> \\<Delta> : v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  delete x\n   \\<Gamma> : the (map_of \\<Gamma>\n                    x) \\<Down>\\<^bsub>x # S\\<^esub> \\<Delta> : v\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "ultimately"], ["proof (chain)\npicking this:\n  map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))\n  delete x\n   \\<Gamma> : the (map_of \\<Gamma>\n                    x) \\<Down>\\<^bsub>x # S\\<^esub> \\<Delta> : v", "have \"\\<Gamma> : (Var x) \\<Down>\\<^bsub>S\\<^esub> (x,v) #  \\<Delta> : v\""], ["proof (prove)\nusing this:\n  map_of \\<Gamma> x = Some (the (map_of \\<Gamma> x))\n  delete x\n   \\<Gamma> : the (map_of \\<Gamma>\n                    x) \\<Down>\\<^bsub>x # S\\<^esub> \\<Delta> : v\n\ngoal (1 subgoal):\n 1. \\<Gamma> : Var x \\<Down>\\<^bsub>S\\<^esub> (x, v) # \\<Delta> : v", "by (rule Variable)"], ["proof (state)\nthis:\n  \\<Gamma> : Var x \\<Down>\\<^bsub>S\\<^esub> (x, v) # \\<Delta> : v\n\ngoal (6 subgoals):\n 1. \\<And>var.\n       e = Var var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 6. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> : Var x \\<Down>\\<^bsub>S\\<^esub> (x, v) # \\<Delta> : v\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "using Var"], ["proof (prove)\nusing this:\n  \\<Gamma> : Var x \\<Down>\\<^bsub>S\\<^esub> (x, v) # \\<Delta> : v\n  e = Var x\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "case (App e' x)"], ["proof (state)\nthis:\n  e = App e' x\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"finite (set S \\<union> fv (\\<Gamma>, e'))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (set S \\<union> fv (\\<Gamma>, e'))", "by simp"], ["proof (state)\nthis:\n  finite (set S \\<union> fv (\\<Gamma>, e'))\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from finite_list[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>xs. set xs = set S \\<union> fv (\\<Gamma>, e')", "obtain S' where S': \"set S' = set S \\<union> fv (\\<Gamma>, e')\""], ["proof (prove)\nusing this:\n  \\<exists>xs. set xs = set S \\<union> fv (\\<Gamma>, e')\n\ngoal (1 subgoal):\n 1. (\\<And>S'.\n        set S' = set S \\<union> fv (\\<Gamma>, e') \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", ".."], ["proof (state)\nthis:\n  set S' = set S \\<union> fv (\\<Gamma>, e')\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.prems[unfolded App]"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> App e'\n                  x \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>", "have prem: \"((\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<down>CFn (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> App e'\n                  x \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. ((\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n     r \\<down>CFn\n     (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by (auto simp del: app_strict)"], ["proof (state)\nthis:\n  ((\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"(\\<N>\\<lbrakk>e'\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  ((\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by auto"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.IH[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>\\<Delta> a. \\<Gamma> : e' \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a", "obtain \\<Delta> v where lhs': \"\\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\""], ["proof (prove)\nusing this:\n  \\<exists>\\<Delta> a. \\<Gamma> : e' \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Delta> v.\n        \\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"fv (\\<Gamma>, e') \\<subseteq> set S'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, e') \\<subseteq> set S'", "using S'"], ["proof (prove)\nusing this:\n  set S' = set S \\<union> fv (\\<Gamma>, e')\n\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, e') \\<subseteq> set S'", "by auto"], ["proof (state)\nthis:\n  fv (\\<Gamma>, e') \\<subseteq> set S'\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from correctness_empty_env[OF lhs' this]"], ["proof (chain)\npicking this:\n  \\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>", "have correct1: \"\\<N>\\<lbrakk>e'\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq> \\<N>\\<lbrakk>v\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\" and \"\\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq> \\<N>\\<lbrace>\\<Delta>\\<rbrace>\""], ["proof (prove)\nusing this:\n  \\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (1 subgoal):\n 1. \\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub> &&&\n    \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n    \\<N>\\<lbrace>\\<Delta>\\<rbrace>", "by auto"], ["proof (state)\nthis:\n  \\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from prem"], ["proof (chain)\npicking this:\n  ((\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>", "have \"((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r \\<down>CFn (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  ((\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n     r \\<down>CFn\n     (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by (rule not_bot_below_trans)(intro correct1 monofun_cfun_fun  monofun_cfun_arg)"], ["proof (state)\nthis:\n  ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "with result_evaluated[OF lhs']"], ["proof (chain)\npicking this:\n  isVal v\n  ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>", "have \"isLam v\""], ["proof (prove)\nusing this:\n  isVal v\n  ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. isLam v", "by (cases r, auto, cases v rule: isVal.cases, auto)"], ["proof (state)\nthis:\n  isLam v\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "then"], ["proof (chain)\npicking this:\n  isLam v", "obtain y e'' where n': \"v = (Lam [y]. e'')\""], ["proof (prove)\nusing this:\n  isLam v\n\ngoal (1 subgoal):\n 1. (\\<And>y e''.\n        v = Lam [y]. e'' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (rule isLam_obtain_fresh)"], ["proof (state)\nthis:\n  v = Lam [y]. e''\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "with lhs'"], ["proof (chain)\npicking this:\n  \\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\n  v = Lam [y]. e''", "have lhs: \"\\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : Lam [y]. e''\""], ["proof (prove)\nusing this:\n  \\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\n  v = Lam [y]. e''\n\ngoal (1 subgoal):\n 1. \\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : Lam [y]. e''", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> : e' \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : Lam [y]. e''\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r \\<down>CFn (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n     r \\<down>CFn\n     (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by fact"], ["proof (state)\nthis:\n  ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n   r \\<down>CFn\n   (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub> \\<sqsubseteq> (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n    (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x", "by (rule C_restr_below)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x|\\<^bsub>r\\<^esub> \\<sqsubseteq>\n  (\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) x\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "note \\<open>v = _\\<close>"], ["proof (state)\nthis:\n  v = Lam [y]. e''\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  v = Lam [y]. e''\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "note \\<open>(\\<N>\\<lbrace>\\<Gamma>\\<rbrace>) \\<sqsubseteq> (\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\\<close>"], ["proof (state)\nthis:\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"(\\<N>\\<lbrakk> Lam [y]. e'' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r \\<sqsubseteq> CFn\\<cdot>(\\<Lambda> v. \\<N>\\<lbrakk>e''\\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)(y := v)\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> Lam [y]. e'' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<sqsubseteq>\n    CFn\\<cdot>\n    (\\<Lambda> v.\n        \\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n        (y := v)\\<^esub>)", "by (rule CELam_no_restr)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Lam [y]. e'' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<sqsubseteq>\n  CFn\\<cdot>\n  (\\<Lambda> v.\n      \\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n      (y := v)\\<^esub>)\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> Lam [y]. e'' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<sqsubseteq>\n  CFn\\<cdot>\n  (\\<Lambda> v.\n      \\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n      (y := v)\\<^esub>)\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"(\\<dots> \\<down>CFn (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<cdot>r = (\\<N>\\<lbrakk>e''\\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)(y := ((\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x))\\<^esub>)\\<cdot>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (CFn\\<cdot>\n     (\\<Lambda> v.\n         \\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n         (y := v)\\<^esub>) \\<down>CFn\n     (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<cdot>\n    r =\n    (\\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n     (y := (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<^esub>)\\<cdot>\n    r", "by simp"], ["proof (state)\nthis:\n  (CFn\\<cdot>\n   (\\<Lambda> v.\n       \\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n       (y := v)\\<^esub>) \\<down>CFn\n   (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<cdot>\n  r =\n  (\\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n   (y := (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<^esub>)\\<cdot>\n  r\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  (CFn\\<cdot>\n   (\\<Lambda> v.\n       \\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n       (y := v)\\<^esub>) \\<down>CFn\n   (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<cdot>\n  r =\n  (\\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n   (y := (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<^esub>)\\<cdot>\n  r\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"\\<dots> = (\\<N>\\<lbrakk>e''[y::=x]\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n     (y := (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<^esub>)\\<cdot>\n    r =\n    (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r", "unfolding ESem_subst"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r =\n    (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r", ".."], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e'' \\<rbrakk>\\<^bsub>(\\<N>\\<lbrace>\\<Delta>\\<rbrace>)\n   (y := (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<^esub>)\\<cdot>\n  r =\n  (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>cont\n            (\\<lambda>a.\n                ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n                 r \\<down>CFn\n                 a)\\<cdot>\n                r);\n   cont\n    (\\<lambda>a.\n        ((\\<N>\\<lbrakk> Lam [y]. e'' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n         r \\<down>CFn\n         a x)\\<cdot>\n        r);\n   cont\n    (\\<lambda>a.\n        (a \\<down>CFn (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<cdot>r)\\<rbrakk>\n  \\<Longrightarrow> (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n                    r \\<noteq>\n                    \\<bottom>", "have \"\\<dots> \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  \\<lbrakk>cont\n            (\\<lambda>a.\n                ((\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n                 r \\<down>CFn\n                 a)\\<cdot>\n                r);\n   cont\n    (\\<lambda>a.\n        ((\\<N>\\<lbrakk> Lam [y]. e'' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n         r \\<down>CFn\n         a x)\\<cdot>\n        r);\n   cont\n    (\\<lambda>a.\n        (a \\<down>CFn (\\<N>\\<lbrace>\\<Delta>\\<rbrace>) x)\\<cdot>r)\\<rbrakk>\n  \\<Longrightarrow> (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n                    r \\<noteq>\n                    \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by this (intro cont2cont cont_fun)+"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "then"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>", "obtain \\<Theta> v' where rhs: \"\\<Delta> : e''[y::=x] \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Theta> v'.\n        \\<Delta> : e''[y::=x] \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using step.IH"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e''[y::=x] \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n  (\\<N>\\<lbrakk> ?e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>?\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom> \\<Longrightarrow>\n  \\<exists>\\<Delta> a. ?\\<Gamma> : ?e \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Theta> v'.\n        \\<Delta> : e''[y::=x] \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<Delta> : e''[y::=x] \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"\\<Gamma> : App e' x \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> : App e' x \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'", "by (rule reds_ApplicationI[OF lhs rhs])"], ["proof (state)\nthis:\n  \\<Gamma> : App e' x \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"\\<Gamma> : App e' x \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\""], ["proof (prove)\nusing this:\n  \\<Gamma> : App e' x \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (1 subgoal):\n 1. \\<Gamma> : App e' x \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'", "apply (rule reds_smaller_L)"], ["proof (prove)\ngoal (1 subgoal):\n 1. set S \\<subseteq> set S'", "using S'"], ["proof (prove)\nusing this:\n  set S' = set S \\<union> fv (\\<Gamma>, e')\n\ngoal (1 subgoal):\n 1. set S \\<subseteq> set S'", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> : App e' x \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\n\ngoal (5 subgoals):\n 1. \\<And>exp var.\n       e = App exp var \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 5. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> : App e' x \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "using App"], ["proof (prove)\nusing this:\n  \\<Gamma> : App e' x \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\n  e = App e' x\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "case (Lam v e')"], ["proof (state)\nthis:\n  {atom v} \\<sharp>* (\\<Gamma>, S)\n  e = Lam [v]. e'\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"\\<Gamma> : Lam [v]. e' \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Lam [v]. e'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> : Lam [v]. e' \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Lam [v]. e'", ".."], ["proof (state)\nthis:\n  \\<Gamma> : Lam [v]. e' \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Lam [v]. e'\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>var exp.\n       \\<lbrakk>{atom var} \\<sharp>* (\\<Gamma>, S);\n        e = Lam [var]. exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 4. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> : Lam [v]. e' \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Lam [v]. e'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "using Lam"], ["proof (prove)\nusing this:\n  \\<Gamma> : Lam [v]. e' \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Lam [v]. e'\n  {atom v} \\<sharp>* (\\<Gamma>, S)\n  e = Lam [v]. e'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "by blast"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "case (Bool b)"], ["proof (state)\nthis:\n  e = Bool b\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"\\<Gamma> : Bool b \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Bool b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> : Bool b \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Bool b", "by rule"], ["proof (state)\nthis:\n  \\<Gamma> : Bool b \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Bool b\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>b.\n       e = Bool b \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 3. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> : Bool b \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Bool b\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "using Bool"], ["proof (prove)\nusing this:\n  \\<Gamma> : Bool b \\<Down>\\<^bsub>S\\<^esub> \\<Gamma> : Bool b\n  e = Bool b\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "by blast"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "case (IfThenElse scrut e\\<^sub>1 e\\<^sub>2)"], ["proof (state)\nthis:\n  e = (scrut ? e\\<^sub>1 : e\\<^sub>2)\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.prems[unfolded IfThenElse]"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                  : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>", "have prem: \"CB_project\\<cdot>((\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r)\\<cdot>((\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r)\\<cdot>((\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r) \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> (scrut ? e\\<^sub>1\n                  : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. CB_project\\<cdot>\n    ((\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n     r)\\<cdot>\n    ((\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n     r)\\<cdot>\n    ((\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n     r) \\<noteq>\n    \\<bottom>", "by (auto simp del: app_strict)"], ["proof (state)\nthis:\n  CB_project\\<cdot>\n  ((\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r)\\<cdot>\n  ((\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r)\\<cdot>\n  ((\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r) \\<noteq>\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "then"], ["proof (chain)\npicking this:\n  CB_project\\<cdot>\n  ((\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r)\\<cdot>\n  ((\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r)\\<cdot>\n  ((\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r) \\<noteq>\n  \\<bottom>", "obtain b where\n      is_CB: \"(\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r = CB\\<cdot>(Discr b)\"\n      and not_bot2: \"((\\<N>\\<lbrakk> (if b then e\\<^sub>1 else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r) \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  CB_project\\<cdot>\n  ((\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r)\\<cdot>\n  ((\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r)\\<cdot>\n  ((\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n   r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<And>b.\n        \\<lbrakk>(\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                 r =\n                 CB\\<cdot>(Discr b);\n         (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                         else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n         r \\<noteq>\n         \\<bottom>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding CB_project_not_bot"], ["proof (prove)\nusing this:\n  \\<exists>b.\n     (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n     r =\n     CB\\<cdot>(Discr b) \\<and>\n     (if b\n      then (\\<N>\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n           r\n      else (\\<N>\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n           r) \\<noteq>\n     \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<And>b.\n        \\<lbrakk>(\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n                 r =\n                 CB\\<cdot>(Discr b);\n         (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                         else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n         r \\<noteq>\n         \\<bottom>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto split: if_splits)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)\n  (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                  else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"finite (set S \\<union> fv (\\<Gamma>, scrut))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (set S \\<union> fv (\\<Gamma>, scrut))", "by simp"], ["proof (state)\nthis:\n  finite (set S \\<union> fv (\\<Gamma>, scrut))\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from finite_list[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>xs. set xs = set S \\<union> fv (\\<Gamma>, scrut)", "obtain S' where S': \"set S' = set S \\<union> fv (\\<Gamma>, scrut)\""], ["proof (prove)\nusing this:\n  \\<exists>xs. set xs = set S \\<union> fv (\\<Gamma>, scrut)\n\ngoal (1 subgoal):\n 1. (\\<And>S'.\n        set S' = set S \\<union> fv (\\<Gamma>, scrut) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", ".."], ["proof (state)\nthis:\n  set S' = set S \\<union> fv (\\<Gamma>, scrut)\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from is_CB"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)", "have \"(\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.IH[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>\\<Delta> a.\n     \\<Gamma> : scrut \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a", "obtain \\<Delta> v where lhs': \"\\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\""], ["proof (prove)\nusing this:\n  \\<exists>\\<Delta> a.\n     \\<Gamma> : scrut \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Delta> v.\n        \\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v", "have \"isVal v\""], ["proof (prove)\nusing this:\n  \\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : v\n\ngoal (1 subgoal):\n 1. isVal v", "by (rule result_evaluated)"], ["proof (state)\nthis:\n  isVal v\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"fv (\\<Gamma>, scrut) \\<subseteq> set S'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, scrut) \\<subseteq> set S'", "using S'"], ["proof (prove)\nusing this:\n  set S' = set S \\<union> fv (\\<Gamma>, scrut)\n\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, scrut) \\<subseteq> set S'", "by simp"], ["proof (state)\nthis:\n  fv (\\<Gamma>, scrut) \\<subseteq> set S'\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from correctness_empty_env[OF lhs' this]"], ["proof (chain)\npicking this:\n  \\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>", "have correct1: \"\\<N>\\<lbrakk>scrut\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq> \\<N>\\<lbrakk>v\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\" and correct2: \"\\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq> \\<N>\\<lbrace>\\<Delta>\\<rbrace>\""], ["proof (prove)\nusing this:\n  \\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (1 subgoal):\n 1. \\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n    \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub> &&&\n    \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n    \\<N>\\<lbrace>\\<Delta>\\<rbrace>", "by auto"], ["proof (state)\nthis:\n  \\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from correct1"], ["proof (chain)\npicking this:\n  \\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>", "have \"(\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<sqsubseteq> (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r\""], ["proof (prove)\nusing this:\n  \\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub> \\<sqsubseteq>\n  \\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<sqsubseteq>\n    (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r", "by (rule monofun_cfun_fun)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<sqsubseteq>\n  (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "with is_CB"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<sqsubseteq>\n  (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r", "have \"(\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r = CB\\<cdot>(Discr b)\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)\n  (\\<N>\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<sqsubseteq>\n  (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r =\n    CB\\<cdot>(Discr b)", "by simp"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "with \\<open>isVal v\\<close>"], ["proof (chain)\npicking this:\n  isVal v\n  (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)", "have \"v = Bool b\""], ["proof (prove)\nusing this:\n  isVal v\n  (\\<N>\\<lbrakk> v \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r =\n  CB\\<cdot>(Discr b)\n\ngoal (1 subgoal):\n 1. v = Bool b", "by (cases v rule: isVal.cases) (case_tac r, auto)+"], ["proof (state)\nthis:\n  v = Bool b\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from not_bot2 \\<open>\\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq> \\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<close>"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                  else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>", "have \"(\\<N>\\<lbrakk> (if b then e\\<^sub>1 else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                  else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n  \\<N>\\<lbrace>\\<Gamma>\\<rbrace> \\<sqsubseteq>\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by (rule not_bot_below_trans[OF _ monofun_cfun_fun[OF monofun_cfun_arg]])"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> (if b then e\\<^sub>1\n                  else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.IH[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>\\<Delta>' a.\n     \\<Delta> : (if b then e\\<^sub>1\n                 else e\\<^sub>2) \\<Down>\\<^bsub>?S\\<^esub> \\<Delta>' : a", "obtain \\<Theta> v' where rhs: \"\\<Delta> : (if b then e\\<^sub>1 else e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\""], ["proof (prove)\nusing this:\n  \\<exists>\\<Delta>' a.\n     \\<Delta> : (if b then e\\<^sub>1\n                 else e\\<^sub>2) \\<Down>\\<^bsub>?S\\<^esub> \\<Delta>' : a\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Theta> v'.\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<Delta> : (if b then e\\<^sub>1\n              else e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from lhs'[unfolded \\<open>v = _\\<close>] rhs"], ["proof (chain)\npicking this:\n  \\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : Bool b\n  \\<Delta> : (if b then e\\<^sub>1\n              else e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'", "have \"\\<Gamma> : (scrut ? e\\<^sub>1 : e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\""], ["proof (prove)\nusing this:\n  \\<Gamma> : scrut \\<Down>\\<^bsub>S'\\<^esub> \\<Delta> : Bool b\n  \\<Delta> : (if b then e\\<^sub>1\n              else e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (1 subgoal):\n 1. \\<Gamma> : (scrut ? e\\<^sub>1\n                : e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'", "by rule"], ["proof (state)\nthis:\n  \\<Gamma> : (scrut ? e\\<^sub>1\n              : e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"\\<Gamma> : (scrut ? e\\<^sub>1 : e\\<^sub>2) \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\""], ["proof (prove)\nusing this:\n  \\<Gamma> : (scrut ? e\\<^sub>1\n              : e\\<^sub>2) \\<Down>\\<^bsub>S'\\<^esub> \\<Theta> : v'\n\ngoal (1 subgoal):\n 1. \\<Gamma> : (scrut ? e\\<^sub>1\n                : e\\<^sub>2) \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'", "apply (rule reds_smaller_L)"], ["proof (prove)\ngoal (1 subgoal):\n 1. set S \\<subseteq> set S'", "using S'"], ["proof (prove)\nusing this:\n  set S' = set S \\<union> fv (\\<Gamma>, scrut)\n\ngoal (1 subgoal):\n 1. set S \\<subseteq> set S'", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> : (scrut ? e\\<^sub>1\n              : e\\<^sub>2) \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n 2. \\<And>scrut e1 e2.\n       e = (scrut ? e1 : e2) \\<Longrightarrow>\n       \\<exists>\\<Delta> a.\n          \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> : (scrut ? e\\<^sub>1\n              : e\\<^sub>2) \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "unfolding IfThenElse"], ["proof (prove)\nusing this:\n  \\<Gamma> : (scrut ? e\\<^sub>1\n              : e\\<^sub>2) \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a.\n       \\<Gamma> : (scrut ? e\\<^sub>1\n                   : e\\<^sub>2) \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "by blast"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "case (Let \\<Delta> e')"], ["proof (state)\nthis:\n  atom ` domA \\<Delta> \\<sharp>* (\\<Gamma>, S)\n  e = Terms.Let \\<Delta> e'\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "from step.prems[unfolded Let(2)]"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> Terms.Let \\<Delta>\n                  e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>", "have prem: \"(\\<N>\\<lbrakk>e'\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> Terms.Let \\<Delta>\n                  e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  (C\\<cdot>r) \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "by (simp  del: app_strict)"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "also"], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "have \"atom ` domA \\<Delta> \\<sharp>* \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atom ` domA \\<Delta> \\<sharp>* \\<Gamma>", "using Let(1)"], ["proof (prove)\nusing this:\n  atom ` domA \\<Delta> \\<sharp>* (\\<Gamma>, S)\n\ngoal (1 subgoal):\n 1. atom ` domA \\<Delta> \\<sharp>* \\<Gamma>", "by (simp add: fresh_star_Pair)"], ["proof (state)\nthis:\n  atom ` domA \\<Delta> \\<sharp>* \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"\\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace> = \\<N>\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\""], ["proof (prove)\nusing this:\n  atom ` domA \\<Delta> \\<sharp>* \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace> =\n    \\<N>\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>", "by (rule HSem_merge)"], ["proof (state)\nthis:\n  \\<N>\\<lbrace>\\<Delta>\\<rbrace>\\<N>\\<lbrace>\\<Gamma>\\<rbrace> =\n  \\<N>\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "finally"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>", "have \"(\\<N>\\<lbrakk>e'\\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>r \\<noteq> \\<bottom>\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n    r \\<noteq>\n    \\<bottom>", "."], ["proof (state)\nthis:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "then"], ["proof (chain)\npicking this:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>", "obtain \\<Theta> v where \"\\<Delta> @ \\<Gamma> : e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\""], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Theta> v.\n        \\<Delta> @\n        \\<Gamma> : e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using step.IH"], ["proof (prove)\nusing this:\n  (\\<N>\\<lbrakk> e' \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>\\<Delta> @\n            \\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom>\n  (\\<N>\\<lbrakk> ?e \\<rbrakk>\\<^bsub>\\<N>\\<lbrace>?\\<Gamma>\\<rbrace>\\<^esub>)\\<cdot>\n  r \\<noteq>\n  \\<bottom> \\<Longrightarrow>\n  \\<exists>\\<Delta> a. ?\\<Gamma> : ?e \\<Down>\\<^bsub>?S\\<^esub> \\<Delta> : a\n\ngoal (1 subgoal):\n 1. (\\<And>\\<Theta> v.\n        \\<Delta> @\n        \\<Gamma> : e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<Delta> @ \\<Gamma> : e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "hence \"\\<Gamma> : Let \\<Delta> e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\""], ["proof (prove)\nusing this:\n  \\<Delta> @ \\<Gamma> : e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\n\ngoal (1 subgoal):\n 1. \\<Gamma> : Terms.Let \\<Delta> e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v", "by (rule reds.Let[OF Let(1)])"], ["proof (state)\nthis:\n  \\<Gamma> : Terms.Let \\<Delta> e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\n\ngoal (1 subgoal):\n 1. \\<And>\\<Gamma> exp.\n       \\<lbrakk>atom ` domA \\<Gamma> \\<sharp>* (\\<Gamma>, S);\n        e = Terms.Let \\<Gamma> exp\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<Delta> a.\n                            \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> : Terms.Let \\<Delta> e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "using Let"], ["proof (prove)\nusing this:\n  \\<Gamma> : Terms.Let \\<Delta> e' \\<Down>\\<^bsub>S\\<^esub> \\<Theta> : v\n  atom ` domA \\<Delta> \\<sharp>* (\\<Gamma>, S)\n  e = Terms.Let \\<Delta> e'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>\\<Delta> a. \\<Gamma> : e \\<Down>\\<^bsub>S\\<^esub> \\<Delta> : a\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}