{"file_name": "/home/qj213/afp-2021-10-22/thys/Launchbury/CorrectnessOriginal.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Launchbury", "problem_names": ["theorem correctness:\n  assumes \"\\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : v\"\n  and     \"fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\"\n  shows   \"\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = \\<lbrakk>v\\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\"\n  and     \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> = (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\""], "translations": [["", "theorem correctness:\n  assumes \"\\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : v\"\n  and     \"fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\"\n  shows   \"\\<lbrakk>e\\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = \\<lbrakk>v\\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\"\n  and     \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> = (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> &&&\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "using assms"], ["proof (prove)\nusing this:\n  \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : v\n  fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> &&&\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "proof(nominal_induct arbitrary: \\<rho> rule:reds.strong_induct)"], ["proof (state)\ngoal (12 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 3. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 9. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> b L \\<rho>.\n        fv (\\<Gamma>, Bool b)\n        \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n        (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n        (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\nA total of 12 subgoals...", "case Lambda"], ["proof (state)\nthis:\n  \n\ngoal (12 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 3. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 9. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> b L \\<rho>.\n        fv (\\<Gamma>, Bool b)\n        \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n        (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n        (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\nA total of 12 subgoals...", "case 1"], ["proof (state)\nthis:\n  fv (\\<Gamma>_, Lam [x_]. e_) \\<subseteq> set L_ \\<union> domA \\<Gamma>_\n\ngoal (12 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Lam [x]. e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 3. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 9. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> b L \\<rho>.\n        fv (\\<Gamma>, Bool b)\n        \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n        (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n        (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\nA total of 12 subgoals...", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Lam [x_]. e_ \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> Lam [x_]. e_ \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>\\<^esub>", ".."], ["proof (state)\nthis:\n  \\<lbrakk> Lam [x_]. e_ \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> Lam [x_]. e_ \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>\\<^esub>\n\ngoal (11 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 9. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                     : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                          \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\nA total of 11 subgoals...", "case 2"], ["proof (state)\nthis:\n  fv (\\<Gamma>_, Lam [x_]. e_) \\<subseteq> set L_ \\<union> domA \\<Gamma>_\n\ngoal (11 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<rho>.\n       fv (\\<Gamma>, Lam [x]. e)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 9. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                     : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                          \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\nA total of 11 subgoals...", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>) f|` domA \\<Gamma>_ =\n    (\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>) f|` domA \\<Gamma>_", ".."], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>) f|` domA \\<Gamma>_ =\n  (\\<lbrace>\\<Gamma>_\\<rbrace>\\<rho>) f|` domA \\<Gamma>_\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "next"], ["proof (state)\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "case (Application y \\<Gamma> e x L \\<Delta> \\<Theta> v e')"], ["proof (state)\nthis:\n  atom y \\<sharp> \\<Gamma>\n  atom y \\<sharp> e\n  atom y \\<sharp> x\n  atom y \\<sharp> L\n  atom y \\<sharp> \\<Delta>\n  atom y \\<sharp> \\<Theta>\n  atom y \\<sharp> v\n  \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e'\n  fv (\\<Gamma>, e)\n  \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (\\<Gamma>, e)\n  \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n  (\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Gamma>\n  \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : v\n  fv (\\<Delta>, e'[y::=x])\n  \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n  \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (\\<Delta>, e'[y::=x])\n  \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Delta> =\n  (\\<lbrace>\\<Theta>\\<rbrace>?\\<rho>) f|` domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have Gamma_subset: \"domA \\<Gamma> \\<subseteq> domA \\<Delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domA \\<Gamma> \\<subseteq> domA \\<Delta>", "by (rule reds_doesnt_forget[OF Application.hyps(8)])"], ["proof (state)\nthis:\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "case 1"], ["proof (state)\nthis:\n  fv (\\<Gamma>, App e x) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "hence prem1: \"fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\" and  \"x \\<in> set L \\<union> domA \\<Gamma>\""], ["proof (prove)\nusing this:\n  fv (\\<Gamma>, App e x) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma> &&&\n    x \\<in> set L \\<union> domA \\<Gamma>", "by auto"], ["proof (state)\nthis:\n  fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\n  x \\<in> set L \\<union> domA \\<Gamma>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "moreover"], ["proof (state)\nthis:\n  fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\n  x \\<in> set L \\<union> domA \\<Gamma>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "note reds_pres_closed[OF Application.hyps(8) prem1]"], ["proof (state)\nthis:\n  fv (\\<Delta>, Lam [y]. e') \\<subseteq> set L \\<union> domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "moreover"], ["proof (state)\nthis:\n  fv (\\<Delta>, Lam [y]. e') \\<subseteq> set L \\<union> domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "note reds_doesnt_forget[OF Application.hyps(8)]"], ["proof (state)\nthis:\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "moreover"], ["proof (state)\nthis:\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"fv (e'[y::=x]) \\<subseteq> fv (Lam [y]. e') \\<union> {x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv e'[y::=x] \\<subseteq> fv (Lam [y]. e') \\<union> {x}", "by (auto simp add: fv_subst_eq)"], ["proof (state)\nthis:\n  fv e'[y::=x] \\<subseteq> fv (Lam [y]. e') \\<union> {x}\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "ultimately"], ["proof (chain)\npicking this:\n  fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\n  x \\<in> set L \\<union> domA \\<Gamma>\n  fv (\\<Delta>, Lam [y]. e') \\<subseteq> set L \\<union> domA \\<Delta>\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n  fv e'[y::=x] \\<subseteq> fv (Lam [y]. e') \\<union> {x}", "have prem2: \"fv (\\<Delta>, e'[y::=x]) \\<subseteq> set L \\<union> domA \\<Delta>\""], ["proof (prove)\nusing this:\n  fv (\\<Gamma>, e) \\<subseteq> set L \\<union> domA \\<Gamma>\n  x \\<in> set L \\<union> domA \\<Gamma>\n  fv (\\<Delta>, Lam [y]. e') \\<subseteq> set L \\<union> domA \\<Delta>\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n  fv e'[y::=x] \\<subseteq> fv (Lam [y]. e') \\<union> {x}\n\ngoal (1 subgoal):\n 1. fv (\\<Delta>, e'[y::=x]) \\<subseteq> set L \\<union> domA \\<Delta>", "by auto"], ["proof (state)\nthis:\n  fv (\\<Delta>, e'[y::=x]) \\<subseteq> set L \\<union> domA \\<Delta>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have *: \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x = (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "proof(cases \"x \\<in> domA \\<Gamma>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "case True"], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "from Application.hyps(10)[OF prem1, where \\<rho> = \\<rho>]"], ["proof (chain)\npicking this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "have \"((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x  = ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x\""], ["proof (prove)\nusing this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n    ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x", "by simp"], ["proof (state)\nthis:\n  ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n  ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x\n\ngoal (2 subgoals):\n 1. x \\<in> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n 2. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "with True"], ["proof (chain)\npicking this:\n  x \\<in> domA \\<Gamma>\n  ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n  ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<in> domA \\<Gamma>\n  ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n  ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "by simp"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "case False"], ["proof (state)\nthis:\n  x \\<notin> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Gamma> \\<Longrightarrow>\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "from False \\<open>x \\<in> set L \\<union> domA \\<Gamma>\\<close> reds_avoids_live[OF Application.hyps(8)]"], ["proof (chain)\npicking this:\n  x \\<notin> domA \\<Gamma>\n  x \\<in> set L \\<union> domA \\<Gamma>\n  \\<lbrakk>?x \\<in> set L; ?x \\<notin> domA \\<Gamma>\\<rbrakk>\n  \\<Longrightarrow> ?x \\<notin> domA \\<Delta>", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<notin> domA \\<Gamma>\n  x \\<in> set L \\<union> domA \\<Gamma>\n  \\<lbrakk>?x \\<in> set L; ?x \\<notin> domA \\<Gamma>\\<rbrakk>\n  \\<Longrightarrow> ?x \\<notin> domA \\<Delta>\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "by (auto simp add: lookup_HSem_other)"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "text_raw \\<open>% nice proof start\\<close>"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = (\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) \\<down>Fn (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> App e\n               x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk> App e\n             x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> App e\n             x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<dots> = (\\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>) \\<down>Fn (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x", "using Application.hyps(9)[OF prem1]"], ["proof (prove)\nusing this:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<dots> = (\\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>) \\<down>Fn (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "unfolding *"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n    \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", ".."], ["proof (state)\nthis:\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<dots> = (Fn\\<cdot>(\\<Lambda> z. \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)(y := z)\\<^esub>)) \\<down>Fn (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n    Fn\\<cdot>\n    (\\<Lambda> z.\n        \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n        (y := z)\\<^esub>) \\<down>Fn\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n  Fn\\<cdot>\n  (\\<Lambda> z.\n      \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n      (y := z)\\<^esub>) \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n  Fn\\<cdot>\n  (\\<Lambda> z.\n      \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n      (y := z)\\<^esub>) \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)(y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Fn\\<cdot>\n    (\\<Lambda> z.\n        \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n        (y := z)\\<^esub>) \\<down>Fn\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n    \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n    (y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub>", "by simp"], ["proof (state)\nthis:\n  Fn\\<cdot>\n  (\\<Lambda> z.\n      \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n      (y := z)\\<^esub>) \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n  \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n  (y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  Fn\\<cdot>\n  (\\<Lambda> z.\n      \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n      (y := z)\\<^esub>) \\<down>Fn\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x =\n  \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n  (y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> e'[y ::= x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n    (y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub> =\n    \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>", "unfolding ESem_subst"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>", ".."], ["proof (state)\nthis:\n  \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n  (y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub> =\n  \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> e' \\<rbrakk>\\<^bsub>(\\<lbrace>\\<Delta>\\<rbrace>\\<rho>)\n  (y := (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x)\\<^esub> =\n  \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", "by (rule Application.hyps(12)[OF prem2])"], ["proof (state)\nthis:\n  \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (10 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> App e\n                                    x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 10. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z\n        \\<rho>.\n        \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool\n                                 b;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> Bool\n                       b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Gamma>, scrut)\n            \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n            (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n         \\<Delta> : (if b then e\\<^sub>1\n                     else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            \\<lbrakk> (if b then e\\<^sub>1\n                       else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n            \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n         \\<And>\\<rho>.\n            fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n            \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n            (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n            (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n         fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n         \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n        \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma> =\n                          (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                          domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk> App e\n             x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", "show \"\\<lbrakk> App e x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\nusing this:\n  \\<lbrakk> App e\n             x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<lbrakk> App e\n               x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", "."], ["proof (state)\nthis:\n  \\<lbrakk> App e\n             x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (9 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "text_raw \\<open>% nice proof end\\<close>"], ["proof (state)\nthis:\n  \\<lbrakk> App e\n             x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (9 subgoals):\n 1. \\<And>y \\<Gamma> e x L \\<Delta> \\<Theta> z e' \\<rho>.\n       \\<lbrakk>atom y \\<sharp> \\<Gamma>; atom y \\<sharp> e;\n        atom y \\<sharp> x; atom y \\<sharp> L; atom y \\<sharp> \\<Delta>;\n        atom y \\<sharp> \\<Theta>; atom y \\<sharp> z;\n        \\<Gamma> : e \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Lam [y]. e';\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Lam [y]. e' \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, e)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : e'[y::=x] \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> e'[y::=x] \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, e'[y::=x])\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, App e x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 9. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "show \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> = (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "using Application.hyps(10)[OF prem1]\n          env_restr_eq_subset[OF Gamma_subset Application.hyps(13)[OF prem2]]"], ["proof (prove)\nusing this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Gamma>\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>3) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Theta>\\<rbrace>?\\<rho>3) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "by (rule trans)"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "next"], ["proof (state)\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case (Variable \\<Gamma> x e L \\<Delta> v)"], ["proof (state)\nthis:\n  map_of \\<Gamma> x = Some e\n  delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : v\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union>\n              domA (delete x \\<Gamma>) \\<Longrightarrow>\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union>\n              domA (delete x \\<Gamma>) \\<Longrightarrow>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>?\\<rho>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA (delete x \\<Gamma>)\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "hence [simp]:\"x \\<in> domA \\<Gamma>\""], ["proof (prove)\nusing this:\n  map_of \\<Gamma> x = Some e\n  delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : v\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union>\n              domA (delete x \\<Gamma>) \\<Longrightarrow>\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union>\n              domA (delete x \\<Gamma>) \\<Longrightarrow>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>?\\<rho>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA (delete x \\<Gamma>)\n\ngoal (1 subgoal):\n 1. x \\<in> domA \\<Gamma>", "by (metis domA_from_set map_of_SomeD)"], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "let ?\\<Gamma> = \"delete x \\<Gamma>\""], ["proof (state)\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case 2"], ["proof (state)\nthis:\n  fv (\\<Gamma>, Var x) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"x \\<notin> domA \\<Delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> domA \\<Delta>", "by (rule reds_avoids_live[OF Variable.hyps(2)], simp_all)"], ["proof (state)\nthis:\n  x \\<notin> domA \\<Delta>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have subset: \"domA ?\\<Gamma> \\<subseteq> domA \\<Delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domA (delete x \\<Gamma>) \\<subseteq> domA \\<Delta>", "by (rule reds_doesnt_forget[OF Variable.hyps(2)])"], ["proof (state)\nthis:\n  domA (delete x \\<Gamma>) \\<subseteq> domA \\<Delta>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "let \"?new\" = \"domA \\<Delta> - domA \\<Gamma>\""], ["proof (state)\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"fv (?\\<Gamma>, e) \\<union> {x} \\<subseteq> fv (\\<Gamma>, Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv (delete x \\<Gamma>, e) \\<union> {x} \\<subseteq> fv (\\<Gamma>, Var x)", "by (rule fv_delete_heap[OF \\<open>map_of \\<Gamma> x = Some e\\<close>])"], ["proof (state)\nthis:\n  fv (delete x \\<Gamma>, e) \\<union> {x} \\<subseteq> fv (\\<Gamma>, Var x)\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "hence prem: \"fv (?\\<Gamma>, e) \\<subseteq> set (x # L) \\<union> domA ?\\<Gamma>\""], ["proof (prove)\nusing this:\n  fv (delete x \\<Gamma>, e) \\<union> {x} \\<subseteq> fv (\\<Gamma>, Var x)\n\ngoal (1 subgoal):\n 1. fv (delete x \\<Gamma>, e)\n    \\<subseteq> set (x # L) \\<union> domA (delete x \\<Gamma>)", "using 2"], ["proof (prove)\nusing this:\n  fv (delete x \\<Gamma>, e) \\<union> {x} \\<subseteq> fv (\\<Gamma>, Var x)\n  fv (\\<Gamma>, Var x) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. fv (delete x \\<Gamma>, e)\n    \\<subseteq> set (x # L) \\<union> domA (delete x \\<Gamma>)", "by auto"], ["proof (state)\nthis:\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union> domA (delete x \\<Gamma>)\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "hence fv_subset: \"fv (?\\<Gamma>, e) - domA ?\\<Gamma> \\<subseteq> - ?new\""], ["proof (prove)\nusing this:\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union> domA (delete x \\<Gamma>)\n\ngoal (1 subgoal):\n 1. fv (delete x \\<Gamma>, e) - domA (delete x \\<Gamma>)\n    \\<subseteq> - (domA \\<Delta> - domA \\<Gamma>)", "using reds_avoids_live'[OF Variable.hyps(2)]"], ["proof (prove)\nusing this:\n  fv (delete x \\<Gamma>, e)\n  \\<subseteq> set (x # L) \\<union> domA (delete x \\<Gamma>)\n  (domA \\<Delta> - domA (delete x \\<Gamma>)) \\<inter> set (x # L) = {}\n\ngoal (1 subgoal):\n 1. fv (delete x \\<Gamma>, e) - domA (delete x \\<Gamma>)\n    \\<subseteq> - (domA \\<Delta> - domA \\<Gamma>)", "by auto"], ["proof (state)\nthis:\n  fv (delete x \\<Gamma>, e) - domA (delete x \\<Gamma>)\n  \\<subseteq> - (domA \\<Delta> - domA \\<Gamma>)\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"domA \\<Gamma> \\<subseteq> (-?new)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domA \\<Gamma> \\<subseteq> - (domA \\<Delta> - domA \\<Gamma>)", "by auto"], ["proof (state)\nthis:\n  domA \\<Gamma> \\<subseteq> - (domA \\<Delta> - domA \\<Gamma>)\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<lbrace>\\<Gamma>\\<rbrace>\\<rho> = \\<lbrace>(x,e) # ?\\<Gamma>\\<rbrace>\\<rho>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrace>\\<Gamma>\\<rbrace>\\<rho> =\n    \\<lbrace>(x, e) # delete x \\<Gamma>\\<rbrace>\\<rho>", "by (rule HSem_reorder[OF map_of_delete_insert[symmetric, OF Variable(1)]])"], ["proof (state)\nthis:\n  \\<lbrace>\\<Gamma>\\<rbrace>\\<rho> =\n  \\<lbrace>(x, e) # delete x \\<Gamma>\\<rbrace>\\<rho>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrace>\\<Gamma>\\<rbrace>\\<rho> =\n  \\<lbrace>(x, e) # delete x \\<Gamma>\\<rbrace>\\<rho>\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<mu> \\<rho>'. (\\<rho> ++\\<^bsub>(domA ?\\<Gamma>)\\<^esub> (\\<lbrace>?\\<Gamma>\\<rbrace>\\<rho>'))( x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<rho>'\\<^esub>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrace>(x, e) # delete x \\<Gamma>\\<rbrace>\\<rho> =\n    (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>xa\\<^esub>))", "by (rule iterative_HSem, simp)"], ["proof (state)\nthis:\n  \\<lbrace>(x, e) # delete x \\<Gamma>\\<rbrace>\\<rho> =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>xa\\<^esub>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrace>(x, e) # delete x \\<Gamma>\\<rbrace>\\<rho> =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>xa\\<^esub>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<mu> \\<rho>'. (\\<rho> ++\\<^bsub>(domA ?\\<Gamma>)\\<^esub> (\\<lbrace>?\\<Gamma>\\<rbrace>\\<rho>'))( x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>?\\<Gamma>\\<rbrace>\\<rho>'\\<^esub>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>xa\\<^esub>)) =\n    (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n               \\<Gamma>\\<rbrace>xa\\<^esub>))", "by (rule iterative_HSem', simp)"], ["proof (state)\nthis:\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>xa\\<^esub>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  \\<lbrace>\\<Gamma>\\<rbrace>\\<rho> =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>))", "have \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)f|` (- ?new) = (...) f|` (- ?new)\""], ["proof (prove)\nusing this:\n  \\<lbrace>\\<Gamma>\\<rbrace>\\<rho> =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>))\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>)) =\n    (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n               \\<Gamma>\\<rbrace>xa\\<^esub>)) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>))", "by simp"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<mu> \\<rho>'. (\\<rho> ++\\<^bsub>domA \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>'))( x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>'\\<^esub>)) f|` (- ?new)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n               \\<Gamma>\\<rbrace>xa\\<^esub>)) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>)) =\n    (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n        (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>)) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>))", "proof (induction rule: parallel_fix_ind[where P =\"\\<lambda> x y. x f|` (- ?new) = y f|` (- ?new)\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>x.\n            fst x f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n            snd x f|` (- (domA \\<Delta> - domA \\<Gamma>)))\n 2. \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n    \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))\n 3. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>x.\n            fst x f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n            snd x f|` (- (domA \\<Delta> - domA \\<Gamma>)))\n 2. \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n    \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))\n 3. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>x.\n            fst x f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n            snd x f|` (- (domA \\<Delta> - domA \\<Gamma>)))", "by simp"], ["proof (state)\nthis:\n  adm (\\<lambda>x.\n          fst x f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n          snd x f|` (- (domA \\<Delta> - domA \\<Gamma>)))\n\ngoal (2 subgoals):\n 1. \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n    \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))\n 2. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n    \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))\n 2. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "case 2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n    \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))\n 2. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n    \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))", ".."], ["proof (state)\nthis:\n  \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n  \\<bottom> f|` (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "case (3 \\<sigma> \\<sigma>')"], ["proof (state)\nthis:\n  \\<sigma> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n  \\<sigma>' f|` (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "hence \"\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>?\\<Gamma>\\<rbrace>\\<sigma>\\<^esub> = \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>?\\<Gamma>\\<rbrace>\\<sigma>'\\<^esub>\"\n      and \"(\\<lbrace>?\\<Gamma>\\<rbrace>\\<sigma>) f|` domA ?\\<Gamma> = (\\<lbrace>?\\<Gamma>\\<rbrace>\\<sigma>') f|` domA ?\\<Gamma>\""], ["proof (prove)\nusing this:\n  \\<sigma> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n  \\<sigma>' f|` (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n     \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n    \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n     \\<Gamma>\\<rbrace>\\<sigma>'\\<^esub> &&&\n    (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n    domA (delete x \\<Gamma>) =\n    (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>') f|`\n    domA (delete x \\<Gamma>)", "using fv_subset"], ["proof (prove)\nusing this:\n  \\<sigma> f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n  \\<sigma>' f|` (- (domA \\<Delta> - domA \\<Gamma>))\n  fv (delete x \\<Gamma>, e) - domA (delete x \\<Gamma>)\n  \\<subseteq> - (domA \\<Delta> - domA \\<Gamma>)\n\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n     \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n    \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n     \\<Gamma>\\<rbrace>\\<sigma>'\\<^esub> &&&\n    (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n    domA (delete x \\<Gamma>) =\n    (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>') f|`\n    domA (delete x \\<Gamma>)", "by (auto intro: ESem_fresh_cong HSem_fresh_cong  env_restr_eq_subset[OF _ 3])"], ["proof (state)\nthis:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>'\\<^esub>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>') f|`\n  domA (delete x \\<Gamma>)\n\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "from trans[OF this(1) Variable(3)[OF prem]] trans[OF this(2) Variable(4)[OF prem]]"], ["proof (chain)\npicking this:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA (delete x \\<Gamma>)", "have  \"\\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>?\\<Gamma>\\<rbrace>\\<sigma>\\<^esub> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub>\"\n       and \"(\\<lbrace>?\\<Gamma>\\<rbrace>\\<sigma>) f|` domA ?\\<Gamma> = (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA ?\\<Gamma>\""], ["proof (prove)\nusing this:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA (delete x \\<Gamma>)\n\ngoal (1 subgoal):\n 1. \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n     \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub> &&&\n    (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n    domA (delete x \\<Gamma>) =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA (delete x \\<Gamma>)", "."], ["proof (state)\nthis:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA (delete x \\<Gamma>)\n\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       xa f|` (- (domA \\<Delta> - domA \\<Gamma>)) =\n       y f|` (- (domA \\<Delta> - domA \\<Gamma>)) \\<Longrightarrow>\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              (delete x\n                                \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                       \\<Gamma>\\<rbrace>xa))\n           (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n       xa f|`\n       (- (domA \\<Delta> - domA \\<Gamma>)) =\n       (\\<Lambda> xa.\n           (\\<rho> ++\\<^bsub>domA\n                              \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n           (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n       y f|`\n       (- (domA \\<Delta> - domA \\<Gamma>))", "thus ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA (delete x \\<Gamma>)\n\ngoal (1 subgoal):\n 1. (\\<Lambda> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n               \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n    \\<sigma> f|`\n    (- (domA \\<Delta> - domA \\<Gamma>)) =\n    (\\<Lambda> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n        (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n    \\<sigma>' f|`\n    (- (domA \\<Delta> - domA \\<Gamma>))", "using subset"], ["proof (prove)\nusing this:\n  \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n   \\<Gamma>\\<rbrace>\\<sigma>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>'\\<^esub>\n  (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<sigma>) f|`\n  domA (delete x \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<sigma>') f|` domA (delete x \\<Gamma>)\n  domA (delete x \\<Gamma>) \\<subseteq> domA \\<Delta>\n\ngoal (1 subgoal):\n 1. (\\<Lambda> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           (delete x\n                             \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                    \\<Gamma>\\<rbrace>xa))\n        (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n               \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n    \\<sigma> f|`\n    (- (domA \\<Delta> - domA \\<Gamma>)) =\n    (\\<Lambda> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n        (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n    \\<sigma>' f|`\n    (- (domA \\<Delta> - domA \\<Gamma>))", "by (fastforce simp add: lookup_override_on_eq  lookup_env_restr_eq dest: env_restr_eqD )"], ["proof (state)\nthis:\n  (\\<Lambda> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>))\\<cdot>\n  \\<sigma> f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<Lambda> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>))\\<cdot>\n  \\<sigma>' f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         (delete x\n                           \\<Gamma>)\\<^esub> (\\<lbrace>delete x\n                  \\<Gamma>\\<rbrace>xa))\n      (x := \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n             \\<Gamma>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<mu> \\<rho>'. (\\<rho> ++\\<^bsub>domA \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>'))( x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<rho>'\\<^esub>)) f|` (-?new)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n        (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>)) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>)) =\n    (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n        (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>xa\\<^esub>)) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>))", "by (rule arg_cong[OF iterative_HSem'[symmetric], OF \\<open>x \\<notin> domA \\<Delta>\\<close>])"], ["proof (state)\nthis:\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<lbrace>(x,v) # \\<Delta>\\<rbrace>\\<rho>)  f|` (-?new)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<mu> xa.\n        (\\<rho> ++\\<^bsub>domA\n                           \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n        (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>xa\\<^esub>)) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>)) =\n    (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) f|`\n    (- (domA \\<Delta> - domA \\<Gamma>))", "by (rule arg_cong[OF iterative_HSem[symmetric], OF \\<open>x \\<notin> domA \\<Delta>\\<close>])"], ["proof (state)\nthis:\n  (\\<mu> xa.\n      (\\<rho> ++\\<^bsub>domA\n                         \\<Delta>\\<^esub> (\\<lbrace>\\<Delta>\\<rbrace>xa))\n      (x := \\<lbrakk> v \\<rbrakk>\\<^bsub>xa\\<^esub>)) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (8 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>(x, z) # \\<Delta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 8. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))", "show le: ?case"], ["proof (prove)\nusing this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>)) =\n  (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) f|`\n  (- (domA \\<Delta> - domA \\<Gamma>))\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "by (rule env_restr_eq_subset[OF \\<open>domA \\<Gamma> \\<subseteq> (-?new)\\<close>])"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (7 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n        \\<Delta>\\<rbrace>\\<rho>\\<^esub>", "using env_restr_eqD[OF le, where x = x]"], ["proof (prove)\nusing this:\n  x \\<in> domA \\<Gamma> \\<Longrightarrow>\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (1 subgoal):\n 1. \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n        \\<Delta>\\<rbrace>\\<rho>\\<^esub>", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n      \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (7 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n      \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (7 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n        \\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n    \\<Delta>\\<rbrace>\\<rho>\\<^esub>", "by (auto simp add: lookup_HSem_heap)"], ["proof (state)\nthis:\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n      \\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n  \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (7 subgoals):\n 1. \\<And>\\<Gamma> x e L \\<Delta> z \\<rho>.\n       \\<lbrakk>map_of \\<Gamma> x = Some e;\n        delete x \\<Gamma> : e \\<Down>\\<^bsub>x # L\\<^esub> \\<Delta> : z;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> e \\<rbrakk>\\<^bsub>\\<lbrace>delete x\n            \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (delete x \\<Gamma>, e)\n           \\<subseteq> set (x # L) \\<union>\n                       domA (delete x \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>delete x \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (delete x \\<Gamma>) =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA (delete x \\<Gamma>);\n        fv (\\<Gamma>, Var x)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>(x, z) #\n                         \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 3. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 7. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n  \\<Delta>\\<rbrace>\\<rho>\\<^esub>", "show \"\\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) # \\<Delta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\nusing this:\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n  \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n    \\<Delta>\\<rbrace>\\<rho>\\<^esub>", "."], ["proof (state)\nthis:\n  \\<lbrakk> Var x \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>(x, v) #\n  \\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (6 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 5. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 5. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case (Bool b)"], ["proof (state)\nthis:\n  \n\ngoal (6 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 5. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case 1"], ["proof (state)\nthis:\n  fv (b, Bool b_) \\<subseteq> set L_ \\<union> domA b\n\ngoal (6 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n       \\<lbrakk> Bool\n                  b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 5. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 6. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Bool b_ \\<rbrakk>\\<^bsub>\\<lbrace>b\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> Bool b_ \\<rbrakk>\\<^bsub>\\<lbrace>b\\<rbrace>\\<rho>\\<^esub>", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk> Bool b_ \\<rbrakk>\\<^bsub>\\<lbrace>b\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> Bool b_ \\<rbrakk>\\<^bsub>\\<lbrace>b\\<rbrace>\\<rho>\\<^esub>\n\ngoal (5 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case 2"], ["proof (state)\nthis:\n  fv (b, Bool b_) \\<subseteq> set L_ \\<union> domA b\n\ngoal (5 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> b L \\<rho>.\n       fv (\\<Gamma>, Bool b)\n       \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 5. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>b\\<rbrace>\\<rho>) f|` domA b =\n    (\\<lbrace>b\\<rbrace>\\<rho>) f|` domA b", "by simp"], ["proof (state)\nthis:\n  (\\<lbrace>b\\<rbrace>\\<rho>) f|` domA b =\n  (\\<lbrace>b\\<rbrace>\\<rho>) f|` domA b\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case (IfThenElse \\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> v)"], ["proof (state)\nthis:\n  \\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b\n  fv (\\<Gamma>, scrut)\n  \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n  \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> Bool\n             b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (\\<Gamma>, scrut)\n  \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n  (\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Gamma>\n  \\<Delta> : (if b then e\\<^sub>1\n              else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : v\n  fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n  \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n  \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Delta> =\n  (\\<lbrace>\\<Theta>\\<rbrace>?\\<rho>) f|` domA \\<Delta>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have Gamma_subset: \"domA \\<Gamma> \\<subseteq> domA \\<Delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domA \\<Gamma> \\<subseteq> domA \\<Delta>", "by (rule reds_doesnt_forget[OF IfThenElse.hyps(1)])"], ["proof (state)\nthis:\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "let ?e = \"if b then e\\<^sub>1 else e\\<^sub>2\""], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case 1"], ["proof (state)\nthis:\n  fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n  \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "hence prem1: \"fv (\\<Gamma>, scrut) \\<subseteq> set L \\<union> domA \\<Gamma>\"\n    and prem2: \"fv (\\<Delta>, ?e) \\<subseteq> set L \\<union> domA \\<Delta>\"\n    and \"fv ?e \\<subseteq> domA \\<Gamma> \\<union> set L\""], ["proof (prove)\nusing this:\n  fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n  \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, scrut) \\<subseteq> set L \\<union> domA \\<Gamma> &&&\n    fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n    \\<subseteq> set L \\<union> domA \\<Delta> &&&\n    fv (if b then e\\<^sub>1 else e\\<^sub>2)\n    \\<subseteq> domA \\<Gamma> \\<union> set L", "using new_free_vars_on_heap[OF IfThenElse.hyps(1)] Gamma_subset"], ["proof (prove)\nusing this:\n  fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n  \\<subseteq> set L \\<union> domA \\<Gamma>\n  fv (\\<Delta>, Bool b) - domA \\<Delta>\n  \\<subseteq> fv (\\<Gamma>, scrut) - domA \\<Gamma>\n  domA \\<Gamma> \\<subseteq> domA \\<Delta>\n\ngoal (1 subgoal):\n 1. fv (\\<Gamma>, scrut) \\<subseteq> set L \\<union> domA \\<Gamma> &&&\n    fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n    \\<subseteq> set L \\<union> domA \\<Delta> &&&\n    fv (if b then e\\<^sub>1 else e\\<^sub>2)\n    \\<subseteq> domA \\<Gamma> \\<union> set L", "by auto"], ["proof (state)\nthis:\n  fv (\\<Gamma>, scrut) \\<subseteq> set L \\<union> domA \\<Gamma>\n  fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n  \\<subseteq> set L \\<union> domA \\<Delta>\n  fv (if b then e\\<^sub>1 else e\\<^sub>2)\n  \\<subseteq> domA \\<Gamma> \\<union> set L\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<lbrakk> (scrut ? e\\<^sub>1 : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = B_project\\<cdot>(\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>(\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>(\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> (scrut ? e\\<^sub>1\n               : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    B_project\\<cdot>\n    (\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk> (scrut ? e\\<^sub>1\n             : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  B_project\\<cdot>\n  (\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> (scrut ? e\\<^sub>1\n             : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  B_project\\<cdot>\n  (\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = B_project\\<cdot>(\\<lbrakk> Bool b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>(\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>(\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B_project\\<cdot>\n    (\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n    B_project\\<cdot>\n    (\\<lbrakk> Bool\n                b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)", "unfolding IfThenElse.hyps(2)[OF prem1]"], ["proof (prove)\ngoal (1 subgoal):\n 1. B_project\\<cdot>\n    (\\<lbrakk> Bool\n                b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n    B_project\\<cdot>\n    (\\<lbrakk> Bool\n                b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)", ".."], ["proof (state)\nthis:\n  B_project\\<cdot>\n  (\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n  B_project\\<cdot>\n  (\\<lbrakk> Bool\n              b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  B_project\\<cdot>\n  (\\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n  B_project\\<cdot>\n  (\\<lbrakk> Bool\n              b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> ?e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B_project\\<cdot>\n    (\\<lbrakk> Bool\n                b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n    (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n    \\<lbrakk> (if b then e\\<^sub>1\n               else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>", "by simp"], ["proof (state)\nthis:\n  B_project\\<cdot>\n  (\\<lbrakk> Bool\n              b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  B_project\\<cdot>\n  (\\<lbrakk> Bool\n              b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>1 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>)\\<cdot>\n  (\\<lbrakk> e\\<^sub>2 \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>) =\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> ?e \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> (if b then e\\<^sub>1\n               else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> (if b then e\\<^sub>1\n               else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>", "proof(rule ESem_fresh_cong_subset[OF  \\<open>fv ?e \\<subseteq> domA \\<Gamma> \\<union> set L\\<close> env_restr_eqI])"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> domA \\<Gamma> \\<union> set L \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n       (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> domA \\<Gamma> \\<union> set L \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n       (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "assume \"x \\<in> domA \\<Gamma> \\<union> set L\""], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma> \\<union> set L\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> domA \\<Gamma> \\<union> set L \\<Longrightarrow>\n       (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n       (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "thus \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x = (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\""], ["proof (prove)\nusing this:\n  x \\<in> domA \\<Gamma> \\<union> set L\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "proof(cases \"x \\<in> domA \\<Gamma>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<in> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n 2. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<notin> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "assume \"x \\<in> domA \\<Gamma>\""], ["proof (state)\nthis:\n  x \\<in> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<in> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n 2. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<notin> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "from IfThenElse.hyps(3)[OF prem1]"], ["proof (chain)\npicking this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Gamma>", "have \"((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x  = ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x\""], ["proof (prove)\nusing this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n    ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x", "by simp"], ["proof (state)\nthis:\n  ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n  ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x\n\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<in> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n 2. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<notin> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "with \\<open>x \\<in> domA \\<Gamma>\\<close>"], ["proof (chain)\npicking this:\n  x \\<in> domA \\<Gamma>\n  ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n  ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<in> domA \\<Gamma>\n  ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n  ((\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "by simp"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<notin> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<notin> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "assume \"x \\<notin> domA \\<Gamma>\""], ["proof (state)\nthis:\n  x \\<notin> domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> domA \\<Gamma> \\<union> set L;\n     x \\<notin> domA \\<Gamma>\\<rbrakk>\n    \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n                      (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "from this \\<open>x \\<in> domA \\<Gamma> \\<union> set L\\<close> reds_avoids_live[OF IfThenElse.hyps(1)]"], ["proof (chain)\npicking this:\n  x \\<notin> domA \\<Gamma>\n  x \\<in> domA \\<Gamma> \\<union> set L\n  \\<lbrakk>?x \\<in> set L; ?x \\<notin> domA \\<Gamma>\\<rbrakk>\n  \\<Longrightarrow> ?x \\<notin> domA \\<Delta>", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<notin> domA \\<Gamma>\n  x \\<in> domA \\<Gamma> \\<union> set L\n  \\<lbrakk>?x \\<in> set L; ?x \\<notin> domA \\<Gamma>\\<rbrakk>\n  \\<Longrightarrow> ?x \\<notin> domA \\<Delta>\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x", "by (simp add: lookup_HSem_other)"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) x =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> (if b then e\\<^sub>1\n               else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", "unfolding IfThenElse.hyps(5)[OF prem2]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", ".."], ["proof (state)\nthis:\n  \\<lbrakk> (if b then e\\<^sub>1\n             else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> (scrut ? e\\<^sub>1\n                                    : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 4. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk> (scrut ? e\\<^sub>1\n             : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk> (scrut ? e\\<^sub>1\n             : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<lbrakk> (scrut ? e\\<^sub>1\n               : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>", "."], ["proof (state)\nthis:\n  \\<lbrakk> (scrut ? e\\<^sub>1\n             : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (3 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "thm env_restr_eq_subset"], ["proof (state)\nthis:\n  \\<lbrakk> (scrut ? e\\<^sub>1\n             : e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (3 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>\n 3. \\<And>\\<Gamma> scrut L \\<Delta> b e\\<^sub>1 e\\<^sub>2 \\<Theta> z \\<rho>.\n       \\<lbrakk>\\<Gamma> : scrut \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : Bool b;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           \\<lbrakk> scrut \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> Bool\n                      b \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Gamma>, scrut)\n           \\<subseteq> set L \\<union> domA \\<Gamma> \\<Longrightarrow>\n           (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>;\n        \\<Delta> : (if b then e\\<^sub>1\n                    else e\\<^sub>2) \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           \\<lbrakk> (if b then e\\<^sub>1\n                      else e\\<^sub>2) \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta>, if b then e\\<^sub>1 else e\\<^sub>2)\n           \\<subseteq> set L \\<union> domA \\<Delta> \\<Longrightarrow>\n           (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Delta> =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Delta>;\n        fv (\\<Gamma>, scrut ? e\\<^sub>1 : e\\<^sub>2)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "show \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> = (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "using IfThenElse.hyps(3)[OF prem1]\n          env_restr_eq_subset[OF Gamma_subset IfThenElse.hyps(6)[OF prem2]]"], ["proof (prove)\nusing this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>?\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA \\<Gamma>\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>3) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Theta>\\<rbrace>?\\<rho>3) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "by (rule trans)"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case (Let as \\<Gamma> L body \\<Delta> v)"], ["proof (state)\nthis:\n  atom ` domA as \\<sharp>* \\<Gamma>\n  atom ` domA as \\<sharp>* L\n  as @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Delta> : v\n  fv (as @ \\<Gamma>, body)\n  \\<subseteq> set L \\<union> domA (as @ \\<Gamma>) \\<Longrightarrow>\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @\n     \\<Gamma>\\<rbrace>?\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>\\<^esub>\n  fv (as @ \\<Gamma>, body)\n  \\<subseteq> set L \\<union> domA (as @ \\<Gamma>) \\<Longrightarrow>\n  (\\<lbrace>as @ \\<Gamma>\\<rbrace>?\\<rho>) f|` domA (as @ \\<Gamma>) =\n  (\\<lbrace>\\<Delta>\\<rbrace>?\\<rho>) f|` domA (as @ \\<Gamma>)\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "case 1"], ["proof (state)\nthis:\n  fv (\\<Gamma>, Terms.Let as body) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "{"], ["proof (state)\nthis:\n  fv (\\<Gamma>, Terms.Let as body) \\<subseteq> set L \\<union> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "fix a"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "assume a: \"a \\<in> domA  as\""], ["proof (state)\nthis:\n  a \\<in> domA as\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"atom a \\<sharp> \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atom a \\<sharp> \\<Gamma>", "by (rule Let(1)[unfolded fresh_star_def, rule_format, OF imageI[OF a]])"], ["proof (state)\nthis:\n  atom a \\<sharp> \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "hence \"a \\<notin> domA \\<Gamma>\""], ["proof (prove)\nusing this:\n  atom a \\<sharp> \\<Gamma>\n\ngoal (1 subgoal):\n 1. a \\<notin> domA \\<Gamma>", "by (metis domA_not_fresh)"], ["proof (state)\nthis:\n  a \\<notin> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "}"], ["proof (state)\nthis:\n  ?a2 \\<in> domA as \\<Longrightarrow> ?a2 \\<notin> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "note * = this"], ["proof (state)\nthis:\n  ?a2 \\<in> domA as \\<Longrightarrow> ?a2 \\<notin> domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"fv (as @ \\<Gamma>, body) - domA (as @ \\<Gamma>) \\<subseteq>  fv (\\<Gamma>, Let as body) - domA \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv (as @ \\<Gamma>, body) - domA (as @ \\<Gamma>)\n    \\<subseteq> fv (\\<Gamma>, Terms.Let as body) - domA \\<Gamma>", "by auto"], ["proof (state)\nthis:\n  fv (as @ \\<Gamma>, body) - domA (as @ \\<Gamma>)\n  \\<subseteq> fv (\\<Gamma>, Terms.Let as body) - domA \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "with 1"], ["proof (chain)\npicking this:\n  fv (\\<Gamma>, Terms.Let as body) \\<subseteq> set L \\<union> domA \\<Gamma>\n  fv (as @ \\<Gamma>, body) - domA (as @ \\<Gamma>)\n  \\<subseteq> fv (\\<Gamma>, Terms.Let as body) - domA \\<Gamma>", "have prem: \"fv (as @ \\<Gamma>, body) \\<subseteq> set L \\<union> domA (as @ \\<Gamma>)\""], ["proof (prove)\nusing this:\n  fv (\\<Gamma>, Terms.Let as body) \\<subseteq> set L \\<union> domA \\<Gamma>\n  fv (as @ \\<Gamma>, body) - domA (as @ \\<Gamma>)\n  \\<subseteq> fv (\\<Gamma>, Terms.Let as body) - domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. fv (as @ \\<Gamma>, body) \\<subseteq> set L \\<union> domA (as @ \\<Gamma>)", "by auto"], ["proof (state)\nthis:\n  fv (as @ \\<Gamma>, body) \\<subseteq> set L \\<union> domA (as @ \\<Gamma>)\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have f1: \"atom ` domA as \\<sharp>* \\<Gamma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atom ` domA as \\<sharp>* \\<Gamma>", "using Let(1)"], ["proof (prove)\nusing this:\n  atom ` domA as \\<sharp>* \\<Gamma>\n\ngoal (1 subgoal):\n 1. atom ` domA as \\<sharp>* \\<Gamma>", "by (simp add: set_bn_to_atom_domA)"], ["proof (state)\nthis:\n  atom ` domA as \\<sharp>* \\<Gamma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<lbrakk> Let as body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> = \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> Terms.Let as\n               body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>", "by (simp)"], ["proof (state)\nthis:\n  \\<lbrakk> Terms.Let as\n             body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> Terms.Let as\n             body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @\n       \\<Gamma>\\<rbrace>\\<rho>\\<^esub>", "by (rule arg_cong[OF HSem_merge[OF f1]])"], ["proof (state)\nthis:\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @\n     \\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @\n     \\<Gamma>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @\n       \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>", "by (rule Let.hyps(4)[OF prem])"], ["proof (state)\nthis:\n  \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>as @\n     \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (2 subgoals):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> \\<lbrakk> Terms.Let \\<Delta>\n                                    body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n                         \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>\n 2. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk> Terms.Let as\n             body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk> Terms.Let as\n             body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<lbrakk> Terms.Let as\n               body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n    \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>", "."], ["proof (state)\nthis:\n  \\<lbrakk> Terms.Let as\n             body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n  \\<lbrakk> v \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta>\\<rbrace>\\<rho>\\<^esub>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` (domA \\<Gamma>) = (\\<lbrace>as\\<rbrace>(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>)) f|` (domA \\<Gamma>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "apply (rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n       ((\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n        domA \\<Gamma>)\n        x", "apply (case_tac \"x \\<in> domA as\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> domA as \\<Longrightarrow>\n       ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n       ((\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n        domA \\<Gamma>)\n        x\n 2. \\<And>x.\n       x \\<notin> domA as \\<Longrightarrow>\n       ((\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>) x =\n       ((\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n        domA \\<Gamma>)\n        x", "apply (auto simp add: lookup_HSem_other lookup_env_restr_eq *)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>) f|` (domA \\<Gamma>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n    domA \\<Gamma> =\n    (\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "by (rule arg_cong[OF HSem_merge[OF f1]])"], ["proof (state)\nthis:\n  (\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "also"], ["proof (state)\nthis:\n  (\\<lbrace>as\\<rbrace>\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "have \"\\<dots> = (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` (domA \\<Gamma>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "by (rule env_restr_eq_subset[OF _ Let.hyps(5)[OF prem]]) simp"], ["proof (state)\nthis:\n  (\\<lbrace>as @ \\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. \\<And>\\<Delta> \\<Gamma> L body \\<Theta> z \\<rho>.\n       \\<lbrakk>atom ` domA \\<Delta> \\<sharp>* \\<Gamma>;\n        atom ` domA \\<Delta> \\<sharp>* L;\n        \\<Delta> @ \\<Gamma> : body \\<Down>\\<^bsub>L\\<^esub> \\<Theta> : z;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           \\<lbrakk> body \\<rbrakk>\\<^bsub>\\<lbrace>\\<Delta> @\n              \\<Gamma>\\<rbrace>\\<rho>\\<^esub> =\n           \\<lbrakk> z \\<rbrakk>\\<^bsub>\\<lbrace>\\<Theta>\\<rbrace>\\<rho>\\<^esub>;\n        \\<And>\\<rho>.\n           fv (\\<Delta> @ \\<Gamma>, body)\n           \\<subseteq> set L \\<union>\n                       domA (\\<Delta> @ \\<Gamma>) \\<Longrightarrow>\n           (\\<lbrace>\\<Delta> @ \\<Gamma>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>) =\n           (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n           domA (\\<Delta> @ \\<Gamma>);\n        fv (\\<Gamma>, Terms.Let \\<Delta> body)\n        \\<subseteq> set L \\<union> domA \\<Gamma>\\<rbrakk>\n       \\<Longrightarrow> (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma> =\n                         (\\<lbrace>\\<Theta>\\<rbrace>\\<rho>) f|`\n                         domA \\<Gamma>", "finally"], ["proof (chain)\npicking this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "show \"(\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> = (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\""], ["proof (prove)\nusing this:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal (1 subgoal):\n 1. (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n    (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>", "."], ["proof (state)\nthis:\n  (\\<lbrace>\\<Gamma>\\<rbrace>\\<rho>) f|` domA \\<Gamma> =\n  (\\<lbrace>\\<Delta>\\<rbrace>\\<rho>) f|` domA \\<Gamma>\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}